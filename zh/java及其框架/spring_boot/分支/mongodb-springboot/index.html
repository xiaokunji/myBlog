<!doctype html><html lang=zh dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>MongoDB-SpringBoot | ç±³äºŒ</title><meta name=keywords content="default"><meta name=description content="     "><meta name=author content="xkj"><link rel=canonical href=https://xiaokunji.github.io/zh/java%E5%8F%8A%E5%85%B6%E6%A1%86%E6%9E%B6/spring_boot/%E5%88%86%E6%94%AF/mongodb-springboot/><link crossorigin=anonymous href=/assets/css/stylesheet.4e0011f750c7441f57e7cdbfd7afb83ad2ac4efdcdb4adebee9988b40de3f85c.css integrity="sha256-TgAR91DHRB9X582/16+4OtKsTv3NtK3r7pmItA3j+Fw=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://xiaokunji.github.io/img/Q.gif><link rel=icon type=image/png sizes=16x16 href=https://xiaokunji.github.io/img/Q.gif><link rel=icon type=image/png sizes=32x32 href=https://xiaokunji.github.io/img/Q.gif><link rel=apple-touch-icon href=https://xiaokunji.github.io/Q.gif><link rel=mask-icon href=https://xiaokunji.github.io/Q.gif><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=zh href=https://xiaokunji.github.io/zh/java%E5%8F%8A%E5%85%B6%E6%A1%86%E6%9E%B6/spring_boot/%E5%88%86%E6%94%AF/mongodb-springboot/><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><meta property="og:title" content="MongoDB-SpringBoot"><meta property="og:description" content="     "><meta property="og:type" content="article"><meta property="og:url" content="https://xiaokunji.github.io/zh/java%E5%8F%8A%E5%85%B6%E6%A1%86%E6%9E%B6/spring_boot/%E5%88%86%E6%94%AF/mongodb-springboot/"><meta property="article:section" content="javaåŠå…¶æ¡†æ¶"><meta property="article:published_time" content="2023-08-22T00:00:00+00:00"><meta property="article:modified_time" content="2023-08-22T00:00:00+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="MongoDB-SpringBoot"><meta name=twitter:description content="     "><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":6,"name":"MongoDB-SpringBoot","item":"https://xiaokunji.github.io/zh/java%E5%8F%8A%E5%85%B6%E6%A1%86%E6%9E%B6/spring_boot/%E5%88%86%E6%94%AF/mongodb-springboot/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"MongoDB-SpringBoot","name":"MongoDB-SpringBoot","description":"     ","keywords":["default"],"articleBody":"é…ç½®æ–‡ä»¶,application.yml\n1 2 3 4 5 spring: data: mongodb: database: JHT_CPR uri: mongodb://10.10.203.16:27017/JHT_CPR å·¥å…·ç±»:\n1 2 3 4 5 6 7 8 public interface MongodbMapper\u003cT\u003e { public void save(String tableName, T entity); public void batchSave(String tableName, List\u003cT\u003e lists); // ... è¿™æ˜¯æ¥å£,åé¢å¯ä»¥å†™å¾ˆå¤š } å®ç°mongoå·¥å…·ç±»\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 @Configuration @Component @Slf4j public abstract class MongodbMapperImpl\u003cT\u003e implements MongodbMapper\u003cT\u003e { @Autowired private MongoTemplate mongoTemplate; protected abstract Class\u003cT\u003e getEntityClass(); protected abstract String getCollectionName(); @Override public void save(String tableName, T entity) { // è·å–å¯¹è±¡ä¸­å±æ€§å¯¹åº”çš„å­—æ®µåŠå…¶å€¼ Map\u003cString, Object\u003e map = ClassUtils.getColumnValue(entity); log.info(\"æ–°å¢æ•°æ®ï¼š{}\", JSON.toJSONString(map)); // æ•°æ® Document datas = new Document(); for (Map.Entry\u003cString, Object\u003e entry : map.entrySet()) { datas.append(entry.getKey(), entry.getValue()); } // TODO å¸¦è¡¥å…… //\tMongoCollection collection = mongoDatabase.getCollection(tableName); // //\tcollection.insertOne(datas); } /** * åˆ†é¡µæŸ¥è¯¢æ•°æ® * @author xkj * @param pageIndex * @param pageSize * @param params æŸ¥è¯¢æ¡ä»¶\u003cå­—æ®µå,å­—æ®µå€¼\u003e, å­—æ®µå€¼ä¸­ é™å®šå¼€å¤´(^),é™å®šç»“å°¾($),ä¸å†™åˆ™ä¸ºå…¨åŒ¹é… * @param order æ’åº,å¦‚[id]ã€[id asc]ã€[id asc,name desc] * @return */ @Override public PageInfos\u003cT\u003e pageByProps(int pageIndex, int pageSize, Map\u003cString, Object\u003e params, String order) { // åˆ›å»ºåˆ†é¡µæ¨¡å‹å¯¹è±¡ PageInfos\u003cT\u003e page = new PageInfos\u003cT\u003e(new ArrayList\u003cT\u003e(), 0L, 1, 10); // æŸ¥è¯¢æ€»è®°å½•æ•° int count = countByCondition(createQuery(params, null)); // å°è£…ç»“æœæ•°æ® if (count \u003e 0) { Query query = createQuery(params, order); // è®¾ç½®åˆ†é¡µä¿¡æ¯ query.skip((pageIndex - 1) * pageSize); query.limit(pageSize); page = new PageInfos\u003cT\u003e(mongoTemplate.find(query, getEntityClass()), count, pageIndex, pageSize); } return page; } @Override public int countByCondition(Query query) { Long count = mongoTemplate.count(query, getEntityClass()); return count.intValue(); } /** * åˆ›å»ºå¸¦æœ‰whereæ¡ä»¶ï¼ˆåªæ”¯æŒç­‰å€¼ï¼‰å’Œæ’åºçš„Queryå¯¹è±¡ * * @param order æ’åº,å¦‚[id]ã€[id asc]ã€[id asc,name desc] * @param list\téœ€è¦æ¨¡ç³ŠæŸ¥è¯¢çš„å­—æ®µ colName-R,colName-L åˆ†åˆ«è¡¨ç¤ºé™å®šå¼€å¤´(^),é™å®šç»“å°¾($),ä¸å†™åˆ™ä¸ºå…¨åŒ¹é… * @param list1\tæ—¶é—´å­—æ®µåšæ¯”è¾ƒ(ç±»ä¼¼æ’åº) [updateTime \u003e=],[updateTime \u003e], [updateTime \u003c],[updateTime \u003c=] * @return Queryå¯¹è±¡ */ protected Query createQuery(Map\u003cString,Object\u003e params, String order) { Query query = new Query(); // TODO æŒ‡å®šå­—æ®µæŸ¥ // where æ¡ä»¶ for (Entry\u003cString, Object\u003e param : params.entrySet()) { String key = param.getKey(); Object value = param.getValue(); if (StringUtils.isNoneBlank(key, value+\"\")) { if (StringUtils.containsAny(value+\"\", \"^\", \"$\")) { query.addCriteria(Criteria.where(key).regex(value+\"\")); } else { query.addCriteria(Criteria.where(key).is(value)); } } } // æ’åº List\u003cOrder\u003e orderList = parseOrder(order); if (CollectionUtils.isNotEmpty(orderList)) { query.with(Sort.by(orderList)); } return query; } /** * propValue,åŒ…å«åŒ¹é…å­—ç¬¦åšæ¨¡ç³ŠæŸ¥è¯¢, åˆ†åˆ«è¡¨ç¤ºé™å®šå¼€å¤´(^),é™å®šç»“å°¾($),ä¸å†™åˆ™ä¸ºå…¨åŒ¹é… * @author xkj * @param propName å­—æ®µå * @param propValue å­—æ®µå€¼ * @param order æ’åºå€¼ * @return */ @Override public List\u003cT\u003e findByProp(String propName, Object propValue, String order) { Query query = new Query(); // å‚æ•° if (StringUtils.containsAny(propValue + \"\", \"^\", \"$\")) { query.addCriteria(Criteria.where(propName).regex(propValue + \"\")); } else { query.addCriteria(Criteria.where(propName).is(propValue)); } // æ’åº List\u003cOrder\u003e orderList = parseOrder(order); if (CollectionUtils.isNotEmpty(orderList)) { // query.with(new Sort(orderList)); query.with(Sort.by(orderList)); } return mongoTemplate.find(query, getEntityClass()); } @Override public List\u003cT\u003e findByProps(Map\u003cString, Object\u003e map,String order) { Query query = createQuery(map, order); return mongoTemplate.find(query, getEntityClass()); } @Override public List\u003cT\u003e aggregate(Class\u003cT\u003e clazz,AggregationOperation... operations) { Aggregation aggregation = Aggregation.newAggregation(operations); AggregationResults\u003cT\u003e results = mongoTemplate.aggregate(aggregation,getCollectionName(), clazz); return results.getMappedResults(); } /** * ä½¿ç”¨èšåˆåˆ†é¡µæŸ¥è¯¢ * @author xkj * @param clazz è¿”å‚ç±» * @param pageSize * @param pageIndex * @param order æ’åº, * @param operations èšåˆç±»æ•°ç»„ * @return */ @Override public \u003cI\u003e PageInfos\u003cI\u003e pageByAggregate(Class\u003cI\u003e clazz, Integer pageSize, Integer pageIndex, String order,AggregationOperation... operations) { List\u003cAggregationOperation\u003e countOp = new ArrayList\u003c\u003e(Arrays.asList(operations)); // count countOp.add(Aggregation.count().as(\"id\")); Aggregation aggregationCount = Aggregation.newAggregation(countOp); AggregationResults\u003cI\u003e resultCount = mongoTemplate.aggregate(aggregationCount, getCollectionName(), clazz); long count = 0; Pattern pattern = Pattern.compile(\"(id=)\\d\"); Matcher matcher = pattern.matcher(resultCount.getRawResults().toString()); if (matcher.find()) { count = NumberUtils.toLong(matcher.group().substring(matcher.group().length() - 1)); } PageInfos\u003cI\u003e result = new PageInfos\u003c\u003e(null, count, pageIndex, pageSize); if (count \u003e 0) { // æ’åº List\u003cAggregationOperation\u003e queryOp = new ArrayList\u003c\u003e(Arrays.asList(operations)); List\u003cOrder\u003e orders = parseOrder(order); if (CollectionUtils.isNotEmpty(orders)) { SortOperation sortOperation = Aggregation.sort(Sort.by(orders)); queryOp.add(sortOperation); } // åˆ†é¡µ SkipOperation skipOperation = Aggregation.skip((long) (pageIndex - 1) * pageSize); LimitOperation limitOperation = Aggregation.limit(pageSize); queryOp.add(limitOperation); queryOp.add(skipOperation); Aggregation aggregation = Aggregation.newAggregation(queryOp); // æ±‚å€¼ AggregationResults\u003cI\u003e results = mongoTemplate.aggregate(aggregation, getCollectionName(), clazz); result = new PageInfos\u003c\u003e(results.getMappedResults(), count, pageIndex, pageSize); } return result; } @Override public \u003cI\u003e List\u003cI\u003e executeCommand(Class\u003cI\u003e clazz,String jsonCommand) { Document document = mongoTemplate.executeCommand(jsonCommand); List\u003cI\u003e results = ManagerUtil.copyBeans(document.get(\"results\"), clazz) ; return results; } } ä¸šåŠ¡ç±»\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 @Autowired private ResultRecordMapper resultMapper; /** * åˆ†é¡µæŸ¥è¯¢æœåŠ¡è°ƒç”¨è®°å½• * @author xkj * @param input * @return */ @Override public BaseResponse queryServiceUsedRecord(SerUsedRecordInput input) { BaseResponse response = new BaseResponse(); input.calculateOffset(); Map\u003cString, Object\u003e params = buildSerUsedQuery(input); PageInfos\u003cCallRecordDetail\u003e record = resultMapper.pageByProps(input.getPageIndex(), input.getPageSize(),params, \"createTime desc\"); PageInfos\u003cSerUsedRecordDTO\u003e result = new PageInfos\u003c\u003e(ManagerUtil.copyBeans(record.getData(), SerUsedRecordDTO.class), record.getTotalCount(),record.getPageIndex(), record.getPageSize()); response.setRespData(result); resultCode.setSuccessResponse(response); return response; } /** * æ„å»º æŸ¥è¯¢æœåŠ¡è°ƒç”¨è®°å½• æŸ¥è¯¢æ¡ä»¶ * @author xkj * @param input * @return */ private Map\u003cString, Object\u003e buildSerUsedQuery(SerUsedRecordInput input) { Map\u003cString, Object\u003e params = new HashMap\u003c\u003e(); if (StringUtils.isNotBlank(input.getName())) { params.put(ManagerConstants.MONGO_CALLER_INFO_CALLER_NAME, \"^.*\" + input.getName() + \".*$\");// å…¨æ¨¡ç³Š } if (StringUtils.isNotBlank(input.getSerialNumber())) { params.put(ManagerConstants.MONGO_CALLER_INFO_SERIAL_NUMBER, input.getSerialNumber()); } if (input.getCallType() != null) { params.put(ManagerConstants.MONGO_CALLER_INFO_CALL_TYPE, input.getCallType()); } if (input.getIdentEffect() != null) { params.put(ManagerConstants.MONGO_CALLER_INFO_IDENT_EFFECT, input.getIdentEffect()); } if (StringUtils.isNotBlank(input.getCarNumber())) { params.put(ManagerConstants.MONGO_CALLER_INFO_FRONT_IDENT_RESULT, \"^.*\" + input.getCarNumber() + \".*$\");// å…¨æ¨¡ç³Š params.put(ManagerConstants.MONGO_CALLER_INFO_CLOUD_IDENT_RESULT, \"^.*\" + input.getCarNumber() + \".*$\");// å…¨æ¨¡ç³Š params.put(ManagerConstants.MONGO_CALLER_INFO_HUMAN_IDENT_RESULT, \"^.*\" + input.getCarNumber() + \".*$\");// å…¨æ¨¡ç³Š } return params; } /** * åˆ†é¡µæŸ¥è¯¢ç®—æ³•è¯†åˆ«è®°å½• * @author xkj * @param input * @return */ @Override public BaseResponse queryAgloIdentRecord(SerUsedRecordInput input) { BaseResponse response = new BaseResponse(); input.calculateOffset(); //\tStringBuilder commSB= new StringBuilder(); //\tcommSB.append(\"{aggregate : 'CPR_CALLER_INFO', pipeline : \"); //\tcommSB.append(\"[\"); //\tcommSB.append(\"{'$unwind':{'path':'$algos','preserveNullAndEmptyArrays':true}},\"); //\tcommSB.append(\"{'$match':{'algos.algo_id':1}},\"); //\tcommSB.append(\"{'$group':{'_id':{'algo_id':'$algos.algo_id','serial_number':'$serial_number'},'algoName':{'$last':'$algos.algo_name'},'identResult':{'$last':'$algos.ident_result'},'serialNumber':{'$last':'$serial_number'}}}\"); //\tcommSB.append(\"{$project:{'algoName':'$algoName','serNumber':'$serNumber','identResult':'$identResult','identEffect':'$identEffect','humanIdentResult':'$humanIdentResult','createTime':'$create_time','_id':0}},\"); //\tcommSB.append(\"]}\"); //\tList list = resultMapper.executeCommand(commSB.toString()); PageInfos\u003cAlgoIdentPageDTO\u003e list = resultMapper.pageByAggregate(AlgoIdentPageDTO.class, input.getPageSize(), input.getPageIndex(), \"create_time desc\", buildAlgoIdentRecordOperation(input)); response.setRespData(list); resultCode.setSuccessResponse(response); return response; } private AggregationOperation[] buildAlgoIdentRecordOperation(SerUsedRecordInput input) { // å¹³é“ºæ•°ç»„ UnwindOperation unwindOperation = Aggregation.unwind(ManagerConstants.MONGO_CALLER_INFO_ALGOS, true); // åŒ¹é…æ¡ä»¶ Criteria criteria = new Criteria(); if(input.getAlgoId() != null) {// ç®—æ³•id criteria.and(ManagerConstants.MONGO_CALLER_INFO_ALGOS_ALGOID).is(input.getAlgoId()); } if(StringUtils.isNotBlank(input.getSerialNumber())) {// ä¸šåŠ¡æµæ°´å· criteria.and(ManagerConstants.MONGO_CALLER_INFO_SERIAL_NUMBER).is(input.getSerialNumber()); } if(StringUtils.isNotBlank(input.getCarNumber())) {// è½¦ç‰Œå· // äººå·¥è¯†åˆ«è½¦ç‰Œ or ç®—æ³•è¯†åˆ«è½¦ç‰Œ criteria.orOperator( Criteria.where(ManagerConstants.MONGO_CALLER_INFO_ALGOS_IDENT_RESULT) .regex(\"^.*\" + input.getCarNumber() + \".*$\"), Criteria.where(ManagerConstants.MONGO_CALLER_INFO_HUMAN_IDENT_RESULT) .regex(\"^.*\" + input.getCarNumber() + \".*$\")) ;// å…¨æ¨¡ç³Š } MatchOperation matchOperation = Aggregation.match(criteria); // åˆ†ç»„ GroupOperation groupOperation = Aggregation.group(ManagerConstants.MONGO_CALLER_INFO_ALGOS_ALGOID,ManagerConstants.MONGO_CALLER_INFO_SERIAL_NUMBER) .last(ManagerConstants.MONGO_CALLER_INFO_ALGOS_NAME).as(\"algo_name\") .last(ManagerConstants.MONGO_CALLER_INFO_ALGOS_IDENT_RESULT).as(\"ident_result\") .last(ManagerConstants.MONGO_CALLER_INFO_HUMAN_IDENT_RESULT).as(ManagerConstants.MONGO_CALLER_INFO_HUMAN_IDENT_RESULT) .last(ManagerConstants.MONGO_CALLER_INFO_IDENT_EFFECT).as(ManagerConstants.MONGO_CALLER_INFO_IDENT_EFFECT) .last(ManagerConstants.MONGO_CALLER_INFO_SERIAL_NUMBER).as(ManagerConstants.MONGO_CALLER_INFO_SERIAL_NUMBER) .last(\"create_time\").as(\"create_time\"); // è¿‡æ»¤å­—æ®µ //\tProjectionOperation projectionOperation = Aggregation.project(\"serialNumber\",\"identResult\").andExclude(\"_id\"); return ArrayUtils.toArray(unwindOperation,matchOperation,groupOperation); } mongodbMapperç±»\n1 2 3 public interface ResultRecordMapper extends MongodbMapper\u003cCallRecordDetail\u003e { } mongodbMapperå®ç°ç±»\n1 2 3 4 5 6 7 8 9 10 11 12 13 @Component public class ResultRecordMapperImpl extends MongodbMapperImpl\u003cCallRecordDetail\u003e implements ResultRecordMapper { @Override protected Class\u003cCallRecordDetail\u003e getEntityClass() { return CallRecordDetail.class; } @Override protected String getCollectionName() { return ManagerConstants.MONGO_CALLER_INFO; } } ä»¥åå¯èƒ½ä¼šé‡åˆ°æ›´å¥½çš„å·¥å…·ç±»å§,è¿™æ˜¯å€Ÿé‰´ä¸»æ•°æ®ä¸­å¿ƒçš„ä»£ç \n","wordCount":"1706","inLanguage":"zh","datePublished":"2023-08-22T00:00:00Z","dateModified":"2023-08-22T00:00:00Z","author":{"@type":"Person","name":"xkj"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://xiaokunji.github.io/zh/java%E5%8F%8A%E5%85%B6%E6%A1%86%E6%9E%B6/spring_boot/%E5%88%86%E6%94%AF/mongodb-springboot/"},"publisher":{"@type":"Organization","name":"ç±³äºŒ","logo":{"@type":"ImageObject","url":"https://xiaokunji.github.io/img/Q.gif"}}}</script></head><body class=dark id=top><script>localStorage.getItem("pref-theme")==="light"&&document.body.classList.remove("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://xiaokunji.github.io/zh/ accesskey=h title="ç±³äºŒ (Alt + H)"><img src=https://xiaokunji.github.io/img/Q.gif alt aria-label=logo height=35>ç±³äºŒ</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li><li><a href=https://xiaokunji.github.io/en/ title=English aria-label=English>English</a></li></ul></div></div><ul id=menu><li><a href=https://xiaokunji.github.io/zh/ title=ğŸ ä¸»é¡µ><span>ğŸ ä¸»é¡µ</span></a></li><li><a href=https://xiaokunji.github.io/zh/search title="ğŸ”æœç´¢ (Alt + /)" accesskey=/><span>ğŸ”æœç´¢</span></a></li><li><a href=https://xiaokunji.github.io/zh/post title=ğŸ“šæ–‡ç« ><span>ğŸ“šæ–‡ç« </span></a></li><li><a href=https://xiaokunji.github.io/zh/archives/ title=â±æ—¶é—´è½´><span>â±æ—¶é—´è½´</span></a></li><li><a href=https://xiaokunji.github.io/zh/tags title=ğŸ”–æ ‡ç­¾><span>ğŸ”–æ ‡ç­¾</span></a></li><li><a href=https://xiaokunji.github.io/zh/categories title=ğŸ“–åˆ†ç±»><span>ğŸ“–åˆ†ç±»</span></a></li><li><a href=https://xiaokunji.github.io/zh/links title=ğŸ¤å‹é“¾><span>ğŸ¤å‹é“¾</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><nav aria-label=breadcrumb><ul><a href=https://xiaokunji.github.io/zh/>content</a> <span>></span>
<a href=https://xiaokunji.github.io/zh/java%E5%8F%8A%E5%85%B6%E6%A1%86%E6%9E%B6/>javaåŠå…¶æ¡†æ¶</a> <span>></span>
<a href=https://xiaokunji.github.io/zh/java%E5%8F%8A%E5%85%B6%E6%A1%86%E6%9E%B6/spring_boot/>Spring_Boot</a> <span>></span>
<a href=https://xiaokunji.github.io/zh/java%E5%8F%8A%E5%85%B6%E6%A1%86%E6%9E%B6/spring_boot/%E5%88%86%E6%94%AF/>åˆ†æ”¯</a> <span>></span></ul></nav><h1 class=post-title>MongoDB-SpringBoot</h1><div class=post-description></div><div class=post-meta><span title='2023-08-22 00:00:00 +0000 UTC'>2023-08-22</span>&nbsp;Â·&nbsp;4 åˆ†é’Ÿ&nbsp;Â·&nbsp;xkj
&nbsp;|&nbsp;åˆ†ç±»: &nbsp;<ul class=post-categories-meta><a href=https://xiaokunji.github.io/zh/categories/java%E5%8F%8A%E5%85%B6%E6%A1%86%E6%9E%B6/>javaåŠå…¶æ¡†æ¶</a></ul><script async src=//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js></script>
<span id=busuanzi_container_page_pv>&nbsp;| è®¿é—®: <span id=busuanzi_value_page_pv></span></span></div></header><div class=post-content><p>é…ç½®æ–‡ä»¶,application.yml</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yml data-lang=yml><span style=display:flex><span><span style=color:#f92672>spring</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>data</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>mongodb</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>database</span>: <span style=color:#ae81ff>JHT_CPR</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>uri</span>: <span style=color:#ae81ff>mongodb://10.10.203.16:27017/JHT_CPR</span>
</span></span></code></pre></td></tr></table></div></div><p>å·¥å…·ç±»:</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">8
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>MongodbMapper</span><span style=color:#f92672>&lt;</span>T<span style=color:#f92672>&gt;</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>save</span><span style=color:#f92672>(</span>String tableName<span style=color:#f92672>,</span> T entity<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>batchSave</span><span style=color:#f92672>(</span>String tableName<span style=color:#f92672>,</span> List<span style=color:#f92672>&lt;</span>T<span style=color:#f92672>&gt;</span> lists<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>	<span style=color:#75715e>// ... è¿™æ˜¯æ¥å£,åé¢å¯ä»¥å†™å¾ˆå¤š
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#f92672>}</span>
</span></span></code></pre></td></tr></table></div></div><p>å®ç°mongoå·¥å…·ç±»</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 52
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 53
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 54
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 55
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 56
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 57
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 58
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 59
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 60
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 61
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 62
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 63
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 64
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 65
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 66
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 67
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 68
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 69
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 70
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 71
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 72
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 73
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 74
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 75
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 76
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 77
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 78
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 79
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 80
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 81
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 82
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 83
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 84
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 85
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 86
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 87
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 88
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 89
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 90
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 91
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 92
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 93
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 94
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 95
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 96
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 97
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 98
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 99
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">100
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">101
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">102
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">103
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">104
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">105
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">106
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">107
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">108
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">109
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">110
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">111
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">112
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">113
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">114
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">115
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">116
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">117
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">118
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">119
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">120
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">121
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">122
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">123
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">124
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">125
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">126
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">127
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">128
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">129
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">130
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">131
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">132
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">133
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">134
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">135
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">136
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">137
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">138
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">139
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">140
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">141
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">142
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">143
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">144
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">145
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">146
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">147
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">148
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">149
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">150
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">151
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">152
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">153
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">154
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">155
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">156
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">157
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">158
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">159
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">160
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">161
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">162
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">163
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">164
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">165
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">166
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">167
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">168
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">169
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">170
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">171
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">172
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">173
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">174
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">175
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">176
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">177
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">178
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">179
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">180
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">181
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">182
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">183
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">184
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">185
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">186
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">187
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">188
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">189
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">190
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">191
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">192
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#a6e22e>@Configuration</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@Component</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@Slf4j</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>abstract</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>MongodbMapperImpl</span><span style=color:#f92672>&lt;</span>T<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>implements</span> MongodbMapper<span style=color:#f92672>&lt;</span>T<span style=color:#f92672>&gt;</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>@Autowired</span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>private</span> MongoTemplate mongoTemplate<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>protected</span> <span style=color:#66d9ef>abstract</span> Class<span style=color:#f92672>&lt;</span>T<span style=color:#f92672>&gt;</span> <span style=color:#a6e22e>getEntityClass</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>protected</span> <span style=color:#66d9ef>abstract</span> String <span style=color:#a6e22e>getCollectionName</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>@Override</span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>save</span><span style=color:#f92672>(</span>String tableName<span style=color:#f92672>,</span> T entity<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>		<span style=color:#75715e>// è·å–å¯¹è±¡ä¸­å±æ€§å¯¹åº”çš„å­—æ®µåŠå…¶å€¼
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>		Map<span style=color:#f92672>&lt;</span>String<span style=color:#f92672>,</span> Object<span style=color:#f92672>&gt;</span> map <span style=color:#f92672>=</span> ClassUtils<span style=color:#f92672>.</span><span style=color:#a6e22e>getColumnValue</span><span style=color:#f92672>(</span>entity<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>		log<span style=color:#f92672>.</span><span style=color:#a6e22e>info</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;æ–°å¢æ•°æ®ï¼š{}&#34;</span><span style=color:#f92672>,</span> JSON<span style=color:#f92672>.</span><span style=color:#a6e22e>toJSONString</span><span style=color:#f92672>(</span>map<span style=color:#f92672>));</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>		<span style=color:#75715e>// æ•°æ®
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>		Document datas <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> Document<span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span>Map<span style=color:#f92672>.</span><span style=color:#a6e22e>Entry</span><span style=color:#f92672>&lt;</span>String<span style=color:#f92672>,</span> Object<span style=color:#f92672>&gt;</span> entry <span style=color:#f92672>:</span> map<span style=color:#f92672>.</span><span style=color:#a6e22e>entrySet</span><span style=color:#f92672>())</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>			datas<span style=color:#f92672>.</span><span style=color:#a6e22e>append</span><span style=color:#f92672>(</span>entry<span style=color:#f92672>.</span><span style=color:#a6e22e>getKey</span><span style=color:#f92672>(),</span> entry<span style=color:#f92672>.</span><span style=color:#a6e22e>getValue</span><span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>		<span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>		<span style=color:#75715e>// TODO å¸¦è¡¥å……
</span></span></span><span style=display:flex><span><span style=color:#75715e>//		MongoCollection&lt;Document&gt; collection = mongoDatabase.getCollection(tableName);
</span></span></span><span style=display:flex><span><span style=color:#75715e>//
</span></span></span><span style=display:flex><span><span style=color:#75715e>//		collection.insertOne(datas);
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	<span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>	
</span></span><span style=display:flex><span>	<span style=color:#75715e>/**
</span></span></span><span style=display:flex><span><span style=color:#75715e>	 * åˆ†é¡µæŸ¥è¯¢æ•°æ®
</span></span></span><span style=display:flex><span><span style=color:#75715e>	 * @author xkj 
</span></span></span><span style=display:flex><span><span style=color:#75715e>	 * @param pageIndex
</span></span></span><span style=display:flex><span><span style=color:#75715e>	 * @param pageSize
</span></span></span><span style=display:flex><span><span style=color:#75715e>	 * @param params æŸ¥è¯¢æ¡ä»¶&lt;å­—æ®µå,å­—æ®µå€¼&gt;, å­—æ®µå€¼ä¸­ é™å®šå¼€å¤´(^),é™å®šç»“å°¾($),ä¸å†™åˆ™ä¸ºå…¨åŒ¹é…
</span></span></span><span style=display:flex><span><span style=color:#75715e>	 * @param order æ’åº,å¦‚[id]ã€[id asc]ã€[id asc,name desc]
</span></span></span><span style=display:flex><span><span style=color:#75715e>	 * @return
</span></span></span><span style=display:flex><span><span style=color:#75715e>	 */</span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>@Override</span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>public</span> PageInfos<span style=color:#f92672>&lt;</span>T<span style=color:#f92672>&gt;</span> <span style=color:#a6e22e>pageByProps</span><span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> pageIndex<span style=color:#f92672>,</span> <span style=color:#66d9ef>int</span> pageSize<span style=color:#f92672>,</span> Map<span style=color:#f92672>&lt;</span>String<span style=color:#f92672>,</span> Object<span style=color:#f92672>&gt;</span> params<span style=color:#f92672>,</span> String order<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>		<span style=color:#75715e>// åˆ›å»ºåˆ†é¡µæ¨¡å‹å¯¹è±¡
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>		PageInfos<span style=color:#f92672>&lt;</span>T<span style=color:#f92672>&gt;</span> page <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> PageInfos<span style=color:#f92672>&lt;</span>T<span style=color:#f92672>&gt;(</span><span style=color:#66d9ef>new</span> ArrayList<span style=color:#f92672>&lt;</span>T<span style=color:#f92672>&gt;(),</span> 0L<span style=color:#f92672>,</span> 1<span style=color:#f92672>,</span> 10<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>		<span style=color:#75715e>// æŸ¥è¯¢æ€»è®°å½•æ•°
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>		<span style=color:#66d9ef>int</span> count <span style=color:#f92672>=</span> countByCondition<span style=color:#f92672>(</span>createQuery<span style=color:#f92672>(</span>params<span style=color:#f92672>,</span> <span style=color:#66d9ef>null</span><span style=color:#f92672>));</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>		<span style=color:#75715e>// å°è£…ç»“æœæ•°æ®
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>		<span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>count <span style=color:#f92672>&gt;</span> 0<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>			Query query <span style=color:#f92672>=</span> createQuery<span style=color:#f92672>(</span>params<span style=color:#f92672>,</span> order<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>			<span style=color:#75715e>// è®¾ç½®åˆ†é¡µä¿¡æ¯
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>			query<span style=color:#f92672>.</span><span style=color:#a6e22e>skip</span><span style=color:#f92672>((</span>pageIndex <span style=color:#f92672>-</span> 1<span style=color:#f92672>)</span> <span style=color:#f92672>*</span> pageSize<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>			query<span style=color:#f92672>.</span><span style=color:#a6e22e>limit</span><span style=color:#f92672>(</span>pageSize<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>			page <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> PageInfos<span style=color:#f92672>&lt;</span>T<span style=color:#f92672>&gt;(</span>mongoTemplate<span style=color:#f92672>.</span><span style=color:#a6e22e>find</span><span style=color:#f92672>(</span>query<span style=color:#f92672>,</span> getEntityClass<span style=color:#f92672>()),</span> count<span style=color:#f92672>,</span> pageIndex<span style=color:#f92672>,</span> pageSize<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>		<span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>return</span> page<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>	<span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>	
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>@Override</span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>public</span> <span style=color:#66d9ef>int</span> <span style=color:#a6e22e>countByCondition</span><span style=color:#f92672>(</span>Query query<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>		Long count <span style=color:#f92672>=</span> mongoTemplate<span style=color:#f92672>.</span><span style=color:#a6e22e>count</span><span style=color:#f92672>(</span>query<span style=color:#f92672>,</span> getEntityClass<span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>return</span> count<span style=color:#f92672>.</span><span style=color:#a6e22e>intValue</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>	<span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>	
</span></span><span style=display:flex><span>	<span style=color:#75715e>/**
</span></span></span><span style=display:flex><span><span style=color:#75715e>	 * åˆ›å»ºå¸¦æœ‰whereæ¡ä»¶ï¼ˆåªæ”¯æŒç­‰å€¼ï¼‰å’Œæ’åºçš„Queryå¯¹è±¡
</span></span></span><span style=display:flex><span><span style=color:#75715e>	 * 
</span></span></span><span style=display:flex><span><span style=color:#75715e>	 * @param order  æ’åº,å¦‚[id]ã€[id asc]ã€[id asc,name desc]
</span></span></span><span style=display:flex><span><span style=color:#75715e>	 * @param list	   éœ€è¦æ¨¡ç³ŠæŸ¥è¯¢çš„å­—æ®µ  colName-R,colName-L åˆ†åˆ«è¡¨ç¤ºé™å®šå¼€å¤´(^),é™å®šç»“å°¾($),ä¸å†™åˆ™ä¸ºå…¨åŒ¹é…
</span></span></span><span style=display:flex><span><span style=color:#75715e>	 * @param list1	   æ—¶é—´å­—æ®µåšæ¯”è¾ƒ(ç±»ä¼¼æ’åº)  [updateTime &gt;=],[updateTime &gt;], [updateTime &lt;],[updateTime &lt;=]
</span></span></span><span style=display:flex><span><span style=color:#75715e>	 * @return Queryå¯¹è±¡
</span></span></span><span style=display:flex><span><span style=color:#75715e>	 */</span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>protected</span> Query <span style=color:#a6e22e>createQuery</span><span style=color:#f92672>(</span>Map<span style=color:#f92672>&lt;</span>String<span style=color:#f92672>,</span>Object<span style=color:#f92672>&gt;</span> params<span style=color:#f92672>,</span> String order<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>		Query query <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> Query<span style=color:#f92672>();</span>
</span></span><span style=display:flex><span><span style=color:#75715e>// TODO æŒ‡å®šå­—æ®µæŸ¥
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>		<span style=color:#75715e>// where æ¡ä»¶
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>		<span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span>Entry<span style=color:#f92672>&lt;</span>String<span style=color:#f92672>,</span> Object<span style=color:#f92672>&gt;</span> param <span style=color:#f92672>:</span> params<span style=color:#f92672>.</span><span style=color:#a6e22e>entrySet</span><span style=color:#f92672>())</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>			String key <span style=color:#f92672>=</span> param<span style=color:#f92672>.</span><span style=color:#a6e22e>getKey</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>			Object value <span style=color:#f92672>=</span> param<span style=color:#f92672>.</span><span style=color:#a6e22e>getValue</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>			<span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>StringUtils<span style=color:#f92672>.</span><span style=color:#a6e22e>isNoneBlank</span><span style=color:#f92672>(</span>key<span style=color:#f92672>,</span> value<span style=color:#f92672>+</span><span style=color:#e6db74>&#34;&#34;</span><span style=color:#f92672>))</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>				<span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>StringUtils<span style=color:#f92672>.</span><span style=color:#a6e22e>containsAny</span><span style=color:#f92672>(</span>value<span style=color:#f92672>+</span><span style=color:#e6db74>&#34;&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;^&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;$&#34;</span><span style=color:#f92672>))</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>					query<span style=color:#f92672>.</span><span style=color:#a6e22e>addCriteria</span><span style=color:#f92672>(</span>Criteria<span style=color:#f92672>.</span><span style=color:#a6e22e>where</span><span style=color:#f92672>(</span>key<span style=color:#f92672>).</span><span style=color:#a6e22e>regex</span><span style=color:#f92672>(</span>value<span style=color:#f92672>+</span><span style=color:#e6db74>&#34;&#34;</span><span style=color:#f92672>));</span>
</span></span><span style=display:flex><span>				<span style=color:#f92672>}</span> <span style=color:#66d9ef>else</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>					query<span style=color:#f92672>.</span><span style=color:#a6e22e>addCriteria</span><span style=color:#f92672>(</span>Criteria<span style=color:#f92672>.</span><span style=color:#a6e22e>where</span><span style=color:#f92672>(</span>key<span style=color:#f92672>).</span><span style=color:#a6e22e>is</span><span style=color:#f92672>(</span>value<span style=color:#f92672>));</span>
</span></span><span style=display:flex><span>				<span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>			<span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>		<span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>		
</span></span><span style=display:flex><span>		<span style=color:#75715e>// æ’åº
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>		List<span style=color:#f92672>&lt;</span>Order<span style=color:#f92672>&gt;</span> orderList <span style=color:#f92672>=</span> parseOrder<span style=color:#f92672>(</span>order<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>CollectionUtils<span style=color:#f92672>.</span><span style=color:#a6e22e>isNotEmpty</span><span style=color:#f92672>(</span>orderList<span style=color:#f92672>))</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>			query<span style=color:#f92672>.</span><span style=color:#a6e22e>with</span><span style=color:#f92672>(</span>Sort<span style=color:#f92672>.</span><span style=color:#a6e22e>by</span><span style=color:#f92672>(</span>orderList<span style=color:#f92672>));</span>
</span></span><span style=display:flex><span>		<span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>return</span> query<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>	<span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>	
</span></span><span style=display:flex><span>	<span style=color:#75715e>/**
</span></span></span><span style=display:flex><span><span style=color:#75715e>	 * propValue,åŒ…å«åŒ¹é…å­—ç¬¦åšæ¨¡ç³ŠæŸ¥è¯¢,  åˆ†åˆ«è¡¨ç¤ºé™å®šå¼€å¤´(^),é™å®šç»“å°¾($),ä¸å†™åˆ™ä¸ºå…¨åŒ¹é…
</span></span></span><span style=display:flex><span><span style=color:#75715e>	 * @author xkj 
</span></span></span><span style=display:flex><span><span style=color:#75715e>	 * @param propName å­—æ®µå
</span></span></span><span style=display:flex><span><span style=color:#75715e>	 * @param propValue å­—æ®µå€¼
</span></span></span><span style=display:flex><span><span style=color:#75715e>	 * @param order æ’åºå€¼
</span></span></span><span style=display:flex><span><span style=color:#75715e>	 * @return
</span></span></span><span style=display:flex><span><span style=color:#75715e>	 */</span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>@Override</span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>public</span> List<span style=color:#f92672>&lt;</span>T<span style=color:#f92672>&gt;</span> <span style=color:#a6e22e>findByProp</span><span style=color:#f92672>(</span>String propName<span style=color:#f92672>,</span> Object propValue<span style=color:#f92672>,</span> String order<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>		Query query <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> Query<span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>		<span style=color:#75715e>// å‚æ•°
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>		<span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>StringUtils<span style=color:#f92672>.</span><span style=color:#a6e22e>containsAny</span><span style=color:#f92672>(</span>propValue <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;^&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;$&#34;</span><span style=color:#f92672>))</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>			query<span style=color:#f92672>.</span><span style=color:#a6e22e>addCriteria</span><span style=color:#f92672>(</span>Criteria<span style=color:#f92672>.</span><span style=color:#a6e22e>where</span><span style=color:#f92672>(</span>propName<span style=color:#f92672>).</span><span style=color:#a6e22e>regex</span><span style=color:#f92672>(</span>propValue <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;&#34;</span><span style=color:#f92672>));</span>
</span></span><span style=display:flex><span>		<span style=color:#f92672>}</span> <span style=color:#66d9ef>else</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>			query<span style=color:#f92672>.</span><span style=color:#a6e22e>addCriteria</span><span style=color:#f92672>(</span>Criteria<span style=color:#f92672>.</span><span style=color:#a6e22e>where</span><span style=color:#f92672>(</span>propName<span style=color:#f92672>).</span><span style=color:#a6e22e>is</span><span style=color:#f92672>(</span>propValue<span style=color:#f92672>));</span>
</span></span><span style=display:flex><span>		<span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>		<span style=color:#75715e>// æ’åº
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>		List<span style=color:#f92672>&lt;</span>Order<span style=color:#f92672>&gt;</span> orderList <span style=color:#f92672>=</span> parseOrder<span style=color:#f92672>(</span>order<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>CollectionUtils<span style=color:#f92672>.</span><span style=color:#a6e22e>isNotEmpty</span><span style=color:#f92672>(</span>orderList<span style=color:#f92672>))</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>			<span style=color:#75715e>// query.with(new Sort(orderList));
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>			query<span style=color:#f92672>.</span><span style=color:#a6e22e>with</span><span style=color:#f92672>(</span>Sort<span style=color:#f92672>.</span><span style=color:#a6e22e>by</span><span style=color:#f92672>(</span>orderList<span style=color:#f92672>));</span>
</span></span><span style=display:flex><span>		<span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>return</span> mongoTemplate<span style=color:#f92672>.</span><span style=color:#a6e22e>find</span><span style=color:#f92672>(</span>query<span style=color:#f92672>,</span> getEntityClass<span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>	<span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>	
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>@Override</span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>public</span> List<span style=color:#f92672>&lt;</span>T<span style=color:#f92672>&gt;</span> <span style=color:#a6e22e>findByProps</span><span style=color:#f92672>(</span>Map<span style=color:#f92672>&lt;</span>String<span style=color:#f92672>,</span> Object<span style=color:#f92672>&gt;</span> map<span style=color:#f92672>,</span>String order<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>		Query query <span style=color:#f92672>=</span> createQuery<span style=color:#f92672>(</span>map<span style=color:#f92672>,</span> order<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>return</span> mongoTemplate<span style=color:#f92672>.</span><span style=color:#a6e22e>find</span><span style=color:#f92672>(</span>query<span style=color:#f92672>,</span> getEntityClass<span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>	<span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>	
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>@Override</span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>public</span> List<span style=color:#f92672>&lt;</span>T<span style=color:#f92672>&gt;</span> <span style=color:#a6e22e>aggregate</span><span style=color:#f92672>(</span>Class<span style=color:#f92672>&lt;</span>T<span style=color:#f92672>&gt;</span> clazz<span style=color:#f92672>,</span>AggregationOperation<span style=color:#f92672>...</span> operations<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>		Aggregation aggregation <span style=color:#f92672>=</span> Aggregation<span style=color:#f92672>.</span><span style=color:#a6e22e>newAggregation</span><span style=color:#f92672>(</span>operations<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>		AggregationResults<span style=color:#f92672>&lt;</span>T<span style=color:#f92672>&gt;</span> results <span style=color:#f92672>=</span> mongoTemplate<span style=color:#f92672>.</span><span style=color:#a6e22e>aggregate</span><span style=color:#f92672>(</span>aggregation<span style=color:#f92672>,</span>getCollectionName<span style=color:#f92672>(),</span> clazz<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>return</span> results<span style=color:#f92672>.</span><span style=color:#a6e22e>getMappedResults</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>	<span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>	
</span></span><span style=display:flex><span>	<span style=color:#75715e>/**
</span></span></span><span style=display:flex><span><span style=color:#75715e>	 * ä½¿ç”¨èšåˆåˆ†é¡µæŸ¥è¯¢
</span></span></span><span style=display:flex><span><span style=color:#75715e>	 * @author xkj 
</span></span></span><span style=display:flex><span><span style=color:#75715e>	 * @param clazz è¿”å‚ç±»
</span></span></span><span style=display:flex><span><span style=color:#75715e>	 * @param pageSize 
</span></span></span><span style=display:flex><span><span style=color:#75715e>	 * @param pageIndex
</span></span></span><span style=display:flex><span><span style=color:#75715e>	 * @param order æ’åº, 
</span></span></span><span style=display:flex><span><span style=color:#75715e>	 * @param operations  èšåˆç±»æ•°ç»„
</span></span></span><span style=display:flex><span><span style=color:#75715e>	 * @return
</span></span></span><span style=display:flex><span><span style=color:#75715e>	 */</span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>@Override</span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>public</span> <span style=color:#f92672>&lt;</span>I<span style=color:#f92672>&gt;</span> PageInfos<span style=color:#f92672>&lt;</span>I<span style=color:#f92672>&gt;</span> <span style=color:#a6e22e>pageByAggregate</span><span style=color:#f92672>(</span>Class<span style=color:#f92672>&lt;</span>I<span style=color:#f92672>&gt;</span> clazz<span style=color:#f92672>,</span> Integer pageSize<span style=color:#f92672>,</span> Integer pageIndex<span style=color:#f92672>,</span> String order<span style=color:#f92672>,</span>AggregationOperation<span style=color:#f92672>...</span> operations<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>		List<span style=color:#f92672>&lt;</span>AggregationOperation<span style=color:#f92672>&gt;</span> countOp <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> ArrayList<span style=color:#f92672>&lt;&gt;(</span>Arrays<span style=color:#f92672>.</span><span style=color:#a6e22e>asList</span><span style=color:#f92672>(</span>operations<span style=color:#f92672>));</span>
</span></span><span style=display:flex><span>		<span style=color:#75715e>// count
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>		countOp<span style=color:#f92672>.</span><span style=color:#a6e22e>add</span><span style=color:#f92672>(</span>Aggregation<span style=color:#f92672>.</span><span style=color:#a6e22e>count</span><span style=color:#f92672>().</span><span style=color:#a6e22e>as</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;id&#34;</span><span style=color:#f92672>));</span>
</span></span><span style=display:flex><span>		Aggregation aggregationCount <span style=color:#f92672>=</span> Aggregation<span style=color:#f92672>.</span><span style=color:#a6e22e>newAggregation</span><span style=color:#f92672>(</span>countOp<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>		AggregationResults<span style=color:#f92672>&lt;</span>I<span style=color:#f92672>&gt;</span> resultCount <span style=color:#f92672>=</span> mongoTemplate<span style=color:#f92672>.</span><span style=color:#a6e22e>aggregate</span><span style=color:#f92672>(</span>aggregationCount<span style=color:#f92672>,</span> getCollectionName<span style=color:#f92672>(),</span> clazz<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>long</span> count <span style=color:#f92672>=</span> 0<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>		Pattern pattern <span style=color:#f92672>=</span> Pattern<span style=color:#f92672>.</span><span style=color:#a6e22e>compile</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;(id=)\d&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>		Matcher matcher <span style=color:#f92672>=</span> pattern<span style=color:#f92672>.</span><span style=color:#a6e22e>matcher</span><span style=color:#f92672>(</span>resultCount<span style=color:#f92672>.</span><span style=color:#a6e22e>getRawResults</span><span style=color:#f92672>().</span><span style=color:#a6e22e>toString</span><span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>matcher<span style=color:#f92672>.</span><span style=color:#a6e22e>find</span><span style=color:#f92672>())</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>			count <span style=color:#f92672>=</span> NumberUtils<span style=color:#f92672>.</span><span style=color:#a6e22e>toLong</span><span style=color:#f92672>(</span>matcher<span style=color:#f92672>.</span><span style=color:#a6e22e>group</span><span style=color:#f92672>().</span><span style=color:#a6e22e>substring</span><span style=color:#f92672>(</span>matcher<span style=color:#f92672>.</span><span style=color:#a6e22e>group</span><span style=color:#f92672>().</span><span style=color:#a6e22e>length</span><span style=color:#f92672>()</span> <span style=color:#f92672>-</span> 1<span style=color:#f92672>));</span>
</span></span><span style=display:flex><span>		<span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>		PageInfos<span style=color:#f92672>&lt;</span>I<span style=color:#f92672>&gt;</span> result <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> PageInfos<span style=color:#f92672>&lt;&gt;(</span><span style=color:#66d9ef>null</span><span style=color:#f92672>,</span> count<span style=color:#f92672>,</span> pageIndex<span style=color:#f92672>,</span> pageSize<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>count <span style=color:#f92672>&gt;</span> 0<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>			<span style=color:#75715e>// æ’åº
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>			List<span style=color:#f92672>&lt;</span>AggregationOperation<span style=color:#f92672>&gt;</span> queryOp <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> ArrayList<span style=color:#f92672>&lt;&gt;(</span>Arrays<span style=color:#f92672>.</span><span style=color:#a6e22e>asList</span><span style=color:#f92672>(</span>operations<span style=color:#f92672>));</span>
</span></span><span style=display:flex><span>			List<span style=color:#f92672>&lt;</span>Order<span style=color:#f92672>&gt;</span> orders <span style=color:#f92672>=</span> parseOrder<span style=color:#f92672>(</span>order<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>			<span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>CollectionUtils<span style=color:#f92672>.</span><span style=color:#a6e22e>isNotEmpty</span><span style=color:#f92672>(</span>orders<span style=color:#f92672>))</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>				SortOperation sortOperation <span style=color:#f92672>=</span> Aggregation<span style=color:#f92672>.</span><span style=color:#a6e22e>sort</span><span style=color:#f92672>(</span>Sort<span style=color:#f92672>.</span><span style=color:#a6e22e>by</span><span style=color:#f92672>(</span>orders<span style=color:#f92672>));</span>
</span></span><span style=display:flex><span>				queryOp<span style=color:#f92672>.</span><span style=color:#a6e22e>add</span><span style=color:#f92672>(</span>sortOperation<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>			<span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>			<span style=color:#75715e>// åˆ†é¡µ
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>			SkipOperation skipOperation <span style=color:#f92672>=</span> Aggregation<span style=color:#f92672>.</span><span style=color:#a6e22e>skip</span><span style=color:#f92672>((</span><span style=color:#66d9ef>long</span><span style=color:#f92672>)</span> <span style=color:#f92672>(</span>pageIndex <span style=color:#f92672>-</span> 1<span style=color:#f92672>)</span> <span style=color:#f92672>*</span> pageSize<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>			LimitOperation limitOperation <span style=color:#f92672>=</span> Aggregation<span style=color:#f92672>.</span><span style=color:#a6e22e>limit</span><span style=color:#f92672>(</span>pageSize<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>			queryOp<span style=color:#f92672>.</span><span style=color:#a6e22e>add</span><span style=color:#f92672>(</span>limitOperation<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>			queryOp<span style=color:#f92672>.</span><span style=color:#a6e22e>add</span><span style=color:#f92672>(</span>skipOperation<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>			Aggregation aggregation <span style=color:#f92672>=</span> Aggregation<span style=color:#f92672>.</span><span style=color:#a6e22e>newAggregation</span><span style=color:#f92672>(</span>queryOp<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>			<span style=color:#75715e>// æ±‚å€¼
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>			AggregationResults<span style=color:#f92672>&lt;</span>I<span style=color:#f92672>&gt;</span> results <span style=color:#f92672>=</span> mongoTemplate<span style=color:#f92672>.</span><span style=color:#a6e22e>aggregate</span><span style=color:#f92672>(</span>aggregation<span style=color:#f92672>,</span> getCollectionName<span style=color:#f92672>(),</span> clazz<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>			result <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> PageInfos<span style=color:#f92672>&lt;&gt;(</span>results<span style=color:#f92672>.</span><span style=color:#a6e22e>getMappedResults</span><span style=color:#f92672>(),</span> count<span style=color:#f92672>,</span> pageIndex<span style=color:#f92672>,</span> pageSize<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>		<span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>return</span> result<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>	<span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>	
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>@Override</span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>public</span> <span style=color:#f92672>&lt;</span>I<span style=color:#f92672>&gt;</span> List<span style=color:#f92672>&lt;</span>I<span style=color:#f92672>&gt;</span> <span style=color:#a6e22e>executeCommand</span><span style=color:#f92672>(</span>Class<span style=color:#f92672>&lt;</span>I<span style=color:#f92672>&gt;</span> clazz<span style=color:#f92672>,</span>String jsonCommand<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>		Document document <span style=color:#f92672>=</span> mongoTemplate<span style=color:#f92672>.</span><span style=color:#a6e22e>executeCommand</span><span style=color:#f92672>(</span>jsonCommand<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>		List<span style=color:#f92672>&lt;</span>I<span style=color:#f92672>&gt;</span> results <span style=color:#f92672>=</span>  ManagerUtil<span style=color:#f92672>.</span><span style=color:#a6e22e>copyBeans</span><span style=color:#f92672>(</span>document<span style=color:#f92672>.</span><span style=color:#a6e22e>get</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;results&#34;</span><span style=color:#f92672>),</span> clazz<span style=color:#f92672>)</span> <span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>return</span> results<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>	<span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>	
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span></code></pre></td></tr></table></div></div><p>ä¸šåŠ¡ç±»</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 52
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 53
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 54
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 55
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 56
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 57
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 58
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 59
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 60
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 61
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 62
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 63
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 64
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 65
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 66
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 67
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 68
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 69
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 70
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 71
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 72
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 73
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 74
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 75
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 76
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 77
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 78
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 79
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 80
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 81
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 82
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 83
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 84
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 85
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 86
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 87
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 88
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 89
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 90
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 91
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 92
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 93
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 94
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 95
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 96
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 97
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 98
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 99
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">100
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">101
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">102
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">103
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">104
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">105
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#a6e22e>@Autowired</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>private</span> ResultRecordMapper  resultMapper<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/**
</span></span></span><span style=display:flex><span><span style=color:#75715e>	 * åˆ†é¡µæŸ¥è¯¢æœåŠ¡è°ƒç”¨è®°å½•
</span></span></span><span style=display:flex><span><span style=color:#75715e>	 * @author xkj 
</span></span></span><span style=display:flex><span><span style=color:#75715e>	 * @param input
</span></span></span><span style=display:flex><span><span style=color:#75715e>	 * @return
</span></span></span><span style=display:flex><span><span style=color:#75715e>	 */</span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>@Override</span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>public</span> BaseResponse <span style=color:#a6e22e>queryServiceUsedRecord</span><span style=color:#f92672>(</span>SerUsedRecordInput input<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>		BaseResponse response <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> BaseResponse<span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>		input<span style=color:#f92672>.</span><span style=color:#a6e22e>calculateOffset</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>		Map<span style=color:#f92672>&lt;</span>String<span style=color:#f92672>,</span> Object<span style=color:#f92672>&gt;</span> params <span style=color:#f92672>=</span> buildSerUsedQuery<span style=color:#f92672>(</span>input<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>		PageInfos<span style=color:#f92672>&lt;</span>CallRecordDetail<span style=color:#f92672>&gt;</span> record <span style=color:#f92672>=</span> resultMapper<span style=color:#f92672>.</span><span style=color:#a6e22e>pageByProps</span><span style=color:#f92672>(</span>input<span style=color:#f92672>.</span><span style=color:#a6e22e>getPageIndex</span><span style=color:#f92672>(),</span> input<span style=color:#f92672>.</span><span style=color:#a6e22e>getPageSize</span><span style=color:#f92672>(),</span>params<span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;createTime desc&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>		PageInfos<span style=color:#f92672>&lt;</span>SerUsedRecordDTO<span style=color:#f92672>&gt;</span> result <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> PageInfos<span style=color:#f92672>&lt;&gt;(</span>ManagerUtil<span style=color:#f92672>.</span><span style=color:#a6e22e>copyBeans</span><span style=color:#f92672>(</span>record<span style=color:#f92672>.</span><span style=color:#a6e22e>getData</span><span style=color:#f92672>(),</span> SerUsedRecordDTO<span style=color:#f92672>.</span><span style=color:#a6e22e>class</span><span style=color:#f92672>),</span> record<span style=color:#f92672>.</span><span style=color:#a6e22e>getTotalCount</span><span style=color:#f92672>(),</span>record<span style=color:#f92672>.</span><span style=color:#a6e22e>getPageIndex</span><span style=color:#f92672>(),</span> record<span style=color:#f92672>.</span><span style=color:#a6e22e>getPageSize</span><span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>		response<span style=color:#f92672>.</span><span style=color:#a6e22e>setRespData</span><span style=color:#f92672>(</span>result<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>		resultCode<span style=color:#f92672>.</span><span style=color:#a6e22e>setSuccessResponse</span><span style=color:#f92672>(</span>response<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>return</span> response<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>	<span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/**
</span></span></span><span style=display:flex><span><span style=color:#75715e>	 * æ„å»º æŸ¥è¯¢æœåŠ¡è°ƒç”¨è®°å½• æŸ¥è¯¢æ¡ä»¶
</span></span></span><span style=display:flex><span><span style=color:#75715e>	 * @author xkj
</span></span></span><span style=display:flex><span><span style=color:#75715e>	 * @param input
</span></span></span><span style=display:flex><span><span style=color:#75715e>	 * @return  
</span></span></span><span style=display:flex><span><span style=color:#75715e>	 */</span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>private</span> Map<span style=color:#f92672>&lt;</span>String<span style=color:#f92672>,</span> Object<span style=color:#f92672>&gt;</span> <span style=color:#a6e22e>buildSerUsedQuery</span><span style=color:#f92672>(</span>SerUsedRecordInput input<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>		Map<span style=color:#f92672>&lt;</span>String<span style=color:#f92672>,</span> Object<span style=color:#f92672>&gt;</span> params <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> HashMap<span style=color:#f92672>&lt;&gt;();</span>
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>StringUtils<span style=color:#f92672>.</span><span style=color:#a6e22e>isNotBlank</span><span style=color:#f92672>(</span>input<span style=color:#f92672>.</span><span style=color:#a6e22e>getName</span><span style=color:#f92672>()))</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>			params<span style=color:#f92672>.</span><span style=color:#a6e22e>put</span><span style=color:#f92672>(</span>ManagerConstants<span style=color:#f92672>.</span><span style=color:#a6e22e>MONGO_CALLER_INFO_CALLER_NAME</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;^.*&#34;</span> <span style=color:#f92672>+</span> input<span style=color:#f92672>.</span><span style=color:#a6e22e>getName</span><span style=color:#f92672>()</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;.*$&#34;</span><span style=color:#f92672>);</span><span style=color:#75715e>// å…¨æ¨¡ç³Š
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>		<span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>StringUtils<span style=color:#f92672>.</span><span style=color:#a6e22e>isNotBlank</span><span style=color:#f92672>(</span>input<span style=color:#f92672>.</span><span style=color:#a6e22e>getSerialNumber</span><span style=color:#f92672>()))</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>			params<span style=color:#f92672>.</span><span style=color:#a6e22e>put</span><span style=color:#f92672>(</span>ManagerConstants<span style=color:#f92672>.</span><span style=color:#a6e22e>MONGO_CALLER_INFO_SERIAL_NUMBER</span><span style=color:#f92672>,</span> input<span style=color:#f92672>.</span><span style=color:#a6e22e>getSerialNumber</span><span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>		<span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>input<span style=color:#f92672>.</span><span style=color:#a6e22e>getCallType</span><span style=color:#f92672>()</span> <span style=color:#f92672>!=</span> <span style=color:#66d9ef>null</span><span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>			params<span style=color:#f92672>.</span><span style=color:#a6e22e>put</span><span style=color:#f92672>(</span>ManagerConstants<span style=color:#f92672>.</span><span style=color:#a6e22e>MONGO_CALLER_INFO_CALL_TYPE</span><span style=color:#f92672>,</span> input<span style=color:#f92672>.</span><span style=color:#a6e22e>getCallType</span><span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>		<span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>input<span style=color:#f92672>.</span><span style=color:#a6e22e>getIdentEffect</span><span style=color:#f92672>()</span> <span style=color:#f92672>!=</span> <span style=color:#66d9ef>null</span><span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>			params<span style=color:#f92672>.</span><span style=color:#a6e22e>put</span><span style=color:#f92672>(</span>ManagerConstants<span style=color:#f92672>.</span><span style=color:#a6e22e>MONGO_CALLER_INFO_IDENT_EFFECT</span><span style=color:#f92672>,</span> input<span style=color:#f92672>.</span><span style=color:#a6e22e>getIdentEffect</span><span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>		<span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>StringUtils<span style=color:#f92672>.</span><span style=color:#a6e22e>isNotBlank</span><span style=color:#f92672>(</span>input<span style=color:#f92672>.</span><span style=color:#a6e22e>getCarNumber</span><span style=color:#f92672>()))</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>			params<span style=color:#f92672>.</span><span style=color:#a6e22e>put</span><span style=color:#f92672>(</span>ManagerConstants<span style=color:#f92672>.</span><span style=color:#a6e22e>MONGO_CALLER_INFO_FRONT_IDENT_RESULT</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;^.*&#34;</span> <span style=color:#f92672>+</span> input<span style=color:#f92672>.</span><span style=color:#a6e22e>getCarNumber</span><span style=color:#f92672>()</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;.*$&#34;</span><span style=color:#f92672>);</span><span style=color:#75715e>// å…¨æ¨¡ç³Š
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>			params<span style=color:#f92672>.</span><span style=color:#a6e22e>put</span><span style=color:#f92672>(</span>ManagerConstants<span style=color:#f92672>.</span><span style=color:#a6e22e>MONGO_CALLER_INFO_CLOUD_IDENT_RESULT</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;^.*&#34;</span> <span style=color:#f92672>+</span> input<span style=color:#f92672>.</span><span style=color:#a6e22e>getCarNumber</span><span style=color:#f92672>()</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;.*$&#34;</span><span style=color:#f92672>);</span><span style=color:#75715e>// å…¨æ¨¡ç³Š
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>			params<span style=color:#f92672>.</span><span style=color:#a6e22e>put</span><span style=color:#f92672>(</span>ManagerConstants<span style=color:#f92672>.</span><span style=color:#a6e22e>MONGO_CALLER_INFO_HUMAN_IDENT_RESULT</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;^.*&#34;</span> <span style=color:#f92672>+</span> input<span style=color:#f92672>.</span><span style=color:#a6e22e>getCarNumber</span><span style=color:#f92672>()</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;.*$&#34;</span><span style=color:#f92672>);</span><span style=color:#75715e>// å…¨æ¨¡ç³Š
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>		<span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>return</span> params<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>	<span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>/**
</span></span></span><span style=display:flex><span><span style=color:#75715e>	 * åˆ†é¡µæŸ¥è¯¢ç®—æ³•è¯†åˆ«è®°å½•
</span></span></span><span style=display:flex><span><span style=color:#75715e>	 * @author xkj 
</span></span></span><span style=display:flex><span><span style=color:#75715e>	 * @param input
</span></span></span><span style=display:flex><span><span style=color:#75715e>	 * @return
</span></span></span><span style=display:flex><span><span style=color:#75715e>	 */</span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>@Override</span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>public</span> BaseResponse <span style=color:#a6e22e>queryAgloIdentRecord</span><span style=color:#f92672>(</span>SerUsedRecordInput input<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>		BaseResponse response <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> BaseResponse<span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>		input<span style=color:#f92672>.</span><span style=color:#a6e22e>calculateOffset</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span><span style=color:#75715e>//		StringBuilder  commSB= new StringBuilder(); 
</span></span></span><span style=display:flex><span><span style=color:#75715e>//		commSB.append(&#34;{aggregate : &#39;CPR_CALLER_INFO&#39;, pipeline : &#34;);
</span></span></span><span style=display:flex><span><span style=color:#75715e>//		commSB.append(&#34;[&#34;);
</span></span></span><span style=display:flex><span><span style=color:#75715e>//		commSB.append(&#34;{&#39;$unwind&#39;:{&#39;path&#39;:&#39;$algos&#39;,&#39;preserveNullAndEmptyArrays&#39;:true}},&#34;);
</span></span></span><span style=display:flex><span><span style=color:#75715e>//		commSB.append(&#34;{&#39;$match&#39;:{&#39;algos.algo_id&#39;:1}},&#34;);
</span></span></span><span style=display:flex><span><span style=color:#75715e>//		commSB.append(&#34;{&#39;$group&#39;:{&#39;_id&#39;:{&#39;algo_id&#39;:&#39;$algos.algo_id&#39;,&#39;serial_number&#39;:&#39;$serial_number&#39;},&#39;algoName&#39;:{&#39;$last&#39;:&#39;$algos.algo_name&#39;},&#39;identResult&#39;:{&#39;$last&#39;:&#39;$algos.ident_result&#39;},&#39;serialNumber&#39;:{&#39;$last&#39;:&#39;$serial_number&#39;}}}&#34;);
</span></span></span><span style=display:flex><span><span style=color:#75715e>//		commSB.append(&#34;{$project:{&#39;algoName&#39;:&#39;$algoName&#39;,&#39;serNumber&#39;:&#39;$serNumber&#39;,&#39;identResult&#39;:&#39;$identResult&#39;,&#39;identEffect&#39;:&#39;$identEffect&#39;,&#39;humanIdentResult&#39;:&#39;$humanIdentResult&#39;,&#39;createTime&#39;:&#39;$create_time&#39;,&#39;_id&#39;:0}},&#34;);
</span></span></span><span style=display:flex><span><span style=color:#75715e>//		commSB.append(&#34;]}&#34;);
</span></span></span><span style=display:flex><span><span style=color:#75715e>//		List&lt;AlgoIdentPageDTO&gt; list = resultMapper.executeCommand(commSB.toString());
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>		PageInfos<span style=color:#f92672>&lt;</span>AlgoIdentPageDTO<span style=color:#f92672>&gt;</span> list <span style=color:#f92672>=</span> resultMapper<span style=color:#f92672>.</span><span style=color:#a6e22e>pageByAggregate</span><span style=color:#f92672>(</span>AlgoIdentPageDTO<span style=color:#f92672>.</span><span style=color:#a6e22e>class</span><span style=color:#f92672>,</span> input<span style=color:#f92672>.</span><span style=color:#a6e22e>getPageSize</span><span style=color:#f92672>(),</span> input<span style=color:#f92672>.</span><span style=color:#a6e22e>getPageIndex</span><span style=color:#f92672>(),</span> <span style=color:#e6db74>&#34;create_time desc&#34;</span><span style=color:#f92672>,</span> buildAlgoIdentRecordOperation<span style=color:#f92672>(</span>input<span style=color:#f92672>));</span>
</span></span><span style=display:flex><span>		response<span style=color:#f92672>.</span><span style=color:#a6e22e>setRespData</span><span style=color:#f92672>(</span>list<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>		resultCode<span style=color:#f92672>.</span><span style=color:#a6e22e>setSuccessResponse</span><span style=color:#f92672>(</span>response<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>return</span> response<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>	<span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>	
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>private</span> AggregationOperation<span style=color:#f92672>[]</span> <span style=color:#a6e22e>buildAlgoIdentRecordOperation</span><span style=color:#f92672>(</span>SerUsedRecordInput input<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>		<span style=color:#75715e>// å¹³é“ºæ•°ç»„
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>		UnwindOperation unwindOperation <span style=color:#f92672>=</span> Aggregation<span style=color:#f92672>.</span><span style=color:#a6e22e>unwind</span><span style=color:#f92672>(</span>ManagerConstants<span style=color:#f92672>.</span><span style=color:#a6e22e>MONGO_CALLER_INFO_ALGOS</span><span style=color:#f92672>,</span> <span style=color:#66d9ef>true</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>		<span style=color:#75715e>// åŒ¹é…æ¡ä»¶
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>		Criteria criteria <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> Criteria<span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>if</span><span style=color:#f92672>(</span>input<span style=color:#f92672>.</span><span style=color:#a6e22e>getAlgoId</span><span style=color:#f92672>()</span> <span style=color:#f92672>!=</span> <span style=color:#66d9ef>null</span><span style=color:#f92672>)</span> <span style=color:#f92672>{</span><span style=color:#75715e>// ç®—æ³•id
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>			criteria<span style=color:#f92672>.</span><span style=color:#a6e22e>and</span><span style=color:#f92672>(</span>ManagerConstants<span style=color:#f92672>.</span><span style=color:#a6e22e>MONGO_CALLER_INFO_ALGOS_ALGOID</span><span style=color:#f92672>).</span><span style=color:#a6e22e>is</span><span style=color:#f92672>(</span>input<span style=color:#f92672>.</span><span style=color:#a6e22e>getAlgoId</span><span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>		<span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>if</span><span style=color:#f92672>(</span>StringUtils<span style=color:#f92672>.</span><span style=color:#a6e22e>isNotBlank</span><span style=color:#f92672>(</span>input<span style=color:#f92672>.</span><span style=color:#a6e22e>getSerialNumber</span><span style=color:#f92672>()))</span> <span style=color:#f92672>{</span><span style=color:#75715e>// ä¸šåŠ¡æµæ°´å·
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>			criteria<span style=color:#f92672>.</span><span style=color:#a6e22e>and</span><span style=color:#f92672>(</span>ManagerConstants<span style=color:#f92672>.</span><span style=color:#a6e22e>MONGO_CALLER_INFO_SERIAL_NUMBER</span><span style=color:#f92672>).</span><span style=color:#a6e22e>is</span><span style=color:#f92672>(</span>input<span style=color:#f92672>.</span><span style=color:#a6e22e>getSerialNumber</span><span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>		<span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>if</span><span style=color:#f92672>(</span>StringUtils<span style=color:#f92672>.</span><span style=color:#a6e22e>isNotBlank</span><span style=color:#f92672>(</span>input<span style=color:#f92672>.</span><span style=color:#a6e22e>getCarNumber</span><span style=color:#f92672>()))</span> <span style=color:#f92672>{</span><span style=color:#75715e>// è½¦ç‰Œå·
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>			<span style=color:#75715e>// äººå·¥è¯†åˆ«è½¦ç‰Œ or ç®—æ³•è¯†åˆ«è½¦ç‰Œ
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>			criteria<span style=color:#f92672>.</span><span style=color:#a6e22e>orOperator</span><span style=color:#f92672>(</span>
</span></span><span style=display:flex><span>					Criteria<span style=color:#f92672>.</span><span style=color:#a6e22e>where</span><span style=color:#f92672>(</span>ManagerConstants<span style=color:#f92672>.</span><span style=color:#a6e22e>MONGO_CALLER_INFO_ALGOS_IDENT_RESULT</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>							<span style=color:#f92672>.</span><span style=color:#a6e22e>regex</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;^.*&#34;</span> <span style=color:#f92672>+</span> input<span style=color:#f92672>.</span><span style=color:#a6e22e>getCarNumber</span><span style=color:#f92672>()</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;.*$&#34;</span><span style=color:#f92672>),</span>
</span></span><span style=display:flex><span>					Criteria<span style=color:#f92672>.</span><span style=color:#a6e22e>where</span><span style=color:#f92672>(</span>ManagerConstants<span style=color:#f92672>.</span><span style=color:#a6e22e>MONGO_CALLER_INFO_HUMAN_IDENT_RESULT</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>							<span style=color:#f92672>.</span><span style=color:#a6e22e>regex</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;^.*&#34;</span> <span style=color:#f92672>+</span> input<span style=color:#f92672>.</span><span style=color:#a6e22e>getCarNumber</span><span style=color:#f92672>()</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;.*$&#34;</span><span style=color:#f92672>))</span> <span style=color:#f92672>;</span><span style=color:#75715e>// å…¨æ¨¡ç³Š
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>		<span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>		MatchOperation matchOperation <span style=color:#f92672>=</span> Aggregation<span style=color:#f92672>.</span><span style=color:#a6e22e>match</span><span style=color:#f92672>(</span>criteria<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>		<span style=color:#75715e>// åˆ†ç»„
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>		GroupOperation groupOperation <span style=color:#f92672>=</span> Aggregation<span style=color:#f92672>.</span><span style=color:#a6e22e>group</span><span style=color:#f92672>(</span>ManagerConstants<span style=color:#f92672>.</span><span style=color:#a6e22e>MONGO_CALLER_INFO_ALGOS_ALGOID</span><span style=color:#f92672>,</span>ManagerConstants<span style=color:#f92672>.</span><span style=color:#a6e22e>MONGO_CALLER_INFO_SERIAL_NUMBER</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>				<span style=color:#f92672>.</span><span style=color:#a6e22e>last</span><span style=color:#f92672>(</span>ManagerConstants<span style=color:#f92672>.</span><span style=color:#a6e22e>MONGO_CALLER_INFO_ALGOS_NAME</span><span style=color:#f92672>).</span><span style=color:#a6e22e>as</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;algo_name&#34;</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>				<span style=color:#f92672>.</span><span style=color:#a6e22e>last</span><span style=color:#f92672>(</span>ManagerConstants<span style=color:#f92672>.</span><span style=color:#a6e22e>MONGO_CALLER_INFO_ALGOS_IDENT_RESULT</span><span style=color:#f92672>).</span><span style=color:#a6e22e>as</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;ident_result&#34;</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>				<span style=color:#f92672>.</span><span style=color:#a6e22e>last</span><span style=color:#f92672>(</span>ManagerConstants<span style=color:#f92672>.</span><span style=color:#a6e22e>MONGO_CALLER_INFO_HUMAN_IDENT_RESULT</span><span style=color:#f92672>).</span><span style=color:#a6e22e>as</span><span style=color:#f92672>(</span>ManagerConstants<span style=color:#f92672>.</span><span style=color:#a6e22e>MONGO_CALLER_INFO_HUMAN_IDENT_RESULT</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>				<span style=color:#f92672>.</span><span style=color:#a6e22e>last</span><span style=color:#f92672>(</span>ManagerConstants<span style=color:#f92672>.</span><span style=color:#a6e22e>MONGO_CALLER_INFO_IDENT_EFFECT</span><span style=color:#f92672>).</span><span style=color:#a6e22e>as</span><span style=color:#f92672>(</span>ManagerConstants<span style=color:#f92672>.</span><span style=color:#a6e22e>MONGO_CALLER_INFO_IDENT_EFFECT</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>				<span style=color:#f92672>.</span><span style=color:#a6e22e>last</span><span style=color:#f92672>(</span>ManagerConstants<span style=color:#f92672>.</span><span style=color:#a6e22e>MONGO_CALLER_INFO_SERIAL_NUMBER</span><span style=color:#f92672>).</span><span style=color:#a6e22e>as</span><span style=color:#f92672>(</span>ManagerConstants<span style=color:#f92672>.</span><span style=color:#a6e22e>MONGO_CALLER_INFO_SERIAL_NUMBER</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>				<span style=color:#f92672>.</span><span style=color:#a6e22e>last</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;create_time&#34;</span><span style=color:#f92672>).</span><span style=color:#a6e22e>as</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;create_time&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>		<span style=color:#75715e>// è¿‡æ»¤å­—æ®µ
</span></span></span><span style=display:flex><span><span style=color:#75715e>//		ProjectionOperation projectionOperation = Aggregation.project(&#34;serialNumber&#34;,&#34;identResult&#34;).andExclude(&#34;_id&#34;);
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>		<span style=color:#66d9ef>return</span> ArrayUtils<span style=color:#f92672>.</span><span style=color:#a6e22e>toArray</span><span style=color:#f92672>(</span>unwindOperation<span style=color:#f92672>,</span>matchOperation<span style=color:#f92672>,</span>groupOperation<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>		
</span></span><span style=display:flex><span>	<span style=color:#f92672>}</span>
</span></span></code></pre></td></tr></table></div></div><p>mongodbMapperç±»</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>ResultRecordMapper</span> <span style=color:#66d9ef>extends</span> MongodbMapper<span style=color:#f92672>&lt;</span>CallRecordDetail<span style=color:#f92672>&gt;</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span></code></pre></td></tr></table></div></div><p>mongodbMapperå®ç°ç±»</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#a6e22e>@Component</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>ResultRecordMapperImpl</span> <span style=color:#66d9ef>extends</span> MongodbMapperImpl<span style=color:#f92672>&lt;</span>CallRecordDetail<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>implements</span> ResultRecordMapper  <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>@Override</span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>protected</span> Class<span style=color:#f92672>&lt;</span>CallRecordDetail<span style=color:#f92672>&gt;</span> <span style=color:#a6e22e>getEntityClass</span><span style=color:#f92672>()</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>return</span> CallRecordDetail<span style=color:#f92672>.</span><span style=color:#a6e22e>class</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>	<span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>	
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>@Override</span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>protected</span> String <span style=color:#a6e22e>getCollectionName</span><span style=color:#f92672>()</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>return</span> ManagerConstants<span style=color:#f92672>.</span><span style=color:#a6e22e>MONGO_CALLER_INFO</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>	<span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span></code></pre></td></tr></table></div></div><blockquote><p><strong>ä»¥åå¯èƒ½ä¼šé‡åˆ°æ›´å¥½çš„å·¥å…·ç±»å§,è¿™æ˜¯å€Ÿé‰´ä¸»æ•°æ®ä¸­å¿ƒçš„ä»£ç </strong></p></blockquote></div><footer class=post-footer><ul class=post-tags><li><a href=https://xiaokunji.github.io/zh/tags/%E5%88%86%E6%94%AF/>åˆ†æ”¯</a></li><li><a href=https://xiaokunji.github.io/zh/tags/java%E5%8F%8A%E5%85%B6%E6%A1%86%E6%9E%B6/>javaåŠå…¶æ¡†æ¶</a></li></ul><nav class=paginav><a class=prev href=https://xiaokunji.github.io/zh/java%E5%8F%8A%E5%85%B6%E6%A1%86%E6%9E%B6/maven/maven%E6%89%93%E5%8C%85%E6%8F%92%E4%BB%B6/><span class=title>Â« ä¸Šä¸€é¡µ</span><br><span>mavenæ‰“åŒ…æ’ä»¶</span></a>
<a class=next href=https://xiaokunji.github.io/zh/%E7%BB%BC%E5%90%88/%E7%AE%97%E6%B3%95/morris%E9%81%8D%E5%8E%86%E8%8E%AB%E9%87%8C%E6%96%AF%E9%81%8D%E5%8E%86/><span class=title>ä¸‹ä¸€é¡µ Â»</span><br><span>morriséå†(è«é‡Œæ–¯éå†)</span></a></nav></footer></article></main><footer class=footer><span>Copyright
&copy;
-2023
<a href=https://xiaokunji.github.io/zh/ style=color:#939393>ç±³äºŒ</a>
All Rights Reserved</span>
<span id=busuanzi_container><span class="fa fa-user">ç”¨æˆ·æ•°:</span><span id=busuanzi_value_site_uv></span>
<span class="fa fa-eye">è®¿é—®æ•°:</span><span id=busuanzi_value_site_pv></span></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="å¤åˆ¶";function s(){t.innerHTML="å·²å¤åˆ¶ï¼",setTimeout(()=>{t.innerHTML="å¤åˆ¶"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>