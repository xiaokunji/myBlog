<!doctype html><html lang=zh dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>java8 | 米二</title><meta name=keywords content=" 介绍, 1. 案例, 1.1 基本使用, 1.2 其他应用, 2. 高阶使用, 2.1 受检函数式接口:, 2.2  根据类中某个字段去重以及分页处理, 2.3 自定义Collector"><meta name=description content="     "><meta name=author content="xkj"><link rel=canonical href=https://xiaokunji.com/zh/java%E5%8F%8A%E5%85%B6%E6%A1%86%E6%9E%B6/java%E5%9F%BA%E7%A1%80/java8.html><link crossorigin=anonymous href=/assets/css/stylesheet.b3faf608c544858ba700943ffe182cb647f38432d29a07d73234965beacb26f6.css integrity="sha256-s/r2CMVEhYunAJQ//hgstkfzhDLSmgfXMjSWW+rLJvY=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://xiaokunji.com/img/Q.svg><link rel=icon type=image/png sizes=16x16 href=https://xiaokunji.com/img/Q.svg><link rel=icon type=image/png sizes=32x32 href=https://xiaokunji.com/img/Q.svg><link rel=apple-touch-icon href=https://xiaokunji.com/Q.svg><link rel=mask-icon href=https://xiaokunji.com/Q.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=zh href=https://xiaokunji.com/zh/java%E5%8F%8A%E5%85%B6%E6%A1%86%E6%9E%B6/java%E5%9F%BA%E7%A1%80/java8.html><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><meta property="og:title" content="java8"><meta property="og:description" content="     "><meta property="og:type" content="article"><meta property="og:url" content="https://xiaokunji.com/zh/java%E5%8F%8A%E5%85%B6%E6%A1%86%E6%9E%B6/java%E5%9F%BA%E7%A1%80/java8.html"><meta property="article:section" content="java及其框架"><meta property="article:published_time" content="2023-08-22T00:00:00+00:00"><meta property="article:modified_time" content="2023-09-01T16:11:13+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="java8"><meta name=twitter:description content="     "><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":4,"name":"java8","item":"https://xiaokunji.com/zh/java%E5%8F%8A%E5%85%B6%E6%A1%86%E6%9E%B6/java%E5%9F%BA%E7%A1%80/java8.html"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"java8","name":"java8","description":"     ","keywords":[" 介绍"," 1. 案例"," 1.1 基本使用"," 1.2 其他应用"," 2. 高阶使用"," 2.1 受检函数式接口:"," 2.2  根据类中某个字段去重以及分页处理"," 2.3 自定义Collector"],"articleBody":"[TOC]\n介绍 stream的优势:\n如表1-1中所示，Stream中的操作可以分为两大类：中间操作与结束操作，\n中间操作只是对操作进行了记录，只有结束操作才会触发实际的计算（即惰性求值），这也是Stream在迭代大集合时高效的原因之一。\n中间操作又可以分为无状态（Stateless）操作与有状态（Stateful）操作，前者是指元素的处理不受之前元素的影响；后者是指该操作只有拿到所有元素之后才能继续下去。\n结束操作又可以分为短路与非短路操作，这个应该很好理解，前者是指遇到某些符合条件的元素就可以得到最终结果；而后者是指必须处理所有元素才能得到最终结果。\n来自 http://www.cnblogs.com/Dorae/p/7779246.html 大概总结一下: 流式迭代集合操作,中间操作不会实际计算,而且会并行处理,(一个数据会同时被处理),等到了结束操作才会触发操作(和spark很像),java8的foreach还有并发处理,在数据量很大时foreach和流式的优势才会体现\n1. 案例 函数式接口(导读): 那些地方可以用,看流的入参就行了\nFunction =\u003e 函数,有输入有输出 参入参数T , 返回 R (用得多)\npredicate =\u003e 谓词/判定, 有输入,返回布尔值,主要作为一个谓词演算推导真假值存在 (用得多)\nconsumer =\u003e 谓词/消费,有输入无输出,\nsupplier =\u003e 提供, 无输入有输出,\n(特殊) Operator =\u003e 继承于 BiFunction ,所以也属于function, 算子Operator包括：UnaryOperator和BinaryOperator。分别对应单元算子和二元算子。其中BinaryOperator 可用于reduce\n来自 https://blog.csdn.net/lz710117239/article/details/76192629 来自 http://www.sohu.com/a/123958799_465959 1.1 基本使用 // Function =\u003e 就是一个函数,有输入输出 // 接收一个参数 Function\u003cInteger, Integer\u003e add = x -\u003e x + 1; System.out.println(add.apply(4)); // 输出: 5 // 接收两个参数 BiFunction\u003cString, Integer, Person\u003e addxy2Str = (x, y) -\u003e new Person(x, y); System.out.println(addxy2Str.apply(\"xkj\", 6)); // 输出: 对象信息 String nameStr=\"xkj,xkq,xkk,qoo\"; List\u003cString\u003e nameList = Arrays.asList(nameStr.split(\",\")); List\u003cPerson\u003e personList = new ArrayList\u003c\u003e(); Person p1=new Person(\"xkj\", 4); personList.add(p1); // Predicate =\u003e 可以用来过滤,查找 //功能:找到含 xkj 的字符串 =\u003e 返回集合 || 返回布尔 Predicate\u003cString\u003e isConxkj= n-\u003en.contains(\"xkj\"); List\u003cString\u003e xkjInfo = nameList.stream().filter(isConxkj).collect(Collectors.toList());//按 isConxkj 过滤 boolean isHaveXkj = nameList.stream().anyMatch(isConxkj); // 按isConxkj 找到任意一个就行 System.out.println(xkjInfo); // 输出 : xkj System.out.println(isHaveXkj); // 输出: true // Consumer =\u003e 只有入参没有返参,可以做一些数据处理 可以用在forEach中给list修改属性值, Consumer\u003cPerson\u003e addPrefix = p-\u003ep.setAge(30);; personList.forEach(System.out::println);//修改前 // 输出:Person [name=xkj, age=4] personList.stream().forEach(addPrefix); personList.forEach(System.out::println);//修改后 // 输出 : Person [name=xkj, age=30] //Supplier =\u003e 可以用来取配置信息(还是定义变量来爽),还有new对象(我感觉还是直接new爽快) (暂时不知道场景) Supplier\u003cPerson\u003e person=Person::new; Person p = person.get(); // 每个get都是个新的对象 System.out.println(p); //输出: Person [name=null, age=0] /** * 判断语句是否正确执行,返回语句的返回值,报错则为null * 比如,传入格式化时间语句,确定时间是否合法 */ public static \u003cT\u003e T of(Supplier\u003c? extends T\u003e supplier) { try { return supplier.get(); } catch (Throwable t) { return null; } } @Test public void testCollect() { initInfo(); Predicate\u003cString\u003e isConxkj= n-\u003en.contains(\"xk\"); //按 isConxkj 计数 Long xkjCount = nameList.stream().filter(isConxkj).collect(Collectors.counting()); System.out.println(xkjCount); //按 isConxkj 分区并对结果计数 (去掉后面的计数函数,就可以得到具体的值) Map\u003cBoolean, Long\u003e xkjCountMap = nameList.stream().collect(Collectors.partitioningBy(n-\u003en.contains(\"xk\"),Collectors.counting())); System.out.println(xkjCountMap); //按 isConxkj 过滤,得到的结果用,连接 String xkJoin = nameList.stream().filter(isConxkj).collect(Collectors.joining(\",\")); System.out.println(xkJoin); //按 isConxkj 过滤,得到的结果用,连接 Map\u003cObject, Object\u003e xkMap = nameList.stream().filter(isConxkj).collect(Collectors.toMap(k-\u003ek+\"_zz\", v-\u003ev)); System.out.println(xkMap); //按 名字map,person为val Map\u003cObject, Person\u003e xkMapByName = personList.stream().collect(Collectors.toMap(p-\u003ep.getName(),p-\u003ep)); System.out.println(xkMapByName); //分组后去最大值 Map\u003cInteger, Optional\u003cUsers\u003e\u003e collect = users.stream().collect(Collectors.groupingBy(Users::getAge, Collectors.maxBy(Comparator.comparing(Users::getId)))); // https://www.jianshu.com/p/21b20c375599 更多使用分组 // https://cloud.tencent.com/developer/article/1863390 // 按年龄分组 Map\u003cInteger, List\u003cPerson\u003e\u003e groupMapByAge = personList.stream().collect(Collectors.groupingBy(p-\u003ep.getAge())); System.out.println(groupMapByAge); // 用map操作数值类型时是有装箱处理的,多少有损耗,用mapToLong就是将值变成基本类型,然后用boxed变成普通流 Long decrease = ageList.stream().mapToLong(a-\u003ea).boxed().reduce((x,y)-\u003ex-y).orElse(0L); System.out.println(decrease); // 合并list List\u003cServiceOrder\u003e serviceOrderList = new ArrayList\u003c\u003e(); List\u003cString\u003e projectNoAll = serviceOrderList.stream().flatMap(s-\u003es.getProjectNos().stream()).collect(Collectors.toList()); List\u003cAClass\u003e unionResult = Stream.of(serviceOrderList, serviceOrderList).flatMap(Collection::stream).collect(Collectors.toList()); @Test public void testMR() { initInfo(); BinaryOperator\u003cString\u003e lk = (x, y) -\u003e x + y; Optional\u003cString\u003e reduceStr = nameList.stream().map(n -\u003e n).reduce(lk);//将所有的值拼起来 System.out.println(reduceStr.get()); } T reduce(T identity, BinaryOperator accumulator)\n相对于一个参数的方法来说，它多了一个T类型的参数；实际上就相当于需要计算的值在Stream的基础上多了一个初始化的值 eg.\nStream\u003cString\u003e s = Stream.of(\"test\", \"t1\", \"t2\", \"teeeee\", \"aaaa\", \"taaa\"); System.out.println(s.reduce(\"[value]:\", (s1, s2) -\u003e s1.concat(s2))); // [value]:testt1t2teeeeeaaaataaa 来自 https://blog.csdn.net/icarusliu/article/details/79504602 1.2 其他应用 json 格式化使用, 值不为null的才输出\nreturn JSON.toJSONString(val,(PropertyFilter)((obj, name, value) -\u003e value != null)); // NameFilter: 处理name字段,(比如对name加个后缀) // ValueFilter: 处理value字段,(比如对value加个后缀) // PropertyFilter: 处理obj字段 2. 高阶使用 2.1 受检函数式接口: package com.gree.ecommerce.utils.function; import java.util.Optional; /** * (检查)抛出lambda中异常情况 * * @author A80080 * @createDate 2021/4/21 */ public interface CheckFun { interface Function\u003cT, R\u003e { /** * Function类型 * * @param function 处理函数 * @param p 入参 * @return 处理结果, 报错返回 Optional.empty(); * @author A80080 * @createDate 2021/4/21 */ static \u003cT, R\u003e Optional\u003cR\u003e tryOf(Function\u003cT, R\u003e function, T p) { try { return Optional.ofNullable(function.apply(p)); } catch (Throwable t) { return Optional.empty(); } } /** * 参照 java.util.function.Function * * @param t 入参 * @return R 类型数据 * @throws Exception 异常 * @author A80080 * @createDate 2021/4/21 */ R apply(T t) throws Exception; } interface Supplier\u003cT\u003e { /** * Supplier 类型 * * @param supplier 处理函数 * @return 返回语句的返回值(optional), 报错则为Optional.empty() * @author A80080 */ static \u003cT\u003e Optional\u003cT\u003e tryOf(CheckFun.Supplier\u003c? extends T\u003e supplier) { try { return Optional.ofNullable(supplier.get()); } catch (Throwable t) { return Optional.empty(); } } /** * 参照 java.util.function.Supplier * * @return T 类型 * @throws Exception 异常 * @author A80080 * @createDate 2021/4/21 */ T get() throws Exception; } interface Consumer\u003cT\u003e { /** * consumer 类型 * 报错将忽略 * * @param consumer 处理函数 * @param p 入参 * @author A80080 * @createDate 2021/4/21 */ static \u003cT\u003e void tryOf(CheckFun.Consumer\u003cT\u003e consumer, T p) { try { consumer.accept(p); } catch (Throwable ignored) { } } /** * 参照 java.util.function.Consumer * * @param t 入参 * @throws Exception 异常 * @author A80080 * @createDate 2021/4/21 */ void accept(T t) throws Exception; } interface Predicate\u003cT\u003e { /** * Predicate类型 * * @param predicate 处理函数 * @param p 入参 * @return 处理结果, 报错返回 false * @author A80080 * @createDate 2021/4/21 */ static \u003cT\u003e boolean tryOf(CheckFun.Predicate\u003cT\u003e predicate, T p) { try { return predicate.test(p); } catch (Throwable t) { return false; } } /** * 参照 java.util.function.Predicate * * @param t 入参 * @return boolean * @throws Exception 异常 * @author A80080 * @createDate 2021/4/21 */ boolean test(T t) throws Exception; } } // 使用案例 @Test public void test() { Stream.of(\"uNameCookie\", \"uidCookie\", \"loginNameCookie\", \"loginStatusCookie\", \"mobileLoginTokenCookie\") .filter(c-\u003e!CheckFun.Predicate.tryOf(a-\u003eURLEncoder.encode(c, \"utf-8\").equals(\"\"),c)) .peek(c -\u003e c.concat(CheckFun.Supplier.tryOf(() -\u003e URLEncoder.encode(c, \"utf-8\")).orElse(c))) .map(c -\u003e c.concat(CheckFun.Function.tryOf(a -\u003e URLEncoder.encode(a, \"utf-8\"), c).orElse(c))) .peek(c -\u003e CheckFun.Consumer.tryOf(x -\u003e c.concat(URLEncoder.encode(x, \"utf-8\")), c)) .forEach(System.out::println); } 2.2 根据类中某个字段去重以及分页处理 // 根据类中某个字段去重 @Test public void should_return_2_because_distinct_by_age() { userList = userList.stream() .filter(distinctByKey(User::getName)) .collect(Collectors.toList()); userList.forEach(System.out::println); assertEquals(2, userList.size()); } private static \u003cT, R\u003e Predicate\u003cT\u003e distinctByKey(Function\u003cT, R\u003e keyExtractor) { Set\u003cR\u003e seen = ConcurrentHashMap.newKeySet(); return t -\u003e seen.add(keyExtractor.apply(t)); } // 链接：https://hacpai.com/article/1545321970124 divideBatchHandler(nameList,System.out::println); } /** * 运用场景:当数据量过大,需要分批处理时 * @author xkj * @param dataList 需要处理的数据 * @param consumer 处理函数 * @since */ public \u003cT\u003e void divideBatchHandler(List\u003cT\u003e dataList, Consumer\u003cList\u003cT\u003e\u003e consumer) { Optional.ofNullable(dataList).ifPresent(list -\u003e IntStream.range(0, list.size()) .mapToObj(i -\u003e new AbstractMap.SimpleImmutableEntry\u003c\u003e(i, list.get(i)))// 给数据编号 .collect(Collectors.groupingBy( e -\u003e e.getKey() / 10, Collectors.mapping(Map.Entry::getValue, Collectors.toList()))) // 按编号分批并合并编号对应的值 .values() .parallelStream()// 并行处理 .forEach(consumer) // 执行处理函数 ); } 2.3 自定义Collector Collector主要包含五个参数，它的行为也是由这五个参数来定义的，如下所示：\nCollector实现的三个泛型具体是什么：\nT（输入的元素类型）：T A（累积结果的容器类型）： R（最终生成的结果类型）： public interface Collector\u003cT, A, R\u003e { // supplier参数用于生成结果容器，容器类型为A Supplier\u003cA\u003e supplier(); // accumulator用于消费元素，也就是归纳元素，这里的T就是元素，它会将流中的元素一个一个与结果容器A发生操作 BiConsumer\u003cA, T\u003e accumulator(); // combiner用于两个两个合并并行执行的线程的执行结果，将其合并为一个最终结果A BinaryOperator\u003cA\u003e combiner(); // finisher用于将之前整合完的结果R转换成为A Function\u003cA, R\u003e finisher(); // characteristics表示当前Collector的特征值，这是个不可变Set Set\u003cCharacteristics\u003e characteristics(); } 枚举常量Characteristics 中共有三个特征值，它们的具体含义如下：\nCONCURRENT：表示结果容器只有一个（即使是在并行流的情况下）。只有在并行流且收集器不具备此特性的情况下，combiner()返回的lambda表达式才会执行（中间结果容器只有一个就无需合并）。设置此特性时意味着多个线程可以对同一个结果容器调用，因此结果容器必须是线程安全的。\nUNORDERED：表示流中的元素无序。\nIDENTITY_FINISH：表示中间结果容器类型与最终结果类型一致。设置此特性时finiser()方法不会被调用。\n/** 该案例作用: 对集合元素 求和并转成字符串 */ @Test public void Test(){ // 1. 第一个参数是临时值的容器 // 2. 第二个参数是把入参放到容器中 // 3. 第三个参数是把第二步的值做一个结合放到容器中 // 4. 第四个参数把容器中的值转化成结果类型 // 5. 第五个参数是一个特征值 BiConsumer\u003cList\u003cLong\u003e, Long\u003e accumulator = (x, y) -\u003e { x.add(y); return; }; BinaryOperator\u003cList\u003cLong\u003e\u003e combiner = (x, y) -\u003e { x.addAll(y); return x; }; Function\u003cList\u003cLong\u003e, String\u003e func = x -\u003e String.valueOf(x.stream().mapToLong(y-\u003e y).sum()); Collector\u003cLong, List\u003cLong\u003e, String\u003e longSupplier = Collector.of(ArrayList::new, accumulator, combiner,func, Collector.Characteristics.UNORDERED); String collect = Stream.of(1, 1, 2, 2) .map(Long::new) .collect(longSupplier); System.out.println(\"collect = \" + collect); } java8新特性(四) Collector（收集器）_戏流年的博客-CSDN博客_collector Java基础系列-Collector和Collectors - 简书 (jianshu.com) ","wordCount":"3170","inLanguage":"zh","datePublished":"2023-08-22T00:00:00Z","dateModified":"2023-09-01T16:11:13.270466518Z","author":{"@type":"Person","name":"xkj"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://xiaokunji.com/zh/java%E5%8F%8A%E5%85%B6%E6%A1%86%E6%9E%B6/java%E5%9F%BA%E7%A1%80/java8.html"},"publisher":{"@type":"Organization","name":"米二","logo":{"@type":"ImageObject","url":"https://xiaokunji.com/img/Q.svg"}}}</script></head><body class=dark id=top><script>localStorage.getItem("pref-theme")==="light"&&document.body.classList.remove("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://xiaokunji.com/zh/ accesskey=h title="米二 (Alt + H)"><img src=https://xiaokunji.com/img/Q.svg alt aria-label=logo height=35>米二</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li><li><a href=https://xiaokunji.com/en/ title=English aria-label=English>English</a></li></ul></div></div><ul id=menu><li><a href=https://xiaokunji.com/zh/ title=🏠主页><span>🏠主页</span></a></li><li><a href=https://xiaokunji.com/zh/search.html title="🔍搜索 (Alt + /)" accesskey=/><span>🔍搜索</span></a></li><li><a href=https://xiaokunji.com/zh/post.html title=📚文章><span>📚文章</span></a></li><li><a href=https://xiaokunji.com/zh/archives.html title=⏱时间轴><span>⏱时间轴</span></a></li><li><a href=https://xiaokunji.com/zh/tags.html title=🔖标签><span>🔖标签</span></a></li><li><a href=https://xiaokunji.com/zh/categories.html title=📖分类><span>📖分类</span></a></li><li><a href=https://xiaokunji.com/zh/links.html title=🤝友链><span>🤝友链</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><nav aria-label=breadcrumb><ul><a href=https://xiaokunji.com/zh/>🏠</a> <span>></span>
<a href=https://xiaokunji.com/zh/java%E5%8F%8A%E5%85%B6%E6%A1%86%E6%9E%B6.html>java及其框架</a> <span>></span>
<a href=https://xiaokunji.com/zh/java%E5%8F%8A%E5%85%B6%E6%A1%86%E6%9E%B6/java%E5%9F%BA%E7%A1%80.html>java基础</a> <span>></span></ul></nav><h1 class=post-title>java8</h1><div class=post-description></div><div class=post-meta>创建:&nbsp;<span title='2023-08-22 00:00:00 +0000 UTC'>2023-08-22</span>&nbsp;·&nbsp;更新:&nbsp;2023-09-01&nbsp;·&nbsp;7 分钟&nbsp;·&nbsp;xkj
&nbsp;|&nbsp;分类: &nbsp;<ul class=post-categories-meta><a href=https://xiaokunji.com/zh/categories/java%E5%8F%8A%E5%85%B6%E6%A1%86%E6%9E%B6.html>java及其框架</a></ul><span id=busuanzi_container_page_pv>&nbsp;| 访问: <span id=busuanzi_value_page_pv></span></span></div></header><aside id=toc-container class="toc-container wide"><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>目录</span></summary><div class=inner><ul><li><a href=#%e4%bb%8b%e7%bb%8d aria-label=介绍>介绍</a></li><li><a href=#1-%e6%a1%88%e4%be%8b aria-label="1. 案例">1. 案例</a><ul><li><a href=#11-%e5%9f%ba%e6%9c%ac%e4%bd%bf%e7%94%a8 aria-label="1.1 基本使用">1.1 基本使用</a></li><li><a href=#12-%e5%85%b6%e4%bb%96%e5%ba%94%e7%94%a8 aria-label="1.2 其他应用">1.2 其他应用</a></li></ul></li><li><a href=#2-%e9%ab%98%e9%98%b6%e4%bd%bf%e7%94%a8 aria-label="2. 高阶使用">2. 高阶使用</a><ul><li><a href=#21-%e5%8f%97%e6%a3%80%e5%87%bd%e6%95%b0%e5%bc%8f%e6%8e%a5%e5%8f%a3 aria-label="2.1 受检函数式接口:">2.1 受检函数式接口:</a></li><li><a href=#22--%e6%a0%b9%e6%8d%ae%e7%b1%bb%e4%b8%ad%e6%9f%90%e4%b8%aa%e5%ad%97%e6%ae%b5%e5%8e%bb%e9%87%8d%e4%bb%a5%e5%8f%8a%e5%88%86%e9%a1%b5%e5%a4%84%e7%90%86 aria-label="2.2  根据类中某个字段去重以及分页处理">2.2 根据类中某个字段去重以及分页处理</a></li><li><a href=#23-%e8%87%aa%e5%ae%9a%e4%b9%89collector aria-label="2.3 自定义Collector">2.3 自定义Collector</a></li></ul></li></ul></div></details></div></aside><script>let activeElement,elements;window.addEventListener("DOMContentLoaded",function(){checkTocPosition(),elements=document.querySelectorAll("h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]"),activeElement=elements[0];const t=encodeURI(activeElement.getAttribute("id")).toLowerCase();document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active")},!1),window.addEventListener("resize",function(){checkTocPosition()},!1),window.addEventListener("scroll",()=>{activeElement=Array.from(elements).find(e=>{if(getOffsetTop(e)-window.pageYOffset>0&&getOffsetTop(e)-window.pageYOffset<window.innerHeight/2)return e})||activeElement,elements.forEach(e=>{const t=encodeURI(e.getAttribute("id")).toLowerCase();e===activeElement?document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active"):document.querySelector(`.inner ul li a[href="#${t}"]`).classList.remove("active")})},!1);const main=parseInt(getComputedStyle(document.body).getPropertyValue("--article-width"),10),toc=parseInt(getComputedStyle(document.body).getPropertyValue("--toc-width"),10),gap=parseInt(getComputedStyle(document.body).getPropertyValue("--gap"),10);function checkTocPosition(){const e=document.body.scrollWidth;e-main-toc*2-gap*4>0?document.getElementById("toc-container").classList.add("wide"):document.getElementById("toc-container").classList.remove("wide")}function getOffsetTop(e){if(!e.getClientRects().length)return 0;let t=e.getBoundingClientRect(),n=e.ownerDocument.defaultView;return t.top+n.pageYOffset}</script><div class=post-content><p>[TOC]</p><h1 id=介绍>介绍<a hidden class=anchor aria-hidden=true href=#介绍>#</a></h1><p><strong>stream的优势:</strong></p><p><img loading=lazy src=https://gitee.com/xiaokunji/my-images/raw/master/myMD/java8-steam.png alt=image-20210429111143136></p><p>如表1-1中所示，<strong>Stream中的操作可以分为两大类</strong>：<u>中间操作与结束操作</u>，</p><p>  中间操作只是对操作进行了记录，只有结束操作才会触发实际的计算（即惰性求值），这也是Stream在迭代大集合时高效的原因之一。</p><p>  中间操作又可以分为无状态（Stateless）操作与有状态（Stateful）操作，前者是指元素的处理不受之前元素的影响；后者是指该操作只有拿到所有元素之后才能继续下去。</p><p>  结束操作又可以分为短路与非短路操作，这个应该很好理解，前者是指遇到某些符合条件的元素就可以得到最终结果；而后者是指必须处理所有元素才能得到最终结果。</p><blockquote><p>来自 <a href=http://www.cnblogs.com/Dorae/p/7779246.html target=_blank rel=noopener>http://www.cnblogs.com/Dorae/p/7779246.html</a></p></blockquote><p>大概总结一下: <u>流式迭代集合操作,中间操作不会实际计算,而且会并行处理,(一个数据会同时被处理),等到了结束操作才会触发操作(和spark很像),java8的foreach还有并发处理,在数据量很大时foreach和流式的优势才会体现</u></p><p><img loading=lazy src=https://github.com/xiaokunji/MyImagesBed/blob/master/mdImagesimage-20210824141738190.png alt=img></p><h1 id=1-案例>1. 案例<a hidden class=anchor aria-hidden=true href=#1-案例>#</a></h1><p>函数式接口(导读): 那些地方可以用,看流的入参就行了</p><ol><li><p>Function => 函数,有输入有输出 参入参数T , 返回 R (用得多)</p></li><li><p>predicate => 谓词/判定, 有输入,返回布尔值,主要作为一个谓词演算推导真假值存在 (用得多)</p></li><li><p>consumer => 谓词/消费,有输入无输出,</p></li><li><p>supplier => 提供, 无输入有输出,</p></li><li><p>(特殊) Operator => 继承于 BiFunction ,所以也属于function, 算子Operator包括：UnaryOperator和BinaryOperator。分别对应单元算子和二元算子。其中BinaryOperator 可用于reduce</p><blockquote><p>来自 <a href=https://blog.csdn.net/lz710117239/article/details/76192629 target=_blank rel=noopener>https://blog.csdn.net/lz710117239/article/details/76192629</a></p><p>来自 <a href=http://www.sohu.com/a/123958799_465959 target=_blank rel=noopener>http://www.sohu.com/a/123958799_465959</a></p></blockquote></li></ol><h2 id=11-基本使用>1.1 基本使用<a hidden class=anchor aria-hidden=true href=#11-基本使用>#</a></h2><div class=highlight><pre tabindex=0 style=color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic>// Function =&gt; 就是一个函数,有输入输出
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>        <span style=color:#8b949e;font-style:italic>// 接收一个参数
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>        Function<span style=color:#ff7b72;font-weight:700>&lt;</span>Integer<span style=color:#ff7b72;font-weight:700>,</span> Integer<span style=color:#ff7b72;font-weight:700>&gt;</span> add <span style=color:#ff7b72;font-weight:700>=</span> x <span style=color:#ff7b72;font-weight:700>-&gt;</span> x <span style=color:#ff7b72;font-weight:700>+</span> 1<span style=color:#ff7b72;font-weight:700>;</span>
</span></span><span style=display:flex><span>        System<span style=color:#ff7b72;font-weight:700>.</span>out<span style=color:#ff7b72;font-weight:700>.</span>println<span style=color:#ff7b72;font-weight:700>(</span>add<span style=color:#ff7b72;font-weight:700>.</span>apply<span style=color:#ff7b72;font-weight:700>(</span>4<span style=color:#ff7b72;font-weight:700>));</span> <span style=color:#8b949e;font-style:italic>// 输出: 5
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>        <span style=color:#8b949e;font-style:italic>// 接收两个参数
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>        BiFunction<span style=color:#ff7b72;font-weight:700>&lt;</span>String<span style=color:#ff7b72;font-weight:700>,</span> Integer<span style=color:#ff7b72;font-weight:700>,</span> Person<span style=color:#ff7b72;font-weight:700>&gt;</span> addxy2Str <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#ff7b72;font-weight:700>(</span>x<span style=color:#ff7b72;font-weight:700>,</span> y<span style=color:#ff7b72;font-weight:700>)</span> <span style=color:#ff7b72;font-weight:700>-&gt;</span> <span style=color:#ff7b72>new</span> Person<span style=color:#ff7b72;font-weight:700>(</span>x<span style=color:#ff7b72;font-weight:700>,</span> y<span style=color:#ff7b72;font-weight:700>);</span>
</span></span><span style=display:flex><span>        System<span style=color:#ff7b72;font-weight:700>.</span>out<span style=color:#ff7b72;font-weight:700>.</span>println<span style=color:#ff7b72;font-weight:700>(</span>addxy2Str<span style=color:#ff7b72;font-weight:700>.</span>apply<span style=color:#ff7b72;font-weight:700>(</span><span style=color:#a5d6ff>&#34;xkj&#34;</span><span style=color:#ff7b72;font-weight:700>,</span> 6<span style=color:#ff7b72;font-weight:700>));</span> <span style=color:#8b949e;font-style:italic>// 输出: 对象信息
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>        String nameStr<span style=color:#ff7b72;font-weight:700>=</span><span style=color:#a5d6ff>&#34;xkj,xkq,xkk,qoo&#34;</span><span style=color:#ff7b72;font-weight:700>;</span>
</span></span><span style=display:flex><span>        List<span style=color:#ff7b72;font-weight:700>&lt;</span>String<span style=color:#ff7b72;font-weight:700>&gt;</span> nameList <span style=color:#ff7b72;font-weight:700>=</span> Arrays<span style=color:#ff7b72;font-weight:700>.</span>asList<span style=color:#ff7b72;font-weight:700>(</span>nameStr<span style=color:#ff7b72;font-weight:700>.</span>split<span style=color:#ff7b72;font-weight:700>(</span><span style=color:#a5d6ff>&#34;,&#34;</span><span style=color:#ff7b72;font-weight:700>));</span>
</span></span><span style=display:flex><span>        List<span style=color:#ff7b72;font-weight:700>&lt;</span>Person<span style=color:#ff7b72;font-weight:700>&gt;</span> personList <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#ff7b72>new</span> ArrayList<span style=color:#ff7b72;font-weight:700>&lt;&gt;();</span>
</span></span><span style=display:flex><span>        Person p1<span style=color:#ff7b72;font-weight:700>=</span><span style=color:#ff7b72>new</span> Person<span style=color:#ff7b72;font-weight:700>(</span><span style=color:#a5d6ff>&#34;xkj&#34;</span><span style=color:#ff7b72;font-weight:700>,</span> 4<span style=color:#ff7b72;font-weight:700>);</span>
</span></span><span style=display:flex><span>        personList<span style=color:#ff7b72;font-weight:700>.</span>add<span style=color:#ff7b72;font-weight:700>(</span>p1<span style=color:#ff7b72;font-weight:700>);</span>
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic>// Predicate  =&gt; 可以用来过滤,查找
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>        <span style=color:#8b949e;font-style:italic>//功能:找到含 xkj 的字符串  =&gt;  返回集合  || 返回布尔
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>        Predicate<span style=color:#ff7b72;font-weight:700>&lt;</span>String<span style=color:#ff7b72;font-weight:700>&gt;</span> isConxkj<span style=color:#ff7b72;font-weight:700>=</span> n<span style=color:#ff7b72;font-weight:700>-&gt;</span>n<span style=color:#ff7b72;font-weight:700>.</span>contains<span style=color:#ff7b72;font-weight:700>(</span><span style=color:#a5d6ff>&#34;xkj&#34;</span><span style=color:#ff7b72;font-weight:700>);</span>
</span></span><span style=display:flex><span>        List<span style=color:#ff7b72;font-weight:700>&lt;</span>String<span style=color:#ff7b72;font-weight:700>&gt;</span> xkjInfo <span style=color:#ff7b72;font-weight:700>=</span> nameList<span style=color:#ff7b72;font-weight:700>.</span>stream<span style=color:#ff7b72;font-weight:700>().</span>filter<span style=color:#ff7b72;font-weight:700>(</span>isConxkj<span style=color:#ff7b72;font-weight:700>).</span>collect<span style=color:#ff7b72;font-weight:700>(</span>Collectors<span style=color:#ff7b72;font-weight:700>.</span>toList<span style=color:#ff7b72;font-weight:700>());</span><span style=color:#8b949e;font-style:italic>//按 isConxkj 过滤
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>        <span style=color:#ff7b72>boolean</span> isHaveXkj <span style=color:#ff7b72;font-weight:700>=</span> nameList<span style=color:#ff7b72;font-weight:700>.</span>stream<span style=color:#ff7b72;font-weight:700>().</span>anyMatch<span style=color:#ff7b72;font-weight:700>(</span>isConxkj<span style=color:#ff7b72;font-weight:700>);</span> <span style=color:#8b949e;font-style:italic>// 按isConxkj 找到任意一个就行
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>        System<span style=color:#ff7b72;font-weight:700>.</span>out<span style=color:#ff7b72;font-weight:700>.</span>println<span style=color:#ff7b72;font-weight:700>(</span>xkjInfo<span style=color:#ff7b72;font-weight:700>);</span> <span style=color:#8b949e;font-style:italic>// 输出 :  xkj
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>        System<span style=color:#ff7b72;font-weight:700>.</span>out<span style=color:#ff7b72;font-weight:700>.</span>println<span style=color:#ff7b72;font-weight:700>(</span>isHaveXkj<span style=color:#ff7b72;font-weight:700>);</span> <span style=color:#8b949e;font-style:italic>// 输出: true
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>        
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic>// Consumer =&gt; 只有入参没有返参,可以做一些数据处理 可以用在forEach中给list修改属性值, 
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>        Consumer<span style=color:#ff7b72;font-weight:700>&lt;</span>Person<span style=color:#ff7b72;font-weight:700>&gt;</span> addPrefix <span style=color:#ff7b72;font-weight:700>=</span> p<span style=color:#ff7b72;font-weight:700>-&gt;</span>p<span style=color:#ff7b72;font-weight:700>.</span>setAge<span style=color:#ff7b72;font-weight:700>(</span>30<span style=color:#ff7b72;font-weight:700>);;</span>
</span></span><span style=display:flex><span>        personList<span style=color:#ff7b72;font-weight:700>.</span>forEach<span style=color:#ff7b72;font-weight:700>(</span>System<span style=color:#ff7b72;font-weight:700>.</span>out<span style=color:#ff7b72;font-weight:700>::</span>println<span style=color:#ff7b72;font-weight:700>);</span><span style=color:#8b949e;font-style:italic>//修改前  // 输出:Person [name=xkj, age=4]
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>        personList<span style=color:#ff7b72;font-weight:700>.</span>stream<span style=color:#ff7b72;font-weight:700>().</span>forEach<span style=color:#ff7b72;font-weight:700>(</span>addPrefix<span style=color:#ff7b72;font-weight:700>);</span>
</span></span><span style=display:flex><span>        personList<span style=color:#ff7b72;font-weight:700>.</span>forEach<span style=color:#ff7b72;font-weight:700>(</span>System<span style=color:#ff7b72;font-weight:700>.</span>out<span style=color:#ff7b72;font-weight:700>::</span>println<span style=color:#ff7b72;font-weight:700>);</span><span style=color:#8b949e;font-style:italic>//修改后  // 输出 : Person [name=xkj, age=30]
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>        
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic>//Supplier =&gt; 可以用来取配置信息(还是定义变量来爽),还有new对象(我感觉还是直接new爽快)  (暂时不知道场景)
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>        Supplier<span style=color:#ff7b72;font-weight:700>&lt;</span>Person<span style=color:#ff7b72;font-weight:700>&gt;</span> person<span style=color:#ff7b72;font-weight:700>=</span>Person<span style=color:#ff7b72;font-weight:700>::</span><span style=color:#ff7b72>new</span><span style=color:#ff7b72;font-weight:700>;</span>
</span></span><span style=display:flex><span>        Person p <span style=color:#ff7b72;font-weight:700>=</span> person<span style=color:#ff7b72;font-weight:700>.</span>get<span style=color:#ff7b72;font-weight:700>();</span> <span style=color:#8b949e;font-style:italic>// 每个get都是个新的对象
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>        System<span style=color:#ff7b72;font-weight:700>.</span>out<span style=color:#ff7b72;font-weight:700>.</span>println<span style=color:#ff7b72;font-weight:700>(</span>p<span style=color:#ff7b72;font-weight:700>);</span>  <span style=color:#8b949e;font-style:italic>//输出: Person [name=null, age=0]
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>/**
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>* 判断语句是否正确执行,返回语句的返回值,报错则为null
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>* 比如,传入格式化时间语句,确定时间是否合法
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>*/</span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>public</span> <span style=color:#ff7b72>static</span> <span style=color:#ff7b72;font-weight:700>&lt;</span>T<span style=color:#ff7b72;font-weight:700>&gt;</span> T <span style=color:#d2a8ff;font-weight:700>of</span><span style=color:#ff7b72;font-weight:700>(</span>Supplier<span style=color:#ff7b72;font-weight:700>&lt;?</span> <span style=color:#ff7b72>extends</span> T<span style=color:#ff7b72;font-weight:700>&gt;</span> supplier<span style=color:#ff7b72;font-weight:700>)</span> <span style=color:#ff7b72;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>try</span> <span style=color:#ff7b72;font-weight:700>{</span>
</span></span><span style=display:flex><span>            <span style=color:#ff7b72>return</span> supplier<span style=color:#ff7b72;font-weight:700>.</span>get<span style=color:#ff7b72;font-weight:700>();</span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72;font-weight:700>}</span> <span style=color:#ff7b72>catch</span> <span style=color:#ff7b72;font-weight:700>(</span>Throwable t<span style=color:#ff7b72;font-weight:700>)</span> <span style=color:#ff7b72;font-weight:700>{</span>
</span></span><span style=display:flex><span>            <span style=color:#ff7b72>return</span> <span style=color:#79c0ff>null</span><span style=color:#ff7b72;font-weight:700>;</span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#ff7b72;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#d2a8ff;font-weight:700>@Test</span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>public</span> <span style=color:#ff7b72>void</span> <span style=color:#d2a8ff;font-weight:700>testCollect</span><span style=color:#ff7b72;font-weight:700>()</span> <span style=color:#ff7b72;font-weight:700>{</span>
</span></span><span style=display:flex><span>        initInfo<span style=color:#ff7b72;font-weight:700>();</span>
</span></span><span style=display:flex><span>        Predicate<span style=color:#ff7b72;font-weight:700>&lt;</span>String<span style=color:#ff7b72;font-weight:700>&gt;</span> isConxkj<span style=color:#ff7b72;font-weight:700>=</span> n<span style=color:#ff7b72;font-weight:700>-&gt;</span>n<span style=color:#ff7b72;font-weight:700>.</span>contains<span style=color:#ff7b72;font-weight:700>(</span><span style=color:#a5d6ff>&#34;xk&#34;</span><span style=color:#ff7b72;font-weight:700>);</span>
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic>//按 isConxkj 计数
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>        Long xkjCount <span style=color:#ff7b72;font-weight:700>=</span> nameList<span style=color:#ff7b72;font-weight:700>.</span>stream<span style=color:#ff7b72;font-weight:700>().</span>filter<span style=color:#ff7b72;font-weight:700>(</span>isConxkj<span style=color:#ff7b72;font-weight:700>).</span>collect<span style=color:#ff7b72;font-weight:700>(</span>Collectors<span style=color:#ff7b72;font-weight:700>.</span>counting<span style=color:#ff7b72;font-weight:700>());</span>
</span></span><span style=display:flex><span>        System<span style=color:#ff7b72;font-weight:700>.</span>out<span style=color:#ff7b72;font-weight:700>.</span>println<span style=color:#ff7b72;font-weight:700>(</span>xkjCount<span style=color:#ff7b72;font-weight:700>);</span>
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic>//按 isConxkj 分区并对结果计数  (去掉后面的计数函数,就可以得到具体的值)
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>        Map<span style=color:#ff7b72;font-weight:700>&lt;</span>Boolean<span style=color:#ff7b72;font-weight:700>,</span> Long<span style=color:#ff7b72;font-weight:700>&gt;</span> xkjCountMap <span style=color:#ff7b72;font-weight:700>=</span> nameList<span style=color:#ff7b72;font-weight:700>.</span>stream<span style=color:#ff7b72;font-weight:700>().</span>collect<span style=color:#ff7b72;font-weight:700>(</span>Collectors<span style=color:#ff7b72;font-weight:700>.</span>partitioningBy<span style=color:#ff7b72;font-weight:700>(</span>n<span style=color:#ff7b72;font-weight:700>-&gt;</span>n<span style=color:#ff7b72;font-weight:700>.</span>contains<span style=color:#ff7b72;font-weight:700>(</span><span style=color:#a5d6ff>&#34;xk&#34;</span><span style=color:#ff7b72;font-weight:700>),</span>Collectors<span style=color:#ff7b72;font-weight:700>.</span>counting<span style=color:#ff7b72;font-weight:700>()));</span>
</span></span><span style=display:flex><span>        System<span style=color:#ff7b72;font-weight:700>.</span>out<span style=color:#ff7b72;font-weight:700>.</span>println<span style=color:#ff7b72;font-weight:700>(</span>xkjCountMap<span style=color:#ff7b72;font-weight:700>);</span>
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic>//按 isConxkj 过滤,得到的结果用,连接
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>        String xkJoin <span style=color:#ff7b72;font-weight:700>=</span> nameList<span style=color:#ff7b72;font-weight:700>.</span>stream<span style=color:#ff7b72;font-weight:700>().</span>filter<span style=color:#ff7b72;font-weight:700>(</span>isConxkj<span style=color:#ff7b72;font-weight:700>).</span>collect<span style=color:#ff7b72;font-weight:700>(</span>Collectors<span style=color:#ff7b72;font-weight:700>.</span>joining<span style=color:#ff7b72;font-weight:700>(</span><span style=color:#a5d6ff>&#34;,&#34;</span><span style=color:#ff7b72;font-weight:700>));</span>
</span></span><span style=display:flex><span>        System<span style=color:#ff7b72;font-weight:700>.</span>out<span style=color:#ff7b72;font-weight:700>.</span>println<span style=color:#ff7b72;font-weight:700>(</span>xkJoin<span style=color:#ff7b72;font-weight:700>);</span>
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic>//按 isConxkj 过滤,得到的结果用,连接
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>        Map<span style=color:#ff7b72;font-weight:700>&lt;</span>Object<span style=color:#ff7b72;font-weight:700>,</span> Object<span style=color:#ff7b72;font-weight:700>&gt;</span> xkMap <span style=color:#ff7b72;font-weight:700>=</span> nameList<span style=color:#ff7b72;font-weight:700>.</span>stream<span style=color:#ff7b72;font-weight:700>().</span>filter<span style=color:#ff7b72;font-weight:700>(</span>isConxkj<span style=color:#ff7b72;font-weight:700>).</span>collect<span style=color:#ff7b72;font-weight:700>(</span>Collectors<span style=color:#ff7b72;font-weight:700>.</span>toMap<span style=color:#ff7b72;font-weight:700>(</span>k<span style=color:#ff7b72;font-weight:700>-&gt;</span>k<span style=color:#ff7b72;font-weight:700>+</span><span style=color:#a5d6ff>&#34;_zz&#34;</span><span style=color:#ff7b72;font-weight:700>,</span> v<span style=color:#ff7b72;font-weight:700>-&gt;</span>v<span style=color:#ff7b72;font-weight:700>));</span>
</span></span><span style=display:flex><span>        System<span style=color:#ff7b72;font-weight:700>.</span>out<span style=color:#ff7b72;font-weight:700>.</span>println<span style=color:#ff7b72;font-weight:700>(</span>xkMap<span style=color:#ff7b72;font-weight:700>);</span>
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic>//按 名字map,person为val
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>        Map<span style=color:#ff7b72;font-weight:700>&lt;</span>Object<span style=color:#ff7b72;font-weight:700>,</span> Person<span style=color:#ff7b72;font-weight:700>&gt;</span> xkMapByName <span style=color:#ff7b72;font-weight:700>=</span> personList<span style=color:#ff7b72;font-weight:700>.</span>stream<span style=color:#ff7b72;font-weight:700>().</span>collect<span style=color:#ff7b72;font-weight:700>(</span>Collectors<span style=color:#ff7b72;font-weight:700>.</span>toMap<span style=color:#ff7b72;font-weight:700>(</span>p<span style=color:#ff7b72;font-weight:700>-&gt;</span>p<span style=color:#ff7b72;font-weight:700>.</span>getName<span style=color:#ff7b72;font-weight:700>(),</span>p<span style=color:#ff7b72;font-weight:700>-&gt;</span>p<span style=color:#ff7b72;font-weight:700>));</span>
</span></span><span style=display:flex><span>        System<span style=color:#ff7b72;font-weight:700>.</span>out<span style=color:#ff7b72;font-weight:700>.</span>println<span style=color:#ff7b72;font-weight:700>(</span>xkMapByName<span style=color:#ff7b72;font-weight:700>);</span>
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>    <span style=color:#8b949e;font-style:italic>//分组后去最大值
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>    Map<span style=color:#ff7b72;font-weight:700>&lt;</span>Integer<span style=color:#ff7b72;font-weight:700>,</span> Optional<span style=color:#ff7b72;font-weight:700>&lt;</span>Users<span style=color:#ff7b72;font-weight:700>&gt;&gt;</span> collect <span style=color:#ff7b72;font-weight:700>=</span> users<span style=color:#ff7b72;font-weight:700>.</span>stream<span style=color:#ff7b72;font-weight:700>().</span>collect<span style=color:#ff7b72;font-weight:700>(</span>Collectors<span style=color:#ff7b72;font-weight:700>.</span>groupingBy<span style=color:#ff7b72;font-weight:700>(</span>Users<span style=color:#ff7b72;font-weight:700>::</span>getAge<span style=color:#ff7b72;font-weight:700>,</span> Collectors<span style=color:#ff7b72;font-weight:700>.</span>maxBy<span style=color:#ff7b72;font-weight:700>(</span>Comparator<span style=color:#ff7b72;font-weight:700>.</span>comparing<span style=color:#ff7b72;font-weight:700>(</span>Users<span style=color:#ff7b72;font-weight:700>::</span>getId<span style=color:#ff7b72;font-weight:700>))));</span>
</span></span><span style=display:flex><span>    <span style=color:#8b949e;font-style:italic>// https://www.jianshu.com/p/21b20c375599 更多使用分组
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>    <span style=color:#8b949e;font-style:italic>// https://cloud.tencent.com/developer/article/1863390
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>    <span style=color:#8b949e;font-style:italic>// 按年龄分组
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>    Map<span style=color:#ff7b72;font-weight:700>&lt;</span>Integer<span style=color:#ff7b72;font-weight:700>,</span> List<span style=color:#ff7b72;font-weight:700>&lt;</span>Person<span style=color:#ff7b72;font-weight:700>&gt;&gt;</span> groupMapByAge <span style=color:#ff7b72;font-weight:700>=</span> personList<span style=color:#ff7b72;font-weight:700>.</span>stream<span style=color:#ff7b72;font-weight:700>().</span>collect<span style=color:#ff7b72;font-weight:700>(</span>Collectors<span style=color:#ff7b72;font-weight:700>.</span>groupingBy<span style=color:#ff7b72;font-weight:700>(</span>p<span style=color:#ff7b72;font-weight:700>-&gt;</span>p<span style=color:#ff7b72;font-weight:700>.</span>getAge<span style=color:#ff7b72;font-weight:700>()));</span>
</span></span><span style=display:flex><span>    System<span style=color:#ff7b72;font-weight:700>.</span>out<span style=color:#ff7b72;font-weight:700>.</span>println<span style=color:#ff7b72;font-weight:700>(</span>groupMapByAge<span style=color:#ff7b72;font-weight:700>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#8b949e;font-style:italic>// 用map操作数值类型时是有装箱处理的,多少有损耗,用mapToLong就是将值变成基本类型,然后用boxed变成普通流
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>    Long decrease  <span style=color:#ff7b72;font-weight:700>=</span> ageList<span style=color:#ff7b72;font-weight:700>.</span>stream<span style=color:#ff7b72;font-weight:700>().</span>mapToLong<span style=color:#ff7b72;font-weight:700>(</span>a<span style=color:#ff7b72;font-weight:700>-&gt;</span>a<span style=color:#ff7b72;font-weight:700>).</span>boxed<span style=color:#ff7b72;font-weight:700>().</span>reduce<span style=color:#ff7b72;font-weight:700>((</span>x<span style=color:#ff7b72;font-weight:700>,</span>y<span style=color:#ff7b72;font-weight:700>)-&gt;</span>x<span style=color:#ff7b72;font-weight:700>-</span>y<span style=color:#ff7b72;font-weight:700>).</span>orElse<span style=color:#ff7b72;font-weight:700>(</span>0L<span style=color:#ff7b72;font-weight:700>);</span>
</span></span><span style=display:flex><span>    System<span style=color:#ff7b72;font-weight:700>.</span>out<span style=color:#ff7b72;font-weight:700>.</span>println<span style=color:#ff7b72;font-weight:700>(</span>decrease<span style=color:#ff7b72;font-weight:700>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#8b949e;font-style:italic>// 合并list
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>    List<span style=color:#ff7b72;font-weight:700>&lt;</span>ServiceOrder<span style=color:#ff7b72;font-weight:700>&gt;</span> serviceOrderList <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#ff7b72>new</span> ArrayList<span style=color:#ff7b72;font-weight:700>&lt;&gt;();</span>
</span></span><span style=display:flex><span>    List<span style=color:#ff7b72;font-weight:700>&lt;</span>String<span style=color:#ff7b72;font-weight:700>&gt;</span> projectNoAll <span style=color:#ff7b72;font-weight:700>=</span> serviceOrderList<span style=color:#ff7b72;font-weight:700>.</span>stream<span style=color:#ff7b72;font-weight:700>().</span>flatMap<span style=color:#ff7b72;font-weight:700>(</span>s<span style=color:#ff7b72;font-weight:700>-&gt;</span>s<span style=color:#ff7b72;font-weight:700>.</span>getProjectNos<span style=color:#ff7b72;font-weight:700>().</span>stream<span style=color:#ff7b72;font-weight:700>()).</span>collect<span style=color:#ff7b72;font-weight:700>(</span>Collectors<span style=color:#ff7b72;font-weight:700>.</span>toList<span style=color:#ff7b72;font-weight:700>());</span>
</span></span><span style=display:flex><span>    List<span style=color:#ff7b72;font-weight:700>&lt;</span>AClass<span style=color:#ff7b72;font-weight:700>&gt;</span> unionResult <span style=color:#ff7b72;font-weight:700>=</span> Stream<span style=color:#ff7b72;font-weight:700>.</span>of<span style=color:#ff7b72;font-weight:700>(</span>serviceOrderList<span style=color:#ff7b72;font-weight:700>,</span> serviceOrderList<span style=color:#ff7b72;font-weight:700>).</span>flatMap<span style=color:#ff7b72;font-weight:700>(</span>Collection<span style=color:#ff7b72;font-weight:700>::</span>stream<span style=color:#ff7b72;font-weight:700>).</span>collect<span style=color:#ff7b72;font-weight:700>(</span>Collectors<span style=color:#ff7b72;font-weight:700>.</span>toList<span style=color:#ff7b72;font-weight:700>());</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#d2a8ff;font-weight:700>@Test</span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>public</span> <span style=color:#ff7b72>void</span> <span style=color:#d2a8ff;font-weight:700>testMR</span><span style=color:#ff7b72;font-weight:700>()</span> <span style=color:#ff7b72;font-weight:700>{</span>
</span></span><span style=display:flex><span>        initInfo<span style=color:#ff7b72;font-weight:700>();</span>
</span></span><span style=display:flex><span>        BinaryOperator<span style=color:#ff7b72;font-weight:700>&lt;</span>String<span style=color:#ff7b72;font-weight:700>&gt;</span> lk <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#ff7b72;font-weight:700>(</span>x<span style=color:#ff7b72;font-weight:700>,</span> y<span style=color:#ff7b72;font-weight:700>)</span> <span style=color:#ff7b72;font-weight:700>-&gt;</span> x <span style=color:#ff7b72;font-weight:700>+</span> y<span style=color:#ff7b72;font-weight:700>;</span>
</span></span><span style=display:flex><span>        Optional<span style=color:#ff7b72;font-weight:700>&lt;</span>String<span style=color:#ff7b72;font-weight:700>&gt;</span> reduceStr <span style=color:#ff7b72;font-weight:700>=</span> nameList<span style=color:#ff7b72;font-weight:700>.</span>stream<span style=color:#ff7b72;font-weight:700>().</span>map<span style=color:#ff7b72;font-weight:700>(</span>n <span style=color:#ff7b72;font-weight:700>-&gt;</span> n<span style=color:#ff7b72;font-weight:700>).</span>reduce<span style=color:#ff7b72;font-weight:700>(</span>lk<span style=color:#ff7b72;font-weight:700>);</span><span style=color:#8b949e;font-style:italic>//将所有的值拼起来
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>        System<span style=color:#ff7b72;font-weight:700>.</span>out<span style=color:#ff7b72;font-weight:700>.</span>println<span style=color:#ff7b72;font-weight:700>(</span>reduceStr<span style=color:#ff7b72;font-weight:700>.</span>get<span style=color:#ff7b72;font-weight:700>());</span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72;font-weight:700>}</span>
</span></span></code></pre></div><p><code>T reduce(T identity, BinaryOperator&lt;T> accumulator)</code></p><p>相对于一个参数的方法来说，它多了一个T类型的参数；实际上就相当于需要计算的值在Stream的基础上多了一个初始化的值
eg.</p><div class=highlight><pre tabindex=0 style=color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span>Stream<span style=color:#ff7b72;font-weight:700>&lt;</span>String<span style=color:#ff7b72;font-weight:700>&gt;</span> s <span style=color:#ff7b72;font-weight:700>=</span> Stream<span style=color:#ff7b72;font-weight:700>.</span>of<span style=color:#ff7b72;font-weight:700>(</span><span style=color:#a5d6ff>&#34;test&#34;</span><span style=color:#ff7b72;font-weight:700>,</span> <span style=color:#a5d6ff>&#34;t1&#34;</span><span style=color:#ff7b72;font-weight:700>,</span> <span style=color:#a5d6ff>&#34;t2&#34;</span><span style=color:#ff7b72;font-weight:700>,</span> <span style=color:#a5d6ff>&#34;teeeee&#34;</span><span style=color:#ff7b72;font-weight:700>,</span> <span style=color:#a5d6ff>&#34;aaaa&#34;</span><span style=color:#ff7b72;font-weight:700>,</span> <span style=color:#a5d6ff>&#34;taaa&#34;</span><span style=color:#ff7b72;font-weight:700>);</span>
</span></span><span style=display:flex><span>System<span style=color:#ff7b72;font-weight:700>.</span>out<span style=color:#ff7b72;font-weight:700>.</span>println<span style=color:#ff7b72;font-weight:700>(</span>s<span style=color:#ff7b72;font-weight:700>.</span>reduce<span style=color:#ff7b72;font-weight:700>(</span><span style=color:#a5d6ff>&#34;[value]:&#34;</span><span style=color:#ff7b72;font-weight:700>,</span> <span style=color:#ff7b72;font-weight:700>(</span>s1<span style=color:#ff7b72;font-weight:700>,</span> s2<span style=color:#ff7b72;font-weight:700>)</span> <span style=color:#ff7b72;font-weight:700>-&gt;</span> s1<span style=color:#ff7b72;font-weight:700>.</span>concat<span style=color:#ff7b72;font-weight:700>(</span>s2<span style=color:#ff7b72;font-weight:700>)));</span>    <span style=color:#8b949e;font-style:italic>// [value]:testt1t2teeeeeaaaataaa
</span></span></span></code></pre></div><blockquote><p>来自 <a href=https://blog.csdn.net/icarusliu/article/details/79504602 target=_blank rel=noopener>https://blog.csdn.net/icarusliu/article/details/79504602</a></p></blockquote><h2 id=12-其他应用>1.2 其他应用<a hidden class=anchor aria-hidden=true href=#12-其他应用>#</a></h2><p>json 格式化使用, 值不为null的才输出</p><div class=highlight><pre tabindex=0 style=color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#ff7b72>return</span> JSON<span style=color:#ff7b72;font-weight:700>.</span>toJSONString<span style=color:#ff7b72;font-weight:700>(</span>val<span style=color:#ff7b72;font-weight:700>,(</span>PropertyFilter<span style=color:#ff7b72;font-weight:700>)((</span>obj<span style=color:#ff7b72;font-weight:700>,</span> name<span style=color:#ff7b72;font-weight:700>,</span> value<span style=color:#ff7b72;font-weight:700>)</span> <span style=color:#ff7b72;font-weight:700>-&gt;</span> value <span style=color:#ff7b72;font-weight:700>!=</span> <span style=color:#79c0ff>null</span><span style=color:#ff7b72;font-weight:700>));</span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// NameFilter: 处理name字段,(比如对name加个后缀)
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// ValueFilter: 处理value字段,(比如对value加个后缀)
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// PropertyFilter: 处理obj字段
</span></span></span></code></pre></div><h1 id=2-高阶使用>2. 高阶使用<a hidden class=anchor aria-hidden=true href=#2-高阶使用>#</a></h1><h2 id=21-受检函数式接口>2.1 受检函数式接口:<a hidden class=anchor aria-hidden=true href=#21-受检函数式接口>#</a></h2><div class=highlight><pre tabindex=0 style=color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#ff7b72>package</span> <span style=color:#ff7b72>com.gree.ecommerce.utils.function</span><span style=color:#ff7b72;font-weight:700>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>import</span> <span style=color:#ff7b72>java.util.Optional</span><span style=color:#ff7b72;font-weight:700>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>/**
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic> * (检查)抛出lambda中异常情况
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic> *
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic> * @author A80080
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic> * @createDate 2021/4/21
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic> */</span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>public</span> <span style=color:#ff7b72>interface</span> <span style=color:#f0883e;font-weight:700>CheckFun</span> <span style=color:#ff7b72;font-weight:700>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>interface</span> <span style=color:#f0883e;font-weight:700>Function</span><span style=color:#ff7b72;font-weight:700>&lt;</span>T<span style=color:#ff7b72;font-weight:700>,</span> R<span style=color:#ff7b72;font-weight:700>&gt;</span> <span style=color:#ff7b72;font-weight:700>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic>/**
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>         * Function类型
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>         *
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>         * @param function 处理函数
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>         * @param p        入参
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>         * @return 处理结果, 报错返回 Optional.empty();
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>         * @author A80080
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>         * @createDate 2021/4/21
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>         */</span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>static</span> <span style=color:#ff7b72;font-weight:700>&lt;</span>T<span style=color:#ff7b72;font-weight:700>,</span> R<span style=color:#ff7b72;font-weight:700>&gt;</span> Optional<span style=color:#ff7b72;font-weight:700>&lt;</span>R<span style=color:#ff7b72;font-weight:700>&gt;</span> <span style=color:#d2a8ff;font-weight:700>tryOf</span><span style=color:#ff7b72;font-weight:700>(</span>Function<span style=color:#ff7b72;font-weight:700>&lt;</span>T<span style=color:#ff7b72;font-weight:700>,</span> R<span style=color:#ff7b72;font-weight:700>&gt;</span> function<span style=color:#ff7b72;font-weight:700>,</span> T p<span style=color:#ff7b72;font-weight:700>)</span> <span style=color:#ff7b72;font-weight:700>{</span>
</span></span><span style=display:flex><span>            <span style=color:#ff7b72>try</span> <span style=color:#ff7b72;font-weight:700>{</span>
</span></span><span style=display:flex><span>                <span style=color:#ff7b72>return</span> Optional<span style=color:#ff7b72;font-weight:700>.</span>ofNullable<span style=color:#ff7b72;font-weight:700>(</span>function<span style=color:#ff7b72;font-weight:700>.</span>apply<span style=color:#ff7b72;font-weight:700>(</span>p<span style=color:#ff7b72;font-weight:700>));</span>
</span></span><span style=display:flex><span>            <span style=color:#ff7b72;font-weight:700>}</span> <span style=color:#ff7b72>catch</span> <span style=color:#ff7b72;font-weight:700>(</span>Throwable t<span style=color:#ff7b72;font-weight:700>)</span> <span style=color:#ff7b72;font-weight:700>{</span>
</span></span><span style=display:flex><span>                <span style=color:#ff7b72>return</span> Optional<span style=color:#ff7b72;font-weight:700>.</span>empty<span style=color:#ff7b72;font-weight:700>();</span>
</span></span><span style=display:flex><span>            <span style=color:#ff7b72;font-weight:700>}</span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic>/**
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>         * 参照 java.util.function.Function
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>         *
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>         * @param t 入参
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>         * @return R 类型数据
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>         * @throws Exception 异常
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>         * @author A80080
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>         * @createDate 2021/4/21
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>         */</span>
</span></span><span style=display:flex><span>        R <span style=color:#d2a8ff;font-weight:700>apply</span><span style=color:#ff7b72;font-weight:700>(</span>T t<span style=color:#ff7b72;font-weight:700>)</span> <span style=color:#ff7b72>throws</span> Exception<span style=color:#ff7b72;font-weight:700>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>interface</span> <span style=color:#f0883e;font-weight:700>Supplier</span><span style=color:#ff7b72;font-weight:700>&lt;</span>T<span style=color:#ff7b72;font-weight:700>&gt;</span> <span style=color:#ff7b72;font-weight:700>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic>/**
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>         * Supplier 类型
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>         *
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>         * @param supplier 处理函数
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>         * @return 返回语句的返回值(optional), 报错则为Optional.empty()
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>         * @author A80080
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>         */</span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>static</span> <span style=color:#ff7b72;font-weight:700>&lt;</span>T<span style=color:#ff7b72;font-weight:700>&gt;</span> Optional<span style=color:#ff7b72;font-weight:700>&lt;</span>T<span style=color:#ff7b72;font-weight:700>&gt;</span> <span style=color:#d2a8ff;font-weight:700>tryOf</span><span style=color:#ff7b72;font-weight:700>(</span>CheckFun<span style=color:#ff7b72;font-weight:700>.</span>Supplier<span style=color:#ff7b72;font-weight:700>&lt;?</span> <span style=color:#ff7b72>extends</span> T<span style=color:#ff7b72;font-weight:700>&gt;</span> supplier<span style=color:#ff7b72;font-weight:700>)</span> <span style=color:#ff7b72;font-weight:700>{</span>
</span></span><span style=display:flex><span>            <span style=color:#ff7b72>try</span> <span style=color:#ff7b72;font-weight:700>{</span>
</span></span><span style=display:flex><span>                <span style=color:#ff7b72>return</span> Optional<span style=color:#ff7b72;font-weight:700>.</span>ofNullable<span style=color:#ff7b72;font-weight:700>(</span>supplier<span style=color:#ff7b72;font-weight:700>.</span>get<span style=color:#ff7b72;font-weight:700>());</span>
</span></span><span style=display:flex><span>            <span style=color:#ff7b72;font-weight:700>}</span> <span style=color:#ff7b72>catch</span> <span style=color:#ff7b72;font-weight:700>(</span>Throwable t<span style=color:#ff7b72;font-weight:700>)</span> <span style=color:#ff7b72;font-weight:700>{</span>
</span></span><span style=display:flex><span>                <span style=color:#ff7b72>return</span> Optional<span style=color:#ff7b72;font-weight:700>.</span>empty<span style=color:#ff7b72;font-weight:700>();</span>
</span></span><span style=display:flex><span>            <span style=color:#ff7b72;font-weight:700>}</span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic>/**
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>         * 参照 java.util.function.Supplier
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>         *
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>         * @return T 类型
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>         * @throws Exception 异常
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>         * @author A80080
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>         * @createDate 2021/4/21
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>         */</span>
</span></span><span style=display:flex><span>        T <span style=color:#d2a8ff;font-weight:700>get</span><span style=color:#ff7b72;font-weight:700>()</span> <span style=color:#ff7b72>throws</span> Exception<span style=color:#ff7b72;font-weight:700>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>interface</span> <span style=color:#f0883e;font-weight:700>Consumer</span><span style=color:#ff7b72;font-weight:700>&lt;</span>T<span style=color:#ff7b72;font-weight:700>&gt;</span> <span style=color:#ff7b72;font-weight:700>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic>/**
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>         * consumer 类型
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>         * &lt;p&gt; 报错将忽略
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>         *
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>         * @param consumer 处理函数
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>         * @param p        入参
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>         * @author A80080
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>         * @createDate 2021/4/21
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>         */</span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>static</span> <span style=color:#ff7b72;font-weight:700>&lt;</span>T<span style=color:#ff7b72;font-weight:700>&gt;</span> <span style=color:#ff7b72>void</span> <span style=color:#d2a8ff;font-weight:700>tryOf</span><span style=color:#ff7b72;font-weight:700>(</span>CheckFun<span style=color:#ff7b72;font-weight:700>.</span>Consumer<span style=color:#ff7b72;font-weight:700>&lt;</span>T<span style=color:#ff7b72;font-weight:700>&gt;</span> consumer<span style=color:#ff7b72;font-weight:700>,</span> T p<span style=color:#ff7b72;font-weight:700>)</span> <span style=color:#ff7b72;font-weight:700>{</span>
</span></span><span style=display:flex><span>            <span style=color:#ff7b72>try</span> <span style=color:#ff7b72;font-weight:700>{</span>
</span></span><span style=display:flex><span>                consumer<span style=color:#ff7b72;font-weight:700>.</span>accept<span style=color:#ff7b72;font-weight:700>(</span>p<span style=color:#ff7b72;font-weight:700>);</span>
</span></span><span style=display:flex><span>            <span style=color:#ff7b72;font-weight:700>}</span> <span style=color:#ff7b72>catch</span> <span style=color:#ff7b72;font-weight:700>(</span>Throwable ignored<span style=color:#ff7b72;font-weight:700>)</span> <span style=color:#ff7b72;font-weight:700>{</span>
</span></span><span style=display:flex><span>            <span style=color:#ff7b72;font-weight:700>}</span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic>/**
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>         * 参照 java.util.function.Consumer
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>         *
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>         * @param t 入参
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>         * @throws Exception 异常
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>         * @author A80080
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>         * @createDate 2021/4/21
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>         */</span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>void</span> <span style=color:#d2a8ff;font-weight:700>accept</span><span style=color:#ff7b72;font-weight:700>(</span>T t<span style=color:#ff7b72;font-weight:700>)</span> <span style=color:#ff7b72>throws</span> Exception<span style=color:#ff7b72;font-weight:700>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>interface</span> <span style=color:#f0883e;font-weight:700>Predicate</span><span style=color:#ff7b72;font-weight:700>&lt;</span>T<span style=color:#ff7b72;font-weight:700>&gt;</span> <span style=color:#ff7b72;font-weight:700>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic>/**
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>         * Predicate类型
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>         *
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>         * @param predicate 处理函数
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>         * @param p         入参
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>         * @return 处理结果, 报错返回 false
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>         * @author A80080
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>         * @createDate 2021/4/21
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>         */</span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>static</span> <span style=color:#ff7b72;font-weight:700>&lt;</span>T<span style=color:#ff7b72;font-weight:700>&gt;</span> <span style=color:#ff7b72>boolean</span> <span style=color:#d2a8ff;font-weight:700>tryOf</span><span style=color:#ff7b72;font-weight:700>(</span>CheckFun<span style=color:#ff7b72;font-weight:700>.</span>Predicate<span style=color:#ff7b72;font-weight:700>&lt;</span>T<span style=color:#ff7b72;font-weight:700>&gt;</span> predicate<span style=color:#ff7b72;font-weight:700>,</span> T p<span style=color:#ff7b72;font-weight:700>)</span> <span style=color:#ff7b72;font-weight:700>{</span>
</span></span><span style=display:flex><span>            <span style=color:#ff7b72>try</span> <span style=color:#ff7b72;font-weight:700>{</span>
</span></span><span style=display:flex><span>                <span style=color:#ff7b72>return</span> predicate<span style=color:#ff7b72;font-weight:700>.</span>test<span style=color:#ff7b72;font-weight:700>(</span>p<span style=color:#ff7b72;font-weight:700>);</span>
</span></span><span style=display:flex><span>            <span style=color:#ff7b72;font-weight:700>}</span> <span style=color:#ff7b72>catch</span> <span style=color:#ff7b72;font-weight:700>(</span>Throwable t<span style=color:#ff7b72;font-weight:700>)</span> <span style=color:#ff7b72;font-weight:700>{</span>
</span></span><span style=display:flex><span>                <span style=color:#ff7b72>return</span> <span style=color:#79c0ff>false</span><span style=color:#ff7b72;font-weight:700>;</span>
</span></span><span style=display:flex><span>            <span style=color:#ff7b72;font-weight:700>}</span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic>/**
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>         * 参照 java.util.function.Predicate
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>         *
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>         * @param t 入参
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>         * @return boolean
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>         * @throws Exception 异常
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>         * @author A80080
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>         * @createDate 2021/4/21
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>         */</span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>boolean</span> <span style=color:#d2a8ff;font-weight:700>test</span><span style=color:#ff7b72;font-weight:700>(</span>T t<span style=color:#ff7b72;font-weight:700>)</span> <span style=color:#ff7b72>throws</span> Exception<span style=color:#ff7b72;font-weight:700>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff7b72;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// 使用案例
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span><span style=color:#d2a8ff;font-weight:700>@Test</span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>public</span> <span style=color:#ff7b72>void</span> <span style=color:#d2a8ff;font-weight:700>test</span><span style=color:#ff7b72;font-weight:700>()</span> <span style=color:#ff7b72;font-weight:700>{</span>
</span></span><span style=display:flex><span>    Stream<span style=color:#ff7b72;font-weight:700>.</span>of<span style=color:#ff7b72;font-weight:700>(</span><span style=color:#a5d6ff>&#34;uNameCookie&#34;</span><span style=color:#ff7b72;font-weight:700>,</span> <span style=color:#a5d6ff>&#34;uidCookie&#34;</span><span style=color:#ff7b72;font-weight:700>,</span> <span style=color:#a5d6ff>&#34;loginNameCookie&#34;</span><span style=color:#ff7b72;font-weight:700>,</span> <span style=color:#a5d6ff>&#34;loginStatusCookie&#34;</span><span style=color:#ff7b72;font-weight:700>,</span> <span style=color:#a5d6ff>&#34;mobileLoginTokenCookie&#34;</span><span style=color:#ff7b72;font-weight:700>)</span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72;font-weight:700>.</span>filter<span style=color:#ff7b72;font-weight:700>(</span>c<span style=color:#ff7b72;font-weight:700>-&gt;!</span>CheckFun<span style=color:#ff7b72;font-weight:700>.</span>Predicate<span style=color:#ff7b72;font-weight:700>.</span>tryOf<span style=color:#ff7b72;font-weight:700>(</span>a<span style=color:#ff7b72;font-weight:700>-&gt;</span>URLEncoder<span style=color:#ff7b72;font-weight:700>.</span>encode<span style=color:#ff7b72;font-weight:700>(</span>c<span style=color:#ff7b72;font-weight:700>,</span> <span style=color:#a5d6ff>&#34;utf-8&#34;</span><span style=color:#ff7b72;font-weight:700>).</span>equals<span style=color:#ff7b72;font-weight:700>(</span><span style=color:#a5d6ff>&#34;&#34;</span><span style=color:#ff7b72;font-weight:700>),</span>c<span style=color:#ff7b72;font-weight:700>))</span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72;font-weight:700>.</span>peek<span style=color:#ff7b72;font-weight:700>(</span>c <span style=color:#ff7b72;font-weight:700>-&gt;</span> c<span style=color:#ff7b72;font-weight:700>.</span>concat<span style=color:#ff7b72;font-weight:700>(</span>CheckFun<span style=color:#ff7b72;font-weight:700>.</span>Supplier<span style=color:#ff7b72;font-weight:700>.</span>tryOf<span style=color:#ff7b72;font-weight:700>(()</span> <span style=color:#ff7b72;font-weight:700>-&gt;</span> URLEncoder<span style=color:#ff7b72;font-weight:700>.</span>encode<span style=color:#ff7b72;font-weight:700>(</span>c<span style=color:#ff7b72;font-weight:700>,</span> <span style=color:#a5d6ff>&#34;utf-8&#34;</span><span style=color:#ff7b72;font-weight:700>)).</span>orElse<span style=color:#ff7b72;font-weight:700>(</span>c<span style=color:#ff7b72;font-weight:700>)))</span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72;font-weight:700>.</span>map<span style=color:#ff7b72;font-weight:700>(</span>c <span style=color:#ff7b72;font-weight:700>-&gt;</span> c<span style=color:#ff7b72;font-weight:700>.</span>concat<span style=color:#ff7b72;font-weight:700>(</span>CheckFun<span style=color:#ff7b72;font-weight:700>.</span>Function<span style=color:#ff7b72;font-weight:700>.</span>tryOf<span style=color:#ff7b72;font-weight:700>(</span>a <span style=color:#ff7b72;font-weight:700>-&gt;</span> URLEncoder<span style=color:#ff7b72;font-weight:700>.</span>encode<span style=color:#ff7b72;font-weight:700>(</span>a<span style=color:#ff7b72;font-weight:700>,</span> <span style=color:#a5d6ff>&#34;utf-8&#34;</span><span style=color:#ff7b72;font-weight:700>),</span> c<span style=color:#ff7b72;font-weight:700>).</span>orElse<span style=color:#ff7b72;font-weight:700>(</span>c<span style=color:#ff7b72;font-weight:700>)))</span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72;font-weight:700>.</span>peek<span style=color:#ff7b72;font-weight:700>(</span>c <span style=color:#ff7b72;font-weight:700>-&gt;</span> CheckFun<span style=color:#ff7b72;font-weight:700>.</span>Consumer<span style=color:#ff7b72;font-weight:700>.</span>tryOf<span style=color:#ff7b72;font-weight:700>(</span>x <span style=color:#ff7b72;font-weight:700>-&gt;</span> c<span style=color:#ff7b72;font-weight:700>.</span>concat<span style=color:#ff7b72;font-weight:700>(</span>URLEncoder<span style=color:#ff7b72;font-weight:700>.</span>encode<span style=color:#ff7b72;font-weight:700>(</span>x<span style=color:#ff7b72;font-weight:700>,</span> <span style=color:#a5d6ff>&#34;utf-8&#34;</span><span style=color:#ff7b72;font-weight:700>)),</span> c<span style=color:#ff7b72;font-weight:700>))</span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72;font-weight:700>.</span>forEach<span style=color:#ff7b72;font-weight:700>(</span>System<span style=color:#ff7b72;font-weight:700>.</span>out<span style=color:#ff7b72;font-weight:700>::</span>println<span style=color:#ff7b72;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#ff7b72;font-weight:700>}</span>
</span></span></code></pre></div><h2 id=22--根据类中某个字段去重以及分页处理>2.2 根据类中某个字段去重以及分页处理<a hidden class=anchor aria-hidden=true href=#22--根据类中某个字段去重以及分页处理>#</a></h2><div class=highlight><pre tabindex=0 style=color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// 根据类中某个字段去重
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>    <span style=color:#d2a8ff;font-weight:700>@Test</span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>public</span> <span style=color:#ff7b72>void</span> <span style=color:#d2a8ff;font-weight:700>should_return_2_because_distinct_by_age</span><span style=color:#ff7b72;font-weight:700>()</span> <span style=color:#ff7b72;font-weight:700>{</span>
</span></span><span style=display:flex><span>        userList <span style=color:#ff7b72;font-weight:700>=</span> userList<span style=color:#ff7b72;font-weight:700>.</span>stream<span style=color:#ff7b72;font-weight:700>()</span>
</span></span><span style=display:flex><span>                <span style=color:#ff7b72;font-weight:700>.</span>filter<span style=color:#ff7b72;font-weight:700>(</span>distinctByKey<span style=color:#ff7b72;font-weight:700>(</span>User<span style=color:#ff7b72;font-weight:700>::</span>getName<span style=color:#ff7b72;font-weight:700>))</span>
</span></span><span style=display:flex><span>                <span style=color:#ff7b72;font-weight:700>.</span>collect<span style=color:#ff7b72;font-weight:700>(</span>Collectors<span style=color:#ff7b72;font-weight:700>.</span>toList<span style=color:#ff7b72;font-weight:700>());</span>
</span></span><span style=display:flex><span>        userList<span style=color:#ff7b72;font-weight:700>.</span>forEach<span style=color:#ff7b72;font-weight:700>(</span>System<span style=color:#ff7b72;font-weight:700>.</span>out<span style=color:#ff7b72;font-weight:700>::</span>println<span style=color:#ff7b72;font-weight:700>);</span>
</span></span><span style=display:flex><span>        assertEquals<span style=color:#ff7b72;font-weight:700>(</span>2<span style=color:#ff7b72;font-weight:700>,</span> userList<span style=color:#ff7b72;font-weight:700>.</span>size<span style=color:#ff7b72;font-weight:700>());</span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>private</span> <span style=color:#ff7b72>static</span> <span style=color:#ff7b72;font-weight:700>&lt;</span>T<span style=color:#ff7b72;font-weight:700>,</span> R<span style=color:#ff7b72;font-weight:700>&gt;</span> Predicate<span style=color:#ff7b72;font-weight:700>&lt;</span>T<span style=color:#ff7b72;font-weight:700>&gt;</span> <span style=color:#d2a8ff;font-weight:700>distinctByKey</span><span style=color:#ff7b72;font-weight:700>(</span>Function<span style=color:#ff7b72;font-weight:700>&lt;</span>T<span style=color:#ff7b72;font-weight:700>,</span> R<span style=color:#ff7b72;font-weight:700>&gt;</span> keyExtractor<span style=color:#ff7b72;font-weight:700>)</span> <span style=color:#ff7b72;font-weight:700>{</span>
</span></span><span style=display:flex><span>        Set<span style=color:#ff7b72;font-weight:700>&lt;</span>R<span style=color:#ff7b72;font-weight:700>&gt;</span> seen <span style=color:#ff7b72;font-weight:700>=</span> ConcurrentHashMap<span style=color:#ff7b72;font-weight:700>.</span>newKeySet<span style=color:#ff7b72;font-weight:700>();</span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>return</span> t <span style=color:#ff7b72;font-weight:700>-&gt;</span> seen<span style=color:#ff7b72;font-weight:700>.</span>add<span style=color:#ff7b72;font-weight:700>(</span>keyExtractor<span style=color:#ff7b72;font-weight:700>.</span>apply<span style=color:#ff7b72;font-weight:700>(</span>t<span style=color:#ff7b72;font-weight:700>));</span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// 链接：https://hacpai.com/article/1545321970124
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>
</span></span><span style=display:flex><span>divideBatchHandler<span style=color:#ff7b72;font-weight:700>(</span>nameList<span style=color:#ff7b72;font-weight:700>,</span>System<span style=color:#ff7b72;font-weight:700>.</span>out<span style=color:#ff7b72;font-weight:700>::</span>println<span style=color:#ff7b72;font-weight:700>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>/**
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>     * 运用场景:当数据量过大,需要分批处理时
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>     * @author xkj
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>     * @param dataList 需要处理的数据
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>     * @param consumer  处理函数
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>     * @since 
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>     */</span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>public</span> <span style=color:#ff7b72;font-weight:700>&lt;</span>T<span style=color:#ff7b72;font-weight:700>&gt;</span> <span style=color:#ff7b72>void</span> <span style=color:#d2a8ff;font-weight:700>divideBatchHandler</span><span style=color:#ff7b72;font-weight:700>(</span>List<span style=color:#ff7b72;font-weight:700>&lt;</span>T<span style=color:#ff7b72;font-weight:700>&gt;</span> dataList<span style=color:#ff7b72;font-weight:700>,</span> Consumer<span style=color:#ff7b72;font-weight:700>&lt;</span>List<span style=color:#ff7b72;font-weight:700>&lt;</span>T<span style=color:#ff7b72;font-weight:700>&gt;&gt;</span> consumer<span style=color:#ff7b72;font-weight:700>)</span> <span style=color:#ff7b72;font-weight:700>{</span>
</span></span><span style=display:flex><span>        Optional<span style=color:#ff7b72;font-weight:700>.</span>ofNullable<span style=color:#ff7b72;font-weight:700>(</span>dataList<span style=color:#ff7b72;font-weight:700>).</span>ifPresent<span style=color:#ff7b72;font-weight:700>(</span>list <span style=color:#ff7b72;font-weight:700>-&gt;</span>
</span></span><span style=display:flex><span>                IntStream<span style=color:#ff7b72;font-weight:700>.</span>range<span style=color:#ff7b72;font-weight:700>(</span>0<span style=color:#ff7b72;font-weight:700>,</span> list<span style=color:#ff7b72;font-weight:700>.</span>size<span style=color:#ff7b72;font-weight:700>())</span>
</span></span><span style=display:flex><span>                        <span style=color:#ff7b72;font-weight:700>.</span>mapToObj<span style=color:#ff7b72;font-weight:700>(</span>i <span style=color:#ff7b72;font-weight:700>-&gt;</span> <span style=color:#ff7b72>new</span> AbstractMap<span style=color:#ff7b72;font-weight:700>.</span>SimpleImmutableEntry<span style=color:#ff7b72;font-weight:700>&lt;&gt;(</span>i<span style=color:#ff7b72;font-weight:700>,</span> list<span style=color:#ff7b72;font-weight:700>.</span>get<span style=color:#ff7b72;font-weight:700>(</span>i<span style=color:#ff7b72;font-weight:700>)))</span><span style=color:#8b949e;font-style:italic>// 给数据编号
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>                        <span style=color:#ff7b72;font-weight:700>.</span>collect<span style=color:#ff7b72;font-weight:700>(</span>Collectors<span style=color:#ff7b72;font-weight:700>.</span>groupingBy<span style=color:#ff7b72;font-weight:700>(</span>
</span></span><span style=display:flex><span>                                e <span style=color:#ff7b72;font-weight:700>-&gt;</span> e<span style=color:#ff7b72;font-weight:700>.</span>getKey<span style=color:#ff7b72;font-weight:700>()</span> <span style=color:#ff7b72;font-weight:700>/</span> 10<span style=color:#ff7b72;font-weight:700>,</span> 
</span></span><span style=display:flex><span>                                Collectors<span style=color:#ff7b72;font-weight:700>.</span>mapping<span style=color:#ff7b72;font-weight:700>(</span>Map<span style=color:#ff7b72;font-weight:700>.</span>Entry<span style=color:#ff7b72;font-weight:700>::</span>getValue<span style=color:#ff7b72;font-weight:700>,</span> Collectors<span style=color:#ff7b72;font-weight:700>.</span>toList<span style=color:#ff7b72;font-weight:700>())))</span> <span style=color:#8b949e;font-style:italic>// 按编号分批并合并编号对应的值
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>                        <span style=color:#ff7b72;font-weight:700>.</span>values<span style=color:#ff7b72;font-weight:700>()</span>
</span></span><span style=display:flex><span>                        <span style=color:#ff7b72;font-weight:700>.</span>parallelStream<span style=color:#ff7b72;font-weight:700>()</span><span style=color:#8b949e;font-style:italic>// 并行处理
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>                        <span style=color:#ff7b72;font-weight:700>.</span>forEach<span style=color:#ff7b72;font-weight:700>(</span>consumer<span style=color:#ff7b72;font-weight:700>)</span> <span style=color:#8b949e;font-style:italic>// 执行处理函数
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>        <span style=color:#ff7b72;font-weight:700>);</span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72;font-weight:700>}</span>
</span></span></code></pre></div><h2 id=23-自定义collector>2.3 自定义Collector<a hidden class=anchor aria-hidden=true href=#23-自定义collector>#</a></h2><p>Collector主要包含五个参数，它的行为也是由这五个参数来定义的，如下所示：</p><p>Collector实现的三个泛型具体是什么：</p><ul><li>T（输入的元素类型）：T</li><li>A（累积结果的容器类型）：</li><li>R（最终生成的结果类型）：</li></ul><div class=highlight><pre tabindex=0 style=color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#ff7b72>public</span> <span style=color:#ff7b72>interface</span> <span style=color:#f0883e;font-weight:700>Collector</span><span style=color:#ff7b72;font-weight:700>&lt;</span>T<span style=color:#ff7b72;font-weight:700>,</span> A<span style=color:#ff7b72;font-weight:700>,</span> R<span style=color:#ff7b72;font-weight:700>&gt;</span> <span style=color:#ff7b72;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#8b949e;font-style:italic>// supplier参数用于生成结果容器，容器类型为A
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>    Supplier<span style=color:#ff7b72;font-weight:700>&lt;</span>A<span style=color:#ff7b72;font-weight:700>&gt;</span> <span style=color:#d2a8ff;font-weight:700>supplier</span><span style=color:#ff7b72;font-weight:700>();</span>
</span></span><span style=display:flex><span>    <span style=color:#8b949e;font-style:italic>// accumulator用于消费元素，也就是归纳元素，这里的T就是元素，它会将流中的元素一个一个与结果容器A发生操作
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>    BiConsumer<span style=color:#ff7b72;font-weight:700>&lt;</span>A<span style=color:#ff7b72;font-weight:700>,</span> T<span style=color:#ff7b72;font-weight:700>&gt;</span> <span style=color:#d2a8ff;font-weight:700>accumulator</span><span style=color:#ff7b72;font-weight:700>();</span>
</span></span><span style=display:flex><span>    <span style=color:#8b949e;font-style:italic>// combiner用于两个两个合并并行执行的线程的执行结果，将其合并为一个最终结果A
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>    BinaryOperator<span style=color:#ff7b72;font-weight:700>&lt;</span>A<span style=color:#ff7b72;font-weight:700>&gt;</span> <span style=color:#d2a8ff;font-weight:700>combiner</span><span style=color:#ff7b72;font-weight:700>();</span>
</span></span><span style=display:flex><span>    <span style=color:#8b949e;font-style:italic>// finisher用于将之前整合完的结果R转换成为A
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>    Function<span style=color:#ff7b72;font-weight:700>&lt;</span>A<span style=color:#ff7b72;font-weight:700>,</span> R<span style=color:#ff7b72;font-weight:700>&gt;</span> <span style=color:#d2a8ff;font-weight:700>finisher</span><span style=color:#ff7b72;font-weight:700>();</span>
</span></span><span style=display:flex><span>    <span style=color:#8b949e;font-style:italic>// characteristics表示当前Collector的特征值，这是个不可变Set
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>    Set<span style=color:#ff7b72;font-weight:700>&lt;</span>Characteristics<span style=color:#ff7b72;font-weight:700>&gt;</span> <span style=color:#d2a8ff;font-weight:700>characteristics</span><span style=color:#ff7b72;font-weight:700>();</span>
</span></span><span style=display:flex><span><span style=color:#ff7b72;font-weight:700>}</span>
</span></span></code></pre></div><blockquote><p>枚举常量Characteristics 中共有三个特征值，它们的具体含义如下：</p><p>CONCURRENT：表示结果容器只有一个（即使是在并行流的情况下）。只有在并行流且收集器不具备此特性的情况下，combiner()返回的lambda表达式才会执行（中间结果容器只有一个就无需合并）。设置此特性时意味着多个线程可以对同一个结果容器调用，因此结果容器必须是线程安全的。</p><p>UNORDERED：表示流中的元素无序。</p><p>IDENTITY_FINISH：表示中间结果容器类型与最终结果类型一致。<strong>设置此特性时finiser()方法不会被调用。</strong></p></blockquote><div class=highlight><pre tabindex=0 style=color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#8b949e;font-style:italic>/** 该案例作用: 对集合元素 求和并转成字符串
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>*/</span>
</span></span><span style=display:flex><span>    <span style=color:#d2a8ff;font-weight:700>@Test</span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>public</span> <span style=color:#ff7b72>void</span> <span style=color:#d2a8ff;font-weight:700>Test</span><span style=color:#ff7b72;font-weight:700>(){</span>
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic>// 1. 第一个参数是临时值的容器
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>        <span style=color:#8b949e;font-style:italic>// 2. 第二个参数是把入参放到容器中
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>        <span style=color:#8b949e;font-style:italic>// 3. 第三个参数是把第二步的值做一个结合放到容器中
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>        <span style=color:#8b949e;font-style:italic>// 4. 第四个参数把容器中的值转化成结果类型
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>        <span style=color:#8b949e;font-style:italic>// 5. 第五个参数是一个特征值
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>
</span></span><span style=display:flex><span>        BiConsumer<span style=color:#ff7b72;font-weight:700>&lt;</span>List<span style=color:#ff7b72;font-weight:700>&lt;</span>Long<span style=color:#ff7b72;font-weight:700>&gt;,</span> Long<span style=color:#ff7b72;font-weight:700>&gt;</span> accumulator <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#ff7b72;font-weight:700>(</span>x<span style=color:#ff7b72;font-weight:700>,</span> y<span style=color:#ff7b72;font-weight:700>)</span> <span style=color:#ff7b72;font-weight:700>-&gt;</span> <span style=color:#ff7b72;font-weight:700>{</span>
</span></span><span style=display:flex><span>            x<span style=color:#ff7b72;font-weight:700>.</span>add<span style=color:#ff7b72;font-weight:700>(</span>y<span style=color:#ff7b72;font-weight:700>);</span>
</span></span><span style=display:flex><span>            <span style=color:#ff7b72>return</span><span style=color:#ff7b72;font-weight:700>;</span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72;font-weight:700>};</span>
</span></span><span style=display:flex><span>        BinaryOperator<span style=color:#ff7b72;font-weight:700>&lt;</span>List<span style=color:#ff7b72;font-weight:700>&lt;</span>Long<span style=color:#ff7b72;font-weight:700>&gt;&gt;</span> combiner <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#ff7b72;font-weight:700>(</span>x<span style=color:#ff7b72;font-weight:700>,</span> y<span style=color:#ff7b72;font-weight:700>)</span> <span style=color:#ff7b72;font-weight:700>-&gt;</span> <span style=color:#ff7b72;font-weight:700>{</span>
</span></span><span style=display:flex><span>            x<span style=color:#ff7b72;font-weight:700>.</span>addAll<span style=color:#ff7b72;font-weight:700>(</span>y<span style=color:#ff7b72;font-weight:700>);</span>
</span></span><span style=display:flex><span>            <span style=color:#ff7b72>return</span> x<span style=color:#ff7b72;font-weight:700>;</span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72;font-weight:700>};</span>
</span></span><span style=display:flex><span>        Function<span style=color:#ff7b72;font-weight:700>&lt;</span>List<span style=color:#ff7b72;font-weight:700>&lt;</span>Long<span style=color:#ff7b72;font-weight:700>&gt;,</span> String<span style=color:#ff7b72;font-weight:700>&gt;</span> func <span style=color:#ff7b72;font-weight:700>=</span> x <span style=color:#ff7b72;font-weight:700>-&gt;</span> String<span style=color:#ff7b72;font-weight:700>.</span>valueOf<span style=color:#ff7b72;font-weight:700>(</span>x<span style=color:#ff7b72;font-weight:700>.</span>stream<span style=color:#ff7b72;font-weight:700>().</span>mapToLong<span style=color:#ff7b72;font-weight:700>(</span>y<span style=color:#ff7b72;font-weight:700>-&gt;</span> y<span style=color:#ff7b72;font-weight:700>).</span>sum<span style=color:#ff7b72;font-weight:700>());</span>
</span></span><span style=display:flex><span>        Collector<span style=color:#ff7b72;font-weight:700>&lt;</span>Long<span style=color:#ff7b72;font-weight:700>,</span> List<span style=color:#ff7b72;font-weight:700>&lt;</span>Long<span style=color:#ff7b72;font-weight:700>&gt;,</span> String<span style=color:#ff7b72;font-weight:700>&gt;</span> longSupplier <span style=color:#ff7b72;font-weight:700>=</span> Collector<span style=color:#ff7b72;font-weight:700>.</span>of<span style=color:#ff7b72;font-weight:700>(</span>ArrayList<span style=color:#ff7b72;font-weight:700>::</span><span style=color:#ff7b72>new</span><span style=color:#ff7b72;font-weight:700>,</span> accumulator<span style=color:#ff7b72;font-weight:700>,</span> combiner<span style=color:#ff7b72;font-weight:700>,</span>func<span style=color:#ff7b72;font-weight:700>,</span> Collector<span style=color:#ff7b72;font-weight:700>.</span>Characteristics<span style=color:#ff7b72;font-weight:700>.</span>UNORDERED<span style=color:#ff7b72;font-weight:700>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        String collect <span style=color:#ff7b72;font-weight:700>=</span> Stream<span style=color:#ff7b72;font-weight:700>.</span>of<span style=color:#ff7b72;font-weight:700>(</span>1<span style=color:#ff7b72;font-weight:700>,</span> 1<span style=color:#ff7b72;font-weight:700>,</span> 2<span style=color:#ff7b72;font-weight:700>,</span> 2<span style=color:#ff7b72;font-weight:700>)</span>
</span></span><span style=display:flex><span>                <span style=color:#ff7b72;font-weight:700>.</span>map<span style=color:#ff7b72;font-weight:700>(</span>Long<span style=color:#ff7b72;font-weight:700>::</span><span style=color:#ff7b72>new</span><span style=color:#ff7b72;font-weight:700>)</span>
</span></span><span style=display:flex><span>                <span style=color:#ff7b72;font-weight:700>.</span>collect<span style=color:#ff7b72;font-weight:700>(</span>longSupplier<span style=color:#ff7b72;font-weight:700>);</span>
</span></span><span style=display:flex><span>        System<span style=color:#ff7b72;font-weight:700>.</span>out<span style=color:#ff7b72;font-weight:700>.</span>println<span style=color:#ff7b72;font-weight:700>(</span><span style=color:#a5d6ff>&#34;collect = &#34;</span> <span style=color:#ff7b72;font-weight:700>+</span> collect<span style=color:#ff7b72;font-weight:700>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72;font-weight:700>}</span>
</span></span></code></pre></div><p><a href=https://blog.csdn.net/xiliunian/article/details/88773718 target=_blank rel=noopener>java8新特性(四) Collector（收集器）_戏流年的博客-CSDN博客_collector</a></p><p><a href=https://www.jianshu.com/p/7eaa0969b424 target=_blank rel=noopener>Java基础系列-Collector和Collectors - 简书 (jianshu.com)</a></p></div><footer class=post-footer><ul class=post-tags><li><a href=https://xiaokunji.com/zh/tags/Java%E5%9F%BA%E7%A1%80.html>Java基础</a></li><li><a href=https://xiaokunji.com/zh/tags/java%E5%8F%8A%E5%85%B6%E6%A1%86%E6%9E%B6.html>java及其框架</a></li></ul><nav class=paginav><a class=prev href=https://xiaokunji.com/zh/%E7%BB%BC%E5%90%88/%E4%B8%AA%E4%BA%BA%E5%B0%8F%E7%9F%A5%E8%AF%86/%E7%BD%91%E7%BB%9C/IO%E6%A8%A1%E5%9E%8B.html><span class=title>« 上一页</span><br><span>IO模型</span></a>
<a class=next href=https://xiaokunji.com/zh/%E7%BB%BC%E5%90%88/%E4%B8%AA%E4%BA%BA%E5%B0%8F%E7%9F%A5%E8%AF%86/java/javaEE.html><span class=title>下一页 »</span><br><span>javaEE</span></a></nav></footer></article></main><footer class=footer><span>Copyright
&copy;
-2023
<a href=https://xiaokunji.com/zh/ style=color:#939393>米二</a>
All Rights Reserved</span>
<script async src=//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js></script>
<span id=busuanzi_container><span class="fa fa-user">用户数:</span><span id=busuanzi_value_site_uv></span>
<span class="fa fa-eye">访问数:</span><span id=busuanzi_value_site_pv></span></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="复制";function s(){t.innerHTML="已复制！",setTimeout(()=>{t.innerHTML="复制"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>