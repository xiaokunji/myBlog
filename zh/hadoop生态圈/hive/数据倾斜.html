<!doctype html><html lang=zh dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>æ•°æ®å€¾æ–œ | ç±³äºŒ</title><meta name=keywords content=" 1.ä»€ä¹ˆæ˜¯æ•°æ®å€¾æ–œ, 2. æ•°æ®å€¾æ–œå‘ç”Ÿæ—¶çš„ç°è±¡ï¼š , 3. æ•°æ®å€¾æ–œå‘ç”Ÿçš„åŸç† :, 4. äº§ç”ŸåŸå› , 5. è§£å†³æ–¹æ¡ˆ"><meta name=description content="     "><meta name=author content="xkj"><link rel=canonical href=https://xiaokunji.com/zh/hadoop%E7%94%9F%E6%80%81%E5%9C%88/hive/%E6%95%B0%E6%8D%AE%E5%80%BE%E6%96%9C.html><link crossorigin=anonymous href=/assets/css/stylesheet.b3faf608c544858ba700943ffe182cb647f38432d29a07d73234965beacb26f6.css integrity="sha256-s/r2CMVEhYunAJQ//hgstkfzhDLSmgfXMjSWW+rLJvY=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://xiaokunji.com/img/Q.svg><link rel=icon type=image/png sizes=16x16 href=https://xiaokunji.com/img/Q.svg><link rel=icon type=image/png sizes=32x32 href=https://xiaokunji.com/img/Q.svg><link rel=apple-touch-icon href=https://xiaokunji.com/Q.svg><link rel=mask-icon href=https://xiaokunji.com/Q.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=zh href=https://xiaokunji.com/zh/hadoop%E7%94%9F%E6%80%81%E5%9C%88/hive/%E6%95%B0%E6%8D%AE%E5%80%BE%E6%96%9C.html><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><meta property="og:title" content="æ•°æ®å€¾æ–œ"><meta property="og:description" content="     "><meta property="og:type" content="article"><meta property="og:url" content="https://xiaokunji.com/zh/hadoop%E7%94%9F%E6%80%81%E5%9C%88/hive/%E6%95%B0%E6%8D%AE%E5%80%BE%E6%96%9C.html"><meta property="article:section" content="hadoopç”Ÿæ€åœˆ"><meta property="article:published_time" content="2023-08-22T00:00:00+00:00"><meta property="article:modified_time" content="2023-08-30T16:27:33+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="æ•°æ®å€¾æ–œ"><meta name=twitter:description content="     "><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":4,"name":"æ•°æ®å€¾æ–œ","item":"https://xiaokunji.com/zh/hadoop%E7%94%9F%E6%80%81%E5%9C%88/hive/%E6%95%B0%E6%8D%AE%E5%80%BE%E6%96%9C.html"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"æ•°æ®å€¾æ–œ","name":"æ•°æ®å€¾æ–œ","description":"     ","keywords":[" 1.ä»€ä¹ˆæ˜¯æ•°æ®å€¾æ–œ"," 2. æ•°æ®å€¾æ–œå‘ç”Ÿæ—¶çš„ç°è±¡ï¼š "," 3. æ•°æ®å€¾æ–œå‘ç”Ÿçš„åŸç† :"," 4. äº§ç”ŸåŸå› "," 5. è§£å†³æ–¹æ¡ˆ"],"articleBody":"[toc]\n1.ä»€ä¹ˆæ˜¯æ•°æ®å€¾æ–œ ç®€å•çš„è®²ï¼Œæ•°æ®å€¾æ–œå°±æ˜¯æˆ‘ä»¬åœ¨è®¡ç®—æ•°æ®çš„æ—¶å€™ï¼Œæ•°æ®çš„åˆ†æ•£åº¦ä¸å¤Ÿï¼Œå¯¼è‡´å¤§é‡çš„æ•°æ®é›†ä¸­åˆ°äº†é›†ç¾¤ä¸­çš„ä¸€å°æˆ–è€…å‡ å°æœºå™¨ä¸Šè®¡ç®—ï¼Œè€Œé›†ç¾¤ä¸­çš„å…¶ä»–èŠ‚ç‚¹ç©ºé—²ã€‚è¿™äº›å€¾æ–œäº†çš„æ•°æ®çš„è®¡ç®—é€Ÿåº¦è¿œè¿œä½äºå¹³å‡è®¡ç®—é€Ÿåº¦ï¼Œå¯¼è‡´æ•´ä¸ªè®¡ç®—è¿‡ç¨‹è¿‡æ…¢ã€‚\nä¸æ˜¯æ•°æ®é›†ä¸­å¯¼è‡´å€¾æ–œäº†,++è€Œæ˜¯è®¡ç®—å¤ªè¿‡é›†ä¸­++å¯¼è‡´å€¾æ–œ\n2. æ•°æ®å€¾æ–œå‘ç”Ÿæ—¶çš„ç°è±¡ï¼š ç»å¤§å¤šæ•°taskæ‰§è¡Œå¾—éƒ½éå¸¸å¿«ï¼Œä½†ä¸ªåˆ«taskæ‰§è¡Œçš„ææ…¢ã€‚ åŸæœ¬èƒ½æ­£å¸¸æ‰§è¡Œçš„Sparkä½œä¸šï¼ŒæŸå¤©çªç„¶çˆ†å‡ºOOMï¼ˆå†…å­˜æº¢å‡ºï¼‰å¼‚å¸¸ã€‚è§‚å¯Ÿå¼‚å¸¸æ ˆï¼Œæ˜¯æˆ‘ä»¬å†™çš„ä¸šåŠ¡ä»£ç é€ æˆçš„ 3. æ•°æ®å€¾æ–œå‘ç”Ÿçš„åŸç† : åœ¨è¿›è¡Œshuffleçš„æ—¶å€™ï¼Œå¿…é¡»å°†å„ä¸ªèŠ‚ç‚¹ä¸Šç›¸åŒçš„Keyæ‹‰å–åˆ°æŸä¸ªèŠ‚ç‚¹ä¸Šçš„ä¸€ä¸ªtaskæ¥è¿›è¡Œå¤„ç†ï¼Œæ¯”å¦‚æŒ‰ç…§keyè¿›è¡Œèšåˆæˆ–è€…joinæ“ä½œã€‚å¦‚æœæŸä¸ªkeyå¯¹åº”çš„æ•°æ®é‡ç‰¹åˆ«å¤§çš„è¯ï¼Œä¼šå‘ç”Ÿæ•°æ®å€¾æ–œã€‚æ¯”å¦‚å¤§éƒ¨åˆ†keyå¯¹åº”çš„10æ¡æ•°æ®ï¼Œä½†ä¸ªåˆ«keyå´å¯¹åº”äº†100ä¸‡æ¡æ•°æ®ï¼Œé‚£ä¹ˆå¤§éƒ¨åˆ†taskä¼šåªåˆ†é…åˆ°10æ¡æ•°æ®ï¼Œè€Œä¸ªåˆ«taskå¯èƒ½ä¼šåˆ†é…äº†100ä¸‡æ•°æ®ã€‚æ•´ä¸ªsparkä½œä¸šçš„è¿è¡Œè¿›åº¦æ˜¯ç”±è¿è¡Œæ—¶é—´æœ€é•¿çš„é‚£ä¸ªtaskå†³å®šçš„ã€‚Â å› æ­¤å‡ºç°æ•°æ®å€¾æ–œçš„æ—¶å€™ï¼Œsparkä½œä¸šçœ‹èµ·æ¥ä¼šè¿è¡Œå¾—éå¸¸ç¼“æ…¢ï¼Œç”šè‡³å¯èƒ½å› ä¸ºæŸä¸ªtaskå¤„ç†çš„æ•°æ®é‡è¿‡å¤§å¯¼è‡´OOMã€‚\nåæ­£å°±æ˜¯è¿‡å¤šçš„keyåˆ†é…åˆ°åŒä¸€ä¸ªreduceå»æ‰§è¡Œäº†,è€Œé‚£å°æœºå™¨æ— æ³•å¤„ç†é‚£ä¹ˆå¤š,è§£å†³æ–¹æ¡ˆåŸºæœ¬å¾€å‡è½»å‹åŠ›æ–¹å‘é \nåŸæ–‡é“¾æ¥ï¼šhttps://blog.csdn.net/weixin_35353187/article/details/84303518\n4. äº§ç”ŸåŸå›  æ•°æ®å€¾æ–œåŸå› æœ‰ä»¥ä¸‹å‡ æ–¹é¢ï¼š\nkeyåˆ†å¸ƒä¸å‡åŒ€ ä¸šåŠ¡æ•°æ®æœ¬èº«çš„ç‰¹æ€§ (æ¯”å¦‚åŒ—äº¬/ä¸Šæµ·æ•°æ®é‡æ¯”é•¿æ²™æ•°æ®è¦å¤š) å»ºè¡¨æ—¶è€ƒè™‘ä¸å‘¨ (ç”¨æˆ·è¡¨å’Œæ—¥å¿—è¡¨,å…±åŒæ‹¥æœ‰è®¿é—®ipå­—æ®µ,ä½†æ˜¯ç±»å‹å´ä¸ä¸€æ ·æˆ–è€…é»˜è®¤å€¼ä¸åŒä¹‹ç±») æŸäº›SQLè¯­å¥æœ¬èº«å°±æœ‰æ•°æ®å€¾æ–œ (å‡ºç°shuffleæ“ä½œ) 5. è§£å†³æ–¹æ¡ˆ hiveå’ŒMR/sparkçš„æ–¹æ¡ˆä¸ä¸€æ ·,æ¯•ç«Ÿä¸€ä¸ªæ˜¯å†™sql,ä¸€ä¸ªæ˜¯å†™ç¨‹åº,ä½†æ˜¯æ–¹å‘æ˜¯ä¸€æ ·çš„\nhiveçš„sqlå†™å¥½ä¸€ç‚¹ä¼šæœ‰æ•ˆé¿å…æ•°æ®å€¾æ–œ\n1. ç©ºå€¼äº§ç”Ÿçš„æ•°æ®å€¾æ–œ\nåœºæ™¯è¯´æ˜ åœ¨æ—¥å¿—ä¸­ï¼Œå¸¸ä¼šæœ‰ä¿¡æ¯ä¸¢å¤±çš„é—®é¢˜ï¼Œæ¯”å¦‚æ—¥å¿—ä¸­çš„ user_idï¼Œå¦‚æœå–å…¶ä¸­çš„ user_id å’Œç”¨æˆ·è¡¨ä¸­çš„ user_id ç›¸å…³è”ï¼Œå°±ä¼šç¢°åˆ°æ•°æ®å€¾æ–œçš„é—®é¢˜ã€‚\nè§£å†³æ–¹æ¡ˆ 1ï¼šuser_id ä¸ºç©ºçš„ä¸å‚ä¸å…³è” è§£å†³æ–¹æ¡ˆ 2ï¼šèµ‹äºˆç©ºå€¼æ–°çš„ key å€¼ æ–¹æ³• 2 æ¯”æ–¹æ³• 1 æ•ˆç‡æ›´å¥½ï¼Œä¸ä½† IO å°‘äº†ï¼Œè€Œä¸”ä½œä¸šæ•°ä¹Ÿå°‘äº†ï¼Œæ–¹æ¡ˆ 1 ä¸­ï¼Œlog è¡¨ è¯»äº†ä¸¤æ¬¡ï¼Œjobs è‚¯å®šæ˜¯ 2ï¼Œè€Œæ–¹æ¡ˆ 2 æ˜¯ 1ã€‚è¿™ä¸ªä¼˜åŒ–é€‚åˆæ— æ•ˆ idï¼ˆæ¯”å¦‚-99ï¼Œâ€™â€™ï¼Œnullï¼‰äº§ ç”Ÿçš„æ•°æ®å€¾æ–œï¼ŒæŠŠç©ºå€¼çš„ key å˜æˆä¸€ä¸ªå­—ç¬¦ä¸²åŠ ä¸Šä¸€ä¸ªéšæœºæ•°ï¼Œå°±èƒ½æŠŠé€ æˆæ•°æ®å€¾æ–œçš„ æ•°æ®åˆ†åˆ°ä¸åŒçš„ reduce ä¸Šè§£å†³æ•°æ®å€¾æ–œçš„é—®é¢˜ã€‚\næ”¹å˜ä¹‹å¤„ï¼šä½¿æœ¬èº«ä¸º null çš„æ‰€æœ‰è®°å½•ä¸ä¼šæ‹¥æŒ¤åœ¨åŒä¸€ä¸ª reduceTask äº†ï¼Œä¼šç”±äºæœ‰æ›¿ä»£çš„ éšæœºå­—ç¬¦ä¸²å€¼ï¼Œè€Œåˆ†æ•£åˆ°äº†å¤šä¸ª reduceTask ä¸­äº†ï¼Œç”±äº null å€¼å…³è”ä¸ä¸Šï¼Œå¤„ç†åå¹¶ä¸å½±å“æœ€ç»ˆç»“æœã€‚\n1.1 ç‰¹æ®Šå€¼åˆ†å¼€å¤„ç†\næˆ‘ä»¬å·²ç»çŸ¥é“user_id = 0æ˜¯ä¸€ä¸ªç‰¹æ®Škeyï¼Œé‚£ä¹ˆå¯ä»¥æŠŠç‰¹æ®Šå€¼éš”ç¦»å¼€æ¥å•ç‹¬åšjoinï¼Œè¿™æ ·ç‰¹æ®Šå€¼è‚¯å®šä¼šè½¬åŒ–æˆmap joinï¼Œéç‰¹æ®Šå€¼å°±æ˜¯æ²¡æœ‰å€¾æ–œçš„æ™®é€šjoinäº†ï¼š\nselect * from ( select * from logs where user_id = 0 ) a join ( select * from users where user_id = 0 ) b on a.user_id = b.user_id union all select * from logs a join users b on a.user_id \u003c\u003e 0 and a.user_id = b.user_id; https://blog.csdn.net/anshuai_aw1/article/details/84033160 2. ä¸åŒæ•°æ®ç±»å‹å…³è”äº§ç”Ÿæ•°æ®å€¾æ–œ\nåœºæ™¯è¯´æ˜\nç”¨æˆ·è¡¨ä¸­ user_id å­—æ®µä¸º intï¼Œlog è¡¨ä¸­ user_id ä¸ºæ—¢æœ‰ string ä¹Ÿæœ‰ int çš„ç±»å‹ï¼Œ å½“æŒ‰ç…§ä¸¤ä¸ªè¡¨çš„ user_id è¿›è¡Œ join æ“ä½œçš„æ—¶å€™ï¼Œé»˜è®¤çš„ hash æ“ä½œä¼šæŒ‰ç…§ int ç±»å‹çš„ id è¿› è¡Œåˆ†é…ï¼Œè¿™æ ·å°±ä¼šå¯¼è‡´æ‰€æœ‰çš„ string ç±»å‹çš„ id å°±è¢«åˆ†åˆ°åŒä¸€ä¸ª reducer å½“ä¸­\nè§£å†³æ–¹æ¡ˆ: æŠŠæ•°å­—ç±»å‹ id è½¬æ¢æˆ string ç±»å‹çš„ id 3. å¤§å°è¡¨å…³è”æŸ¥è¯¢äº§ç”Ÿæ•°æ®å€¾æ–œ\næ³¨æ„ï¼šä½¿ç”¨map joinè§£å†³å°è¡¨å…³è”å¤§è¡¨é€ æˆçš„æ•°æ®å€¾æ–œé—®é¢˜ã€‚è¿™ä¸ªæ–¹æ³•ä½¿ç”¨çš„é¢‘ç‡å¾ˆé«˜ã€‚ map join æ¦‚å¿µï¼šå°†å…¶ä¸­åšè¿æ¥çš„å°è¡¨ï¼ˆå…¨é‡æ•°æ®ï¼‰åˆ†å‘åˆ°æ‰€æœ‰ MapTask ç«¯è¿›è¡Œ Joinï¼Œä» è€Œé¿å…äº† reduceTask(å› ä¸ºæ²¡æœ‰reduceäº†)ï¼Œå‰æè¦æ±‚æ˜¯å†…å­˜è¶³ä»¥è£…ä¸‹è¯¥å…¨é‡æ•°æ®\nä»¥å¤§è¡¨ a å’Œå°è¡¨ b ä¸ºä¾‹ï¼Œæ‰€æœ‰çš„ maptask èŠ‚ç‚¹éƒ½è£…è½½å°è¡¨ b çš„æ‰€æœ‰æ•°æ®ï¼Œç„¶åå¤§è¡¨ a çš„ ä¸€ä¸ªæ•°æ®å—æ•°æ®æ¯”å¦‚è¯´æ˜¯ a1 å»è·Ÿ b å…¨é‡æ•°æ®åšé“¾æ¥ï¼Œå°±çœå»äº† reduce åšæ±‡æ€»çš„è¿‡ç¨‹ã€‚ æ‰€ä»¥ç›¸å¯¹æ¥è¯´ï¼Œåœ¨å†…å­˜å…è®¸çš„æ¡ä»¶ä¸‹ä½¿ç”¨ map join æ¯”ç›´æ¥ä½¿ç”¨ MapReduce æ•ˆç‡è¿˜é«˜äº›ï¼Œ å½“ç„¶è¿™åªé™äºåš join æŸ¥è¯¢çš„æ—¶å€™ã€‚\nåœ¨ hive ä¸­ï¼Œç›´æ¥æä¾›äº†èƒ½å¤Ÿåœ¨ HQL è¯­å¥æŒ‡å®šè¯¥æ¬¡æŸ¥è¯¢ä½¿ç”¨ map joinï¼Œmap join çš„ç”¨æ³•æ˜¯ åœ¨æŸ¥è¯¢/å­æŸ¥è¯¢çš„SELECTå…³é”®å­—åé¢æ·»åŠ /*+ MAPJOIN(tablelist) */æç¤ºä¼˜åŒ–å™¨è½¬åŒ–ä¸ºmap joinï¼ˆæ—©æœŸçš„ Hive ç‰ˆæœ¬çš„ä¼˜åŒ–å™¨æ˜¯ä¸èƒ½è‡ªåŠ¨ä¼˜åŒ– map join çš„ï¼‰ã€‚\nå…·ä½“ç”¨æ³•\nselect /* +mapjoin(a) */ a.id aid, name, age from a join b on a.id = b.id; select /* +mapjoin(movies) */ a.title, b.rating from movies a join ratings b on a.movieid = b.movieid; åœ¨ hive0.11 ç‰ˆæœ¬ä»¥åä¼šè‡ªåŠ¨å¼€å¯ map join ä¼˜åŒ–ï¼Œç”±ä¸¤ä¸ªå‚æ•°æ§åˆ¶ï¼š\nset hive.auto.convert.join=true; //è®¾ç½® MapJoin ä¼˜åŒ–è‡ªåŠ¨å¼€å¯ set hive.mapjoin.smalltable.filesize=25000000 //è®¾ç½®å°è¡¨ä¸è¶…è¿‡å¤šå¤§æ—¶å¼€å¯ mapjoin ä¼˜åŒ– https://www.cnblogs.com/qingyunzong/p/8847597.html https://blog.csdn.net/baichoufei90/article/details/86554840 https://blog.csdn.net/weixin_35353187/article/details/84303518 ","wordCount":"1861","inLanguage":"zh","datePublished":"2023-08-22T00:00:00Z","dateModified":"2023-08-30T16:27:33.771734927Z","author":{"@type":"Person","name":"xkj"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://xiaokunji.com/zh/hadoop%E7%94%9F%E6%80%81%E5%9C%88/hive/%E6%95%B0%E6%8D%AE%E5%80%BE%E6%96%9C.html"},"publisher":{"@type":"Organization","name":"ç±³äºŒ","logo":{"@type":"ImageObject","url":"https://xiaokunji.com/img/Q.svg"}}}</script></head><body class=dark id=top><script>localStorage.getItem("pref-theme")==="light"&&document.body.classList.remove("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://xiaokunji.com/zh/ accesskey=h title="ç±³äºŒ (Alt + H)"><img src=https://xiaokunji.com/img/Q.svg alt aria-label=logo height=35>ç±³äºŒ</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li><li><a href=https://xiaokunji.com/en/ title=English aria-label=English>English</a></li></ul></div></div><ul id=menu><li><a href=https://xiaokunji.com/zh/ title=ğŸ ä¸»é¡µ><span>ğŸ ä¸»é¡µ</span></a></li><li><a href=https://xiaokunji.com/zh/search.html title="ğŸ”æœç´¢ (Alt + /)" accesskey=/><span>ğŸ”æœç´¢</span></a></li><li><a href=https://xiaokunji.com/zh/post.html title=ğŸ“šæ–‡ç« ><span>ğŸ“šæ–‡ç« </span></a></li><li><a href=https://xiaokunji.com/zh/archives.html title=â±æ—¶é—´è½´><span>â±æ—¶é—´è½´</span></a></li><li><a href=https://xiaokunji.com/zh/tags.html title=ğŸ”–æ ‡ç­¾><span>ğŸ”–æ ‡ç­¾</span></a></li><li><a href=https://xiaokunji.com/zh/categories.html title=ğŸ“–åˆ†ç±»><span>ğŸ“–åˆ†ç±»</span></a></li><li><a href=https://xiaokunji.com/zh/links.html title=ğŸ¤å‹é“¾><span>ğŸ¤å‹é“¾</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><nav aria-label=breadcrumb><ul><a href=https://xiaokunji.com/zh/>ğŸ </a> <span>></span>
<a href=https://xiaokunji.com/zh/hadoop%E7%94%9F%E6%80%81%E5%9C%88.html>hadoopç”Ÿæ€åœˆ</a> <span>></span>
<a href=https://xiaokunji.com/zh/hadoop%E7%94%9F%E6%80%81%E5%9C%88/hive.html>Hive</a> <span>></span></ul></nav><h1 class=post-title>æ•°æ®å€¾æ–œ</h1><div class=post-description></div><div class=post-meta>åˆ›å»º:&nbsp;<span title='2023-08-22 00:00:00 +0000 UTC'>2023-08-22</span>&nbsp;Â·&nbsp;æ›´æ–°:&nbsp;2023-08-30&nbsp;Â·&nbsp;4 åˆ†é’Ÿ&nbsp;Â·&nbsp;xkj
&nbsp;|&nbsp;åˆ†ç±»: &nbsp;<ul class=post-categories-meta><a href=https://xiaokunji.com/zh/categories/hadoop%E7%94%9F%E6%80%81%E5%9C%88.html>Hadoopç”Ÿæ€åœˆ</a></ul><span id=busuanzi_container_page_pv>&nbsp;| è®¿é—®: <span id=busuanzi_value_page_pv></span></span></div></header><aside id=toc-container class="toc-container wide"><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>ç›®å½•</span></summary><div class=inner><ul><li><a href=#1%e4%bb%80%e4%b9%88%e6%98%af%e6%95%b0%e6%8d%ae%e5%80%be%e6%96%9c aria-label=1.ä»€ä¹ˆæ˜¯æ•°æ®å€¾æ–œ>1.ä»€ä¹ˆæ˜¯æ•°æ®å€¾æ–œ</a></li><li><a href=#2-%e6%95%b0%e6%8d%ae%e5%80%be%e6%96%9c%e5%8f%91%e7%94%9f%e6%97%b6%e7%9a%84%e7%8e%b0%e8%b1%a1 aria-label="2. æ•°æ®å€¾æ–œå‘ç”Ÿæ—¶çš„ç°è±¡ï¼š">2. æ•°æ®å€¾æ–œå‘ç”Ÿæ—¶çš„ç°è±¡ï¼š</a></li><li><a href=#3-%e6%95%b0%e6%8d%ae%e5%80%be%e6%96%9c%e5%8f%91%e7%94%9f%e7%9a%84%e5%8e%9f%e7%90%86- aria-label="3. æ•°æ®å€¾æ–œå‘ç”Ÿçš„åŸç† :">3. æ•°æ®å€¾æ–œå‘ç”Ÿçš„åŸç† :</a></li><li><a href=#4-%e4%ba%a7%e7%94%9f%e5%8e%9f%e5%9b%a0 aria-label="4. äº§ç”ŸåŸå› ">4. äº§ç”ŸåŸå› </a></li><li><a href=#5-%e8%a7%a3%e5%86%b3%e6%96%b9%e6%a1%88 aria-label="5. è§£å†³æ–¹æ¡ˆ">5. è§£å†³æ–¹æ¡ˆ</a></li></ul></div></details></div></aside><script>let activeElement,elements;window.addEventListener("DOMContentLoaded",function(){checkTocPosition(),elements=document.querySelectorAll("h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]"),activeElement=elements[0];const t=encodeURI(activeElement.getAttribute("id")).toLowerCase();document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active")},!1),window.addEventListener("resize",function(){checkTocPosition()},!1),window.addEventListener("scroll",()=>{activeElement=Array.from(elements).find(e=>{if(getOffsetTop(e)-window.pageYOffset>0&&getOffsetTop(e)-window.pageYOffset<window.innerHeight/2)return e})||activeElement,elements.forEach(e=>{const t=encodeURI(e.getAttribute("id")).toLowerCase();e===activeElement?document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active"):document.querySelector(`.inner ul li a[href="#${t}"]`).classList.remove("active")})},!1);const main=parseInt(getComputedStyle(document.body).getPropertyValue("--article-width"),10),toc=parseInt(getComputedStyle(document.body).getPropertyValue("--toc-width"),10),gap=parseInt(getComputedStyle(document.body).getPropertyValue("--gap"),10);function checkTocPosition(){const e=document.body.scrollWidth;e-main-toc*2-gap*4>0?document.getElementById("toc-container").classList.add("wide"):document.getElementById("toc-container").classList.remove("wide")}function getOffsetTop(e){if(!e.getClientRects().length)return 0;let t=e.getBoundingClientRect(),n=e.ownerDocument.defaultView;return t.top+n.pageYOffset}</script><div class=post-content><p>[toc]</p><h1 id=1ä»€ä¹ˆæ˜¯æ•°æ®å€¾æ–œ>1.ä»€ä¹ˆæ˜¯æ•°æ®å€¾æ–œ<a hidden class=anchor aria-hidden=true href=#1ä»€ä¹ˆæ˜¯æ•°æ®å€¾æ–œ>#</a></h1><p>ç®€å•çš„è®²ï¼Œæ•°æ®å€¾æ–œå°±æ˜¯æˆ‘ä»¬åœ¨è®¡ç®—æ•°æ®çš„æ—¶å€™ï¼Œæ•°æ®çš„åˆ†æ•£åº¦ä¸å¤Ÿï¼Œå¯¼è‡´å¤§é‡çš„æ•°æ®é›†ä¸­åˆ°äº†é›†ç¾¤ä¸­çš„ä¸€å°æˆ–è€…å‡ å°æœºå™¨ä¸Šè®¡ç®—ï¼Œè€Œé›†ç¾¤ä¸­çš„å…¶ä»–èŠ‚ç‚¹ç©ºé—²ã€‚è¿™äº›å€¾æ–œäº†çš„æ•°æ®çš„è®¡ç®—é€Ÿåº¦è¿œè¿œä½äºå¹³å‡è®¡ç®—é€Ÿåº¦ï¼Œå¯¼è‡´æ•´ä¸ªè®¡ç®—è¿‡ç¨‹è¿‡æ…¢ã€‚</p><blockquote><p>ä¸æ˜¯æ•°æ®é›†ä¸­å¯¼è‡´å€¾æ–œäº†,++è€Œæ˜¯è®¡ç®—å¤ªè¿‡é›†ä¸­++å¯¼è‡´å€¾æ–œ</p></blockquote><h1 id=2-æ•°æ®å€¾æ–œå‘ç”Ÿæ—¶çš„ç°è±¡>2. æ•°æ®å€¾æ–œå‘ç”Ÿæ—¶çš„ç°è±¡ï¼š<a hidden class=anchor aria-hidden=true href=#2-æ•°æ®å€¾æ–œå‘ç”Ÿæ—¶çš„ç°è±¡>#</a></h1><ol><li>ç»å¤§å¤šæ•°taskæ‰§è¡Œå¾—éƒ½éå¸¸å¿«ï¼Œä½†ä¸ªåˆ«taskæ‰§è¡Œçš„ææ…¢ã€‚</li><li>åŸæœ¬èƒ½æ­£å¸¸æ‰§è¡Œçš„Sparkä½œä¸šï¼ŒæŸå¤©çªç„¶çˆ†å‡ºOOMï¼ˆå†…å­˜æº¢å‡ºï¼‰å¼‚å¸¸ã€‚è§‚å¯Ÿå¼‚å¸¸æ ˆï¼Œæ˜¯æˆ‘ä»¬å†™çš„ä¸šåŠ¡ä»£ç é€ æˆçš„</li></ol><h1 id=3-æ•°æ®å€¾æ–œå‘ç”Ÿçš„åŸç†->3. æ•°æ®å€¾æ–œå‘ç”Ÿçš„åŸç† :<a hidden class=anchor aria-hidden=true href=#3-æ•°æ®å€¾æ–œå‘ç”Ÿçš„åŸç†->#</a></h1><p>åœ¨è¿›è¡Œshuffleçš„æ—¶å€™ï¼Œå¿…é¡»å°†å„ä¸ªèŠ‚ç‚¹ä¸Šç›¸åŒçš„Keyæ‹‰å–åˆ°æŸä¸ªèŠ‚ç‚¹ä¸Šçš„ä¸€ä¸ªtaskæ¥è¿›è¡Œå¤„ç†ï¼Œæ¯”å¦‚æŒ‰ç…§keyè¿›è¡Œèšåˆæˆ–è€…joinæ“ä½œã€‚å¦‚æœæŸä¸ªkeyå¯¹åº”çš„æ•°æ®é‡ç‰¹åˆ«å¤§çš„è¯ï¼Œä¼šå‘ç”Ÿæ•°æ®å€¾æ–œã€‚æ¯”å¦‚å¤§éƒ¨åˆ†keyå¯¹åº”çš„10æ¡æ•°æ®ï¼Œä½†ä¸ªåˆ«keyå´å¯¹åº”äº†100ä¸‡æ¡æ•°æ®ï¼Œé‚£ä¹ˆå¤§éƒ¨åˆ†taskä¼šåªåˆ†é…åˆ°10æ¡æ•°æ®ï¼Œè€Œä¸ªåˆ«taskå¯èƒ½ä¼šåˆ†é…äº†100ä¸‡æ•°æ®ã€‚æ•´ä¸ªsparkä½œä¸šçš„è¿è¡Œè¿›åº¦æ˜¯ç”±è¿è¡Œæ—¶é—´æœ€é•¿çš„é‚£ä¸ªtaskå†³å®šçš„ã€‚Â 
å› æ­¤å‡ºç°æ•°æ®å€¾æ–œçš„æ—¶å€™ï¼Œsparkä½œä¸šçœ‹èµ·æ¥ä¼šè¿è¡Œå¾—éå¸¸ç¼“æ…¢ï¼Œç”šè‡³å¯èƒ½å› ä¸ºæŸä¸ªtaskå¤„ç†çš„æ•°æ®é‡è¿‡å¤§å¯¼è‡´OOMã€‚</p><blockquote><p>åæ­£å°±æ˜¯è¿‡å¤šçš„keyåˆ†é…åˆ°åŒä¸€ä¸ªreduceå»æ‰§è¡Œäº†,è€Œé‚£å°æœºå™¨æ— æ³•å¤„ç†é‚£ä¹ˆå¤š,è§£å†³æ–¹æ¡ˆåŸºæœ¬å¾€å‡è½»å‹åŠ›æ–¹å‘é <br>åŸæ–‡é“¾æ¥ï¼šhttps://blog.csdn.net/weixin_35353187/article/details/84303518</p></blockquote><h1 id=4-äº§ç”ŸåŸå› >4. äº§ç”ŸåŸå› <a hidden class=anchor aria-hidden=true href=#4-äº§ç”ŸåŸå› >#</a></h1><p>æ•°æ®å€¾æ–œåŸå› æœ‰ä»¥ä¸‹å‡ æ–¹é¢ï¼š</p><ul><li>keyåˆ†å¸ƒä¸å‡åŒ€</li><li>ä¸šåŠ¡æ•°æ®æœ¬èº«çš„ç‰¹æ€§ (æ¯”å¦‚åŒ—äº¬/ä¸Šæµ·æ•°æ®é‡æ¯”é•¿æ²™æ•°æ®è¦å¤š)</li><li>å»ºè¡¨æ—¶è€ƒè™‘ä¸å‘¨ (ç”¨æˆ·è¡¨å’Œæ—¥å¿—è¡¨,å…±åŒæ‹¥æœ‰è®¿é—®ipå­—æ®µ,ä½†æ˜¯ç±»å‹å´ä¸ä¸€æ ·æˆ–è€…é»˜è®¤å€¼ä¸åŒä¹‹ç±»)</li><li>æŸäº›SQLè¯­å¥æœ¬èº«å°±æœ‰æ•°æ®å€¾æ–œ (å‡ºç°shuffleæ“ä½œ)</li></ul><h1 id=5-è§£å†³æ–¹æ¡ˆ>5. è§£å†³æ–¹æ¡ˆ<a hidden class=anchor aria-hidden=true href=#5-è§£å†³æ–¹æ¡ˆ>#</a></h1><blockquote><p>hiveå’ŒMR/sparkçš„æ–¹æ¡ˆä¸ä¸€æ ·,æ¯•ç«Ÿä¸€ä¸ªæ˜¯å†™sql,ä¸€ä¸ªæ˜¯å†™ç¨‹åº,ä½†æ˜¯æ–¹å‘æ˜¯ä¸€æ ·çš„<br>hiveçš„sqlå†™å¥½ä¸€ç‚¹ä¼šæœ‰æ•ˆé¿å…æ•°æ®å€¾æ–œ</p></blockquote><p><strong>1. ç©ºå€¼äº§ç”Ÿçš„æ•°æ®å€¾æ–œ</strong><br><strong>åœºæ™¯è¯´æ˜</strong><br>åœ¨æ—¥å¿—ä¸­ï¼Œå¸¸ä¼šæœ‰ä¿¡æ¯ä¸¢å¤±çš„é—®é¢˜ï¼Œæ¯”å¦‚æ—¥å¿—ä¸­çš„ user_idï¼Œå¦‚æœå–å…¶ä¸­çš„ user_id å’Œç”¨æˆ·è¡¨ä¸­çš„ user_id ç›¸å…³è”ï¼Œå°±ä¼šç¢°åˆ°æ•°æ®å€¾æ–œçš„é—®é¢˜ã€‚</p><div class=highlight><pre tabindex=0 style=color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>è§£å†³æ–¹æ¡ˆ 1ï¼šuser_id ä¸ºç©ºçš„ä¸å‚ä¸å…³è”
</span></span><span style=display:flex><span>è§£å†³æ–¹æ¡ˆ 2ï¼šèµ‹äºˆç©ºå€¼æ–°çš„ key å€¼
</span></span></code></pre></div><blockquote><p>æ–¹æ³• 2 æ¯”æ–¹æ³• 1 æ•ˆç‡æ›´å¥½ï¼Œä¸ä½† IO å°‘äº†ï¼Œè€Œä¸”ä½œä¸šæ•°ä¹Ÿå°‘äº†ï¼Œæ–¹æ¡ˆ 1 ä¸­ï¼Œlog è¡¨ è¯»äº†ä¸¤æ¬¡ï¼Œjobs è‚¯å®šæ˜¯ 2ï¼Œè€Œæ–¹æ¡ˆ 2 æ˜¯ 1ã€‚è¿™ä¸ªä¼˜åŒ–é€‚åˆæ— æ•ˆ idï¼ˆæ¯”å¦‚-99ï¼Œâ€™â€™ï¼Œnullï¼‰äº§ ç”Ÿçš„æ•°æ®å€¾æ–œï¼ŒæŠŠç©ºå€¼çš„ key å˜æˆä¸€ä¸ªå­—ç¬¦ä¸²åŠ ä¸Šä¸€ä¸ªéšæœºæ•°ï¼Œå°±èƒ½æŠŠé€ æˆæ•°æ®å€¾æ–œçš„ æ•°æ®åˆ†åˆ°ä¸åŒçš„ reduce ä¸Šè§£å†³æ•°æ®å€¾æ–œçš„é—®é¢˜ã€‚<br>æ”¹å˜ä¹‹å¤„ï¼šä½¿æœ¬èº«ä¸º null çš„æ‰€æœ‰è®°å½•ä¸ä¼šæ‹¥æŒ¤åœ¨åŒä¸€ä¸ª reduceTask äº†ï¼Œä¼šç”±äºæœ‰æ›¿ä»£çš„ éšæœºå­—ç¬¦ä¸²å€¼ï¼Œè€Œåˆ†æ•£åˆ°äº†å¤šä¸ª reduceTask ä¸­äº†ï¼Œç”±äº null å€¼å…³è”ä¸ä¸Šï¼Œå¤„ç†åå¹¶ä¸å½±å“æœ€ç»ˆç»“æœã€‚</p></blockquote><p>1.1 ç‰¹æ®Šå€¼åˆ†å¼€å¤„ç†<br>æˆ‘ä»¬å·²ç»çŸ¥é“user_id = 0æ˜¯ä¸€ä¸ªç‰¹æ®Škeyï¼Œé‚£ä¹ˆå¯ä»¥æŠŠç‰¹æ®Šå€¼éš”ç¦»å¼€æ¥å•ç‹¬åšjoinï¼Œè¿™æ ·ç‰¹æ®Šå€¼è‚¯å®šä¼šè½¬åŒ–æˆmap joinï¼Œéç‰¹æ®Šå€¼å°±æ˜¯æ²¡æœ‰å€¾æ–œçš„æ™®é€šjoinäº†ï¼š</p><div class=highlight><pre tabindex=0 style=color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>select
</span></span><span style=display:flex><span>	*
</span></span><span style=display:flex><span>from
</span></span><span style=display:flex><span>	(
</span></span><span style=display:flex><span>		select * from logs where user_id = 0
</span></span><span style=display:flex><span>	)
</span></span><span style=display:flex><span>	a
</span></span><span style=display:flex><span>join
</span></span><span style=display:flex><span>	(
</span></span><span style=display:flex><span>		select * from users where user_id = 0
</span></span><span style=display:flex><span>	)
</span></span><span style=display:flex><span>	b
</span></span><span style=display:flex><span>on
</span></span><span style=display:flex><span>	a.user_id = b.user_id
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>union all
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>select * from logs a join users b on a.user_id &lt;&gt; 0 and a.user_id = b.user_id;
</span></span></code></pre></div><blockquote><p><a href=https://blog.csdn.net/anshuai_aw1/article/details/84033160 target=_blank rel=noopener>https://blog.csdn.net/anshuai_aw1/article/details/84033160</a></p></blockquote><p><strong>2. ä¸åŒæ•°æ®ç±»å‹å…³è”äº§ç”Ÿæ•°æ®å€¾æ–œ</strong><br><strong>åœºæ™¯è¯´æ˜</strong><br>ç”¨æˆ·è¡¨ä¸­ user_id å­—æ®µä¸º intï¼Œlog è¡¨ä¸­ user_id ä¸ºæ—¢æœ‰ string ä¹Ÿæœ‰ int çš„ç±»å‹ï¼Œ å½“æŒ‰ç…§ä¸¤ä¸ªè¡¨çš„ user_id è¿›è¡Œ join æ“ä½œçš„æ—¶å€™ï¼Œé»˜è®¤çš„ hash æ“ä½œä¼šæŒ‰ç…§ int ç±»å‹çš„ id è¿› è¡Œåˆ†é…ï¼Œè¿™æ ·å°±ä¼šå¯¼è‡´æ‰€æœ‰çš„ string ç±»å‹çš„ id å°±è¢«åˆ†åˆ°åŒä¸€ä¸ª reducer å½“ä¸­</p><div class=highlight><pre tabindex=0 style=color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>è§£å†³æ–¹æ¡ˆ: æŠŠæ•°å­—ç±»å‹ id è½¬æ¢æˆ string ç±»å‹çš„ id
</span></span></code></pre></div><p><strong>3. å¤§å°è¡¨å…³è”æŸ¥è¯¢äº§ç”Ÿæ•°æ®å€¾æ–œ</strong></p><blockquote><p>æ³¨æ„ï¼šä½¿ç”¨map joinè§£å†³å°è¡¨å…³è”å¤§è¡¨é€ æˆçš„æ•°æ®å€¾æ–œé—®é¢˜ã€‚è¿™ä¸ªæ–¹æ³•ä½¿ç”¨çš„é¢‘ç‡å¾ˆé«˜ã€‚
map join æ¦‚å¿µï¼šå°†å…¶ä¸­åšè¿æ¥çš„å°è¡¨ï¼ˆå…¨é‡æ•°æ®ï¼‰åˆ†å‘åˆ°æ‰€æœ‰ MapTask ç«¯è¿›è¡Œ Joinï¼Œä» è€Œé¿å…äº† reduceTask(å› ä¸ºæ²¡æœ‰reduceäº†)ï¼Œå‰æè¦æ±‚æ˜¯å†…å­˜è¶³ä»¥è£…ä¸‹è¯¥å…¨é‡æ•°æ®</p></blockquote><p>ä»¥å¤§è¡¨ a å’Œå°è¡¨ b ä¸ºä¾‹ï¼Œæ‰€æœ‰çš„ maptask èŠ‚ç‚¹éƒ½è£…è½½å°è¡¨ b çš„æ‰€æœ‰æ•°æ®ï¼Œç„¶åå¤§è¡¨ a çš„ ä¸€ä¸ªæ•°æ®å—æ•°æ®æ¯”å¦‚è¯´æ˜¯ a1 å»è·Ÿ b å…¨é‡æ•°æ®åšé“¾æ¥ï¼Œå°±çœå»äº† reduce åšæ±‡æ€»çš„è¿‡ç¨‹ã€‚ æ‰€ä»¥ç›¸å¯¹æ¥è¯´ï¼Œåœ¨å†…å­˜å…è®¸çš„æ¡ä»¶ä¸‹ä½¿ç”¨ map join æ¯”ç›´æ¥ä½¿ç”¨ MapReduce æ•ˆç‡è¿˜é«˜äº›ï¼Œ å½“ç„¶è¿™åªé™äºåš join æŸ¥è¯¢çš„æ—¶å€™ã€‚</p><p>åœ¨ hive ä¸­ï¼Œç›´æ¥æä¾›äº†èƒ½å¤Ÿåœ¨ HQL è¯­å¥æŒ‡å®šè¯¥æ¬¡æŸ¥è¯¢ä½¿ç”¨ map joinï¼Œmap join çš„ç”¨æ³•æ˜¯ åœ¨æŸ¥è¯¢/å­æŸ¥è¯¢çš„SELECTå…³é”®å­—åé¢æ·»åŠ /*+ MAPJOIN(tablelist) */æç¤ºä¼˜åŒ–å™¨è½¬åŒ–ä¸ºmap joinï¼ˆæ—©æœŸçš„ Hive ç‰ˆæœ¬çš„ä¼˜åŒ–å™¨æ˜¯ä¸èƒ½è‡ªåŠ¨ä¼˜åŒ– map join çš„ï¼‰ã€‚<br>å…·ä½“ç”¨æ³•</p><div class=highlight><pre tabindex=0 style=color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>select /* +mapjoin(a) */ a.id aid, name, age from a join b on a.id = b.id;
</span></span><span style=display:flex><span>select /* +mapjoin(movies) */ a.title, b.rating from movies a join ratings b on a.movieid = b.movieid;
</span></span></code></pre></div><p>åœ¨ hive0.11 ç‰ˆæœ¬ä»¥åä¼šè‡ªåŠ¨å¼€å¯ map join ä¼˜åŒ–ï¼Œç”±ä¸¤ä¸ªå‚æ•°æ§åˆ¶ï¼š</p><div class=highlight><pre tabindex=0 style=color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>set hive.auto.convert.join=true; //è®¾ç½® MapJoin ä¼˜åŒ–è‡ªåŠ¨å¼€å¯
</span></span><span style=display:flex><span>set hive.mapjoin.smalltable.filesize=25000000 //è®¾ç½®å°è¡¨ä¸è¶…è¿‡å¤šå¤§æ—¶å¼€å¯ mapjoin ä¼˜åŒ–
</span></span></code></pre></div><blockquote><p><a href=https://www.cnblogs.com/qingyunzong/p/8847597.html target=_blank rel=noopener>https://www.cnblogs.com/qingyunzong/p/8847597.html</a>
<a href=https://blog.csdn.net/baichoufei90/article/details/86554840 target=_blank rel=noopener>https://blog.csdn.net/baichoufei90/article/details/86554840</a>
<a href=https://blog.csdn.net/weixin_35353187/article/details/84303518 target=_blank rel=noopener>https://blog.csdn.net/weixin_35353187/article/details/84303518</a></p></blockquote></div><footer class=post-footer><ul class=post-tags><li><a href=https://xiaokunji.com/zh/tags/hive.html>Hive</a></li><li><a href=https://xiaokunji.com/zh/tags/hadoop%E7%94%9F%E6%80%81%E5%9C%88.html>Hadoopç”Ÿæ€åœˆ</a></li></ul></footer></article></main><footer class=footer><span>Copyright
&copy;
-2023
<a href=https://xiaokunji.com/zh/ style=color:#939393>ç±³äºŒ</a>
All Rights Reserved</span>
<script async src=//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js></script>
<span id=busuanzi_container><span class="fa fa-user">ç”¨æˆ·æ•°:</span><span id=busuanzi_value_site_uv></span>
<span class="fa fa-eye">è®¿é—®æ•°:</span><span id=busuanzi_value_site_pv></span></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="å¤åˆ¶";function s(){t.innerHTML="å·²å¤åˆ¶ï¼",setTimeout(()=>{t.innerHTML="å¤åˆ¶"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>