<!DOCTYPE html>
<html dir="auto" lang="zh"><head><meta charset="utf-8"/><meta content="IE=edge" http-equiv="x-ua-compatible"/><meta content="width=device-width,initial-scale=1,shrink-to-fit=no" name="viewport"/><meta content="index, follow" name="robots"/><title>函数 | 米二</title><meta content=" 条件函数, assert_true(BOOLEAN condition), coalesce(T v1,T v2,...), if, isnotnull(a), isnull(a), nullif(a,b), nvl(T value,T default_value), 日期函数, add_months, current_date, current_timestamp(), datediff(STRING enddate,STRING startdate), date_add(DATE startdate,INT days), date_sub(DATE startdate,INT days), date_format(DATE|TIMESTAMP|STRING ts,STRING fmt), dayofmonth(STRING date), extract(field FROM source) 时间截取函数, year(STRING date), quarter(DATE|TIMESTAMP|STRING a), month(STRING date), day(STRING date),, hour(STRING date), minute(STRING date), second(STRING date), from_unixtime(BIGINT unixtime [,STRING format]), from_utc_timestamp(T a,STRING timezone), last_day(STRING date), to_date(STRING timestamp), to_utc_timestamp(T a,STRING timezone), trunc(STRING date,STRING format)  截取年或月的第一天, unix_timestamp([STRING date [,STRING pattern]]), weekofyear(STRING date), next_day(STRING start_date,STRING day_of_week), months_between(DATE|TIMESTAMP|STRING date1,DATE|TIMESTAMP|STRING date2)" name="keywords"/><meta content="     " name="description"/><meta content="xkj" name="author"/><link href="https://xiaokunji.com/zh/hadoop%E7%94%9F%E6%80%81%E5%9C%88/Hive/%E5%87%BD%E6%95%B0.html" rel="canonical"/><link as="style" crossorigin="anonymous" href="/assets/css/stylesheet.dc6bd2c841ee388e899e13872ae986c0e847e8b957d6714ad6ddc628ef2d17ff.css" integrity="sha256-3GvSyEHuOI6JnhOHKumGwOhH6LlX1nFK1t3GKO8tF/8=" rel="preload stylesheet"/><script crossorigin="anonymous" defer="" integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload="hljs.initHighlightingOnLoad()" src="/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js"></script>
<link href="https://xiaokunji.com/img/Q.svg" rel="icon"/><link href="https://xiaokunji.com/img/Q.svg" rel="icon" sizes="16x16" type="image/png"/><link href="https://xiaokunji.com/img/Q.svg" rel="icon" sizes="32x32" type="image/png"/><link href="https://xiaokunji.com/Q.svg" rel="apple-touch-icon"/><link href="https://xiaokunji.com/Q.svg" rel="mask-icon"/><meta content="#2e2e33" name="theme-color"/><meta content="#2e2e33" name="msapplication-TileColor"/><link href="https://xiaokunji.com/zh/hadoop%E7%94%9F%E6%80%81%E5%9C%88/Hive/%E5%87%BD%E6%95%B0.html" hreflang="zh" rel="alternate"/><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><meta content="函数" property="og:title"/><meta content="     " property="og:description"/><meta content="article" property="og:type"/><meta content="https://xiaokunji.com/zh/hadoop%E7%94%9F%E6%80%81%E5%9C%88/Hive/%E5%87%BD%E6%95%B0.html" property="og:url"/><meta content="hadoop生态圈" property="article:section"/><meta content="2023-08-22T00:00:00+00:00" property="article:published_time"/><meta content="2023-08-29T00:59:17+08:00" property="article:modified_time"/><meta content="summary" name="twitter:card"/><meta content="函数" name="twitter:title"/><meta content="     " name="twitter:description"/><script type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":4,"name":"函数","item":"https://xiaokunji.com/zh/hadoop%E7%94%9F%E6%80%81%E5%9C%88/Hive/%E5%87%BD%E6%95%B0.html"}]}</script><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","headline":"函数","name":"函数","description":"     ","keywords":[" 条件函数"," assert_true(BOOLEAN condition)"," coalesce(T v1, T v2, ...)"," if"," isnotnull(a)"," isnull(a)"," nullif(a, b)"," nvl(T value, T default_value)"," 日期函数"," add_months"," current_date"," current_timestamp()"," datediff(STRING enddate, STRING startdate)"," date_add(DATE startdate, INT days)"," date_sub(DATE startdate, INT days)"," date_format(DATE|TIMESTAMP|STRING ts, STRING fmt)"," dayofmonth(STRING date)"," extract(field FROM source) 时间截取函数"," year(STRING date)"," quarter(DATE|TIMESTAMP|STRING a)"," month(STRING date)"," day(STRING date),"," hour(STRING date)"," minute(STRING date)"," second(STRING date)"," from_unixtime(BIGINT unixtime [, STRING format])"," from_utc_timestamp(T a, STRING timezone)"," last_day(STRING date)"," to_date(STRING timestamp)"," to_utc_timestamp(T a, STRING timezone)"," trunc(STRING date, STRING format)  截取年或月的第一天"," unix_timestamp([STRING date [, STRING pattern]])"," weekofyear(STRING date)"," next_day(STRING start_date, STRING day_of_week)"," months_between(DATE|TIMESTAMP|STRING date1, DATE|TIMESTAMP|STRING date2)"],"articleBody":"[toc]\n条件函数 assert_true(BOOLEAN condition) 解释 如果condition不为true，则抛出异常，否则返回null\n使用案例 select assert_true(1\u003c2) -- 返回null select assert_true(1\u003e2) -- 抛出异常 coalesce(T v1, T v2, …) 解释 返回第一个不为null的值，如果都为null，则返回null\n使用案例 select coalesce(null,1,2,null) -- 返回1 select coalesce(1,null) -- 返回1 select coalesce(null,null) -- 返回null if if ( BOOLEAN testCondition, T valueTrue , T valueFalseOrNull )\n解释 如果testCondition条件为true，则返回第一个值，否则返回第二个值\n使用案例 select if(1 is null,0,1) -- 返回1 select if(null is null,0,1) -- 返回0 isnotnull(a) 解释 如果参数a不为null，则返回true，否则返回false\n使用案例 select isnotnull(1) -- 返回true select isnotnull(null) -- 返回false isnull(a) 解释 与isnotnull相反，如果参数a为null，则返回true，否则返回false\n使用案例 select isnull(null) -- 返回true select isnull(1) -- 返回false nullif(a, b) 解释 如果参数a=b，返回null，否则返回a值(Hive2.2.0版本)\n使用案例 select nullif(1,2) -- 返回1 select nullif(1,1) -- 返回null nvl(T value, T default_value) 解释 如果value的值为null，则返回default_value默认值，否则返回value的值。在null值判断时，可以使用if函数给定默认值，也可以使用此函数给定默认值，使用该函数sql特别简洁。\n使用案例 select nvl(1,0) -- 返回1 select nvl(null,0) -- 返回0 日期函数 add_months add_month( DATE | STRING | TIMESTAMP start_date , INT num_months)\n解释 start_date参数可以是string, date 或者timestamp类型，num_months参数时int类型。返回一个日期，该日期是在start_date基础之上加上num_months个月，即start_date之后null_months个月的一个日期。如果start_date的时间部分的数据会被忽略。注意：如果start_date所在月份的天数大于结果日期月的天数，则返回结果月的最后一天的日期。\n使用案例 select add_months(\"2020-05-20\",2); -- 返回2020-07-20 select add_months(\"2020-05-20\",8); -- 返回2021-01-20 select add_months(\"2020-05-31\",1); -- 返回2020-06-30,5月有31天，6月只有30天，所以返回下一个月的最后一天 current_date 解释 返回查询时刻的当前日期\n使用案例 select current_date() -- 返回当前查询日期2020-05-20 current_timestamp() 解释 返回查询时刻的当前时间\n使用案例 select current_timestamp() -- 2020-05-20 14:40:47.273 datediff(STRING enddate, STRING startdate) 解释 返回开始日期startdate与结束日期enddate之前相差的天数\n使用案例 select datediff(\"2020-05-20\",\"2020-05-21\"); -- 返回-1 select datediff(\"2020-05-21\",\"2020-05-20\"); -- 返回1 date_add(DATE startdate, INT days) 解释 在startdate基础上加上几天，然后返回加上几天之后的一个日期\n使用案例 select date_add(\"2020-05-20\",1); -- 返回2020-05-21,1表示加1天 select date_add(\"2020-05-20\",-1); -- 返回2020-05-19，-1表示减一天 date_sub(DATE startdate, INT days) 解释 在startdate基础上减去几天，然后返回减去几天之后的一个日期,功能与date_add很类似\n使用案例 select date_sub(\"2020-05-20\",1); -- 返回2020-05-19,1表示减1天 select date_sub(\"2020-05-20\",-1); -- 返回2020-05-21，-1表示加1天 date_format(DATE|TIMESTAMP|STRING ts, STRING fmt) 解释 将date/timestamp/string类型的值转换为一个具体格式化的字符串。支持java的SimpleDateFormat格式，第二个参数fmt必须是一个常量\n使用案例 select date_format('2020-05-20', 'yyyy'); -- 返回2020 select date_format('2020-05-20', 'MM'); -- 返回05 select date_format('2020-05-20', 'dd'); -- 返回20 -- 返回2020年05月20日 00时00分00秒 select date_format('2020-05-20', 'yyyy年MM月dd日 HH时mm分ss秒') ; select date_format('2020-05-20', 'yy/MM/dd') -- 返回 20/05/20 dayofmonth(STRING date) 解释 返回一个日期或时间的天,与day()函数功能相同\n使用案例 select dayofmonth('2020-05-20') -- 返回20 extract(field FROM source) 时间截取函数 解释 提取 day, dayofweek, hour, minute, month, quarter, second, week 或者year的值，field可以选择day, dayofweek, hour, minute, month, quarter, second, week 或者year，source必须是一个date、timestamp或者可以转为 date 、timestamp的字符串。注意：Hive 2.2.0版本之后支持该函数\n使用案例 select extract(year from '2020-05-20 15:21:34.467'); -- 返回2020，年 select extract(quarter from '2020-05-20 15:21:34.467'); -- 返回2，季度 select extract(month from '2020-05-20 15:21:34.467'); -- 返回05，月份 select extract(week from '2020-05-20 15:21:34.467'); -- 返回21，同weekofyear，一年中的第几周 select extract(dayofweek from '2020-05-20 15:21:34.467'); -- 返回4,代表星期三 select extract(day from '2020-05-20 15:21:34.467'); -- 返回20，天 select extract(hour from '2020-05-20 15:21:34.467'); -- 返回15，小时 select extract(minute from '2020-05-20 15:21:34.467'); -- 返回21，分钟 select extract(second from '2020-05-20 15:21:34.467'); -- 返回34，秒 year(STRING date) 解释 返回时间的年份,可以用extract函数替代\n使用案例 select year('2020-05-20 15:21:34'); -- 返回2020 quarter(DATE|TIMESTAMP|STRING a) 解释 返回给定时间或日期的季度，1至4个季度,可以用extract函数替代\n使用案例 select quarter('2020-05-20 15:21:34'); -- 返回2，第2季度 month(STRING date) 解释 返回时间的月份,可以用extract函数替代\n使用案例 select month('2020-05-20 15:21:34') -- 返回5 day(STRING date), 解释 返回一个日期或者时间的天,可以用extract函数替代\n使用案例 select day(\"2020-05-20\"); -- 返回20 select day(\"2020-05-20 15:05:27.5\"); -- 返回20 hour(STRING date) 解释 返回一个时间的小时,可以用extract函数替代\n使用案例 select hour('2020-05-20 15:21:34');-- 返回15 minute(STRING date) 解释 返回一个时间的分钟值,可以用extract函数替代\n使用案例 select minute('2020-05-20 15:21:34'); -- 返回21 second(STRING date) 解释 返回一个时间的秒,可以用extract函数替代\n使用案例 select second('2020-05-20 15:21:34'); --返回34 from_unixtime(BIGINT unixtime [, STRING format]) 解释 将将Unix时间戳转换为字符串格式的时间(比如yyyy-MM-dd HH:mm:ss格式)\n使用案例 select from_unixtime(1589960708); -- 返回2020-05-20 15:45:08 select from_unixtime(1589960708, 'yyyy-MM-dd hh:mm:ss'); -- -- 返回2020-05-20 15:45:08 select from_unixtime(1589960708, 'yyyy-MM-dd'); -- 返回2020-05-20 from_utc_timestamp(T a, STRING timezone) 解释 转换为特定时区的时间\n使用案例 select from_utc_timestamp('2020-05-20 15:21:34','PST'); -- 返回2020-05-20 08:21:34.0 select from_utc_timestamp('2020-05-20 15:21:34','GMT'); -- 返回2020-05-20 15:21:34.0 select from_utc_timestamp('2020-05-20 15:21:34','UTC'); -- 返回2020-05-20 15:21:34.0 select from_utc_timestamp('2020-05-20 15:21:34','DST'); -- 返回2020-05-20 15:21:34.0 select from_utc_timestamp('2020-05-20 15:21:34','CST'); -- 返回2020-05-20 10:21:34.0 last_day(STRING date) 解释 返回给定时间或日期所在月的最后一天，参数可以是’yyyy-MM-dd HH:mm:ss’ 或者 ‘yyyy-MM-dd’类型，时间部分会被忽略\n使用案例 select last_day('2020-05-20 15:21:34'); -- 返回2020-05-31 select last_day('2020-05-20'); -- 返回2020-05-31 to_date(STRING timestamp) 解释 返回一个字符串时间的日期部分，去掉时间部分，2.1.0之前版本返回的是string，2.1.0版本及之后返回的是date\n使用案例 select to_date('2020-05-20 15:21:34'); -- 返回2020-05-20 select to_date('2020-05-20'); -- 返回2020-05-20 to_utc_timestamp(T a, STRING timezone) 解释 转换为世界标准时间UTC的时间戳,与from_utc_timestamp类似\n使用案例 select to_utc_timestamp('2020-05-20 15:21:34', 'GMT'); -- 返回2020-05-20 15:21:34.0 trunc(STRING date, STRING format) 截取年或月的第一天 解释 截断日期到指定的日期精度，仅支持月（MONTH/MON/MM）或者年（YEAR/YYYY/YY）\n使用案例 select trunc('2020-05-20', 'YY'); -- 返回2020-01-01，返回年的1月1日 select trunc('2020-05-20', 'MM'); -- 返回2020-05-01，返回月的第一天 select trunc('2020-05-20 15:21:34', 'MM'); -- 返回2020-05-01 unix_timestamp([STRING date [, STRING pattern]]) 解释 参数时可选的，当参数为空时，返回当前Unix是时间戳，精确到秒。可以指定一个具体的日期，转换为Unix时间戳格式\n使用案例 -- 返回1589959294 select unix_timestamp('2020-05-20 15:21:34','yyyy-MM-dd hh:mm:ss'); -- 返回1589904000 select unix_timestamp('2020-05-20','yyyy-MM-dd'); weekofyear(STRING date) 解释 返回一个日期或时间在一年中的第几周，可以用extract替代\n使用案例 select weekofyear('2020-05-20 15:21:34'); -- 返回21，第21周 select weekofyear('2020-05-20'); -- 返回21，第21周 next_day(STRING start_date, STRING day_of_week) 解释 参数start_date可以是一个时间或日期，day_of_week表示星期几，比如Mo表示星期一，Tu表示星期二，Wed表示星期三，Thur表示星期四，Fri表示星期五，Sat表示星期六，Sun表示星期日。如果指定的星期几在该日期所在的周且在该日期之后，则返回当周的星期几日期，如果指定的星期几不在该日期所在的周，则返回下一个星期几对应的日期\n使用案例 select next_day('2020-05-20','Mon');-- 返回当前日期的下一个周一日期:2020-05-25 select next_day('2020-05-20','Tu');-- 返回当前日期的下一个周二日期:2020-05-26 select next_day('2020-05-20','Wed');-- 返回当前日期的下一个周三日期:2020-05-27 -- 2020-05-20为周三，指定的参数为周四，所以返回当周的周四就是2020-05-21 select next_day('2020-05-20','Th'); select next_day('2020-05-20','Fri');-- 返回周五日期2020-05-22 select next_day('2020-05-20','Sat'); -- 返回周六日期2020-05-23 select next_day('2020-05-20','Sun'); -- 返回周六日期2020-05-24 该函数比较重要：比如取当前日期所在的周一和周日，通过长用在按周进行汇总数据\nselect date_add(next_day('2020-05-20','MO'),-7); -- 返回当前日期的周一日期2020-05-18 select date_add(next_day('2020-05-20','MO'),-1); -- 返回当前日期的周日日期2020-05-24 months_between(DATE|TIMESTAMP|STRING date1, DATE|TIMESTAMP|STRING date2) 解释 返回 date1 和 date2 的月份差。如果date1大于date2，返回正值，否则返回负值，如果是相减是整数月，则返回一个整数，否则会返回小数\n使用案例 select months_between('2020-05-20','2020-05-20'); -- 返回0 select months_between('2020-05-20','2020-06-20'); -- 返回-1 -- 相差的整数月 select months_between('2020-06-30','2020-05-31'); -- 返回1 -- 非整数月，一个月差一天 select months_between('2020-06-29','2020-05-31'); -- 返回0.93548387 ","wordCount":"3250","inLanguage":"zh","datePublished":"2023-08-22T00:00:00Z","dateModified":"2023-08-29T00:59:17+08:00","author":{"@type":"Person","name":"xkj"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://xiaokunji.com/zh/hadoop%E7%94%9F%E6%80%81%E5%9C%88/Hive/%E5%87%BD%E6%95%B0.html"},"publisher":{"@type":"Organization","name":"米二","logo":{"@type":"ImageObject","url":"https://xiaokunji.com/img/Q.svg"}}}</script></head><body class="dark" id="top"><script>localStorage.getItem("pref-theme")==="light"&&document.body.classList.remove("dark")</script><header class="header"><nav class="nav"><div class="logo"><a accesskey="h" href="https://xiaokunji.com/zh/" title="米二 (Alt + H)"><img alt="" aria-label="logo" height="35" src="https://xiaokunji.com/img/Q.svg"/>米二</a><div class="logo-switches"><button accesskey="t" id="theme-toggle" title="(Alt + T)"><svg fill="none" height="18" id="moon" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"></path></svg><svg fill="none" height="18" id="sun" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><circle cx="12" cy="12" r="5"></circle><line x1="12" x2="12" y1="1" y2="3"></line><line x1="12" x2="12" y1="21" y2="23"></line><line x1="4.22" x2="5.64" y1="4.22" y2="5.64"></line><line x1="18.36" x2="19.78" y1="18.36" y2="19.78"></line><line x1="1" x2="3" y1="12" y2="12"></line><line x1="21" x2="23" y1="12" y2="12"></line><line x1="4.22" x2="5.64" y1="19.78" y2="18.36"></line><line x1="18.36" x2="19.78" y1="5.64" y2="4.22"></line></svg></button><ul class="lang-switch"><li>|</li><li><a aria-label="English" href="https://xiaokunji.com/en/" title="English">English</a></li></ul></div></div><ul id="menu"><li><a href="https://xiaokunji.com/zh/" title="🏠主页"><span>🏠主页</span></a></li><li><a accesskey="/" href="https://xiaokunji.com/zh/search" title="🔍搜索 (Alt + /)"><span>🔍搜索</span></a></li><li><a href="https://xiaokunji.com/zh/post.html" title="📚文章"><span>📚文章</span></a></li><li><a href="https://xiaokunji.com/zh/archives.html" title="⏱时间轴"><span>⏱时间轴</span></a></li><li><a href="https://xiaokunji.com/zh/tags.html" title="🔖标签"><span>🔖标签</span></a></li><li><a href="https://xiaokunji.com/zh/categories.html" title="📖分类"><span>📖分类</span></a></li><li><a href="https://xiaokunji.com/zh/links.html" title="🤝友链"><span>🤝友链</span></a></li></ul></nav></header><main class="main"><article class="post-single"><header class="post-header"><nav aria-label="breadcrumb"><ul><a href="https://xiaokunji.com/zh/">🏠</a> <span>&gt;</span>
<a href="https://xiaokunji.com/zh/hadoop%E7%94%9F%E6%80%81%E5%9C%88.html">hadoop生态圈</a> <span>&gt;</span>
<a href="https://xiaokunji.com/zh/hadoop%E7%94%9F%E6%80%81%E5%9C%88/Hive.html">Hive</a> <span>&gt;</span></ul></nav><h1 class="post-title">函数</h1><div class="post-description"></div><div class="post-meta">创建: <span title="2023-08-22 00:00:00 +0000 UTC">2023-08-22</span> · 更新: 2023-08-29 · xkj
 | 分类:  <ul class="post-categories-meta" style="display:inline"><a href="https://xiaokunji.com/zh/categories/Hadoop%E7%94%9F%E6%80%81%E5%9C%88.html">Hadoop生态圈</a></ul><span id="busuanzi_container_page_pv"> | 访问: <span id="busuanzi_value_page_pv">1</span></span></div></header><aside class="toc-container wide" id="toc-container"><div class="toc"><details open=""><summary accesskey="c" title="(Alt + C)"><span class="details">目录</span></summary><div class="inner"><ul><li><a aria-label="条件函数" href="#%e6%9d%a1%e4%bb%b6%e5%87%bd%e6%95%b0">条件函数</a><ul><li><a aria-label="assert_true(BOOLEAN condition)" href="#assert_trueboolean-condition">assert_true(BOOLEAN condition)</a></li><li><a aria-label="coalesce(T v1, T v2, &amp;hellip;)" href="#coalescet-v1-t-v2-">coalesce(T v1, T v2, &amp;mldr;)</a></li><li><a aria-label="if" href="#if">if</a></li><li><a aria-label="isnotnull(a)" href="#isnotnulla">isnotnull(a)</a></li><li><a aria-label="isnull(a)" href="#isnulla">isnull(a)</a></li><li><a aria-label="nullif(a, b)" href="#nullifa-b">nullif(a, b)</a></li><li><a aria-label="nvl(T value, T default_value)" href="#nvlt-value-t-default_value">nvl(T value, T default_value)</a></li></ul></li><li><a aria-label="日期函数" href="#%e6%97%a5%e6%9c%9f%e5%87%bd%e6%95%b0">日期函数</a><ul><li><a aria-label="add_months" href="#add_months">add_months</a></li><li><a aria-label="current_date" href="#current_date">current_date</a></li><li><a aria-label="current_timestamp()" href="#current_timestamp">current_timestamp()</a></li><li><a aria-label="datediff(STRING enddate, STRING startdate)" href="#datediffstring-enddate-string-startdate">datediff(STRING enddate, STRING startdate)</a></li><li><a aria-label="date_add(DATE startdate, INT days)" href="#date_adddate-startdate-int-days">date_add(DATE startdate, INT days)</a></li><li><a aria-label="date_sub(DATE startdate, INT days)" href="#date_subdate-startdate-int-days">date_sub(DATE startdate, INT days)</a></li><li><a aria-label="date_format(DATE|TIMESTAMP|STRING ts, STRING fmt)" href="#date_formatdatetimestampstring-ts-string-fmt">date_format(DATE|TIMESTAMP|STRING ts, STRING fmt)</a></li><li><a aria-label="dayofmonth(STRING date)" href="#dayofmonthstring-date">dayofmonth(STRING date)</a></li><li><a aria-label="extract(field FROM source) 时间截取函数" href="#extractfield-from-source-%e6%97%b6%e9%97%b4%e6%88%aa%e5%8f%96%e5%87%bd%e6%95%b0">extract(field FROM source) 时间截取函数</a></li><li><a aria-label="year(STRING date)" href="#yearstring-date">year(STRING date)</a></li><li><a aria-label="quarter(DATE|TIMESTAMP|STRING a)" href="#quarterdatetimestampstring-a">quarter(DATE|TIMESTAMP|STRING a)</a></li><li><a aria-label="month(STRING date)" href="#monthstring-date">month(STRING date)</a></li><li><a aria-label="day(STRING date)," href="#daystring-date">day(STRING date),</a></li><li><a aria-label="hour(STRING date)" href="#hourstring-date">hour(STRING date)</a></li><li><a aria-label="minute(STRING date)" href="#minutestring-date">minute(STRING date)</a></li><li><a aria-label="second(STRING date)" href="#secondstring-date">second(STRING date)</a></li><li><a aria-label="from_unixtime(BIGINT unixtime [, STRING format])" href="#from_unixtimebigint-unixtime--string-format">from_unixtime(BIGINT unixtime [, STRING format])</a></li><li><a aria-label="from_utc_timestamp(T a, STRING timezone)" href="#from_utc_timestampt-a-string-timezone">from_utc_timestamp(T a, STRING timezone)</a></li><li><a aria-label="last_day(STRING date)" href="#last_daystring-date">last_day(STRING date)</a></li><li><a aria-label="to_date(STRING timestamp)" href="#to_datestring-timestamp">to_date(STRING timestamp)</a></li><li><a aria-label="to_utc_timestamp(T a, STRING timezone)" href="#to_utc_timestampt-a-string-timezone">to_utc_timestamp(T a, STRING timezone)</a></li><li><a aria-label="trunc(STRING date, STRING format)  截取年或月的第一天" href="#truncstring-date-string-format--%e6%88%aa%e5%8f%96%e5%b9%b4%e6%88%96%e6%9c%88%e7%9a%84%e7%ac%ac%e4%b8%80%e5%a4%a9">trunc(STRING date, STRING format) 截取年或月的第一天</a></li><li><a aria-label="unix_timestamp([STRING date [, STRING pattern]])" href="#unix_timestampstring-date--string-pattern">unix_timestamp([STRING date [, STRING pattern]])</a></li><li><a aria-label="weekofyear(STRING date)" href="#weekofyearstring-date">weekofyear(STRING date)</a></li><li><a aria-label="next_day(STRING start_date, STRING day_of_week)" href="#next_daystring-start_date-string-day_of_week">next_day(STRING start_date, STRING day_of_week)</a></li><li><a aria-label="months_between(DATE|TIMESTAMP|STRING date1, DATE|TIMESTAMP|STRING date2)" href="#months_betweendatetimestampstring-date1-datetimestampstring-date2">months_between(DATE|TIMESTAMP|STRING date1, DATE|TIMESTAMP|STRING date2)</a></li></ul></li></ul></div></details></div></aside><script>let activeElement,elements;window.addEventListener("DOMContentLoaded",function(){checkTocPosition(),elements=document.querySelectorAll("h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]"),activeElement=elements[0];const t=encodeURI(activeElement.getAttribute("id")).toLowerCase();document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active")},!1),window.addEventListener("resize",function(){checkTocPosition()},!1),window.addEventListener("scroll",()=>{activeElement=Array.from(elements).find(e=>{if(getOffsetTop(e)-window.pageYOffset>0&&getOffsetTop(e)-window.pageYOffset<window.innerHeight/2)return e})||activeElement,elements.forEach(e=>{const t=encodeURI(e.getAttribute("id")).toLowerCase();e===activeElement?document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active"):document.querySelector(`.inner ul li a[href="#${t}"]`).classList.remove("active")})},!1);const main=parseInt(getComputedStyle(document.body).getPropertyValue("--article-width"),10),toc=parseInt(getComputedStyle(document.body).getPropertyValue("--toc-width"),10),gap=parseInt(getComputedStyle(document.body).getPropertyValue("--gap"),10);function checkTocPosition(){const e=document.body.scrollWidth;e-main-toc*2-gap*4>0?document.getElementById("toc-container").classList.add("wide"):document.getElementById("toc-container").classList.remove("wide")}function getOffsetTop(e){if(!e.getClientRects().length)return 0;let t=e.getBoundingClientRect(),n=e.ownerDocument.defaultView;return t.top+n.pageYOffset}</script><div class="post-content"><p>[toc]</p><h2 id="条件函数">条件函数<a aria-hidden="true" class="anchor" hidden="" href="#条件函数">#</a></h2><h3 id="assert_trueboolean-condition">assert_true(BOOLEAN condition)<a aria-hidden="true" class="anchor" hidden="" href="#assert_trueboolean-condition">#</a></h3><ul><li>解释</li></ul><p>如果condition不为true，则抛出异常，否则返回null</p><ul><li>使用案例</li></ul><div class="highlight"><pre style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4" tabindex="0"><code class="language-fallback" data-lang="fallback"><span style="display:flex"><span>select assert_true(1&lt;2) -- 返回null
</span></span><span style="display:flex"><span>select assert_true(1&gt;2) -- 抛出异常
</span></span></code></pre></div><h3 id="coalescet-v1-t-v2-">coalesce(T v1, T v2, &amp;mldr;)<a aria-hidden="true" class="anchor" hidden="" href="#coalescet-v1-t-v2-">#</a></h3><ul><li>解释</li></ul><p>返回第一个不为null的值，如果都为null，则返回null</p><ul><li>使用案例</li></ul><div class="highlight"><pre style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4" tabindex="0"><code class="language-fallback" data-lang="fallback"><span style="display:flex"><span>select coalesce(null,1,2,null)  -- 返回1
</span></span><span style="display:flex"><span>select coalesce(1,null) -- 返回1
</span></span><span style="display:flex"><span>select coalesce(null,null) -- 返回null
</span></span></code></pre></div><h3 id="if">if<a aria-hidden="true" class="anchor" hidden="" href="#if">#</a></h3><p>if ( BOOLEAN testCondition, T valueTrue , T valueFalseOrNull )</p><ul><li>解释</li></ul><p>如果testCondition条件为true，则返回第一个值，否则返回第二个值</p><ul><li>使用案例</li></ul><div class="highlight"><pre style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4" tabindex="0"><code class="language-fallback" data-lang="fallback"><span style="display:flex"><span>select if(1 is null,0,1)  -- 返回1
</span></span><span style="display:flex"><span>select if(null is null,0,1) -- 返回0
</span></span></code></pre></div><h3 id="isnotnulla">isnotnull(a)<a aria-hidden="true" class="anchor" hidden="" href="#isnotnulla">#</a></h3><ul><li>解释</li></ul><p>如果参数a不为null，则返回true，否则返回false</p><ul><li>使用案例</li></ul><div class="highlight"><pre style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4" tabindex="0"><code class="language-fallback" data-lang="fallback"><span style="display:flex"><span>select isnotnull(1) -- 返回true
</span></span><span style="display:flex"><span>select isnotnull(null) -- 返回false
</span></span></code></pre></div><h3 id="isnulla">isnull(a)<a aria-hidden="true" class="anchor" hidden="" href="#isnulla">#</a></h3><ul><li>解释</li></ul><p>与isnotnull相反，如果参数a为null，则返回true，否则返回false</p><ul><li>使用案例</li></ul><div class="highlight"><pre style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4" tabindex="0"><code class="language-fallback" data-lang="fallback"><span style="display:flex"><span>select isnull(null) -- 返回true
</span></span><span style="display:flex"><span>select isnull(1) -- 返回false
</span></span></code></pre></div><h3 id="nullifa-b">nullif(a, b)<a aria-hidden="true" class="anchor" hidden="" href="#nullifa-b">#</a></h3><ul><li>解释</li></ul><p>如果参数a=b，返回null，否则返回a值(Hive2.2.0版本)</p><ul><li>使用案例</li></ul><div class="highlight"><pre style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4" tabindex="0"><code class="language-fallback" data-lang="fallback"><span style="display:flex"><span>select nullif(1,2) -- 返回1
</span></span><span style="display:flex"><span>select nullif(1,1) -- 返回null
</span></span></code></pre></div><h3 id="nvlt-value-t-default_value">nvl(T value, T default_value)<a aria-hidden="true" class="anchor" hidden="" href="#nvlt-value-t-default_value">#</a></h3><ul><li>解释</li></ul><p>如果value的值为null，则返回default_value默认值，否则返回value的值。在null值判断时，可以使用if函数给定默认值，也可以使用此函数给定默认值，使用该函数sql特别简洁。</p><ul><li>使用案例</li></ul><div class="highlight"><pre style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4" tabindex="0"><code class="language-fallback" data-lang="fallback"><span style="display:flex"><span>select nvl(1,0) -- 返回1
</span></span><span style="display:flex"><span>select nvl(null,0) -- 返回0
</span></span></code></pre></div><h2 id="日期函数">日期函数<a aria-hidden="true" class="anchor" hidden="" href="#日期函数">#</a></h2><h3 id="add_months">add_months<a aria-hidden="true" class="anchor" hidden="" href="#add_months">#</a></h3><p>add_month( DATE | STRING | TIMESTAMP start_date , INT num_months)</p><ul><li>解释</li></ul><p>start_date参数可以是string, date 或者timestamp类型，num_months参数时int类型。返回一个日期，该日期是在start_date基础之上加上num_months个月，即start_date之后null_months个月的一个日期。如果start_date的时间部分的数据会被忽略。注意：如果start_date所在月份的天数大于结果日期月的天数，则返回结果月的最后一天的日期。</p><ul><li>使用案例</li></ul><div class="highlight"><pre style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4" tabindex="0"><code class="language-fallback" data-lang="fallback"><span style="display:flex"><span>select add_months("2020-05-20",2); -- 返回2020-07-20
</span></span><span style="display:flex"><span>select add_months("2020-05-20",8); -- 返回2021-01-20
</span></span><span style="display:flex"><span>select add_months("2020-05-31",1); -- 返回2020-06-30,5月有31天，6月只有30天，所以返回下一个月的最后一天
</span></span></code></pre></div><h3 id="current_date">current_date<a aria-hidden="true" class="anchor" hidden="" href="#current_date">#</a></h3><ul><li>解释</li></ul><p>返回查询时刻的当前日期</p><ul><li>使用案例</li></ul><div class="highlight"><pre style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4" tabindex="0"><code class="language-fallback" data-lang="fallback"><span style="display:flex"><span>select current_date() -- 返回当前查询日期2020-05-20
</span></span></code></pre></div><h3 id="current_timestamp">current_timestamp()<a aria-hidden="true" class="anchor" hidden="" href="#current_timestamp">#</a></h3><ul><li>解释</li></ul><p>返回查询时刻的当前时间</p><ul><li>使用案例</li></ul><div class="highlight"><pre style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4" tabindex="0"><code class="language-fallback" data-lang="fallback"><span style="display:flex"><span>select current_timestamp() -- 2020-05-20 14:40:47.273
</span></span></code></pre></div><h3 id="datediffstring-enddate-string-startdate">datediff(STRING enddate, STRING startdate)<a aria-hidden="true" class="anchor" hidden="" href="#datediffstring-enddate-string-startdate">#</a></h3><ul><li>解释</li></ul><p>返回开始日期startdate与结束日期enddate之前相差的天数</p><ul><li>使用案例</li></ul><div class="highlight"><pre style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4" tabindex="0"><code class="language-fallback" data-lang="fallback"><span style="display:flex"><span>select datediff("2020-05-20","2020-05-21"); -- 返回-1
</span></span><span style="display:flex"><span>select datediff("2020-05-21","2020-05-20"); -- 返回1
</span></span></code></pre></div><h3 id="date_adddate-startdate-int-days">date_add(DATE startdate, INT days)<a aria-hidden="true" class="anchor" hidden="" href="#date_adddate-startdate-int-days">#</a></h3><ul><li>解释</li></ul><p>在startdate基础上加上几天，然后返回加上几天之后的一个日期</p><ul><li>使用案例</li></ul><div class="highlight"><pre style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4" tabindex="0"><code class="language-fallback" data-lang="fallback"><span style="display:flex"><span>select date_add("2020-05-20",1); -- 返回2020-05-21,1表示加1天
</span></span><span style="display:flex"><span>select date_add("2020-05-20",-1); -- 返回2020-05-19，-1表示减一天
</span></span></code></pre></div><h3 id="date_subdate-startdate-int-days">date_sub(DATE startdate, INT days)<a aria-hidden="true" class="anchor" hidden="" href="#date_subdate-startdate-int-days">#</a></h3><ul><li>解释</li></ul><p>在startdate基础上减去几天，然后返回减去几天之后的一个日期,功能与date_add很类似</p><ul><li>使用案例</li></ul><div class="highlight"><pre style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4" tabindex="0"><code class="language-fallback" data-lang="fallback"><span style="display:flex"><span>select date_sub("2020-05-20",1); -- 返回2020-05-19,1表示减1天
</span></span><span style="display:flex"><span>select date_sub("2020-05-20",-1); -- 返回2020-05-21，-1表示加1天
</span></span></code></pre></div><h3 id="date_formatdatetimestampstring-ts-string-fmt">date_format(DATE|TIMESTAMP|STRING ts, STRING fmt)<a aria-hidden="true" class="anchor" hidden="" href="#date_formatdatetimestampstring-ts-string-fmt">#</a></h3><ul><li>解释</li></ul><p>将date/timestamp/string类型的值转换为一个具体格式化的字符串。支持java的SimpleDateFormat格式，第二个参数fmt必须是一个常量</p><ul><li>使用案例</li></ul><div class="highlight"><pre style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4" tabindex="0"><code class="language-fallback" data-lang="fallback"><span style="display:flex"><span>select date_format('2020-05-20', 'yyyy'); -- 返回2020
</span></span><span style="display:flex"><span>select date_format('2020-05-20', 'MM'); -- 返回05
</span></span><span style="display:flex"><span>select date_format('2020-05-20', 'dd'); -- 返回20
</span></span><span style="display:flex"><span>-- 返回2020年05月20日 00时00分00秒
</span></span><span style="display:flex"><span>select date_format('2020-05-20', 'yyyy年MM月dd日 HH时mm分ss秒') ;
</span></span><span style="display:flex"><span>select date_format('2020-05-20', 'yy/MM/dd') -- 返回 20/05/20
</span></span></code></pre></div><h3 id="dayofmonthstring-date">dayofmonth(STRING date)<a aria-hidden="true" class="anchor" hidden="" href="#dayofmonthstring-date">#</a></h3><ul><li>解释</li></ul><p>返回一个日期或时间的天,与day()函数功能相同</p><ul><li>使用案例</li></ul><div class="highlight"><pre style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4" tabindex="0"><code class="language-fallback" data-lang="fallback"><span style="display:flex"><span>select dayofmonth('2020-05-20') -- 返回20
</span></span></code></pre></div><h3 id="extractfield-from-source-时间截取函数">extract(field FROM source) 时间截取函数<a aria-hidden="true" class="anchor" hidden="" href="#extractfield-from-source-时间截取函数">#</a></h3><ul><li>解释</li></ul><p>提取 day, dayofweek, hour, minute, month, quarter, second, week 或者year的值，field可以选择day, dayofweek, hour, minute, month, quarter, second, week 或者year，source必须是一个date、timestamp或者可以转为 date 、timestamp的字符串。注意：Hive 2.2.0版本之后支持该函数</p><ul><li>使用案例</li></ul><div class="highlight"><pre style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4" tabindex="0"><code class="language-fallback" data-lang="fallback"><span style="display:flex"><span>select extract(year from '2020-05-20 15:21:34.467'); -- 返回2020，年
</span></span><span style="display:flex"><span>select extract(quarter from '2020-05-20 15:21:34.467'); -- 返回2，季度
</span></span><span style="display:flex"><span>select extract(month from '2020-05-20 15:21:34.467'); -- 返回05，月份
</span></span><span style="display:flex"><span>select extract(week from '2020-05-20 15:21:34.467'); -- 返回21，同weekofyear，一年中的第几周
</span></span><span style="display:flex"><span>select extract(dayofweek from '2020-05-20 15:21:34.467'); -- 返回4,代表星期三
</span></span><span style="display:flex"><span>select extract(day from '2020-05-20 15:21:34.467'); -- 返回20，天
</span></span><span style="display:flex"><span>select extract(hour from '2020-05-20 15:21:34.467'); -- 返回15，小时
</span></span><span style="display:flex"><span>select extract(minute from '2020-05-20 15:21:34.467'); -- 返回21，分钟
</span></span><span style="display:flex"><span>select extract(second from '2020-05-20 15:21:34.467'); -- 返回34，秒
</span></span></code></pre></div><h3 id="yearstring-date">year(STRING date)<a aria-hidden="true" class="anchor" hidden="" href="#yearstring-date">#</a></h3><ul><li>解释</li></ul><p>返回时间的年份,可以用extract函数替代</p><ul><li>使用案例</li></ul><div class="highlight"><pre style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4" tabindex="0"><code class="language-fallback" data-lang="fallback"><span style="display:flex"><span>select year('2020-05-20 15:21:34'); -- 返回2020
</span></span></code></pre></div><h3 id="quarterdatetimestampstring-a">quarter(DATE|TIMESTAMP|STRING a)<a aria-hidden="true" class="anchor" hidden="" href="#quarterdatetimestampstring-a">#</a></h3><ul><li>解释</li></ul><p>返回给定时间或日期的季度，1至4个季度,可以用extract函数替代</p><ul><li>使用案例</li></ul><div class="highlight"><pre style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4" tabindex="0"><code class="language-fallback" data-lang="fallback"><span style="display:flex"><span>select quarter('2020-05-20 15:21:34'); -- 返回2，第2季度
</span></span></code></pre></div><h3 id="monthstring-date">month(STRING date)<a aria-hidden="true" class="anchor" hidden="" href="#monthstring-date">#</a></h3><ul><li>解释</li></ul><p>返回时间的月份,可以用extract函数替代</p><ul><li>使用案例</li></ul><div class="highlight"><pre style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4" tabindex="0"><code class="language-fallback" data-lang="fallback"><span style="display:flex"><span>select month('2020-05-20 15:21:34') -- 返回5
</span></span></code></pre></div><h3 id="daystring-date">day(STRING date),<a aria-hidden="true" class="anchor" hidden="" href="#daystring-date">#</a></h3><ul><li>解释</li></ul><p>返回一个日期或者时间的天,可以用extract函数替代</p><ul><li>使用案例</li></ul><div class="highlight"><pre style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4" tabindex="0"><code class="language-fallback" data-lang="fallback"><span style="display:flex"><span>select day("2020-05-20"); -- 返回20
</span></span><span style="display:flex"><span>select day("2020-05-20 15:05:27.5"); -- 返回20
</span></span></code></pre></div><h3 id="hourstring-date">hour(STRING date)<a aria-hidden="true" class="anchor" hidden="" href="#hourstring-date">#</a></h3><ul><li>解释</li></ul><p>返回一个时间的小时,可以用extract函数替代</p><ul><li>使用案例</li></ul><div class="highlight"><pre style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4" tabindex="0"><code class="language-fallback" data-lang="fallback"><span style="display:flex"><span>select hour('2020-05-20 15:21:34');-- 返回15
</span></span></code></pre></div><h3 id="minutestring-date">minute(STRING date)<a aria-hidden="true" class="anchor" hidden="" href="#minutestring-date">#</a></h3><ul><li>解释</li></ul><p>返回一个时间的分钟值,可以用extract函数替代</p><ul><li>使用案例</li></ul><div class="highlight"><pre style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4" tabindex="0"><code class="language-fallback" data-lang="fallback"><span style="display:flex"><span>select minute('2020-05-20 15:21:34'); -- 返回21
</span></span></code></pre></div><h3 id="secondstring-date">second(STRING date)<a aria-hidden="true" class="anchor" hidden="" href="#secondstring-date">#</a></h3><ul><li>解释</li></ul><p>返回一个时间的秒,可以用extract函数替代</p><ul><li>使用案例</li></ul><div class="highlight"><pre style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4" tabindex="0"><code class="language-fallback" data-lang="fallback"><span style="display:flex"><span>select second('2020-05-20 15:21:34'); --返回34
</span></span></code></pre></div><h3 id="from_unixtimebigint-unixtime--string-format">from_unixtime(BIGINT unixtime [, STRING format])<a aria-hidden="true" class="anchor" hidden="" href="#from_unixtimebigint-unixtime--string-format">#</a></h3><ul><li>解释</li></ul><p>将将Unix时间戳转换为字符串格式的时间(比如yyyy-MM-dd HH:mm:ss格式)</p><ul><li>使用案例</li></ul><div class="highlight"><pre style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4" tabindex="0"><code class="language-fallback" data-lang="fallback"><span style="display:flex"><span>select from_unixtime(1589960708); -- 返回2020-05-20 15:45:08
</span></span><span style="display:flex"><span>select from_unixtime(1589960708, 'yyyy-MM-dd hh:mm:ss'); -- -- 返回2020-05-20 15:45:08
</span></span><span style="display:flex"><span>select from_unixtime(1589960708, 'yyyy-MM-dd'); -- 返回2020-05-20
</span></span></code></pre></div><h3 id="from_utc_timestampt-a-string-timezone">from_utc_timestamp(T a, STRING timezone)<a aria-hidden="true" class="anchor" hidden="" href="#from_utc_timestampt-a-string-timezone">#</a></h3><ul><li>解释</li></ul><p>转换为特定时区的时间</p><ul><li>使用案例</li></ul><div class="highlight"><pre style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4" tabindex="0"><code class="language-fallback" data-lang="fallback"><span style="display:flex"><span>select from_utc_timestamp('2020-05-20 15:21:34','PST'); -- 返回2020-05-20 08:21:34.0
</span></span><span style="display:flex"><span>select from_utc_timestamp('2020-05-20 15:21:34','GMT'); -- 返回2020-05-20 15:21:34.0
</span></span><span style="display:flex"><span>select from_utc_timestamp('2020-05-20 15:21:34','UTC'); -- 返回2020-05-20 15:21:34.0
</span></span><span style="display:flex"><span>select from_utc_timestamp('2020-05-20 15:21:34','DST'); -- 返回2020-05-20 15:21:34.0
</span></span><span style="display:flex"><span>select from_utc_timestamp('2020-05-20 15:21:34','CST'); -- 返回2020-05-20 10:21:34.0
</span></span></code></pre></div><h3 id="last_daystring-date">last_day(STRING date)<a aria-hidden="true" class="anchor" hidden="" href="#last_daystring-date">#</a></h3><ul><li>解释</li></ul><p>返回给定时间或日期所在月的最后一天，参数可以是’yyyy-MM-dd HH:mm:ss’ 或者 ‘yyyy-MM-dd’类型，时间部分会被忽略</p><ul><li>使用案例</li></ul><div class="highlight"><pre style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4" tabindex="0"><code class="language-fallback" data-lang="fallback"><span style="display:flex"><span>select last_day('2020-05-20 15:21:34'); -- 返回2020-05-31
</span></span><span style="display:flex"><span>select last_day('2020-05-20'); -- 返回2020-05-31 
</span></span></code></pre></div><h3 id="to_datestring-timestamp">to_date(STRING timestamp)<a aria-hidden="true" class="anchor" hidden="" href="#to_datestring-timestamp">#</a></h3><ul><li>解释</li></ul><p>返回一个字符串时间的日期部分，去掉时间部分，2.1.0之前版本返回的是string，2.1.0版本及之后返回的是date</p><ul><li>使用案例</li></ul><div class="highlight"><pre style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4" tabindex="0"><code class="language-fallback" data-lang="fallback"><span style="display:flex"><span>select to_date('2020-05-20 15:21:34'); -- 返回2020-05-20
</span></span><span style="display:flex"><span>select to_date('2020-05-20'); -- 返回2020-05-20
</span></span></code></pre></div><h3 id="to_utc_timestampt-a-string-timezone">to_utc_timestamp(T a, STRING timezone)<a aria-hidden="true" class="anchor" hidden="" href="#to_utc_timestampt-a-string-timezone">#</a></h3><ul><li>解释</li></ul><p>转换为世界标准时间UTC的时间戳,与from_utc_timestamp类似</p><ul><li>使用案例</li></ul><div class="highlight"><pre style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4" tabindex="0"><code class="language-fallback" data-lang="fallback"><span style="display:flex"><span>select to_utc_timestamp('2020-05-20 15:21:34', 'GMT'); -- 返回2020-05-20 15:21:34.0
</span></span></code></pre></div><h3 id="truncstring-date-string-format--截取年或月的第一天">trunc(STRING date, STRING format) 截取年或月的第一天<a aria-hidden="true" class="anchor" hidden="" href="#truncstring-date-string-format--截取年或月的第一天">#</a></h3><ul><li>解释</li></ul><p>截断日期到指定的日期精度，仅支持月（MONTH/MON/MM）或者年（YEAR/YYYY/YY）</p><ul><li>使用案例</li></ul><div class="highlight"><pre style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4" tabindex="0"><code class="language-fallback" data-lang="fallback"><span style="display:flex"><span>select trunc('2020-05-20', 'YY');   -- 返回2020-01-01，返回年的1月1日
</span></span><span style="display:flex"><span>select trunc('2020-05-20', 'MM');   -- 返回2020-05-01，返回月的第一天
</span></span><span style="display:flex"><span>select trunc('2020-05-20 15:21:34', 'MM');   -- 返回2020-05-01
</span></span></code></pre></div><h3 id="unix_timestampstring-date--string-pattern">unix_timestamp([STRING date [, STRING pattern]])<a aria-hidden="true" class="anchor" hidden="" href="#unix_timestampstring-date--string-pattern">#</a></h3><ul><li>解释</li></ul><p>参数时可选的，当参数为空时，返回当前Unix是时间戳，精确到秒。可以指定一个具体的日期，转换为Unix时间戳格式</p><ul><li>使用案例</li></ul><div class="highlight"><pre style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4" tabindex="0"><code class="language-fallback" data-lang="fallback"><span style="display:flex"><span>-- 返回1589959294
</span></span><span style="display:flex"><span>select unix_timestamp('2020-05-20 15:21:34','yyyy-MM-dd hh:mm:ss');
</span></span><span style="display:flex"><span>-- 返回1589904000
</span></span><span style="display:flex"><span>select unix_timestamp('2020-05-20','yyyy-MM-dd');
</span></span></code></pre></div><h3 id="weekofyearstring-date">weekofyear(STRING date)<a aria-hidden="true" class="anchor" hidden="" href="#weekofyearstring-date">#</a></h3><ul><li>解释</li></ul><p>返回一个日期或时间在一年中的第几周，可以用extract替代</p><ul><li>使用案例</li></ul><div class="highlight"><pre style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4" tabindex="0"><code class="language-fallback" data-lang="fallback"><span style="display:flex"><span>select weekofyear('2020-05-20 15:21:34'); -- 返回21，第21周
</span></span><span style="display:flex"><span>select weekofyear('2020-05-20'); -- 返回21，第21周
</span></span></code></pre></div><h3 id="next_daystring-start_date-string-day_of_week">next_day(STRING start_date, STRING day_of_week)<a aria-hidden="true" class="anchor" hidden="" href="#next_daystring-start_date-string-day_of_week">#</a></h3><ul><li>解释</li></ul><p>参数start_date可以是一个时间或日期，day_of_week表示星期几，比如Mo表示星期一，Tu表示星期二，Wed表示星期三，Thur表示星期四，Fri表示星期五，Sat表示星期六，Sun表示星期日。如果指定的星期几在该日期所在的周且在该日期之后，则返回当周的星期几日期，如果指定的星期几不在该日期所在的周，则返回下一个星期几对应的日期</p><ul><li>使用案例</li></ul><div class="highlight"><pre style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4" tabindex="0"><code class="language-fallback" data-lang="fallback"><span style="display:flex"><span>select next_day('2020-05-20','Mon');-- 返回当前日期的下一个周一日期:2020-05-25
</span></span><span style="display:flex"><span>select next_day('2020-05-20','Tu');-- 返回当前日期的下一个周二日期:2020-05-26
</span></span><span style="display:flex"><span>select next_day('2020-05-20','Wed');-- 返回当前日期的下一个周三日期:2020-05-27
</span></span><span style="display:flex"><span>-- 2020-05-20为周三，指定的参数为周四，所以返回当周的周四就是2020-05-21
</span></span><span style="display:flex"><span>select next_day('2020-05-20','Th');
</span></span><span style="display:flex"><span>select next_day('2020-05-20','Fri');-- 返回周五日期2020-05-22
</span></span><span style="display:flex"><span>select next_day('2020-05-20','Sat'); -- 返回周六日期2020-05-23
</span></span><span style="display:flex"><span>select next_day('2020-05-20','Sun'); -- 返回周六日期2020-05-24
</span></span></code></pre></div><p>该函数比较重要：比如取当前日期所在的周一和周日，通过长用在按周进行汇总数据</p><div class="highlight"><pre style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4" tabindex="0"><code class="language-fallback" data-lang="fallback"><span style="display:flex"><span>select date_add(next_day('2020-05-20','MO'),-7); -- 返回当前日期的周一日期2020-05-18
</span></span><span style="display:flex"><span>select date_add(next_day('2020-05-20','MO'),-1); -- 返回当前日期的周日日期2020-05-24
</span></span></code></pre></div><h3 id="months_betweendatetimestampstring-date1-datetimestampstring-date2">months_between(DATE|TIMESTAMP|STRING date1, DATE|TIMESTAMP|STRING date2)<a aria-hidden="true" class="anchor" hidden="" href="#months_betweendatetimestampstring-date1-datetimestampstring-date2">#</a></h3><ul><li>解释</li></ul><p>返回 date1 和 date2 的月份差。如果date1大于date2，返回正值，否则返回负值，如果是相减是整数月，则返回一个整数，否则会返回小数</p><ul><li>使用案例</li></ul><div class="highlight"><pre style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4" tabindex="0"><code class="language-fallback" data-lang="fallback"><span style="display:flex"><span>select months_between('2020-05-20','2020-05-20'); -- 返回0
</span></span><span style="display:flex"><span>select months_between('2020-05-20','2020-06-20'); -- 返回-1
</span></span><span style="display:flex"><span>-- 相差的整数月
</span></span><span style="display:flex"><span>select months_between('2020-06-30','2020-05-31'); -- 返回1
</span></span><span style="display:flex"><span>-- 非整数月，一个月差一天
</span></span><span style="display:flex"><span>select months_between('2020-06-29','2020-05-31'); -- 返回0.93548387
</span></span></code></pre></div></div><footer class="post-footer"><ul class="post-tags"><li><a href="https://xiaokunji.com/zh/tags/Hive.html">Hive</a></li><li><a href="https://xiaokunji.com/zh/tags/Hadoop%E7%94%9F%E6%80%81%E5%9C%88.html">Hadoop生态圈</a></li></ul></footer></article></main><script async="" src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><footer class="footer"><span>Copyright
©
-2024
<a href="https://xiaokunji.com/zh/" style="color:#939393">米二</a>
All Rights Reserved</span>
<span id="busuanzi_container"><span class="fa fa-user">用户数:</span><span id="busuanzi_value_site_uv"></span>
<span class="fa fa-eye">访问数:</span><span id="busuanzi_value_site_pv"></span></span></footer><a accesskey="g" aria-label="go to top" class="top-link" href="#top" id="top-link" title="Go to Top (Alt + G)"><svg fill="currentcolor" viewbox="0 0 12 6" xmlns="http://www.w3.org/2000/svg"><path d="M12 6H0l6-6z"></path></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="复制";function s(){t.innerHTML="已复制！",setTimeout(()=>{t.innerHTML="复制"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>