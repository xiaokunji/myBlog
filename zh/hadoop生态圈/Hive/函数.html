<!doctype html><html lang=zh dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>函数 | 米二</title><meta name=keywords content=" 条件函数, assert_true(BOOLEAN condition), coalesce(T v1,T v2,...), if, isnotnull(a), isnull(a), nullif(a,b), nvl(T value,T default_value), 日期函数, add_months, current_date, current_timestamp(), datediff(STRING enddate,STRING startdate), date_add(DATE startdate,INT days), date_sub(DATE startdate,INT days), date_format(DATE|TIMESTAMP|STRING ts,STRING fmt), dayofmonth(STRING date), extract(field FROM source) 时间截取函数, year(STRING date), quarter(DATE|TIMESTAMP|STRING a), month(STRING date), day(STRING date),, hour(STRING date), minute(STRING date), second(STRING date), from_unixtime(BIGINT unixtime [,STRING format]), from_utc_timestamp(T a,STRING timezone), last_day(STRING date), to_date(STRING timestamp), to_utc_timestamp(T a,STRING timezone), trunc(STRING date,STRING format)  截取年或月的第一天, unix_timestamp([STRING date [,STRING pattern]]), weekofyear(STRING date), next_day(STRING start_date,STRING day_of_week), months_between(DATE|TIMESTAMP|STRING date1,DATE|TIMESTAMP|STRING date2)"><meta name=description content="     "><meta name=author content="xkj"><link rel=canonical href=https://xiaokunji.com/zh/hadoop%E7%94%9F%E6%80%81%E5%9C%88/Hive/%E5%87%BD%E6%95%B0.html><link crossorigin=anonymous href=/assets/css/stylesheet.b3faf608c544858ba700943ffe182cb647f38432d29a07d73234965beacb26f6.css integrity="sha256-s/r2CMVEhYunAJQ//hgstkfzhDLSmgfXMjSWW+rLJvY=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://xiaokunji.com/img/Q.svg><link rel=icon type=image/png sizes=16x16 href=https://xiaokunji.com/img/Q.svg><link rel=icon type=image/png sizes=32x32 href=https://xiaokunji.com/img/Q.svg><link rel=apple-touch-icon href=https://xiaokunji.com/Q.svg><link rel=mask-icon href=https://xiaokunji.com/Q.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=zh href=https://xiaokunji.com/zh/hadoop%E7%94%9F%E6%80%81%E5%9C%88/Hive/%E5%87%BD%E6%95%B0.html><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><meta property="og:title" content="函数"><meta property="og:description" content="     "><meta property="og:type" content="article"><meta property="og:url" content="https://xiaokunji.com/zh/hadoop%E7%94%9F%E6%80%81%E5%9C%88/Hive/%E5%87%BD%E6%95%B0.html"><meta property="article:section" content="hadoop生态圈"><meta property="article:published_time" content="2023-08-22T00:00:00+00:00"><meta property="article:modified_time" content="2023-09-04T11:19:09+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="函数"><meta name=twitter:description content="     "><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":4,"name":"函数","item":"https://xiaokunji.com/zh/hadoop%E7%94%9F%E6%80%81%E5%9C%88/Hive/%E5%87%BD%E6%95%B0.html"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"函数","name":"函数","description":"     ","keywords":[" 条件函数"," assert_true(BOOLEAN condition)"," coalesce(T v1, T v2, ...)"," if"," isnotnull(a)"," isnull(a)"," nullif(a, b)"," nvl(T value, T default_value)"," 日期函数"," add_months"," current_date"," current_timestamp()"," datediff(STRING enddate, STRING startdate)"," date_add(DATE startdate, INT days)"," date_sub(DATE startdate, INT days)"," date_format(DATE|TIMESTAMP|STRING ts, STRING fmt)"," dayofmonth(STRING date)"," extract(field FROM source) 时间截取函数"," year(STRING date)"," quarter(DATE|TIMESTAMP|STRING a)"," month(STRING date)"," day(STRING date),"," hour(STRING date)"," minute(STRING date)"," second(STRING date)"," from_unixtime(BIGINT unixtime [, STRING format])"," from_utc_timestamp(T a, STRING timezone)"," last_day(STRING date)"," to_date(STRING timestamp)"," to_utc_timestamp(T a, STRING timezone)"," trunc(STRING date, STRING format)  截取年或月的第一天"," unix_timestamp([STRING date [, STRING pattern]])"," weekofyear(STRING date)"," next_day(STRING start_date, STRING day_of_week)"," months_between(DATE|TIMESTAMP|STRING date1, DATE|TIMESTAMP|STRING date2)"],"articleBody":"[toc]\n条件函数 assert_true(BOOLEAN condition) 解释 如果condition不为true，则抛出异常，否则返回null\n使用案例 select assert_true(1\u003c2) -- 返回null select assert_true(1\u003e2) -- 抛出异常 coalesce(T v1, T v2, …) 解释 返回第一个不为null的值，如果都为null，则返回null\n使用案例 select coalesce(null,1,2,null) -- 返回1 select coalesce(1,null) -- 返回1 select coalesce(null,null) -- 返回null if if ( BOOLEAN testCondition, T valueTrue , T valueFalseOrNull )\n解释 如果testCondition条件为true，则返回第一个值，否则返回第二个值\n使用案例 select if(1 is null,0,1) -- 返回1 select if(null is null,0,1) -- 返回0 isnotnull(a) 解释 如果参数a不为null，则返回true，否则返回false\n使用案例 select isnotnull(1) -- 返回true select isnotnull(null) -- 返回false isnull(a) 解释 与isnotnull相反，如果参数a为null，则返回true，否则返回false\n使用案例 select isnull(null) -- 返回true select isnull(1) -- 返回false nullif(a, b) 解释 如果参数a=b，返回null，否则返回a值(Hive2.2.0版本)\n使用案例 select nullif(1,2) -- 返回1 select nullif(1,1) -- 返回null nvl(T value, T default_value) 解释 如果value的值为null，则返回default_value默认值，否则返回value的值。在null值判断时，可以使用if函数给定默认值，也可以使用此函数给定默认值，使用该函数sql特别简洁。\n使用案例 select nvl(1,0) -- 返回1 select nvl(null,0) -- 返回0 日期函数 add_months add_month( DATE | STRING | TIMESTAMP start_date , INT num_months)\n解释 start_date参数可以是string, date 或者timestamp类型，num_months参数时int类型。返回一个日期，该日期是在start_date基础之上加上num_months个月，即start_date之后null_months个月的一个日期。如果start_date的时间部分的数据会被忽略。注意：如果start_date所在月份的天数大于结果日期月的天数，则返回结果月的最后一天的日期。\n使用案例 select add_months(\"2020-05-20\",2); -- 返回2020-07-20 select add_months(\"2020-05-20\",8); -- 返回2021-01-20 select add_months(\"2020-05-31\",1); -- 返回2020-06-30,5月有31天，6月只有30天，所以返回下一个月的最后一天 current_date 解释 返回查询时刻的当前日期\n使用案例 select current_date() -- 返回当前查询日期2020-05-20 current_timestamp() 解释 返回查询时刻的当前时间\n使用案例 select current_timestamp() -- 2020-05-20 14:40:47.273 datediff(STRING enddate, STRING startdate) 解释 返回开始日期startdate与结束日期enddate之前相差的天数\n使用案例 select datediff(\"2020-05-20\",\"2020-05-21\"); -- 返回-1 select datediff(\"2020-05-21\",\"2020-05-20\"); -- 返回1 date_add(DATE startdate, INT days) 解释 在startdate基础上加上几天，然后返回加上几天之后的一个日期\n使用案例 select date_add(\"2020-05-20\",1); -- 返回2020-05-21,1表示加1天 select date_add(\"2020-05-20\",-1); -- 返回2020-05-19，-1表示减一天 date_sub(DATE startdate, INT days) 解释 在startdate基础上减去几天，然后返回减去几天之后的一个日期,功能与date_add很类似\n使用案例 select date_sub(\"2020-05-20\",1); -- 返回2020-05-19,1表示减1天 select date_sub(\"2020-05-20\",-1); -- 返回2020-05-21，-1表示加1天 date_format(DATE|TIMESTAMP|STRING ts, STRING fmt) 解释 将date/timestamp/string类型的值转换为一个具体格式化的字符串。支持java的SimpleDateFormat格式，第二个参数fmt必须是一个常量\n使用案例 select date_format('2020-05-20', 'yyyy'); -- 返回2020 select date_format('2020-05-20', 'MM'); -- 返回05 select date_format('2020-05-20', 'dd'); -- 返回20 -- 返回2020年05月20日 00时00分00秒 select date_format('2020-05-20', 'yyyy年MM月dd日 HH时mm分ss秒') ; select date_format('2020-05-20', 'yy/MM/dd') -- 返回 20/05/20 dayofmonth(STRING date) 解释 返回一个日期或时间的天,与day()函数功能相同\n使用案例 select dayofmonth('2020-05-20') -- 返回20 extract(field FROM source) 时间截取函数 解释 提取 day, dayofweek, hour, minute, month, quarter, second, week 或者year的值，field可以选择day, dayofweek, hour, minute, month, quarter, second, week 或者year，source必须是一个date、timestamp或者可以转为 date 、timestamp的字符串。注意：Hive 2.2.0版本之后支持该函数\n使用案例 select extract(year from '2020-05-20 15:21:34.467'); -- 返回2020，年 select extract(quarter from '2020-05-20 15:21:34.467'); -- 返回2，季度 select extract(month from '2020-05-20 15:21:34.467'); -- 返回05，月份 select extract(week from '2020-05-20 15:21:34.467'); -- 返回21，同weekofyear，一年中的第几周 select extract(dayofweek from '2020-05-20 15:21:34.467'); -- 返回4,代表星期三 select extract(day from '2020-05-20 15:21:34.467'); -- 返回20，天 select extract(hour from '2020-05-20 15:21:34.467'); -- 返回15，小时 select extract(minute from '2020-05-20 15:21:34.467'); -- 返回21，分钟 select extract(second from '2020-05-20 15:21:34.467'); -- 返回34，秒 year(STRING date) 解释 返回时间的年份,可以用extract函数替代\n使用案例 select year('2020-05-20 15:21:34'); -- 返回2020 quarter(DATE|TIMESTAMP|STRING a) 解释 返回给定时间或日期的季度，1至4个季度,可以用extract函数替代\n使用案例 select quarter('2020-05-20 15:21:34'); -- 返回2，第2季度 month(STRING date) 解释 返回时间的月份,可以用extract函数替代\n使用案例 select month('2020-05-20 15:21:34') -- 返回5 day(STRING date), 解释 返回一个日期或者时间的天,可以用extract函数替代\n使用案例 select day(\"2020-05-20\"); -- 返回20 select day(\"2020-05-20 15:05:27.5\"); -- 返回20 hour(STRING date) 解释 返回一个时间的小时,可以用extract函数替代\n使用案例 select hour('2020-05-20 15:21:34');-- 返回15 minute(STRING date) 解释 返回一个时间的分钟值,可以用extract函数替代\n使用案例 select minute('2020-05-20 15:21:34'); -- 返回21 second(STRING date) 解释 返回一个时间的秒,可以用extract函数替代\n使用案例 select second('2020-05-20 15:21:34'); --返回34 from_unixtime(BIGINT unixtime [, STRING format]) 解释 将将Unix时间戳转换为字符串格式的时间(比如yyyy-MM-dd HH:mm:ss格式)\n使用案例 select from_unixtime(1589960708); -- 返回2020-05-20 15:45:08 select from_unixtime(1589960708, 'yyyy-MM-dd hh:mm:ss'); -- -- 返回2020-05-20 15:45:08 select from_unixtime(1589960708, 'yyyy-MM-dd'); -- 返回2020-05-20 from_utc_timestamp(T a, STRING timezone) 解释 转换为特定时区的时间\n使用案例 select from_utc_timestamp('2020-05-20 15:21:34','PST'); -- 返回2020-05-20 08:21:34.0 select from_utc_timestamp('2020-05-20 15:21:34','GMT'); -- 返回2020-05-20 15:21:34.0 select from_utc_timestamp('2020-05-20 15:21:34','UTC'); -- 返回2020-05-20 15:21:34.0 select from_utc_timestamp('2020-05-20 15:21:34','DST'); -- 返回2020-05-20 15:21:34.0 select from_utc_timestamp('2020-05-20 15:21:34','CST'); -- 返回2020-05-20 10:21:34.0 last_day(STRING date) 解释 返回给定时间或日期所在月的最后一天，参数可以是’yyyy-MM-dd HH:mm:ss’ 或者 ‘yyyy-MM-dd’类型，时间部分会被忽略\n使用案例 select last_day('2020-05-20 15:21:34'); -- 返回2020-05-31 select last_day('2020-05-20'); -- 返回2020-05-31 to_date(STRING timestamp) 解释 返回一个字符串时间的日期部分，去掉时间部分，2.1.0之前版本返回的是string，2.1.0版本及之后返回的是date\n使用案例 select to_date('2020-05-20 15:21:34'); -- 返回2020-05-20 select to_date('2020-05-20'); -- 返回2020-05-20 to_utc_timestamp(T a, STRING timezone) 解释 转换为世界标准时间UTC的时间戳,与from_utc_timestamp类似\n使用案例 select to_utc_timestamp('2020-05-20 15:21:34', 'GMT'); -- 返回2020-05-20 15:21:34.0 trunc(STRING date, STRING format) 截取年或月的第一天 解释 截断日期到指定的日期精度，仅支持月（MONTH/MON/MM）或者年（YEAR/YYYY/YY）\n使用案例 select trunc('2020-05-20', 'YY'); -- 返回2020-01-01，返回年的1月1日 select trunc('2020-05-20', 'MM'); -- 返回2020-05-01，返回月的第一天 select trunc('2020-05-20 15:21:34', 'MM'); -- 返回2020-05-01 unix_timestamp([STRING date [, STRING pattern]]) 解释 参数时可选的，当参数为空时，返回当前Unix是时间戳，精确到秒。可以指定一个具体的日期，转换为Unix时间戳格式\n使用案例 -- 返回1589959294 select unix_timestamp('2020-05-20 15:21:34','yyyy-MM-dd hh:mm:ss'); -- 返回1589904000 select unix_timestamp('2020-05-20','yyyy-MM-dd'); weekofyear(STRING date) 解释 返回一个日期或时间在一年中的第几周，可以用extract替代\n使用案例 select weekofyear('2020-05-20 15:21:34'); -- 返回21，第21周 select weekofyear('2020-05-20'); -- 返回21，第21周 next_day(STRING start_date, STRING day_of_week) 解释 参数start_date可以是一个时间或日期，day_of_week表示星期几，比如Mo表示星期一，Tu表示星期二，Wed表示星期三，Thur表示星期四，Fri表示星期五，Sat表示星期六，Sun表示星期日。如果指定的星期几在该日期所在的周且在该日期之后，则返回当周的星期几日期，如果指定的星期几不在该日期所在的周，则返回下一个星期几对应的日期\n使用案例 select next_day('2020-05-20','Mon');-- 返回当前日期的下一个周一日期:2020-05-25 select next_day('2020-05-20','Tu');-- 返回当前日期的下一个周二日期:2020-05-26 select next_day('2020-05-20','Wed');-- 返回当前日期的下一个周三日期:2020-05-27 -- 2020-05-20为周三，指定的参数为周四，所以返回当周的周四就是2020-05-21 select next_day('2020-05-20','Th'); select next_day('2020-05-20','Fri');-- 返回周五日期2020-05-22 select next_day('2020-05-20','Sat'); -- 返回周六日期2020-05-23 select next_day('2020-05-20','Sun'); -- 返回周六日期2020-05-24 该函数比较重要：比如取当前日期所在的周一和周日，通过长用在按周进行汇总数据\nselect date_add(next_day('2020-05-20','MO'),-7); -- 返回当前日期的周一日期2020-05-18 select date_add(next_day('2020-05-20','MO'),-1); -- 返回当前日期的周日日期2020-05-24 months_between(DATE|TIMESTAMP|STRING date1, DATE|TIMESTAMP|STRING date2) 解释 返回 date1 和 date2 的月份差。如果date1大于date2，返回正值，否则返回负值，如果是相减是整数月，则返回一个整数，否则会返回小数\n使用案例 select months_between('2020-05-20','2020-05-20'); -- 返回0 select months_between('2020-05-20','2020-06-20'); -- 返回-1 -- 相差的整数月 select months_between('2020-06-30','2020-05-31'); -- 返回1 -- 非整数月，一个月差一天 select months_between('2020-06-29','2020-05-31'); -- 返回0.93548387 ","wordCount":"3250","inLanguage":"zh","datePublished":"2023-08-22T00:00:00Z","dateModified":"2023-09-04T11:19:09.320812324Z","author":{"@type":"Person","name":"xkj"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://xiaokunji.com/zh/hadoop%E7%94%9F%E6%80%81%E5%9C%88/Hive/%E5%87%BD%E6%95%B0.html"},"publisher":{"@type":"Organization","name":"米二","logo":{"@type":"ImageObject","url":"https://xiaokunji.com/img/Q.svg"}}}</script></head><body class=dark id=top><script>localStorage.getItem("pref-theme")==="light"&&document.body.classList.remove("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://xiaokunji.com/zh/ accesskey=h title="米二 (Alt + H)"><img src=https://xiaokunji.com/img/Q.svg alt aria-label=logo height=35>米二</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li><li><a href=https://xiaokunji.com/en/ title=English aria-label=English>English</a></li></ul></div></div><ul id=menu><li><a href=https://xiaokunji.com/zh/ title=🏠主页><span>🏠主页</span></a></li><li><a href=https://xiaokunji.com/zh/search title="🔍搜索 (Alt + /)" accesskey=/><span>🔍搜索</span></a></li><li><a href=https://xiaokunji.com/zh/post.html title=📚文章><span>📚文章</span></a></li><li><a href=https://xiaokunji.com/zh/archives.html title=⏱时间轴><span>⏱时间轴</span></a></li><li><a href=https://xiaokunji.com/zh/tags.html title=🔖标签><span>🔖标签</span></a></li><li><a href=https://xiaokunji.com/zh/categories.html title=📖分类><span>📖分类</span></a></li><li><a href=https://xiaokunji.com/zh/links.html title=🤝友链><span>🤝友链</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><nav aria-label=breadcrumb><ul><a href=https://xiaokunji.com/zh/>🏠</a> <span>></span>
<a href=https://xiaokunji.com/zh/hadoop%E7%94%9F%E6%80%81%E5%9C%88.html>hadoop生态圈</a> <span>></span>
<a href=https://xiaokunji.com/zh/hadoop%E7%94%9F%E6%80%81%E5%9C%88/Hive.html>Hive</a> <span>></span></ul></nav><h1 class=post-title>函数</h1><div class=post-description></div><div class=post-meta>创建:&nbsp;<span title='2023-08-22 00:00:00 +0000 UTC'>2023-08-22</span>&nbsp;·&nbsp;更新:&nbsp;2023-09-04&nbsp;·&nbsp;xkj
&nbsp;|&nbsp;分类: &nbsp;<ul class=post-categories-meta><a href=https://xiaokunji.com/zh/categories/Hadoop%E7%94%9F%E6%80%81%E5%9C%88.html>Hadoop生态圈</a></ul><span id=busuanzi_container_page_pv>&nbsp;| 访问: <span id=busuanzi_value_page_pv>1</span></span></div></header><aside id=toc-container class="toc-container wide"><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>目录</span></summary><div class=inner><ul><li><a href=#%e6%9d%a1%e4%bb%b6%e5%87%bd%e6%95%b0 aria-label=条件函数>条件函数</a><ul><li><a href=#assert_trueboolean-condition aria-label="assert_true(BOOLEAN condition)">assert_true(BOOLEAN condition)</a></li><li><a href=#coalescet-v1-t-v2- aria-label="coalesce(T v1, T v2, &amp;hellip;)">coalesce(T v1, T v2, &mldr;)</a></li><li><a href=#if aria-label=if>if</a></li><li><a href=#isnotnulla aria-label=isnotnull(a)>isnotnull(a)</a></li><li><a href=#isnulla aria-label=isnull(a)>isnull(a)</a></li><li><a href=#nullifa-b aria-label="nullif(a, b)">nullif(a, b)</a></li><li><a href=#nvlt-value-t-default_value aria-label="nvl(T value, T default_value)">nvl(T value, T default_value)</a></li></ul></li><li><a href=#%e6%97%a5%e6%9c%9f%e5%87%bd%e6%95%b0 aria-label=日期函数>日期函数</a><ul><li><a href=#add_months aria-label=add_months>add_months</a></li><li><a href=#current_date aria-label=current_date>current_date</a></li><li><a href=#current_timestamp aria-label=current_timestamp()>current_timestamp()</a></li><li><a href=#datediffstring-enddate-string-startdate aria-label="datediff(STRING enddate, STRING startdate)">datediff(STRING enddate, STRING startdate)</a></li><li><a href=#date_adddate-startdate-int-days aria-label="date_add(DATE startdate, INT days)">date_add(DATE startdate, INT days)</a></li><li><a href=#date_subdate-startdate-int-days aria-label="date_sub(DATE startdate, INT days)">date_sub(DATE startdate, INT days)</a></li><li><a href=#date_formatdatetimestampstring-ts-string-fmt aria-label="date_format(DATE|TIMESTAMP|STRING ts, STRING fmt)">date_format(DATE|TIMESTAMP|STRING ts, STRING fmt)</a></li><li><a href=#dayofmonthstring-date aria-label="dayofmonth(STRING date)">dayofmonth(STRING date)</a></li><li><a href=#extractfield-from-source-%e6%97%b6%e9%97%b4%e6%88%aa%e5%8f%96%e5%87%bd%e6%95%b0 aria-label="extract(field FROM source) 时间截取函数">extract(field FROM source) 时间截取函数</a></li><li><a href=#yearstring-date aria-label="year(STRING date)">year(STRING date)</a></li><li><a href=#quarterdatetimestampstring-a aria-label="quarter(DATE|TIMESTAMP|STRING a)">quarter(DATE|TIMESTAMP|STRING a)</a></li><li><a href=#monthstring-date aria-label="month(STRING date)">month(STRING date)</a></li><li><a href=#daystring-date aria-label="day(STRING date),">day(STRING date),</a></li><li><a href=#hourstring-date aria-label="hour(STRING date)">hour(STRING date)</a></li><li><a href=#minutestring-date aria-label="minute(STRING date)">minute(STRING date)</a></li><li><a href=#secondstring-date aria-label="second(STRING date)">second(STRING date)</a></li><li><a href=#from_unixtimebigint-unixtime--string-format aria-label="from_unixtime(BIGINT unixtime [, STRING format])">from_unixtime(BIGINT unixtime [, STRING format])</a></li><li><a href=#from_utc_timestampt-a-string-timezone aria-label="from_utc_timestamp(T a, STRING timezone)">from_utc_timestamp(T a, STRING timezone)</a></li><li><a href=#last_daystring-date aria-label="last_day(STRING date)">last_day(STRING date)</a></li><li><a href=#to_datestring-timestamp aria-label="to_date(STRING timestamp)">to_date(STRING timestamp)</a></li><li><a href=#to_utc_timestampt-a-string-timezone aria-label="to_utc_timestamp(T a, STRING timezone)">to_utc_timestamp(T a, STRING timezone)</a></li><li><a href=#truncstring-date-string-format--%e6%88%aa%e5%8f%96%e5%b9%b4%e6%88%96%e6%9c%88%e7%9a%84%e7%ac%ac%e4%b8%80%e5%a4%a9 aria-label="trunc(STRING date, STRING format)  截取年或月的第一天">trunc(STRING date, STRING format) 截取年或月的第一天</a></li><li><a href=#unix_timestampstring-date--string-pattern aria-label="unix_timestamp([STRING date [, STRING pattern]])">unix_timestamp([STRING date [, STRING pattern]])</a></li><li><a href=#weekofyearstring-date aria-label="weekofyear(STRING date)">weekofyear(STRING date)</a></li><li><a href=#next_daystring-start_date-string-day_of_week aria-label="next_day(STRING start_date, STRING day_of_week)">next_day(STRING start_date, STRING day_of_week)</a></li><li><a href=#months_betweendatetimestampstring-date1-datetimestampstring-date2 aria-label="months_between(DATE|TIMESTAMP|STRING date1, DATE|TIMESTAMP|STRING date2)">months_between(DATE|TIMESTAMP|STRING date1, DATE|TIMESTAMP|STRING date2)</a></li></ul></li></ul></div></details></div></aside><script>let activeElement,elements;window.addEventListener("DOMContentLoaded",function(){checkTocPosition(),elements=document.querySelectorAll("h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]"),activeElement=elements[0];const t=encodeURI(activeElement.getAttribute("id")).toLowerCase();document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active")},!1),window.addEventListener("resize",function(){checkTocPosition()},!1),window.addEventListener("scroll",()=>{activeElement=Array.from(elements).find(e=>{if(getOffsetTop(e)-window.pageYOffset>0&&getOffsetTop(e)-window.pageYOffset<window.innerHeight/2)return e})||activeElement,elements.forEach(e=>{const t=encodeURI(e.getAttribute("id")).toLowerCase();e===activeElement?document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active"):document.querySelector(`.inner ul li a[href="#${t}"]`).classList.remove("active")})},!1);const main=parseInt(getComputedStyle(document.body).getPropertyValue("--article-width"),10),toc=parseInt(getComputedStyle(document.body).getPropertyValue("--toc-width"),10),gap=parseInt(getComputedStyle(document.body).getPropertyValue("--gap"),10);function checkTocPosition(){const e=document.body.scrollWidth;e-main-toc*2-gap*4>0?document.getElementById("toc-container").classList.add("wide"):document.getElementById("toc-container").classList.remove("wide")}function getOffsetTop(e){if(!e.getClientRects().length)return 0;let t=e.getBoundingClientRect(),n=e.ownerDocument.defaultView;return t.top+n.pageYOffset}</script><div class=post-content><p>[toc]</p><h2 id=条件函数>条件函数<a hidden class=anchor aria-hidden=true href=#条件函数>#</a></h2><h3 id=assert_trueboolean-condition>assert_true(BOOLEAN condition)<a hidden class=anchor aria-hidden=true href=#assert_trueboolean-condition>#</a></h3><ul><li>解释</li></ul><p>如果condition不为true，则抛出异常，否则返回null</p><ul><li>使用案例</li></ul><div class=highlight><pre tabindex=0 style=color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>select assert_true(1&lt;2) -- 返回null
</span></span><span style=display:flex><span>select assert_true(1&gt;2) -- 抛出异常
</span></span></code></pre></div><h3 id=coalescet-v1-t-v2->coalesce(T v1, T v2, &mldr;)<a hidden class=anchor aria-hidden=true href=#coalescet-v1-t-v2->#</a></h3><ul><li>解释</li></ul><p>返回第一个不为null的值，如果都为null，则返回null</p><ul><li>使用案例</li></ul><div class=highlight><pre tabindex=0 style=color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>select coalesce(null,1,2,null)  -- 返回1
</span></span><span style=display:flex><span>select coalesce(1,null) -- 返回1
</span></span><span style=display:flex><span>select coalesce(null,null) -- 返回null
</span></span></code></pre></div><h3 id=if>if<a hidden class=anchor aria-hidden=true href=#if>#</a></h3><p>if ( BOOLEAN testCondition, T valueTrue , T valueFalseOrNull )</p><ul><li>解释</li></ul><p>如果testCondition条件为true，则返回第一个值，否则返回第二个值</p><ul><li>使用案例</li></ul><div class=highlight><pre tabindex=0 style=color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>select if(1 is null,0,1)  -- 返回1
</span></span><span style=display:flex><span>select if(null is null,0,1) -- 返回0
</span></span></code></pre></div><h3 id=isnotnulla>isnotnull(a)<a hidden class=anchor aria-hidden=true href=#isnotnulla>#</a></h3><ul><li>解释</li></ul><p>如果参数a不为null，则返回true，否则返回false</p><ul><li>使用案例</li></ul><div class=highlight><pre tabindex=0 style=color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>select isnotnull(1) -- 返回true
</span></span><span style=display:flex><span>select isnotnull(null) -- 返回false
</span></span></code></pre></div><h3 id=isnulla>isnull(a)<a hidden class=anchor aria-hidden=true href=#isnulla>#</a></h3><ul><li>解释</li></ul><p>与isnotnull相反，如果参数a为null，则返回true，否则返回false</p><ul><li>使用案例</li></ul><div class=highlight><pre tabindex=0 style=color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>select isnull(null) -- 返回true
</span></span><span style=display:flex><span>select isnull(1) -- 返回false
</span></span></code></pre></div><h3 id=nullifa-b>nullif(a, b)<a hidden class=anchor aria-hidden=true href=#nullifa-b>#</a></h3><ul><li>解释</li></ul><p>如果参数a=b，返回null，否则返回a值(Hive2.2.0版本)</p><ul><li>使用案例</li></ul><div class=highlight><pre tabindex=0 style=color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>select nullif(1,2) -- 返回1
</span></span><span style=display:flex><span>select nullif(1,1) -- 返回null
</span></span></code></pre></div><h3 id=nvlt-value-t-default_value>nvl(T value, T default_value)<a hidden class=anchor aria-hidden=true href=#nvlt-value-t-default_value>#</a></h3><ul><li>解释</li></ul><p>如果value的值为null，则返回default_value默认值，否则返回value的值。在null值判断时，可以使用if函数给定默认值，也可以使用此函数给定默认值，使用该函数sql特别简洁。</p><ul><li>使用案例</li></ul><div class=highlight><pre tabindex=0 style=color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>select nvl(1,0) -- 返回1
</span></span><span style=display:flex><span>select nvl(null,0) -- 返回0
</span></span></code></pre></div><h2 id=日期函数>日期函数<a hidden class=anchor aria-hidden=true href=#日期函数>#</a></h2><h3 id=add_months>add_months<a hidden class=anchor aria-hidden=true href=#add_months>#</a></h3><p>add_month( DATE | STRING | TIMESTAMP start_date , INT num_months)</p><ul><li>解释</li></ul><p>start_date参数可以是string, date 或者timestamp类型，num_months参数时int类型。返回一个日期，该日期是在start_date基础之上加上num_months个月，即start_date之后null_months个月的一个日期。如果start_date的时间部分的数据会被忽略。注意：如果start_date所在月份的天数大于结果日期月的天数，则返回结果月的最后一天的日期。</p><ul><li>使用案例</li></ul><div class=highlight><pre tabindex=0 style=color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>select add_months(&#34;2020-05-20&#34;,2); -- 返回2020-07-20
</span></span><span style=display:flex><span>select add_months(&#34;2020-05-20&#34;,8); -- 返回2021-01-20
</span></span><span style=display:flex><span>select add_months(&#34;2020-05-31&#34;,1); -- 返回2020-06-30,5月有31天，6月只有30天，所以返回下一个月的最后一天
</span></span></code></pre></div><h3 id=current_date>current_date<a hidden class=anchor aria-hidden=true href=#current_date>#</a></h3><ul><li>解释</li></ul><p>返回查询时刻的当前日期</p><ul><li>使用案例</li></ul><div class=highlight><pre tabindex=0 style=color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>select current_date() -- 返回当前查询日期2020-05-20
</span></span></code></pre></div><h3 id=current_timestamp>current_timestamp()<a hidden class=anchor aria-hidden=true href=#current_timestamp>#</a></h3><ul><li>解释</li></ul><p>返回查询时刻的当前时间</p><ul><li>使用案例</li></ul><div class=highlight><pre tabindex=0 style=color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>select current_timestamp() -- 2020-05-20 14:40:47.273
</span></span></code></pre></div><h3 id=datediffstring-enddate-string-startdate>datediff(STRING enddate, STRING startdate)<a hidden class=anchor aria-hidden=true href=#datediffstring-enddate-string-startdate>#</a></h3><ul><li>解释</li></ul><p>返回开始日期startdate与结束日期enddate之前相差的天数</p><ul><li>使用案例</li></ul><div class=highlight><pre tabindex=0 style=color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>select datediff(&#34;2020-05-20&#34;,&#34;2020-05-21&#34;); -- 返回-1
</span></span><span style=display:flex><span>select datediff(&#34;2020-05-21&#34;,&#34;2020-05-20&#34;); -- 返回1
</span></span></code></pre></div><h3 id=date_adddate-startdate-int-days>date_add(DATE startdate, INT days)<a hidden class=anchor aria-hidden=true href=#date_adddate-startdate-int-days>#</a></h3><ul><li>解释</li></ul><p>在startdate基础上加上几天，然后返回加上几天之后的一个日期</p><ul><li>使用案例</li></ul><div class=highlight><pre tabindex=0 style=color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>select date_add(&#34;2020-05-20&#34;,1); -- 返回2020-05-21,1表示加1天
</span></span><span style=display:flex><span>select date_add(&#34;2020-05-20&#34;,-1); -- 返回2020-05-19，-1表示减一天
</span></span></code></pre></div><h3 id=date_subdate-startdate-int-days>date_sub(DATE startdate, INT days)<a hidden class=anchor aria-hidden=true href=#date_subdate-startdate-int-days>#</a></h3><ul><li>解释</li></ul><p>在startdate基础上减去几天，然后返回减去几天之后的一个日期,功能与date_add很类似</p><ul><li>使用案例</li></ul><div class=highlight><pre tabindex=0 style=color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>select date_sub(&#34;2020-05-20&#34;,1); -- 返回2020-05-19,1表示减1天
</span></span><span style=display:flex><span>select date_sub(&#34;2020-05-20&#34;,-1); -- 返回2020-05-21，-1表示加1天
</span></span></code></pre></div><h3 id=date_formatdatetimestampstring-ts-string-fmt>date_format(DATE|TIMESTAMP|STRING ts, STRING fmt)<a hidden class=anchor aria-hidden=true href=#date_formatdatetimestampstring-ts-string-fmt>#</a></h3><ul><li>解释</li></ul><p>将date/timestamp/string类型的值转换为一个具体格式化的字符串。支持java的SimpleDateFormat格式，第二个参数fmt必须是一个常量</p><ul><li>使用案例</li></ul><div class=highlight><pre tabindex=0 style=color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>select date_format(&#39;2020-05-20&#39;, &#39;yyyy&#39;); -- 返回2020
</span></span><span style=display:flex><span>select date_format(&#39;2020-05-20&#39;, &#39;MM&#39;); -- 返回05
</span></span><span style=display:flex><span>select date_format(&#39;2020-05-20&#39;, &#39;dd&#39;); -- 返回20
</span></span><span style=display:flex><span>-- 返回2020年05月20日 00时00分00秒
</span></span><span style=display:flex><span>select date_format(&#39;2020-05-20&#39;, &#39;yyyy年MM月dd日 HH时mm分ss秒&#39;) ;
</span></span><span style=display:flex><span>select date_format(&#39;2020-05-20&#39;, &#39;yy/MM/dd&#39;) -- 返回 20/05/20
</span></span></code></pre></div><h3 id=dayofmonthstring-date>dayofmonth(STRING date)<a hidden class=anchor aria-hidden=true href=#dayofmonthstring-date>#</a></h3><ul><li>解释</li></ul><p>返回一个日期或时间的天,与day()函数功能相同</p><ul><li>使用案例</li></ul><div class=highlight><pre tabindex=0 style=color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>select dayofmonth(&#39;2020-05-20&#39;) -- 返回20
</span></span></code></pre></div><h3 id=extractfield-from-source-时间截取函数>extract(field FROM source) 时间截取函数<a hidden class=anchor aria-hidden=true href=#extractfield-from-source-时间截取函数>#</a></h3><ul><li>解释</li></ul><p>提取 day, dayofweek, hour, minute, month, quarter, second, week 或者year的值，field可以选择day, dayofweek, hour, minute, month, quarter, second, week 或者year，source必须是一个date、timestamp或者可以转为 date 、timestamp的字符串。注意：Hive 2.2.0版本之后支持该函数</p><ul><li>使用案例</li></ul><div class=highlight><pre tabindex=0 style=color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>select extract(year from &#39;2020-05-20 15:21:34.467&#39;); -- 返回2020，年
</span></span><span style=display:flex><span>select extract(quarter from &#39;2020-05-20 15:21:34.467&#39;); -- 返回2，季度
</span></span><span style=display:flex><span>select extract(month from &#39;2020-05-20 15:21:34.467&#39;); -- 返回05，月份
</span></span><span style=display:flex><span>select extract(week from &#39;2020-05-20 15:21:34.467&#39;); -- 返回21，同weekofyear，一年中的第几周
</span></span><span style=display:flex><span>select extract(dayofweek from &#39;2020-05-20 15:21:34.467&#39;); -- 返回4,代表星期三
</span></span><span style=display:flex><span>select extract(day from &#39;2020-05-20 15:21:34.467&#39;); -- 返回20，天
</span></span><span style=display:flex><span>select extract(hour from &#39;2020-05-20 15:21:34.467&#39;); -- 返回15，小时
</span></span><span style=display:flex><span>select extract(minute from &#39;2020-05-20 15:21:34.467&#39;); -- 返回21，分钟
</span></span><span style=display:flex><span>select extract(second from &#39;2020-05-20 15:21:34.467&#39;); -- 返回34，秒
</span></span></code></pre></div><h3 id=yearstring-date>year(STRING date)<a hidden class=anchor aria-hidden=true href=#yearstring-date>#</a></h3><ul><li>解释</li></ul><p>返回时间的年份,可以用extract函数替代</p><ul><li>使用案例</li></ul><div class=highlight><pre tabindex=0 style=color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>select year(&#39;2020-05-20 15:21:34&#39;); -- 返回2020
</span></span></code></pre></div><h3 id=quarterdatetimestampstring-a>quarter(DATE|TIMESTAMP|STRING a)<a hidden class=anchor aria-hidden=true href=#quarterdatetimestampstring-a>#</a></h3><ul><li>解释</li></ul><p>返回给定时间或日期的季度，1至4个季度,可以用extract函数替代</p><ul><li>使用案例</li></ul><div class=highlight><pre tabindex=0 style=color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>select quarter(&#39;2020-05-20 15:21:34&#39;); -- 返回2，第2季度
</span></span></code></pre></div><h3 id=monthstring-date>month(STRING date)<a hidden class=anchor aria-hidden=true href=#monthstring-date>#</a></h3><ul><li>解释</li></ul><p>返回时间的月份,可以用extract函数替代</p><ul><li>使用案例</li></ul><div class=highlight><pre tabindex=0 style=color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>select month(&#39;2020-05-20 15:21:34&#39;) -- 返回5
</span></span></code></pre></div><h3 id=daystring-date>day(STRING date),<a hidden class=anchor aria-hidden=true href=#daystring-date>#</a></h3><ul><li>解释</li></ul><p>返回一个日期或者时间的天,可以用extract函数替代</p><ul><li>使用案例</li></ul><div class=highlight><pre tabindex=0 style=color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>select day(&#34;2020-05-20&#34;); -- 返回20
</span></span><span style=display:flex><span>select day(&#34;2020-05-20 15:05:27.5&#34;); -- 返回20
</span></span></code></pre></div><h3 id=hourstring-date>hour(STRING date)<a hidden class=anchor aria-hidden=true href=#hourstring-date>#</a></h3><ul><li>解释</li></ul><p>返回一个时间的小时,可以用extract函数替代</p><ul><li>使用案例</li></ul><div class=highlight><pre tabindex=0 style=color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>select hour(&#39;2020-05-20 15:21:34&#39;);-- 返回15
</span></span></code></pre></div><h3 id=minutestring-date>minute(STRING date)<a hidden class=anchor aria-hidden=true href=#minutestring-date>#</a></h3><ul><li>解释</li></ul><p>返回一个时间的分钟值,可以用extract函数替代</p><ul><li>使用案例</li></ul><div class=highlight><pre tabindex=0 style=color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>select minute(&#39;2020-05-20 15:21:34&#39;); -- 返回21
</span></span></code></pre></div><h3 id=secondstring-date>second(STRING date)<a hidden class=anchor aria-hidden=true href=#secondstring-date>#</a></h3><ul><li>解释</li></ul><p>返回一个时间的秒,可以用extract函数替代</p><ul><li>使用案例</li></ul><div class=highlight><pre tabindex=0 style=color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>select second(&#39;2020-05-20 15:21:34&#39;); --返回34
</span></span></code></pre></div><h3 id=from_unixtimebigint-unixtime--string-format>from_unixtime(BIGINT unixtime [, STRING format])<a hidden class=anchor aria-hidden=true href=#from_unixtimebigint-unixtime--string-format>#</a></h3><ul><li>解释</li></ul><p>将将Unix时间戳转换为字符串格式的时间(比如yyyy-MM-dd HH:mm:ss格式)</p><ul><li>使用案例</li></ul><div class=highlight><pre tabindex=0 style=color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>select from_unixtime(1589960708); -- 返回2020-05-20 15:45:08
</span></span><span style=display:flex><span>select from_unixtime(1589960708, &#39;yyyy-MM-dd hh:mm:ss&#39;); -- -- 返回2020-05-20 15:45:08
</span></span><span style=display:flex><span>select from_unixtime(1589960708, &#39;yyyy-MM-dd&#39;); -- 返回2020-05-20
</span></span></code></pre></div><h3 id=from_utc_timestampt-a-string-timezone>from_utc_timestamp(T a, STRING timezone)<a hidden class=anchor aria-hidden=true href=#from_utc_timestampt-a-string-timezone>#</a></h3><ul><li>解释</li></ul><p>转换为特定时区的时间</p><ul><li>使用案例</li></ul><div class=highlight><pre tabindex=0 style=color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>select from_utc_timestamp(&#39;2020-05-20 15:21:34&#39;,&#39;PST&#39;); -- 返回2020-05-20 08:21:34.0
</span></span><span style=display:flex><span>select from_utc_timestamp(&#39;2020-05-20 15:21:34&#39;,&#39;GMT&#39;); -- 返回2020-05-20 15:21:34.0
</span></span><span style=display:flex><span>select from_utc_timestamp(&#39;2020-05-20 15:21:34&#39;,&#39;UTC&#39;); -- 返回2020-05-20 15:21:34.0
</span></span><span style=display:flex><span>select from_utc_timestamp(&#39;2020-05-20 15:21:34&#39;,&#39;DST&#39;); -- 返回2020-05-20 15:21:34.0
</span></span><span style=display:flex><span>select from_utc_timestamp(&#39;2020-05-20 15:21:34&#39;,&#39;CST&#39;); -- 返回2020-05-20 10:21:34.0
</span></span></code></pre></div><h3 id=last_daystring-date>last_day(STRING date)<a hidden class=anchor aria-hidden=true href=#last_daystring-date>#</a></h3><ul><li>解释</li></ul><p>返回给定时间或日期所在月的最后一天，参数可以是&rsquo;yyyy-MM-dd HH:mm:ss&rsquo; 或者 &lsquo;yyyy-MM-dd&rsquo;类型，时间部分会被忽略</p><ul><li>使用案例</li></ul><div class=highlight><pre tabindex=0 style=color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>select last_day(&#39;2020-05-20 15:21:34&#39;); -- 返回2020-05-31
</span></span><span style=display:flex><span>select last_day(&#39;2020-05-20&#39;); -- 返回2020-05-31 
</span></span></code></pre></div><h3 id=to_datestring-timestamp>to_date(STRING timestamp)<a hidden class=anchor aria-hidden=true href=#to_datestring-timestamp>#</a></h3><ul><li>解释</li></ul><p>返回一个字符串时间的日期部分，去掉时间部分，2.1.0之前版本返回的是string，2.1.0版本及之后返回的是date</p><ul><li>使用案例</li></ul><div class=highlight><pre tabindex=0 style=color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>select to_date(&#39;2020-05-20 15:21:34&#39;); -- 返回2020-05-20
</span></span><span style=display:flex><span>select to_date(&#39;2020-05-20&#39;); -- 返回2020-05-20
</span></span></code></pre></div><h3 id=to_utc_timestampt-a-string-timezone>to_utc_timestamp(T a, STRING timezone)<a hidden class=anchor aria-hidden=true href=#to_utc_timestampt-a-string-timezone>#</a></h3><ul><li>解释</li></ul><p>转换为世界标准时间UTC的时间戳,与from_utc_timestamp类似</p><ul><li>使用案例</li></ul><div class=highlight><pre tabindex=0 style=color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>select to_utc_timestamp(&#39;2020-05-20 15:21:34&#39;, &#39;GMT&#39;); -- 返回2020-05-20 15:21:34.0
</span></span></code></pre></div><h3 id=truncstring-date-string-format--截取年或月的第一天>trunc(STRING date, STRING format) 截取年或月的第一天<a hidden class=anchor aria-hidden=true href=#truncstring-date-string-format--截取年或月的第一天>#</a></h3><ul><li>解释</li></ul><p>截断日期到指定的日期精度，仅支持月（MONTH/MON/MM）或者年（YEAR/YYYY/YY）</p><ul><li>使用案例</li></ul><div class=highlight><pre tabindex=0 style=color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>select trunc(&#39;2020-05-20&#39;, &#39;YY&#39;);   -- 返回2020-01-01，返回年的1月1日
</span></span><span style=display:flex><span>select trunc(&#39;2020-05-20&#39;, &#39;MM&#39;);   -- 返回2020-05-01，返回月的第一天
</span></span><span style=display:flex><span>select trunc(&#39;2020-05-20 15:21:34&#39;, &#39;MM&#39;);   -- 返回2020-05-01
</span></span></code></pre></div><h3 id=unix_timestampstring-date--string-pattern>unix_timestamp([STRING date [, STRING pattern]])<a hidden class=anchor aria-hidden=true href=#unix_timestampstring-date--string-pattern>#</a></h3><ul><li>解释</li></ul><p>参数时可选的，当参数为空时，返回当前Unix是时间戳，精确到秒。可以指定一个具体的日期，转换为Unix时间戳格式</p><ul><li>使用案例</li></ul><div class=highlight><pre tabindex=0 style=color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>-- 返回1589959294
</span></span><span style=display:flex><span>select unix_timestamp(&#39;2020-05-20 15:21:34&#39;,&#39;yyyy-MM-dd hh:mm:ss&#39;);
</span></span><span style=display:flex><span>-- 返回1589904000
</span></span><span style=display:flex><span>select unix_timestamp(&#39;2020-05-20&#39;,&#39;yyyy-MM-dd&#39;);
</span></span></code></pre></div><h3 id=weekofyearstring-date>weekofyear(STRING date)<a hidden class=anchor aria-hidden=true href=#weekofyearstring-date>#</a></h3><ul><li>解释</li></ul><p>返回一个日期或时间在一年中的第几周，可以用extract替代</p><ul><li>使用案例</li></ul><div class=highlight><pre tabindex=0 style=color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>select weekofyear(&#39;2020-05-20 15:21:34&#39;); -- 返回21，第21周
</span></span><span style=display:flex><span>select weekofyear(&#39;2020-05-20&#39;); -- 返回21，第21周
</span></span></code></pre></div><h3 id=next_daystring-start_date-string-day_of_week>next_day(STRING start_date, STRING day_of_week)<a hidden class=anchor aria-hidden=true href=#next_daystring-start_date-string-day_of_week>#</a></h3><ul><li>解释</li></ul><p>参数start_date可以是一个时间或日期，day_of_week表示星期几，比如Mo表示星期一，Tu表示星期二，Wed表示星期三，Thur表示星期四，Fri表示星期五，Sat表示星期六，Sun表示星期日。如果指定的星期几在该日期所在的周且在该日期之后，则返回当周的星期几日期，如果指定的星期几不在该日期所在的周，则返回下一个星期几对应的日期</p><ul><li>使用案例</li></ul><div class=highlight><pre tabindex=0 style=color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>select next_day(&#39;2020-05-20&#39;,&#39;Mon&#39;);-- 返回当前日期的下一个周一日期:2020-05-25
</span></span><span style=display:flex><span>select next_day(&#39;2020-05-20&#39;,&#39;Tu&#39;);-- 返回当前日期的下一个周二日期:2020-05-26
</span></span><span style=display:flex><span>select next_day(&#39;2020-05-20&#39;,&#39;Wed&#39;);-- 返回当前日期的下一个周三日期:2020-05-27
</span></span><span style=display:flex><span>-- 2020-05-20为周三，指定的参数为周四，所以返回当周的周四就是2020-05-21
</span></span><span style=display:flex><span>select next_day(&#39;2020-05-20&#39;,&#39;Th&#39;);
</span></span><span style=display:flex><span>select next_day(&#39;2020-05-20&#39;,&#39;Fri&#39;);-- 返回周五日期2020-05-22
</span></span><span style=display:flex><span>select next_day(&#39;2020-05-20&#39;,&#39;Sat&#39;); -- 返回周六日期2020-05-23
</span></span><span style=display:flex><span>select next_day(&#39;2020-05-20&#39;,&#39;Sun&#39;); -- 返回周六日期2020-05-24
</span></span></code></pre></div><p>该函数比较重要：比如取当前日期所在的周一和周日，通过长用在按周进行汇总数据</p><div class=highlight><pre tabindex=0 style=color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>select date_add(next_day(&#39;2020-05-20&#39;,&#39;MO&#39;),-7); -- 返回当前日期的周一日期2020-05-18
</span></span><span style=display:flex><span>select date_add(next_day(&#39;2020-05-20&#39;,&#39;MO&#39;),-1); -- 返回当前日期的周日日期2020-05-24
</span></span></code></pre></div><h3 id=months_betweendatetimestampstring-date1-datetimestampstring-date2>months_between(DATE|TIMESTAMP|STRING date1, DATE|TIMESTAMP|STRING date2)<a hidden class=anchor aria-hidden=true href=#months_betweendatetimestampstring-date1-datetimestampstring-date2>#</a></h3><ul><li>解释</li></ul><p>返回 date1 和 date2 的月份差。如果date1大于date2，返回正值，否则返回负值，如果是相减是整数月，则返回一个整数，否则会返回小数</p><ul><li>使用案例</li></ul><div class=highlight><pre tabindex=0 style=color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>select months_between(&#39;2020-05-20&#39;,&#39;2020-05-20&#39;); -- 返回0
</span></span><span style=display:flex><span>select months_between(&#39;2020-05-20&#39;,&#39;2020-06-20&#39;); -- 返回-1
</span></span><span style=display:flex><span>-- 相差的整数月
</span></span><span style=display:flex><span>select months_between(&#39;2020-06-30&#39;,&#39;2020-05-31&#39;); -- 返回1
</span></span><span style=display:flex><span>-- 非整数月，一个月差一天
</span></span><span style=display:flex><span>select months_between(&#39;2020-06-29&#39;,&#39;2020-05-31&#39;); -- 返回0.93548387
</span></span></code></pre></div></div><footer class=post-footer><ul class=post-tags><li><a href=https://xiaokunji.com/zh/tags/Hive.html>Hive</a></li><li><a href=https://xiaokunji.com/zh/tags/Hadoop%E7%94%9F%E6%80%81%E5%9C%88.html>Hadoop生态圈</a></li></ul></footer></article></main><script async src=//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js></script><footer class=footer><span>Copyright
&copy;
-2023
<a href=https://xiaokunji.com/zh/ style=color:#939393>米二</a>
All Rights Reserved</span>
<span id=busuanzi_container><span class="fa fa-user">用户数:</span><span id=busuanzi_value_site_uv></span>
<span class="fa fa-eye">访问数:</span><span id=busuanzi_value_site_pv></span></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="复制";function s(){t.innerHTML="已复制！",setTimeout(()=>{t.innerHTML="复制"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>