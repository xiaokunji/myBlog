<!DOCTYPE html>
<html dir="auto" lang="zh"><head><meta charset="utf-8"/><meta content="IE=edge" http-equiv="x-ua-compatible"/><meta content="width=device-width,initial-scale=1,shrink-to-fit=no" name="viewport"/><meta content="index, follow" name="robots"/><title>å‡½æ•° | ç±³äºŒ</title><meta content=" æ¡ä»¶å‡½æ•°, assert_true(BOOLEAN condition), coalesce(T v1,T v2,...), if, isnotnull(a), isnull(a), nullif(a,b), nvl(T value,T default_value), æ—¥æœŸå‡½æ•°, add_months, current_date, current_timestamp(), datediff(STRING enddate,STRING startdate), date_add(DATE startdate,INT days), date_sub(DATE startdate,INT days), date_format(DATE|TIMESTAMP|STRING ts,STRING fmt), dayofmonth(STRING date), extract(field FROM source) æ—¶é—´æˆªå–å‡½æ•°, year(STRING date), quarter(DATE|TIMESTAMP|STRING a), month(STRING date), day(STRING date),, hour(STRING date), minute(STRING date), second(STRING date), from_unixtime(BIGINT unixtime [,STRING format]), from_utc_timestamp(T a,STRING timezone), last_day(STRING date), to_date(STRING timestamp), to_utc_timestamp(T a,STRING timezone), trunc(STRING date,STRING format)  æˆªå–å¹´æˆ–æœˆçš„ç¬¬ä¸€å¤©, unix_timestamp([STRING date [,STRING pattern]]), weekofyear(STRING date), next_day(STRING start_date,STRING day_of_week), months_between(DATE|TIMESTAMP|STRING date1,DATE|TIMESTAMP|STRING date2)" name="keywords"/><meta content="     " name="description"/><meta content="xkj" name="author"/><link href="https://xiaokunji.com/zh/hadoop%E7%94%9F%E6%80%81%E5%9C%88/Hive/%E5%87%BD%E6%95%B0.html" rel="canonical"/><link as="style" crossorigin="anonymous" href="/assets/css/stylesheet.dc6bd2c841ee388e899e13872ae986c0e847e8b957d6714ad6ddc628ef2d17ff.css" integrity="sha256-3GvSyEHuOI6JnhOHKumGwOhH6LlX1nFK1t3GKO8tF/8=" rel="preload stylesheet"/><script crossorigin="anonymous" defer="" integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload="hljs.initHighlightingOnLoad()" src="/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js"></script>
<link href="https://xiaokunji.com/img/Q.svg" rel="icon"/><link href="https://xiaokunji.com/img/Q.svg" rel="icon" sizes="16x16" type="image/png"/><link href="https://xiaokunji.com/img/Q.svg" rel="icon" sizes="32x32" type="image/png"/><link href="https://xiaokunji.com/Q.svg" rel="apple-touch-icon"/><link href="https://xiaokunji.com/Q.svg" rel="mask-icon"/><meta content="#2e2e33" name="theme-color"/><meta content="#2e2e33" name="msapplication-TileColor"/><link href="https://xiaokunji.com/zh/hadoop%E7%94%9F%E6%80%81%E5%9C%88/Hive/%E5%87%BD%E6%95%B0.html" hreflang="zh" rel="alternate"/><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><meta content="å‡½æ•°" property="og:title"/><meta content="     " property="og:description"/><meta content="article" property="og:type"/><meta content="https://xiaokunji.com/zh/hadoop%E7%94%9F%E6%80%81%E5%9C%88/Hive/%E5%87%BD%E6%95%B0.html" property="og:url"/><meta content="hadoopç”Ÿæ€åœˆ" property="article:section"/><meta content="2023-08-22T00:00:00+00:00" property="article:published_time"/><meta content="2023-08-29T00:59:17+08:00" property="article:modified_time"/><meta content="summary" name="twitter:card"/><meta content="å‡½æ•°" name="twitter:title"/><meta content="     " name="twitter:description"/><script type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":4,"name":"å‡½æ•°","item":"https://xiaokunji.com/zh/hadoop%E7%94%9F%E6%80%81%E5%9C%88/Hive/%E5%87%BD%E6%95%B0.html"}]}</script><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","headline":"å‡½æ•°","name":"å‡½æ•°","description":"     ","keywords":[" æ¡ä»¶å‡½æ•°"," assert_true(BOOLEAN condition)"," coalesce(T v1, T v2, ...)"," if"," isnotnull(a)"," isnull(a)"," nullif(a, b)"," nvl(T value, T default_value)"," æ—¥æœŸå‡½æ•°"," add_months"," current_date"," current_timestamp()"," datediff(STRING enddate, STRING startdate)"," date_add(DATE startdate, INT days)"," date_sub(DATE startdate, INT days)"," date_format(DATE|TIMESTAMP|STRING ts, STRING fmt)"," dayofmonth(STRING date)"," extract(field FROM source) æ—¶é—´æˆªå–å‡½æ•°"," year(STRING date)"," quarter(DATE|TIMESTAMP|STRING a)"," month(STRING date)"," day(STRING date),"," hour(STRING date)"," minute(STRING date)"," second(STRING date)"," from_unixtime(BIGINT unixtime [, STRING format])"," from_utc_timestamp(T a, STRING timezone)"," last_day(STRING date)"," to_date(STRING timestamp)"," to_utc_timestamp(T a, STRING timezone)"," trunc(STRING date, STRING format)  æˆªå–å¹´æˆ–æœˆçš„ç¬¬ä¸€å¤©"," unix_timestamp([STRING date [, STRING pattern]])"," weekofyear(STRING date)"," next_day(STRING start_date, STRING day_of_week)"," months_between(DATE|TIMESTAMP|STRING date1, DATE|TIMESTAMP|STRING date2)"],"articleBody":"[toc]\næ¡ä»¶å‡½æ•° assert_true(BOOLEAN condition) è§£é‡Š å¦‚æœconditionä¸ä¸ºtrueï¼Œåˆ™æŠ›å‡ºå¼‚å¸¸ï¼Œå¦åˆ™è¿”å›null\nä½¿ç”¨æ¡ˆä¾‹ select assert_true(1\u003c2) -- è¿”å›null select assert_true(1\u003e2) -- æŠ›å‡ºå¼‚å¸¸ coalesce(T v1, T v2, â€¦) è§£é‡Š è¿”å›ç¬¬ä¸€ä¸ªä¸ä¸ºnullçš„å€¼ï¼Œå¦‚æœéƒ½ä¸ºnullï¼Œåˆ™è¿”å›null\nä½¿ç”¨æ¡ˆä¾‹ select coalesce(null,1,2,null) -- è¿”å›1 select coalesce(1,null) -- è¿”å›1 select coalesce(null,null) -- è¿”å›null if if ( BOOLEAN testCondition, T valueTrue , T valueFalseOrNull )\nè§£é‡Š å¦‚æœtestConditionæ¡ä»¶ä¸ºtrueï¼Œåˆ™è¿”å›ç¬¬ä¸€ä¸ªå€¼ï¼Œå¦åˆ™è¿”å›ç¬¬äºŒä¸ªå€¼\nä½¿ç”¨æ¡ˆä¾‹ select if(1 is null,0,1) -- è¿”å›1 select if(null is null,0,1) -- è¿”å›0 isnotnull(a) è§£é‡Š å¦‚æœå‚æ•°aä¸ä¸ºnullï¼Œåˆ™è¿”å›trueï¼Œå¦åˆ™è¿”å›false\nä½¿ç”¨æ¡ˆä¾‹ select isnotnull(1) -- è¿”å›true select isnotnull(null) -- è¿”å›false isnull(a) è§£é‡Š ä¸isnotnullç›¸åï¼Œå¦‚æœå‚æ•°aä¸ºnullï¼Œåˆ™è¿”å›trueï¼Œå¦åˆ™è¿”å›false\nä½¿ç”¨æ¡ˆä¾‹ select isnull(null) -- è¿”å›true select isnull(1) -- è¿”å›false nullif(a, b) è§£é‡Š å¦‚æœå‚æ•°a=bï¼Œè¿”å›nullï¼Œå¦åˆ™è¿”å›aå€¼(Hive2.2.0ç‰ˆæœ¬)\nä½¿ç”¨æ¡ˆä¾‹ select nullif(1,2) -- è¿”å›1 select nullif(1,1) -- è¿”å›null nvl(T value, T default_value) è§£é‡Š å¦‚æœvalueçš„å€¼ä¸ºnullï¼Œåˆ™è¿”å›default_valueé»˜è®¤å€¼ï¼Œå¦åˆ™è¿”å›valueçš„å€¼ã€‚åœ¨nullå€¼åˆ¤æ–­æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ifå‡½æ•°ç»™å®šé»˜è®¤å€¼ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨æ­¤å‡½æ•°ç»™å®šé»˜è®¤å€¼ï¼Œä½¿ç”¨è¯¥å‡½æ•°sqlç‰¹åˆ«ç®€æ´ã€‚\nä½¿ç”¨æ¡ˆä¾‹ select nvl(1,0) -- è¿”å›1 select nvl(null,0) -- è¿”å›0 æ—¥æœŸå‡½æ•° add_months add_month( DATE | STRING | TIMESTAMP start_date , INT num_months)\nè§£é‡Š start_dateå‚æ•°å¯ä»¥æ˜¯string, date æˆ–è€…timestampç±»å‹ï¼Œnum_monthså‚æ•°æ—¶intç±»å‹ã€‚è¿”å›ä¸€ä¸ªæ—¥æœŸï¼Œè¯¥æ—¥æœŸæ˜¯åœ¨start_dateåŸºç¡€ä¹‹ä¸ŠåŠ ä¸Šnum_monthsä¸ªæœˆï¼Œå³start_dateä¹‹ånull_monthsä¸ªæœˆçš„ä¸€ä¸ªæ—¥æœŸã€‚å¦‚æœstart_dateçš„æ—¶é—´éƒ¨åˆ†çš„æ•°æ®ä¼šè¢«å¿½ç•¥ã€‚æ³¨æ„ï¼šå¦‚æœstart_dateæ‰€åœ¨æœˆä»½çš„å¤©æ•°å¤§äºç»“æœæ—¥æœŸæœˆçš„å¤©æ•°ï¼Œåˆ™è¿”å›ç»“æœæœˆçš„æœ€åä¸€å¤©çš„æ—¥æœŸã€‚\nä½¿ç”¨æ¡ˆä¾‹ select add_months(\"2020-05-20\",2); -- è¿”å›2020-07-20 select add_months(\"2020-05-20\",8); -- è¿”å›2021-01-20 select add_months(\"2020-05-31\",1); -- è¿”å›2020-06-30,5æœˆæœ‰31å¤©ï¼Œ6æœˆåªæœ‰30å¤©ï¼Œæ‰€ä»¥è¿”å›ä¸‹ä¸€ä¸ªæœˆçš„æœ€åä¸€å¤© current_date è§£é‡Š è¿”å›æŸ¥è¯¢æ—¶åˆ»çš„å½“å‰æ—¥æœŸ\nä½¿ç”¨æ¡ˆä¾‹ select current_date() -- è¿”å›å½“å‰æŸ¥è¯¢æ—¥æœŸ2020-05-20 current_timestamp() è§£é‡Š è¿”å›æŸ¥è¯¢æ—¶åˆ»çš„å½“å‰æ—¶é—´\nä½¿ç”¨æ¡ˆä¾‹ select current_timestamp() -- 2020-05-20 14:40:47.273 datediff(STRING enddate, STRING startdate) è§£é‡Š è¿”å›å¼€å§‹æ—¥æœŸstartdateä¸ç»“æŸæ—¥æœŸenddateä¹‹å‰ç›¸å·®çš„å¤©æ•°\nä½¿ç”¨æ¡ˆä¾‹ select datediff(\"2020-05-20\",\"2020-05-21\"); -- è¿”å›-1 select datediff(\"2020-05-21\",\"2020-05-20\"); -- è¿”å›1 date_add(DATE startdate, INT days) è§£é‡Š åœ¨startdateåŸºç¡€ä¸ŠåŠ ä¸Šå‡ å¤©ï¼Œç„¶åè¿”å›åŠ ä¸Šå‡ å¤©ä¹‹åçš„ä¸€ä¸ªæ—¥æœŸ\nä½¿ç”¨æ¡ˆä¾‹ select date_add(\"2020-05-20\",1); -- è¿”å›2020-05-21,1è¡¨ç¤ºåŠ 1å¤© select date_add(\"2020-05-20\",-1); -- è¿”å›2020-05-19ï¼Œ-1è¡¨ç¤ºå‡ä¸€å¤© date_sub(DATE startdate, INT days) è§£é‡Š åœ¨startdateåŸºç¡€ä¸Šå‡å»å‡ å¤©ï¼Œç„¶åè¿”å›å‡å»å‡ å¤©ä¹‹åçš„ä¸€ä¸ªæ—¥æœŸ,åŠŸèƒ½ä¸date_addå¾ˆç±»ä¼¼\nä½¿ç”¨æ¡ˆä¾‹ select date_sub(\"2020-05-20\",1); -- è¿”å›2020-05-19,1è¡¨ç¤ºå‡1å¤© select date_sub(\"2020-05-20\",-1); -- è¿”å›2020-05-21ï¼Œ-1è¡¨ç¤ºåŠ 1å¤© date_format(DATE|TIMESTAMP|STRING ts, STRING fmt) è§£é‡Š å°†date/timestamp/stringç±»å‹çš„å€¼è½¬æ¢ä¸ºä¸€ä¸ªå…·ä½“æ ¼å¼åŒ–çš„å­—ç¬¦ä¸²ã€‚æ”¯æŒjavaçš„SimpleDateFormatæ ¼å¼ï¼Œç¬¬äºŒä¸ªå‚æ•°fmtå¿…é¡»æ˜¯ä¸€ä¸ªå¸¸é‡\nä½¿ç”¨æ¡ˆä¾‹ select date_format('2020-05-20', 'yyyy'); -- è¿”å›2020 select date_format('2020-05-20', 'MM'); -- è¿”å›05 select date_format('2020-05-20', 'dd'); -- è¿”å›20 -- è¿”å›2020å¹´05æœˆ20æ—¥ 00æ—¶00åˆ†00ç§’ select date_format('2020-05-20', 'yyyyå¹´MMæœˆddæ—¥ HHæ—¶mmåˆ†ssç§’') ; select date_format('2020-05-20', 'yy/MM/dd') -- è¿”å› 20/05/20 dayofmonth(STRING date) è§£é‡Š è¿”å›ä¸€ä¸ªæ—¥æœŸæˆ–æ—¶é—´çš„å¤©,ä¸day()å‡½æ•°åŠŸèƒ½ç›¸åŒ\nä½¿ç”¨æ¡ˆä¾‹ select dayofmonth('2020-05-20') -- è¿”å›20 extract(field FROM source) æ—¶é—´æˆªå–å‡½æ•° è§£é‡Š æå– day, dayofweek, hour, minute, month, quarter, second, week æˆ–è€…yearçš„å€¼ï¼Œfieldå¯ä»¥é€‰æ‹©day, dayofweek, hour, minute, month, quarter, second, week æˆ–è€…yearï¼Œsourceå¿…é¡»æ˜¯ä¸€ä¸ªdateã€timestampæˆ–è€…å¯ä»¥è½¬ä¸º date ã€timestampçš„å­—ç¬¦ä¸²ã€‚æ³¨æ„ï¼šHive 2.2.0ç‰ˆæœ¬ä¹‹åæ”¯æŒè¯¥å‡½æ•°\nä½¿ç”¨æ¡ˆä¾‹ select extract(year from '2020-05-20 15:21:34.467'); -- è¿”å›2020ï¼Œå¹´ select extract(quarter from '2020-05-20 15:21:34.467'); -- è¿”å›2ï¼Œå­£åº¦ select extract(month from '2020-05-20 15:21:34.467'); -- è¿”å›05ï¼Œæœˆä»½ select extract(week from '2020-05-20 15:21:34.467'); -- è¿”å›21ï¼ŒåŒweekofyearï¼Œä¸€å¹´ä¸­çš„ç¬¬å‡ å‘¨ select extract(dayofweek from '2020-05-20 15:21:34.467'); -- è¿”å›4,ä»£è¡¨æ˜ŸæœŸä¸‰ select extract(day from '2020-05-20 15:21:34.467'); -- è¿”å›20ï¼Œå¤© select extract(hour from '2020-05-20 15:21:34.467'); -- è¿”å›15ï¼Œå°æ—¶ select extract(minute from '2020-05-20 15:21:34.467'); -- è¿”å›21ï¼Œåˆ†é’Ÿ select extract(second from '2020-05-20 15:21:34.467'); -- è¿”å›34ï¼Œç§’ year(STRING date) è§£é‡Š è¿”å›æ—¶é—´çš„å¹´ä»½,å¯ä»¥ç”¨extractå‡½æ•°æ›¿ä»£\nä½¿ç”¨æ¡ˆä¾‹ select year('2020-05-20 15:21:34'); -- è¿”å›2020 quarter(DATE|TIMESTAMP|STRING a) è§£é‡Š è¿”å›ç»™å®šæ—¶é—´æˆ–æ—¥æœŸçš„å­£åº¦ï¼Œ1è‡³4ä¸ªå­£åº¦,å¯ä»¥ç”¨extractå‡½æ•°æ›¿ä»£\nä½¿ç”¨æ¡ˆä¾‹ select quarter('2020-05-20 15:21:34'); -- è¿”å›2ï¼Œç¬¬2å­£åº¦ month(STRING date) è§£é‡Š è¿”å›æ—¶é—´çš„æœˆä»½,å¯ä»¥ç”¨extractå‡½æ•°æ›¿ä»£\nä½¿ç”¨æ¡ˆä¾‹ select month('2020-05-20 15:21:34') -- è¿”å›5 day(STRING date), è§£é‡Š è¿”å›ä¸€ä¸ªæ—¥æœŸæˆ–è€…æ—¶é—´çš„å¤©,å¯ä»¥ç”¨extractå‡½æ•°æ›¿ä»£\nä½¿ç”¨æ¡ˆä¾‹ select day(\"2020-05-20\"); -- è¿”å›20 select day(\"2020-05-20 15:05:27.5\"); -- è¿”å›20 hour(STRING date) è§£é‡Š è¿”å›ä¸€ä¸ªæ—¶é—´çš„å°æ—¶,å¯ä»¥ç”¨extractå‡½æ•°æ›¿ä»£\nä½¿ç”¨æ¡ˆä¾‹ select hour('2020-05-20 15:21:34');-- è¿”å›15 minute(STRING date) è§£é‡Š è¿”å›ä¸€ä¸ªæ—¶é—´çš„åˆ†é’Ÿå€¼,å¯ä»¥ç”¨extractå‡½æ•°æ›¿ä»£\nä½¿ç”¨æ¡ˆä¾‹ select minute('2020-05-20 15:21:34'); -- è¿”å›21 second(STRING date) è§£é‡Š è¿”å›ä¸€ä¸ªæ—¶é—´çš„ç§’,å¯ä»¥ç”¨extractå‡½æ•°æ›¿ä»£\nä½¿ç”¨æ¡ˆä¾‹ select second('2020-05-20 15:21:34'); --è¿”å›34 from_unixtime(BIGINT unixtime [, STRING format]) è§£é‡Š å°†å°†Unixæ—¶é—´æˆ³è½¬æ¢ä¸ºå­—ç¬¦ä¸²æ ¼å¼çš„æ—¶é—´(æ¯”å¦‚yyyy-MM-dd HH:mm:ssæ ¼å¼)\nä½¿ç”¨æ¡ˆä¾‹ select from_unixtime(1589960708); -- è¿”å›2020-05-20 15:45:08 select from_unixtime(1589960708, 'yyyy-MM-dd hh:mm:ss'); -- -- è¿”å›2020-05-20 15:45:08 select from_unixtime(1589960708, 'yyyy-MM-dd'); -- è¿”å›2020-05-20 from_utc_timestamp(T a, STRING timezone) è§£é‡Š è½¬æ¢ä¸ºç‰¹å®šæ—¶åŒºçš„æ—¶é—´\nä½¿ç”¨æ¡ˆä¾‹ select from_utc_timestamp('2020-05-20 15:21:34','PST'); -- è¿”å›2020-05-20 08:21:34.0 select from_utc_timestamp('2020-05-20 15:21:34','GMT'); -- è¿”å›2020-05-20 15:21:34.0 select from_utc_timestamp('2020-05-20 15:21:34','UTC'); -- è¿”å›2020-05-20 15:21:34.0 select from_utc_timestamp('2020-05-20 15:21:34','DST'); -- è¿”å›2020-05-20 15:21:34.0 select from_utc_timestamp('2020-05-20 15:21:34','CST'); -- è¿”å›2020-05-20 10:21:34.0 last_day(STRING date) è§£é‡Š è¿”å›ç»™å®šæ—¶é—´æˆ–æ—¥æœŸæ‰€åœ¨æœˆçš„æœ€åä¸€å¤©ï¼Œå‚æ•°å¯ä»¥æ˜¯â€™yyyy-MM-dd HH:mm:ssâ€™ æˆ–è€… â€˜yyyy-MM-ddâ€™ç±»å‹ï¼Œæ—¶é—´éƒ¨åˆ†ä¼šè¢«å¿½ç•¥\nä½¿ç”¨æ¡ˆä¾‹ select last_day('2020-05-20 15:21:34'); -- è¿”å›2020-05-31 select last_day('2020-05-20'); -- è¿”å›2020-05-31 to_date(STRING timestamp) è§£é‡Š è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²æ—¶é—´çš„æ—¥æœŸéƒ¨åˆ†ï¼Œå»æ‰æ—¶é—´éƒ¨åˆ†ï¼Œ2.1.0ä¹‹å‰ç‰ˆæœ¬è¿”å›çš„æ˜¯stringï¼Œ2.1.0ç‰ˆæœ¬åŠä¹‹åè¿”å›çš„æ˜¯date\nä½¿ç”¨æ¡ˆä¾‹ select to_date('2020-05-20 15:21:34'); -- è¿”å›2020-05-20 select to_date('2020-05-20'); -- è¿”å›2020-05-20 to_utc_timestamp(T a, STRING timezone) è§£é‡Š è½¬æ¢ä¸ºä¸–ç•Œæ ‡å‡†æ—¶é—´UTCçš„æ—¶é—´æˆ³,ä¸from_utc_timestampç±»ä¼¼\nä½¿ç”¨æ¡ˆä¾‹ select to_utc_timestamp('2020-05-20 15:21:34', 'GMT'); -- è¿”å›2020-05-20 15:21:34.0 trunc(STRING date, STRING format) æˆªå–å¹´æˆ–æœˆçš„ç¬¬ä¸€å¤© è§£é‡Š æˆªæ–­æ—¥æœŸåˆ°æŒ‡å®šçš„æ—¥æœŸç²¾åº¦ï¼Œä»…æ”¯æŒæœˆï¼ˆMONTH/MON/MMï¼‰æˆ–è€…å¹´ï¼ˆYEAR/YYYY/YYï¼‰\nä½¿ç”¨æ¡ˆä¾‹ select trunc('2020-05-20', 'YY'); -- è¿”å›2020-01-01ï¼Œè¿”å›å¹´çš„1æœˆ1æ—¥ select trunc('2020-05-20', 'MM'); -- è¿”å›2020-05-01ï¼Œè¿”å›æœˆçš„ç¬¬ä¸€å¤© select trunc('2020-05-20 15:21:34', 'MM'); -- è¿”å›2020-05-01 unix_timestamp([STRING date [, STRING pattern]]) è§£é‡Š å‚æ•°æ—¶å¯é€‰çš„ï¼Œå½“å‚æ•°ä¸ºç©ºæ—¶ï¼Œè¿”å›å½“å‰Unixæ˜¯æ—¶é—´æˆ³ï¼Œç²¾ç¡®åˆ°ç§’ã€‚å¯ä»¥æŒ‡å®šä¸€ä¸ªå…·ä½“çš„æ—¥æœŸï¼Œè½¬æ¢ä¸ºUnixæ—¶é—´æˆ³æ ¼å¼\nä½¿ç”¨æ¡ˆä¾‹ -- è¿”å›1589959294 select unix_timestamp('2020-05-20 15:21:34','yyyy-MM-dd hh:mm:ss'); -- è¿”å›1589904000 select unix_timestamp('2020-05-20','yyyy-MM-dd'); weekofyear(STRING date) è§£é‡Š è¿”å›ä¸€ä¸ªæ—¥æœŸæˆ–æ—¶é—´åœ¨ä¸€å¹´ä¸­çš„ç¬¬å‡ å‘¨ï¼Œå¯ä»¥ç”¨extractæ›¿ä»£\nä½¿ç”¨æ¡ˆä¾‹ select weekofyear('2020-05-20 15:21:34'); -- è¿”å›21ï¼Œç¬¬21å‘¨ select weekofyear('2020-05-20'); -- è¿”å›21ï¼Œç¬¬21å‘¨ next_day(STRING start_date, STRING day_of_week) è§£é‡Š å‚æ•°start_dateå¯ä»¥æ˜¯ä¸€ä¸ªæ—¶é—´æˆ–æ—¥æœŸï¼Œday_of_weekè¡¨ç¤ºæ˜ŸæœŸå‡ ï¼Œæ¯”å¦‚Moè¡¨ç¤ºæ˜ŸæœŸä¸€ï¼ŒTuè¡¨ç¤ºæ˜ŸæœŸäºŒï¼ŒWedè¡¨ç¤ºæ˜ŸæœŸä¸‰ï¼ŒThurè¡¨ç¤ºæ˜ŸæœŸå››ï¼ŒFriè¡¨ç¤ºæ˜ŸæœŸäº”ï¼ŒSatè¡¨ç¤ºæ˜ŸæœŸå…­ï¼ŒSunè¡¨ç¤ºæ˜ŸæœŸæ—¥ã€‚å¦‚æœæŒ‡å®šçš„æ˜ŸæœŸå‡ åœ¨è¯¥æ—¥æœŸæ‰€åœ¨çš„å‘¨ä¸”åœ¨è¯¥æ—¥æœŸä¹‹åï¼Œåˆ™è¿”å›å½“å‘¨çš„æ˜ŸæœŸå‡ æ—¥æœŸï¼Œå¦‚æœæŒ‡å®šçš„æ˜ŸæœŸå‡ ä¸åœ¨è¯¥æ—¥æœŸæ‰€åœ¨çš„å‘¨ï¼Œåˆ™è¿”å›ä¸‹ä¸€ä¸ªæ˜ŸæœŸå‡ å¯¹åº”çš„æ—¥æœŸ\nä½¿ç”¨æ¡ˆä¾‹ select next_day('2020-05-20','Mon');-- è¿”å›å½“å‰æ—¥æœŸçš„ä¸‹ä¸€ä¸ªå‘¨ä¸€æ—¥æœŸ:2020-05-25 select next_day('2020-05-20','Tu');-- è¿”å›å½“å‰æ—¥æœŸçš„ä¸‹ä¸€ä¸ªå‘¨äºŒæ—¥æœŸ:2020-05-26 select next_day('2020-05-20','Wed');-- è¿”å›å½“å‰æ—¥æœŸçš„ä¸‹ä¸€ä¸ªå‘¨ä¸‰æ—¥æœŸ:2020-05-27 -- 2020-05-20ä¸ºå‘¨ä¸‰ï¼ŒæŒ‡å®šçš„å‚æ•°ä¸ºå‘¨å››ï¼Œæ‰€ä»¥è¿”å›å½“å‘¨çš„å‘¨å››å°±æ˜¯2020-05-21 select next_day('2020-05-20','Th'); select next_day('2020-05-20','Fri');-- è¿”å›å‘¨äº”æ—¥æœŸ2020-05-22 select next_day('2020-05-20','Sat'); -- è¿”å›å‘¨å…­æ—¥æœŸ2020-05-23 select next_day('2020-05-20','Sun'); -- è¿”å›å‘¨å…­æ—¥æœŸ2020-05-24 è¯¥å‡½æ•°æ¯”è¾ƒé‡è¦ï¼šæ¯”å¦‚å–å½“å‰æ—¥æœŸæ‰€åœ¨çš„å‘¨ä¸€å’Œå‘¨æ—¥ï¼Œé€šè¿‡é•¿ç”¨åœ¨æŒ‰å‘¨è¿›è¡Œæ±‡æ€»æ•°æ®\nselect date_add(next_day('2020-05-20','MO'),-7); -- è¿”å›å½“å‰æ—¥æœŸçš„å‘¨ä¸€æ—¥æœŸ2020-05-18 select date_add(next_day('2020-05-20','MO'),-1); -- è¿”å›å½“å‰æ—¥æœŸçš„å‘¨æ—¥æ—¥æœŸ2020-05-24 months_between(DATE|TIMESTAMP|STRING date1, DATE|TIMESTAMP|STRING date2) è§£é‡Š è¿”å› date1 å’Œ date2 çš„æœˆä»½å·®ã€‚å¦‚æœdate1å¤§äºdate2ï¼Œè¿”å›æ­£å€¼ï¼Œå¦åˆ™è¿”å›è´Ÿå€¼ï¼Œå¦‚æœæ˜¯ç›¸å‡æ˜¯æ•´æ•°æœˆï¼Œåˆ™è¿”å›ä¸€ä¸ªæ•´æ•°ï¼Œå¦åˆ™ä¼šè¿”å›å°æ•°\nä½¿ç”¨æ¡ˆä¾‹ select months_between('2020-05-20','2020-05-20'); -- è¿”å›0 select months_between('2020-05-20','2020-06-20'); -- è¿”å›-1 -- ç›¸å·®çš„æ•´æ•°æœˆ select months_between('2020-06-30','2020-05-31'); -- è¿”å›1 -- éæ•´æ•°æœˆï¼Œä¸€ä¸ªæœˆå·®ä¸€å¤© select months_between('2020-06-29','2020-05-31'); -- è¿”å›0.93548387 ","wordCount":"3250","inLanguage":"zh","datePublished":"2023-08-22T00:00:00Z","dateModified":"2023-08-29T00:59:17+08:00","author":{"@type":"Person","name":"xkj"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://xiaokunji.com/zh/hadoop%E7%94%9F%E6%80%81%E5%9C%88/Hive/%E5%87%BD%E6%95%B0.html"},"publisher":{"@type":"Organization","name":"ç±³äºŒ","logo":{"@type":"ImageObject","url":"https://xiaokunji.com/img/Q.svg"}}}</script></head><body class="dark" id="top"><script>localStorage.getItem("pref-theme")==="light"&&document.body.classList.remove("dark")</script><header class="header"><nav class="nav"><div class="logo"><a accesskey="h" href="https://xiaokunji.com/zh/" title="ç±³äºŒ (Alt + H)"><img alt="" aria-label="logo" height="35" src="https://xiaokunji.com/img/Q.svg"/>ç±³äºŒ</a><div class="logo-switches"><button accesskey="t" id="theme-toggle" title="(Alt + T)"><svg fill="none" height="18" id="moon" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"></path></svg><svg fill="none" height="18" id="sun" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><circle cx="12" cy="12" r="5"></circle><line x1="12" x2="12" y1="1" y2="3"></line><line x1="12" x2="12" y1="21" y2="23"></line><line x1="4.22" x2="5.64" y1="4.22" y2="5.64"></line><line x1="18.36" x2="19.78" y1="18.36" y2="19.78"></line><line x1="1" x2="3" y1="12" y2="12"></line><line x1="21" x2="23" y1="12" y2="12"></line><line x1="4.22" x2="5.64" y1="19.78" y2="18.36"></line><line x1="18.36" x2="19.78" y1="5.64" y2="4.22"></line></svg></button><ul class="lang-switch"><li>|</li><li><a aria-label="English" href="https://xiaokunji.com/en/" title="English">English</a></li></ul></div></div><ul id="menu"><li><a href="https://xiaokunji.com/zh/" title="ğŸ ä¸»é¡µ"><span>ğŸ ä¸»é¡µ</span></a></li><li><a accesskey="/" href="https://xiaokunji.com/zh/search" title="ğŸ”æœç´¢ (Alt + /)"><span>ğŸ”æœç´¢</span></a></li><li><a href="https://xiaokunji.com/zh/post.html" title="ğŸ“šæ–‡ç« "><span>ğŸ“šæ–‡ç« </span></a></li><li><a href="https://xiaokunji.com/zh/archives.html" title="â±æ—¶é—´è½´"><span>â±æ—¶é—´è½´</span></a></li><li><a href="https://xiaokunji.com/zh/tags.html" title="ğŸ”–æ ‡ç­¾"><span>ğŸ”–æ ‡ç­¾</span></a></li><li><a href="https://xiaokunji.com/zh/categories.html" title="ğŸ“–åˆ†ç±»"><span>ğŸ“–åˆ†ç±»</span></a></li><li><a href="https://xiaokunji.com/zh/links.html" title="ğŸ¤å‹é“¾"><span>ğŸ¤å‹é“¾</span></a></li></ul></nav></header><main class="main"><article class="post-single"><header class="post-header"><nav aria-label="breadcrumb"><ul><a href="https://xiaokunji.com/zh/">ğŸ </a> <span>&gt;</span>
<a href="https://xiaokunji.com/zh/hadoop%E7%94%9F%E6%80%81%E5%9C%88.html">hadoopç”Ÿæ€åœˆ</a> <span>&gt;</span>
<a href="https://xiaokunji.com/zh/hadoop%E7%94%9F%E6%80%81%E5%9C%88/Hive.html">Hive</a> <span>&gt;</span></ul></nav><h1 class="post-title">å‡½æ•°</h1><div class="post-description"></div><div class="post-meta">åˆ›å»º:Â <span title="2023-08-22 00:00:00 +0000 UTC">2023-08-22</span>Â Â·Â æ›´æ–°:Â 2023-08-29Â Â·Â xkj
Â |Â åˆ†ç±»: Â <ul class="post-categories-meta" style="display:inline"><a href="https://xiaokunji.com/zh/categories/Hadoop%E7%94%9F%E6%80%81%E5%9C%88.html">Hadoopç”Ÿæ€åœˆ</a></ul><span id="busuanzi_container_page_pv">Â | è®¿é—®: <span id="busuanzi_value_page_pv">1</span></span></div></header><aside class="toc-container wide" id="toc-container"><div class="toc"><details open=""><summary accesskey="c" title="(Alt + C)"><span class="details">ç›®å½•</span></summary><div class="inner"><ul><li><a aria-label="æ¡ä»¶å‡½æ•°" href="#%e6%9d%a1%e4%bb%b6%e5%87%bd%e6%95%b0">æ¡ä»¶å‡½æ•°</a><ul><li><a aria-label="assert_true(BOOLEAN condition)" href="#assert_trueboolean-condition">assert_true(BOOLEAN condition)</a></li><li><a aria-label="coalesce(T v1, T v2, &amp;hellip;)" href="#coalescet-v1-t-v2-">coalesce(T v1, T v2, &amp;mldr;)</a></li><li><a aria-label="if" href="#if">if</a></li><li><a aria-label="isnotnull(a)" href="#isnotnulla">isnotnull(a)</a></li><li><a aria-label="isnull(a)" href="#isnulla">isnull(a)</a></li><li><a aria-label="nullif(a, b)" href="#nullifa-b">nullif(a, b)</a></li><li><a aria-label="nvl(T value, T default_value)" href="#nvlt-value-t-default_value">nvl(T value, T default_value)</a></li></ul></li><li><a aria-label="æ—¥æœŸå‡½æ•°" href="#%e6%97%a5%e6%9c%9f%e5%87%bd%e6%95%b0">æ—¥æœŸå‡½æ•°</a><ul><li><a aria-label="add_months" href="#add_months">add_months</a></li><li><a aria-label="current_date" href="#current_date">current_date</a></li><li><a aria-label="current_timestamp()" href="#current_timestamp">current_timestamp()</a></li><li><a aria-label="datediff(STRING enddate, STRING startdate)" href="#datediffstring-enddate-string-startdate">datediff(STRING enddate, STRING startdate)</a></li><li><a aria-label="date_add(DATE startdate, INT days)" href="#date_adddate-startdate-int-days">date_add(DATE startdate, INT days)</a></li><li><a aria-label="date_sub(DATE startdate, INT days)" href="#date_subdate-startdate-int-days">date_sub(DATE startdate, INT days)</a></li><li><a aria-label="date_format(DATE|TIMESTAMP|STRING ts, STRING fmt)" href="#date_formatdatetimestampstring-ts-string-fmt">date_format(DATE|TIMESTAMP|STRING ts, STRING fmt)</a></li><li><a aria-label="dayofmonth(STRING date)" href="#dayofmonthstring-date">dayofmonth(STRING date)</a></li><li><a aria-label="extract(field FROM source) æ—¶é—´æˆªå–å‡½æ•°" href="#extractfield-from-source-%e6%97%b6%e9%97%b4%e6%88%aa%e5%8f%96%e5%87%bd%e6%95%b0">extract(field FROM source) æ—¶é—´æˆªå–å‡½æ•°</a></li><li><a aria-label="year(STRING date)" href="#yearstring-date">year(STRING date)</a></li><li><a aria-label="quarter(DATE|TIMESTAMP|STRING a)" href="#quarterdatetimestampstring-a">quarter(DATE|TIMESTAMP|STRING a)</a></li><li><a aria-label="month(STRING date)" href="#monthstring-date">month(STRING date)</a></li><li><a aria-label="day(STRING date)," href="#daystring-date">day(STRING date),</a></li><li><a aria-label="hour(STRING date)" href="#hourstring-date">hour(STRING date)</a></li><li><a aria-label="minute(STRING date)" href="#minutestring-date">minute(STRING date)</a></li><li><a aria-label="second(STRING date)" href="#secondstring-date">second(STRING date)</a></li><li><a aria-label="from_unixtime(BIGINT unixtime [, STRING format])" href="#from_unixtimebigint-unixtime--string-format">from_unixtime(BIGINT unixtime [, STRING format])</a></li><li><a aria-label="from_utc_timestamp(T a, STRING timezone)" href="#from_utc_timestampt-a-string-timezone">from_utc_timestamp(T a, STRING timezone)</a></li><li><a aria-label="last_day(STRING date)" href="#last_daystring-date">last_day(STRING date)</a></li><li><a aria-label="to_date(STRING timestamp)" href="#to_datestring-timestamp">to_date(STRING timestamp)</a></li><li><a aria-label="to_utc_timestamp(T a, STRING timezone)" href="#to_utc_timestampt-a-string-timezone">to_utc_timestamp(T a, STRING timezone)</a></li><li><a aria-label="trunc(STRING date, STRING format)  æˆªå–å¹´æˆ–æœˆçš„ç¬¬ä¸€å¤©" href="#truncstring-date-string-format--%e6%88%aa%e5%8f%96%e5%b9%b4%e6%88%96%e6%9c%88%e7%9a%84%e7%ac%ac%e4%b8%80%e5%a4%a9">trunc(STRING date, STRING format) æˆªå–å¹´æˆ–æœˆçš„ç¬¬ä¸€å¤©</a></li><li><a aria-label="unix_timestamp([STRING date [, STRING pattern]])" href="#unix_timestampstring-date--string-pattern">unix_timestamp([STRING date [, STRING pattern]])</a></li><li><a aria-label="weekofyear(STRING date)" href="#weekofyearstring-date">weekofyear(STRING date)</a></li><li><a aria-label="next_day(STRING start_date, STRING day_of_week)" href="#next_daystring-start_date-string-day_of_week">next_day(STRING start_date, STRING day_of_week)</a></li><li><a aria-label="months_between(DATE|TIMESTAMP|STRING date1, DATE|TIMESTAMP|STRING date2)" href="#months_betweendatetimestampstring-date1-datetimestampstring-date2">months_between(DATE|TIMESTAMP|STRING date1, DATE|TIMESTAMP|STRING date2)</a></li></ul></li></ul></div></details></div></aside><script>let activeElement,elements;window.addEventListener("DOMContentLoaded",function(){checkTocPosition(),elements=document.querySelectorAll("h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]"),activeElement=elements[0];const t=encodeURI(activeElement.getAttribute("id")).toLowerCase();document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active")},!1),window.addEventListener("resize",function(){checkTocPosition()},!1),window.addEventListener("scroll",()=>{activeElement=Array.from(elements).find(e=>{if(getOffsetTop(e)-window.pageYOffset>0&&getOffsetTop(e)-window.pageYOffset<window.innerHeight/2)return e})||activeElement,elements.forEach(e=>{const t=encodeURI(e.getAttribute("id")).toLowerCase();e===activeElement?document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active"):document.querySelector(`.inner ul li a[href="#${t}"]`).classList.remove("active")})},!1);const main=parseInt(getComputedStyle(document.body).getPropertyValue("--article-width"),10),toc=parseInt(getComputedStyle(document.body).getPropertyValue("--toc-width"),10),gap=parseInt(getComputedStyle(document.body).getPropertyValue("--gap"),10);function checkTocPosition(){const e=document.body.scrollWidth;e-main-toc*2-gap*4>0?document.getElementById("toc-container").classList.add("wide"):document.getElementById("toc-container").classList.remove("wide")}function getOffsetTop(e){if(!e.getClientRects().length)return 0;let t=e.getBoundingClientRect(),n=e.ownerDocument.defaultView;return t.top+n.pageYOffset}</script><div class="post-content"><p>[toc]</p><h2 id="æ¡ä»¶å‡½æ•°">æ¡ä»¶å‡½æ•°<a aria-hidden="true" class="anchor" hidden="" href="#æ¡ä»¶å‡½æ•°">#</a></h2><h3 id="assert_trueboolean-condition">assert_true(BOOLEAN condition)<a aria-hidden="true" class="anchor" hidden="" href="#assert_trueboolean-condition">#</a></h3><ul><li>è§£é‡Š</li></ul><p>å¦‚æœconditionä¸ä¸ºtrueï¼Œåˆ™æŠ›å‡ºå¼‚å¸¸ï¼Œå¦åˆ™è¿”å›null</p><ul><li>ä½¿ç”¨æ¡ˆä¾‹</li></ul><div class="highlight"><pre style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4" tabindex="0"><code class="language-fallback" data-lang="fallback"><span style="display:flex"><span>select assert_true(1&lt;2) -- è¿”å›null
</span></span><span style="display:flex"><span>select assert_true(1&gt;2) -- æŠ›å‡ºå¼‚å¸¸
</span></span></code></pre></div><h3 id="coalescet-v1-t-v2-">coalesce(T v1, T v2, &amp;mldr;)<a aria-hidden="true" class="anchor" hidden="" href="#coalescet-v1-t-v2-">#</a></h3><ul><li>è§£é‡Š</li></ul><p>è¿”å›ç¬¬ä¸€ä¸ªä¸ä¸ºnullçš„å€¼ï¼Œå¦‚æœéƒ½ä¸ºnullï¼Œåˆ™è¿”å›null</p><ul><li>ä½¿ç”¨æ¡ˆä¾‹</li></ul><div class="highlight"><pre style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4" tabindex="0"><code class="language-fallback" data-lang="fallback"><span style="display:flex"><span>select coalesce(null,1,2,null)  -- è¿”å›1
</span></span><span style="display:flex"><span>select coalesce(1,null) -- è¿”å›1
</span></span><span style="display:flex"><span>select coalesce(null,null) -- è¿”å›null
</span></span></code></pre></div><h3 id="if">if<a aria-hidden="true" class="anchor" hidden="" href="#if">#</a></h3><p>if ( BOOLEAN testCondition, T valueTrue , T valueFalseOrNull )</p><ul><li>è§£é‡Š</li></ul><p>å¦‚æœtestConditionæ¡ä»¶ä¸ºtrueï¼Œåˆ™è¿”å›ç¬¬ä¸€ä¸ªå€¼ï¼Œå¦åˆ™è¿”å›ç¬¬äºŒä¸ªå€¼</p><ul><li>ä½¿ç”¨æ¡ˆä¾‹</li></ul><div class="highlight"><pre style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4" tabindex="0"><code class="language-fallback" data-lang="fallback"><span style="display:flex"><span>select if(1 is null,0,1)  -- è¿”å›1
</span></span><span style="display:flex"><span>select if(null is null,0,1) -- è¿”å›0
</span></span></code></pre></div><h3 id="isnotnulla">isnotnull(a)<a aria-hidden="true" class="anchor" hidden="" href="#isnotnulla">#</a></h3><ul><li>è§£é‡Š</li></ul><p>å¦‚æœå‚æ•°aä¸ä¸ºnullï¼Œåˆ™è¿”å›trueï¼Œå¦åˆ™è¿”å›false</p><ul><li>ä½¿ç”¨æ¡ˆä¾‹</li></ul><div class="highlight"><pre style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4" tabindex="0"><code class="language-fallback" data-lang="fallback"><span style="display:flex"><span>select isnotnull(1) -- è¿”å›true
</span></span><span style="display:flex"><span>select isnotnull(null) -- è¿”å›false
</span></span></code></pre></div><h3 id="isnulla">isnull(a)<a aria-hidden="true" class="anchor" hidden="" href="#isnulla">#</a></h3><ul><li>è§£é‡Š</li></ul><p>ä¸isnotnullç›¸åï¼Œå¦‚æœå‚æ•°aä¸ºnullï¼Œåˆ™è¿”å›trueï¼Œå¦åˆ™è¿”å›false</p><ul><li>ä½¿ç”¨æ¡ˆä¾‹</li></ul><div class="highlight"><pre style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4" tabindex="0"><code class="language-fallback" data-lang="fallback"><span style="display:flex"><span>select isnull(null) -- è¿”å›true
</span></span><span style="display:flex"><span>select isnull(1) -- è¿”å›false
</span></span></code></pre></div><h3 id="nullifa-b">nullif(a, b)<a aria-hidden="true" class="anchor" hidden="" href="#nullifa-b">#</a></h3><ul><li>è§£é‡Š</li></ul><p>å¦‚æœå‚æ•°a=bï¼Œè¿”å›nullï¼Œå¦åˆ™è¿”å›aå€¼(Hive2.2.0ç‰ˆæœ¬)</p><ul><li>ä½¿ç”¨æ¡ˆä¾‹</li></ul><div class="highlight"><pre style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4" tabindex="0"><code class="language-fallback" data-lang="fallback"><span style="display:flex"><span>select nullif(1,2) -- è¿”å›1
</span></span><span style="display:flex"><span>select nullif(1,1) -- è¿”å›null
</span></span></code></pre></div><h3 id="nvlt-value-t-default_value">nvl(T value, T default_value)<a aria-hidden="true" class="anchor" hidden="" href="#nvlt-value-t-default_value">#</a></h3><ul><li>è§£é‡Š</li></ul><p>å¦‚æœvalueçš„å€¼ä¸ºnullï¼Œåˆ™è¿”å›default_valueé»˜è®¤å€¼ï¼Œå¦åˆ™è¿”å›valueçš„å€¼ã€‚åœ¨nullå€¼åˆ¤æ–­æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ifå‡½æ•°ç»™å®šé»˜è®¤å€¼ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨æ­¤å‡½æ•°ç»™å®šé»˜è®¤å€¼ï¼Œä½¿ç”¨è¯¥å‡½æ•°sqlç‰¹åˆ«ç®€æ´ã€‚</p><ul><li>ä½¿ç”¨æ¡ˆä¾‹</li></ul><div class="highlight"><pre style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4" tabindex="0"><code class="language-fallback" data-lang="fallback"><span style="display:flex"><span>select nvl(1,0) -- è¿”å›1
</span></span><span style="display:flex"><span>select nvl(null,0) -- è¿”å›0
</span></span></code></pre></div><h2 id="æ—¥æœŸå‡½æ•°">æ—¥æœŸå‡½æ•°<a aria-hidden="true" class="anchor" hidden="" href="#æ—¥æœŸå‡½æ•°">#</a></h2><h3 id="add_months">add_months<a aria-hidden="true" class="anchor" hidden="" href="#add_months">#</a></h3><p>add_month( DATE | STRING | TIMESTAMP start_date , INT num_months)</p><ul><li>è§£é‡Š</li></ul><p>start_dateå‚æ•°å¯ä»¥æ˜¯string, date æˆ–è€…timestampç±»å‹ï¼Œnum_monthså‚æ•°æ—¶intç±»å‹ã€‚è¿”å›ä¸€ä¸ªæ—¥æœŸï¼Œè¯¥æ—¥æœŸæ˜¯åœ¨start_dateåŸºç¡€ä¹‹ä¸ŠåŠ ä¸Šnum_monthsä¸ªæœˆï¼Œå³start_dateä¹‹ånull_monthsä¸ªæœˆçš„ä¸€ä¸ªæ—¥æœŸã€‚å¦‚æœstart_dateçš„æ—¶é—´éƒ¨åˆ†çš„æ•°æ®ä¼šè¢«å¿½ç•¥ã€‚æ³¨æ„ï¼šå¦‚æœstart_dateæ‰€åœ¨æœˆä»½çš„å¤©æ•°å¤§äºç»“æœæ—¥æœŸæœˆçš„å¤©æ•°ï¼Œåˆ™è¿”å›ç»“æœæœˆçš„æœ€åä¸€å¤©çš„æ—¥æœŸã€‚</p><ul><li>ä½¿ç”¨æ¡ˆä¾‹</li></ul><div class="highlight"><pre style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4" tabindex="0"><code class="language-fallback" data-lang="fallback"><span style="display:flex"><span>select add_months("2020-05-20",2); -- è¿”å›2020-07-20
</span></span><span style="display:flex"><span>select add_months("2020-05-20",8); -- è¿”å›2021-01-20
</span></span><span style="display:flex"><span>select add_months("2020-05-31",1); -- è¿”å›2020-06-30,5æœˆæœ‰31å¤©ï¼Œ6æœˆåªæœ‰30å¤©ï¼Œæ‰€ä»¥è¿”å›ä¸‹ä¸€ä¸ªæœˆçš„æœ€åä¸€å¤©
</span></span></code></pre></div><h3 id="current_date">current_date<a aria-hidden="true" class="anchor" hidden="" href="#current_date">#</a></h3><ul><li>è§£é‡Š</li></ul><p>è¿”å›æŸ¥è¯¢æ—¶åˆ»çš„å½“å‰æ—¥æœŸ</p><ul><li>ä½¿ç”¨æ¡ˆä¾‹</li></ul><div class="highlight"><pre style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4" tabindex="0"><code class="language-fallback" data-lang="fallback"><span style="display:flex"><span>select current_date() -- è¿”å›å½“å‰æŸ¥è¯¢æ—¥æœŸ2020-05-20
</span></span></code></pre></div><h3 id="current_timestamp">current_timestamp()<a aria-hidden="true" class="anchor" hidden="" href="#current_timestamp">#</a></h3><ul><li>è§£é‡Š</li></ul><p>è¿”å›æŸ¥è¯¢æ—¶åˆ»çš„å½“å‰æ—¶é—´</p><ul><li>ä½¿ç”¨æ¡ˆä¾‹</li></ul><div class="highlight"><pre style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4" tabindex="0"><code class="language-fallback" data-lang="fallback"><span style="display:flex"><span>select current_timestamp() -- 2020-05-20 14:40:47.273
</span></span></code></pre></div><h3 id="datediffstring-enddate-string-startdate">datediff(STRING enddate, STRING startdate)<a aria-hidden="true" class="anchor" hidden="" href="#datediffstring-enddate-string-startdate">#</a></h3><ul><li>è§£é‡Š</li></ul><p>è¿”å›å¼€å§‹æ—¥æœŸstartdateä¸ç»“æŸæ—¥æœŸenddateä¹‹å‰ç›¸å·®çš„å¤©æ•°</p><ul><li>ä½¿ç”¨æ¡ˆä¾‹</li></ul><div class="highlight"><pre style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4" tabindex="0"><code class="language-fallback" data-lang="fallback"><span style="display:flex"><span>select datediff("2020-05-20","2020-05-21"); -- è¿”å›-1
</span></span><span style="display:flex"><span>select datediff("2020-05-21","2020-05-20"); -- è¿”å›1
</span></span></code></pre></div><h3 id="date_adddate-startdate-int-days">date_add(DATE startdate, INT days)<a aria-hidden="true" class="anchor" hidden="" href="#date_adddate-startdate-int-days">#</a></h3><ul><li>è§£é‡Š</li></ul><p>åœ¨startdateåŸºç¡€ä¸ŠåŠ ä¸Šå‡ å¤©ï¼Œç„¶åè¿”å›åŠ ä¸Šå‡ å¤©ä¹‹åçš„ä¸€ä¸ªæ—¥æœŸ</p><ul><li>ä½¿ç”¨æ¡ˆä¾‹</li></ul><div class="highlight"><pre style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4" tabindex="0"><code class="language-fallback" data-lang="fallback"><span style="display:flex"><span>select date_add("2020-05-20",1); -- è¿”å›2020-05-21,1è¡¨ç¤ºåŠ 1å¤©
</span></span><span style="display:flex"><span>select date_add("2020-05-20",-1); -- è¿”å›2020-05-19ï¼Œ-1è¡¨ç¤ºå‡ä¸€å¤©
</span></span></code></pre></div><h3 id="date_subdate-startdate-int-days">date_sub(DATE startdate, INT days)<a aria-hidden="true" class="anchor" hidden="" href="#date_subdate-startdate-int-days">#</a></h3><ul><li>è§£é‡Š</li></ul><p>åœ¨startdateåŸºç¡€ä¸Šå‡å»å‡ å¤©ï¼Œç„¶åè¿”å›å‡å»å‡ å¤©ä¹‹åçš„ä¸€ä¸ªæ—¥æœŸ,åŠŸèƒ½ä¸date_addå¾ˆç±»ä¼¼</p><ul><li>ä½¿ç”¨æ¡ˆä¾‹</li></ul><div class="highlight"><pre style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4" tabindex="0"><code class="language-fallback" data-lang="fallback"><span style="display:flex"><span>select date_sub("2020-05-20",1); -- è¿”å›2020-05-19,1è¡¨ç¤ºå‡1å¤©
</span></span><span style="display:flex"><span>select date_sub("2020-05-20",-1); -- è¿”å›2020-05-21ï¼Œ-1è¡¨ç¤ºåŠ 1å¤©
</span></span></code></pre></div><h3 id="date_formatdatetimestampstring-ts-string-fmt">date_format(DATE|TIMESTAMP|STRING ts, STRING fmt)<a aria-hidden="true" class="anchor" hidden="" href="#date_formatdatetimestampstring-ts-string-fmt">#</a></h3><ul><li>è§£é‡Š</li></ul><p>å°†date/timestamp/stringç±»å‹çš„å€¼è½¬æ¢ä¸ºä¸€ä¸ªå…·ä½“æ ¼å¼åŒ–çš„å­—ç¬¦ä¸²ã€‚æ”¯æŒjavaçš„SimpleDateFormatæ ¼å¼ï¼Œç¬¬äºŒä¸ªå‚æ•°fmtå¿…é¡»æ˜¯ä¸€ä¸ªå¸¸é‡</p><ul><li>ä½¿ç”¨æ¡ˆä¾‹</li></ul><div class="highlight"><pre style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4" tabindex="0"><code class="language-fallback" data-lang="fallback"><span style="display:flex"><span>select date_format('2020-05-20', 'yyyy'); -- è¿”å›2020
</span></span><span style="display:flex"><span>select date_format('2020-05-20', 'MM'); -- è¿”å›05
</span></span><span style="display:flex"><span>select date_format('2020-05-20', 'dd'); -- è¿”å›20
</span></span><span style="display:flex"><span>-- è¿”å›2020å¹´05æœˆ20æ—¥ 00æ—¶00åˆ†00ç§’
</span></span><span style="display:flex"><span>select date_format('2020-05-20', 'yyyyå¹´MMæœˆddæ—¥ HHæ—¶mmåˆ†ssç§’') ;
</span></span><span style="display:flex"><span>select date_format('2020-05-20', 'yy/MM/dd') -- è¿”å› 20/05/20
</span></span></code></pre></div><h3 id="dayofmonthstring-date">dayofmonth(STRING date)<a aria-hidden="true" class="anchor" hidden="" href="#dayofmonthstring-date">#</a></h3><ul><li>è§£é‡Š</li></ul><p>è¿”å›ä¸€ä¸ªæ—¥æœŸæˆ–æ—¶é—´çš„å¤©,ä¸day()å‡½æ•°åŠŸèƒ½ç›¸åŒ</p><ul><li>ä½¿ç”¨æ¡ˆä¾‹</li></ul><div class="highlight"><pre style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4" tabindex="0"><code class="language-fallback" data-lang="fallback"><span style="display:flex"><span>select dayofmonth('2020-05-20') -- è¿”å›20
</span></span></code></pre></div><h3 id="extractfield-from-source-æ—¶é—´æˆªå–å‡½æ•°">extract(field FROM source) æ—¶é—´æˆªå–å‡½æ•°<a aria-hidden="true" class="anchor" hidden="" href="#extractfield-from-source-æ—¶é—´æˆªå–å‡½æ•°">#</a></h3><ul><li>è§£é‡Š</li></ul><p>æå– day, dayofweek, hour, minute, month, quarter, second, week æˆ–è€…yearçš„å€¼ï¼Œfieldå¯ä»¥é€‰æ‹©day, dayofweek, hour, minute, month, quarter, second, week æˆ–è€…yearï¼Œsourceå¿…é¡»æ˜¯ä¸€ä¸ªdateã€timestampæˆ–è€…å¯ä»¥è½¬ä¸º date ã€timestampçš„å­—ç¬¦ä¸²ã€‚æ³¨æ„ï¼šHive 2.2.0ç‰ˆæœ¬ä¹‹åæ”¯æŒè¯¥å‡½æ•°</p><ul><li>ä½¿ç”¨æ¡ˆä¾‹</li></ul><div class="highlight"><pre style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4" tabindex="0"><code class="language-fallback" data-lang="fallback"><span style="display:flex"><span>select extract(year from '2020-05-20 15:21:34.467'); -- è¿”å›2020ï¼Œå¹´
</span></span><span style="display:flex"><span>select extract(quarter from '2020-05-20 15:21:34.467'); -- è¿”å›2ï¼Œå­£åº¦
</span></span><span style="display:flex"><span>select extract(month from '2020-05-20 15:21:34.467'); -- è¿”å›05ï¼Œæœˆä»½
</span></span><span style="display:flex"><span>select extract(week from '2020-05-20 15:21:34.467'); -- è¿”å›21ï¼ŒåŒweekofyearï¼Œä¸€å¹´ä¸­çš„ç¬¬å‡ å‘¨
</span></span><span style="display:flex"><span>select extract(dayofweek from '2020-05-20 15:21:34.467'); -- è¿”å›4,ä»£è¡¨æ˜ŸæœŸä¸‰
</span></span><span style="display:flex"><span>select extract(day from '2020-05-20 15:21:34.467'); -- è¿”å›20ï¼Œå¤©
</span></span><span style="display:flex"><span>select extract(hour from '2020-05-20 15:21:34.467'); -- è¿”å›15ï¼Œå°æ—¶
</span></span><span style="display:flex"><span>select extract(minute from '2020-05-20 15:21:34.467'); -- è¿”å›21ï¼Œåˆ†é’Ÿ
</span></span><span style="display:flex"><span>select extract(second from '2020-05-20 15:21:34.467'); -- è¿”å›34ï¼Œç§’
</span></span></code></pre></div><h3 id="yearstring-date">year(STRING date)<a aria-hidden="true" class="anchor" hidden="" href="#yearstring-date">#</a></h3><ul><li>è§£é‡Š</li></ul><p>è¿”å›æ—¶é—´çš„å¹´ä»½,å¯ä»¥ç”¨extractå‡½æ•°æ›¿ä»£</p><ul><li>ä½¿ç”¨æ¡ˆä¾‹</li></ul><div class="highlight"><pre style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4" tabindex="0"><code class="language-fallback" data-lang="fallback"><span style="display:flex"><span>select year('2020-05-20 15:21:34'); -- è¿”å›2020
</span></span></code></pre></div><h3 id="quarterdatetimestampstring-a">quarter(DATE|TIMESTAMP|STRING a)<a aria-hidden="true" class="anchor" hidden="" href="#quarterdatetimestampstring-a">#</a></h3><ul><li>è§£é‡Š</li></ul><p>è¿”å›ç»™å®šæ—¶é—´æˆ–æ—¥æœŸçš„å­£åº¦ï¼Œ1è‡³4ä¸ªå­£åº¦,å¯ä»¥ç”¨extractå‡½æ•°æ›¿ä»£</p><ul><li>ä½¿ç”¨æ¡ˆä¾‹</li></ul><div class="highlight"><pre style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4" tabindex="0"><code class="language-fallback" data-lang="fallback"><span style="display:flex"><span>select quarter('2020-05-20 15:21:34'); -- è¿”å›2ï¼Œç¬¬2å­£åº¦
</span></span></code></pre></div><h3 id="monthstring-date">month(STRING date)<a aria-hidden="true" class="anchor" hidden="" href="#monthstring-date">#</a></h3><ul><li>è§£é‡Š</li></ul><p>è¿”å›æ—¶é—´çš„æœˆä»½,å¯ä»¥ç”¨extractå‡½æ•°æ›¿ä»£</p><ul><li>ä½¿ç”¨æ¡ˆä¾‹</li></ul><div class="highlight"><pre style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4" tabindex="0"><code class="language-fallback" data-lang="fallback"><span style="display:flex"><span>select month('2020-05-20 15:21:34') -- è¿”å›5
</span></span></code></pre></div><h3 id="daystring-date">day(STRING date),<a aria-hidden="true" class="anchor" hidden="" href="#daystring-date">#</a></h3><ul><li>è§£é‡Š</li></ul><p>è¿”å›ä¸€ä¸ªæ—¥æœŸæˆ–è€…æ—¶é—´çš„å¤©,å¯ä»¥ç”¨extractå‡½æ•°æ›¿ä»£</p><ul><li>ä½¿ç”¨æ¡ˆä¾‹</li></ul><div class="highlight"><pre style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4" tabindex="0"><code class="language-fallback" data-lang="fallback"><span style="display:flex"><span>select day("2020-05-20"); -- è¿”å›20
</span></span><span style="display:flex"><span>select day("2020-05-20 15:05:27.5"); -- è¿”å›20
</span></span></code></pre></div><h3 id="hourstring-date">hour(STRING date)<a aria-hidden="true" class="anchor" hidden="" href="#hourstring-date">#</a></h3><ul><li>è§£é‡Š</li></ul><p>è¿”å›ä¸€ä¸ªæ—¶é—´çš„å°æ—¶,å¯ä»¥ç”¨extractå‡½æ•°æ›¿ä»£</p><ul><li>ä½¿ç”¨æ¡ˆä¾‹</li></ul><div class="highlight"><pre style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4" tabindex="0"><code class="language-fallback" data-lang="fallback"><span style="display:flex"><span>select hour('2020-05-20 15:21:34');-- è¿”å›15
</span></span></code></pre></div><h3 id="minutestring-date">minute(STRING date)<a aria-hidden="true" class="anchor" hidden="" href="#minutestring-date">#</a></h3><ul><li>è§£é‡Š</li></ul><p>è¿”å›ä¸€ä¸ªæ—¶é—´çš„åˆ†é’Ÿå€¼,å¯ä»¥ç”¨extractå‡½æ•°æ›¿ä»£</p><ul><li>ä½¿ç”¨æ¡ˆä¾‹</li></ul><div class="highlight"><pre style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4" tabindex="0"><code class="language-fallback" data-lang="fallback"><span style="display:flex"><span>select minute('2020-05-20 15:21:34'); -- è¿”å›21
</span></span></code></pre></div><h3 id="secondstring-date">second(STRING date)<a aria-hidden="true" class="anchor" hidden="" href="#secondstring-date">#</a></h3><ul><li>è§£é‡Š</li></ul><p>è¿”å›ä¸€ä¸ªæ—¶é—´çš„ç§’,å¯ä»¥ç”¨extractå‡½æ•°æ›¿ä»£</p><ul><li>ä½¿ç”¨æ¡ˆä¾‹</li></ul><div class="highlight"><pre style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4" tabindex="0"><code class="language-fallback" data-lang="fallback"><span style="display:flex"><span>select second('2020-05-20 15:21:34'); --è¿”å›34
</span></span></code></pre></div><h3 id="from_unixtimebigint-unixtime--string-format">from_unixtime(BIGINT unixtime [, STRING format])<a aria-hidden="true" class="anchor" hidden="" href="#from_unixtimebigint-unixtime--string-format">#</a></h3><ul><li>è§£é‡Š</li></ul><p>å°†å°†Unixæ—¶é—´æˆ³è½¬æ¢ä¸ºå­—ç¬¦ä¸²æ ¼å¼çš„æ—¶é—´(æ¯”å¦‚yyyy-MM-dd HH:mm:ssæ ¼å¼)</p><ul><li>ä½¿ç”¨æ¡ˆä¾‹</li></ul><div class="highlight"><pre style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4" tabindex="0"><code class="language-fallback" data-lang="fallback"><span style="display:flex"><span>select from_unixtime(1589960708); -- è¿”å›2020-05-20 15:45:08
</span></span><span style="display:flex"><span>select from_unixtime(1589960708, 'yyyy-MM-dd hh:mm:ss'); -- -- è¿”å›2020-05-20 15:45:08
</span></span><span style="display:flex"><span>select from_unixtime(1589960708, 'yyyy-MM-dd'); -- è¿”å›2020-05-20
</span></span></code></pre></div><h3 id="from_utc_timestampt-a-string-timezone">from_utc_timestamp(T a, STRING timezone)<a aria-hidden="true" class="anchor" hidden="" href="#from_utc_timestampt-a-string-timezone">#</a></h3><ul><li>è§£é‡Š</li></ul><p>è½¬æ¢ä¸ºç‰¹å®šæ—¶åŒºçš„æ—¶é—´</p><ul><li>ä½¿ç”¨æ¡ˆä¾‹</li></ul><div class="highlight"><pre style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4" tabindex="0"><code class="language-fallback" data-lang="fallback"><span style="display:flex"><span>select from_utc_timestamp('2020-05-20 15:21:34','PST'); -- è¿”å›2020-05-20 08:21:34.0
</span></span><span style="display:flex"><span>select from_utc_timestamp('2020-05-20 15:21:34','GMT'); -- è¿”å›2020-05-20 15:21:34.0
</span></span><span style="display:flex"><span>select from_utc_timestamp('2020-05-20 15:21:34','UTC'); -- è¿”å›2020-05-20 15:21:34.0
</span></span><span style="display:flex"><span>select from_utc_timestamp('2020-05-20 15:21:34','DST'); -- è¿”å›2020-05-20 15:21:34.0
</span></span><span style="display:flex"><span>select from_utc_timestamp('2020-05-20 15:21:34','CST'); -- è¿”å›2020-05-20 10:21:34.0
</span></span></code></pre></div><h3 id="last_daystring-date">last_day(STRING date)<a aria-hidden="true" class="anchor" hidden="" href="#last_daystring-date">#</a></h3><ul><li>è§£é‡Š</li></ul><p>è¿”å›ç»™å®šæ—¶é—´æˆ–æ—¥æœŸæ‰€åœ¨æœˆçš„æœ€åä¸€å¤©ï¼Œå‚æ•°å¯ä»¥æ˜¯â€™yyyy-MM-dd HH:mm:ssâ€™ æˆ–è€… â€˜yyyy-MM-ddâ€™ç±»å‹ï¼Œæ—¶é—´éƒ¨åˆ†ä¼šè¢«å¿½ç•¥</p><ul><li>ä½¿ç”¨æ¡ˆä¾‹</li></ul><div class="highlight"><pre style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4" tabindex="0"><code class="language-fallback" data-lang="fallback"><span style="display:flex"><span>select last_day('2020-05-20 15:21:34'); -- è¿”å›2020-05-31
</span></span><span style="display:flex"><span>select last_day('2020-05-20'); -- è¿”å›2020-05-31 
</span></span></code></pre></div><h3 id="to_datestring-timestamp">to_date(STRING timestamp)<a aria-hidden="true" class="anchor" hidden="" href="#to_datestring-timestamp">#</a></h3><ul><li>è§£é‡Š</li></ul><p>è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²æ—¶é—´çš„æ—¥æœŸéƒ¨åˆ†ï¼Œå»æ‰æ—¶é—´éƒ¨åˆ†ï¼Œ2.1.0ä¹‹å‰ç‰ˆæœ¬è¿”å›çš„æ˜¯stringï¼Œ2.1.0ç‰ˆæœ¬åŠä¹‹åè¿”å›çš„æ˜¯date</p><ul><li>ä½¿ç”¨æ¡ˆä¾‹</li></ul><div class="highlight"><pre style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4" tabindex="0"><code class="language-fallback" data-lang="fallback"><span style="display:flex"><span>select to_date('2020-05-20 15:21:34'); -- è¿”å›2020-05-20
</span></span><span style="display:flex"><span>select to_date('2020-05-20'); -- è¿”å›2020-05-20
</span></span></code></pre></div><h3 id="to_utc_timestampt-a-string-timezone">to_utc_timestamp(T a, STRING timezone)<a aria-hidden="true" class="anchor" hidden="" href="#to_utc_timestampt-a-string-timezone">#</a></h3><ul><li>è§£é‡Š</li></ul><p>è½¬æ¢ä¸ºä¸–ç•Œæ ‡å‡†æ—¶é—´UTCçš„æ—¶é—´æˆ³,ä¸from_utc_timestampç±»ä¼¼</p><ul><li>ä½¿ç”¨æ¡ˆä¾‹</li></ul><div class="highlight"><pre style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4" tabindex="0"><code class="language-fallback" data-lang="fallback"><span style="display:flex"><span>select to_utc_timestamp('2020-05-20 15:21:34', 'GMT'); -- è¿”å›2020-05-20 15:21:34.0
</span></span></code></pre></div><h3 id="truncstring-date-string-format--æˆªå–å¹´æˆ–æœˆçš„ç¬¬ä¸€å¤©">trunc(STRING date, STRING format) æˆªå–å¹´æˆ–æœˆçš„ç¬¬ä¸€å¤©<a aria-hidden="true" class="anchor" hidden="" href="#truncstring-date-string-format--æˆªå–å¹´æˆ–æœˆçš„ç¬¬ä¸€å¤©">#</a></h3><ul><li>è§£é‡Š</li></ul><p>æˆªæ–­æ—¥æœŸåˆ°æŒ‡å®šçš„æ—¥æœŸç²¾åº¦ï¼Œä»…æ”¯æŒæœˆï¼ˆMONTH/MON/MMï¼‰æˆ–è€…å¹´ï¼ˆYEAR/YYYY/YYï¼‰</p><ul><li>ä½¿ç”¨æ¡ˆä¾‹</li></ul><div class="highlight"><pre style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4" tabindex="0"><code class="language-fallback" data-lang="fallback"><span style="display:flex"><span>select trunc('2020-05-20', 'YY');   -- è¿”å›2020-01-01ï¼Œè¿”å›å¹´çš„1æœˆ1æ—¥
</span></span><span style="display:flex"><span>select trunc('2020-05-20', 'MM');   -- è¿”å›2020-05-01ï¼Œè¿”å›æœˆçš„ç¬¬ä¸€å¤©
</span></span><span style="display:flex"><span>select trunc('2020-05-20 15:21:34', 'MM');   -- è¿”å›2020-05-01
</span></span></code></pre></div><h3 id="unix_timestampstring-date--string-pattern">unix_timestamp([STRING date [, STRING pattern]])<a aria-hidden="true" class="anchor" hidden="" href="#unix_timestampstring-date--string-pattern">#</a></h3><ul><li>è§£é‡Š</li></ul><p>å‚æ•°æ—¶å¯é€‰çš„ï¼Œå½“å‚æ•°ä¸ºç©ºæ—¶ï¼Œè¿”å›å½“å‰Unixæ˜¯æ—¶é—´æˆ³ï¼Œç²¾ç¡®åˆ°ç§’ã€‚å¯ä»¥æŒ‡å®šä¸€ä¸ªå…·ä½“çš„æ—¥æœŸï¼Œè½¬æ¢ä¸ºUnixæ—¶é—´æˆ³æ ¼å¼</p><ul><li>ä½¿ç”¨æ¡ˆä¾‹</li></ul><div class="highlight"><pre style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4" tabindex="0"><code class="language-fallback" data-lang="fallback"><span style="display:flex"><span>-- è¿”å›1589959294
</span></span><span style="display:flex"><span>select unix_timestamp('2020-05-20 15:21:34','yyyy-MM-dd hh:mm:ss');
</span></span><span style="display:flex"><span>-- è¿”å›1589904000
</span></span><span style="display:flex"><span>select unix_timestamp('2020-05-20','yyyy-MM-dd');
</span></span></code></pre></div><h3 id="weekofyearstring-date">weekofyear(STRING date)<a aria-hidden="true" class="anchor" hidden="" href="#weekofyearstring-date">#</a></h3><ul><li>è§£é‡Š</li></ul><p>è¿”å›ä¸€ä¸ªæ—¥æœŸæˆ–æ—¶é—´åœ¨ä¸€å¹´ä¸­çš„ç¬¬å‡ å‘¨ï¼Œå¯ä»¥ç”¨extractæ›¿ä»£</p><ul><li>ä½¿ç”¨æ¡ˆä¾‹</li></ul><div class="highlight"><pre style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4" tabindex="0"><code class="language-fallback" data-lang="fallback"><span style="display:flex"><span>select weekofyear('2020-05-20 15:21:34'); -- è¿”å›21ï¼Œç¬¬21å‘¨
</span></span><span style="display:flex"><span>select weekofyear('2020-05-20'); -- è¿”å›21ï¼Œç¬¬21å‘¨
</span></span></code></pre></div><h3 id="next_daystring-start_date-string-day_of_week">next_day(STRING start_date, STRING day_of_week)<a aria-hidden="true" class="anchor" hidden="" href="#next_daystring-start_date-string-day_of_week">#</a></h3><ul><li>è§£é‡Š</li></ul><p>å‚æ•°start_dateå¯ä»¥æ˜¯ä¸€ä¸ªæ—¶é—´æˆ–æ—¥æœŸï¼Œday_of_weekè¡¨ç¤ºæ˜ŸæœŸå‡ ï¼Œæ¯”å¦‚Moè¡¨ç¤ºæ˜ŸæœŸä¸€ï¼ŒTuè¡¨ç¤ºæ˜ŸæœŸäºŒï¼ŒWedè¡¨ç¤ºæ˜ŸæœŸä¸‰ï¼ŒThurè¡¨ç¤ºæ˜ŸæœŸå››ï¼ŒFriè¡¨ç¤ºæ˜ŸæœŸäº”ï¼ŒSatè¡¨ç¤ºæ˜ŸæœŸå…­ï¼ŒSunè¡¨ç¤ºæ˜ŸæœŸæ—¥ã€‚å¦‚æœæŒ‡å®šçš„æ˜ŸæœŸå‡ åœ¨è¯¥æ—¥æœŸæ‰€åœ¨çš„å‘¨ä¸”åœ¨è¯¥æ—¥æœŸä¹‹åï¼Œåˆ™è¿”å›å½“å‘¨çš„æ˜ŸæœŸå‡ æ—¥æœŸï¼Œå¦‚æœæŒ‡å®šçš„æ˜ŸæœŸå‡ ä¸åœ¨è¯¥æ—¥æœŸæ‰€åœ¨çš„å‘¨ï¼Œåˆ™è¿”å›ä¸‹ä¸€ä¸ªæ˜ŸæœŸå‡ å¯¹åº”çš„æ—¥æœŸ</p><ul><li>ä½¿ç”¨æ¡ˆä¾‹</li></ul><div class="highlight"><pre style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4" tabindex="0"><code class="language-fallback" data-lang="fallback"><span style="display:flex"><span>select next_day('2020-05-20','Mon');-- è¿”å›å½“å‰æ—¥æœŸçš„ä¸‹ä¸€ä¸ªå‘¨ä¸€æ—¥æœŸ:2020-05-25
</span></span><span style="display:flex"><span>select next_day('2020-05-20','Tu');-- è¿”å›å½“å‰æ—¥æœŸçš„ä¸‹ä¸€ä¸ªå‘¨äºŒæ—¥æœŸ:2020-05-26
</span></span><span style="display:flex"><span>select next_day('2020-05-20','Wed');-- è¿”å›å½“å‰æ—¥æœŸçš„ä¸‹ä¸€ä¸ªå‘¨ä¸‰æ—¥æœŸ:2020-05-27
</span></span><span style="display:flex"><span>-- 2020-05-20ä¸ºå‘¨ä¸‰ï¼ŒæŒ‡å®šçš„å‚æ•°ä¸ºå‘¨å››ï¼Œæ‰€ä»¥è¿”å›å½“å‘¨çš„å‘¨å››å°±æ˜¯2020-05-21
</span></span><span style="display:flex"><span>select next_day('2020-05-20','Th');
</span></span><span style="display:flex"><span>select next_day('2020-05-20','Fri');-- è¿”å›å‘¨äº”æ—¥æœŸ2020-05-22
</span></span><span style="display:flex"><span>select next_day('2020-05-20','Sat'); -- è¿”å›å‘¨å…­æ—¥æœŸ2020-05-23
</span></span><span style="display:flex"><span>select next_day('2020-05-20','Sun'); -- è¿”å›å‘¨å…­æ—¥æœŸ2020-05-24
</span></span></code></pre></div><p>è¯¥å‡½æ•°æ¯”è¾ƒé‡è¦ï¼šæ¯”å¦‚å–å½“å‰æ—¥æœŸæ‰€åœ¨çš„å‘¨ä¸€å’Œå‘¨æ—¥ï¼Œé€šè¿‡é•¿ç”¨åœ¨æŒ‰å‘¨è¿›è¡Œæ±‡æ€»æ•°æ®</p><div class="highlight"><pre style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4" tabindex="0"><code class="language-fallback" data-lang="fallback"><span style="display:flex"><span>select date_add(next_day('2020-05-20','MO'),-7); -- è¿”å›å½“å‰æ—¥æœŸçš„å‘¨ä¸€æ—¥æœŸ2020-05-18
</span></span><span style="display:flex"><span>select date_add(next_day('2020-05-20','MO'),-1); -- è¿”å›å½“å‰æ—¥æœŸçš„å‘¨æ—¥æ—¥æœŸ2020-05-24
</span></span></code></pre></div><h3 id="months_betweendatetimestampstring-date1-datetimestampstring-date2">months_between(DATE|TIMESTAMP|STRING date1, DATE|TIMESTAMP|STRING date2)<a aria-hidden="true" class="anchor" hidden="" href="#months_betweendatetimestampstring-date1-datetimestampstring-date2">#</a></h3><ul><li>è§£é‡Š</li></ul><p>è¿”å› date1 å’Œ date2 çš„æœˆä»½å·®ã€‚å¦‚æœdate1å¤§äºdate2ï¼Œè¿”å›æ­£å€¼ï¼Œå¦åˆ™è¿”å›è´Ÿå€¼ï¼Œå¦‚æœæ˜¯ç›¸å‡æ˜¯æ•´æ•°æœˆï¼Œåˆ™è¿”å›ä¸€ä¸ªæ•´æ•°ï¼Œå¦åˆ™ä¼šè¿”å›å°æ•°</p><ul><li>ä½¿ç”¨æ¡ˆä¾‹</li></ul><div class="highlight"><pre style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4" tabindex="0"><code class="language-fallback" data-lang="fallback"><span style="display:flex"><span>select months_between('2020-05-20','2020-05-20'); -- è¿”å›0
</span></span><span style="display:flex"><span>select months_between('2020-05-20','2020-06-20'); -- è¿”å›-1
</span></span><span style="display:flex"><span>-- ç›¸å·®çš„æ•´æ•°æœˆ
</span></span><span style="display:flex"><span>select months_between('2020-06-30','2020-05-31'); -- è¿”å›1
</span></span><span style="display:flex"><span>-- éæ•´æ•°æœˆï¼Œä¸€ä¸ªæœˆå·®ä¸€å¤©
</span></span><span style="display:flex"><span>select months_between('2020-06-29','2020-05-31'); -- è¿”å›0.93548387
</span></span></code></pre></div></div><footer class="post-footer"><ul class="post-tags"><li><a href="https://xiaokunji.com/zh/tags/Hive.html">Hive</a></li><li><a href="https://xiaokunji.com/zh/tags/Hadoop%E7%94%9F%E6%80%81%E5%9C%88.html">Hadoopç”Ÿæ€åœˆ</a></li></ul></footer></article></main><script async="" src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><footer class="footer"><span>Copyright
Â©
-2024
<a href="https://xiaokunji.com/zh/" style="color:#939393">ç±³äºŒ</a>
All Rights Reserved</span>
<span id="busuanzi_container"><span class="fa fa-user">ç”¨æˆ·æ•°:</span><span id="busuanzi_value_site_uv"></span>
<span class="fa fa-eye">è®¿é—®æ•°:</span><span id="busuanzi_value_site_pv"></span></span></footer><a accesskey="g" aria-label="go to top" class="top-link" href="#top" id="top-link" title="Go to Top (Alt + G)"><svg fill="currentcolor" viewbox="0 0 12 6" xmlns="http://www.w3.org/2000/svg"><path d="M12 6H0l6-6z"></path></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="å¤åˆ¶";function s(){t.innerHTML="å·²å¤åˆ¶ï¼",setTimeout(()=>{t.innerHTML="å¤åˆ¶"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>