<!doctype html><html lang=zh dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>å‡½æ•° | ç±³äºŒ</title><meta name=keywords content=" æ¡ä»¶å‡½æ•°, assert_true(BOOLEAN condition), coalesce(T v1,T v2,...), if, isnotnull(a), isnull(a), nullif(a,b), nvl(T value,T default_value), æ—¥æœŸå‡½æ•°, add_months, current_date, current_timestamp(), datediff(STRING enddate,STRING startdate), date_add(DATE startdate,INT days), date_sub(DATE startdate,INT days), date_format(DATE|TIMESTAMP|STRING ts,STRING fmt), dayofmonth(STRING date), extract(field FROM source) æ—¶é—´æˆªå–å‡½æ•°, year(STRING date), quarter(DATE|TIMESTAMP|STRING a), month(STRING date), day(STRING date),, hour(STRING date), minute(STRING date), second(STRING date), from_unixtime(BIGINT unixtime [,STRING format]), from_utc_timestamp(T a,STRING timezone), last_day(STRING date), to_date(STRING timestamp), to_utc_timestamp(T a,STRING timezone), trunc(STRING date,STRING format)  æˆªå–å¹´æˆ–æœˆçš„ç¬¬ä¸€å¤©, unix_timestamp([STRING date [,STRING pattern]]), weekofyear(STRING date), next_day(STRING start_date,STRING day_of_week), months_between(DATE|TIMESTAMP|STRING date1,DATE|TIMESTAMP|STRING date2)"><meta name=description content="     "><meta name=author content="xkj"><link rel=canonical href=https://xiaokunji.com/zh/hadoop%E7%94%9F%E6%80%81%E5%9C%88/Hive/%E5%87%BD%E6%95%B0.html><link crossorigin=anonymous href=/assets/css/stylesheet.b3faf608c544858ba700943ffe182cb647f38432d29a07d73234965beacb26f6.css integrity="sha256-s/r2CMVEhYunAJQ//hgstkfzhDLSmgfXMjSWW+rLJvY=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://xiaokunji.com/img/Q.svg><link rel=icon type=image/png sizes=16x16 href=https://xiaokunji.com/img/Q.svg><link rel=icon type=image/png sizes=32x32 href=https://xiaokunji.com/img/Q.svg><link rel=apple-touch-icon href=https://xiaokunji.com/Q.svg><link rel=mask-icon href=https://xiaokunji.com/Q.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=zh href=https://xiaokunji.com/zh/hadoop%E7%94%9F%E6%80%81%E5%9C%88/Hive/%E5%87%BD%E6%95%B0.html><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><meta property="og:title" content="å‡½æ•°"><meta property="og:description" content="     "><meta property="og:type" content="article"><meta property="og:url" content="https://xiaokunji.com/zh/hadoop%E7%94%9F%E6%80%81%E5%9C%88/Hive/%E5%87%BD%E6%95%B0.html"><meta property="article:section" content="hadoopç”Ÿæ€åœˆ"><meta property="article:published_time" content="2023-08-22T00:00:00+00:00"><meta property="article:modified_time" content="2023-09-04T11:19:09+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="å‡½æ•°"><meta name=twitter:description content="     "><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":4,"name":"å‡½æ•°","item":"https://xiaokunji.com/zh/hadoop%E7%94%9F%E6%80%81%E5%9C%88/Hive/%E5%87%BD%E6%95%B0.html"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"å‡½æ•°","name":"å‡½æ•°","description":"     ","keywords":[" æ¡ä»¶å‡½æ•°"," assert_true(BOOLEAN condition)"," coalesce(T v1, T v2, ...)"," if"," isnotnull(a)"," isnull(a)"," nullif(a, b)"," nvl(T value, T default_value)"," æ—¥æœŸå‡½æ•°"," add_months"," current_date"," current_timestamp()"," datediff(STRING enddate, STRING startdate)"," date_add(DATE startdate, INT days)"," date_sub(DATE startdate, INT days)"," date_format(DATE|TIMESTAMP|STRING ts, STRING fmt)"," dayofmonth(STRING date)"," extract(field FROM source) æ—¶é—´æˆªå–å‡½æ•°"," year(STRING date)"," quarter(DATE|TIMESTAMP|STRING a)"," month(STRING date)"," day(STRING date),"," hour(STRING date)"," minute(STRING date)"," second(STRING date)"," from_unixtime(BIGINT unixtime [, STRING format])"," from_utc_timestamp(T a, STRING timezone)"," last_day(STRING date)"," to_date(STRING timestamp)"," to_utc_timestamp(T a, STRING timezone)"," trunc(STRING date, STRING format)  æˆªå–å¹´æˆ–æœˆçš„ç¬¬ä¸€å¤©"," unix_timestamp([STRING date [, STRING pattern]])"," weekofyear(STRING date)"," next_day(STRING start_date, STRING day_of_week)"," months_between(DATE|TIMESTAMP|STRING date1, DATE|TIMESTAMP|STRING date2)"],"articleBody":"[toc]\næ¡ä»¶å‡½æ•° assert_true(BOOLEAN condition) è§£é‡Š å¦‚æœconditionä¸ä¸ºtrueï¼Œåˆ™æŠ›å‡ºå¼‚å¸¸ï¼Œå¦åˆ™è¿”å›null\nä½¿ç”¨æ¡ˆä¾‹ select assert_true(1\u003c2) -- è¿”å›null select assert_true(1\u003e2) -- æŠ›å‡ºå¼‚å¸¸ coalesce(T v1, T v2, â€¦) è§£é‡Š è¿”å›ç¬¬ä¸€ä¸ªä¸ä¸ºnullçš„å€¼ï¼Œå¦‚æœéƒ½ä¸ºnullï¼Œåˆ™è¿”å›null\nä½¿ç”¨æ¡ˆä¾‹ select coalesce(null,1,2,null) -- è¿”å›1 select coalesce(1,null) -- è¿”å›1 select coalesce(null,null) -- è¿”å›null if if ( BOOLEAN testCondition, T valueTrue , T valueFalseOrNull )\nè§£é‡Š å¦‚æœtestConditionæ¡ä»¶ä¸ºtrueï¼Œåˆ™è¿”å›ç¬¬ä¸€ä¸ªå€¼ï¼Œå¦åˆ™è¿”å›ç¬¬äºŒä¸ªå€¼\nä½¿ç”¨æ¡ˆä¾‹ select if(1 is null,0,1) -- è¿”å›1 select if(null is null,0,1) -- è¿”å›0 isnotnull(a) è§£é‡Š å¦‚æœå‚æ•°aä¸ä¸ºnullï¼Œåˆ™è¿”å›trueï¼Œå¦åˆ™è¿”å›false\nä½¿ç”¨æ¡ˆä¾‹ select isnotnull(1) -- è¿”å›true select isnotnull(null) -- è¿”å›false isnull(a) è§£é‡Š ä¸isnotnullç›¸åï¼Œå¦‚æœå‚æ•°aä¸ºnullï¼Œåˆ™è¿”å›trueï¼Œå¦åˆ™è¿”å›false\nä½¿ç”¨æ¡ˆä¾‹ select isnull(null) -- è¿”å›true select isnull(1) -- è¿”å›false nullif(a, b) è§£é‡Š å¦‚æœå‚æ•°a=bï¼Œè¿”å›nullï¼Œå¦åˆ™è¿”å›aå€¼(Hive2.2.0ç‰ˆæœ¬)\nä½¿ç”¨æ¡ˆä¾‹ select nullif(1,2) -- è¿”å›1 select nullif(1,1) -- è¿”å›null nvl(T value, T default_value) è§£é‡Š å¦‚æœvalueçš„å€¼ä¸ºnullï¼Œåˆ™è¿”å›default_valueé»˜è®¤å€¼ï¼Œå¦åˆ™è¿”å›valueçš„å€¼ã€‚åœ¨nullå€¼åˆ¤æ–­æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ifå‡½æ•°ç»™å®šé»˜è®¤å€¼ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨æ­¤å‡½æ•°ç»™å®šé»˜è®¤å€¼ï¼Œä½¿ç”¨è¯¥å‡½æ•°sqlç‰¹åˆ«ç®€æ´ã€‚\nä½¿ç”¨æ¡ˆä¾‹ select nvl(1,0) -- è¿”å›1 select nvl(null,0) -- è¿”å›0 æ—¥æœŸå‡½æ•° add_months add_month( DATE | STRING | TIMESTAMP start_date , INT num_months)\nè§£é‡Š start_dateå‚æ•°å¯ä»¥æ˜¯string, date æˆ–è€…timestampç±»å‹ï¼Œnum_monthså‚æ•°æ—¶intç±»å‹ã€‚è¿”å›ä¸€ä¸ªæ—¥æœŸï¼Œè¯¥æ—¥æœŸæ˜¯åœ¨start_dateåŸºç¡€ä¹‹ä¸ŠåŠ ä¸Šnum_monthsä¸ªæœˆï¼Œå³start_dateä¹‹ånull_monthsä¸ªæœˆçš„ä¸€ä¸ªæ—¥æœŸã€‚å¦‚æœstart_dateçš„æ—¶é—´éƒ¨åˆ†çš„æ•°æ®ä¼šè¢«å¿½ç•¥ã€‚æ³¨æ„ï¼šå¦‚æœstart_dateæ‰€åœ¨æœˆä»½çš„å¤©æ•°å¤§äºç»“æœæ—¥æœŸæœˆçš„å¤©æ•°ï¼Œåˆ™è¿”å›ç»“æœæœˆçš„æœ€åä¸€å¤©çš„æ—¥æœŸã€‚\nä½¿ç”¨æ¡ˆä¾‹ select add_months(\"2020-05-20\",2); -- è¿”å›2020-07-20 select add_months(\"2020-05-20\",8); -- è¿”å›2021-01-20 select add_months(\"2020-05-31\",1); -- è¿”å›2020-06-30,5æœˆæœ‰31å¤©ï¼Œ6æœˆåªæœ‰30å¤©ï¼Œæ‰€ä»¥è¿”å›ä¸‹ä¸€ä¸ªæœˆçš„æœ€åä¸€å¤© current_date è§£é‡Š è¿”å›æŸ¥è¯¢æ—¶åˆ»çš„å½“å‰æ—¥æœŸ\nä½¿ç”¨æ¡ˆä¾‹ select current_date() -- è¿”å›å½“å‰æŸ¥è¯¢æ—¥æœŸ2020-05-20 current_timestamp() è§£é‡Š è¿”å›æŸ¥è¯¢æ—¶åˆ»çš„å½“å‰æ—¶é—´\nä½¿ç”¨æ¡ˆä¾‹ select current_timestamp() -- 2020-05-20 14:40:47.273 datediff(STRING enddate, STRING startdate) è§£é‡Š è¿”å›å¼€å§‹æ—¥æœŸstartdateä¸ç»“æŸæ—¥æœŸenddateä¹‹å‰ç›¸å·®çš„å¤©æ•°\nä½¿ç”¨æ¡ˆä¾‹ select datediff(\"2020-05-20\",\"2020-05-21\"); -- è¿”å›-1 select datediff(\"2020-05-21\",\"2020-05-20\"); -- è¿”å›1 date_add(DATE startdate, INT days) è§£é‡Š åœ¨startdateåŸºç¡€ä¸ŠåŠ ä¸Šå‡ å¤©ï¼Œç„¶åè¿”å›åŠ ä¸Šå‡ å¤©ä¹‹åçš„ä¸€ä¸ªæ—¥æœŸ\nä½¿ç”¨æ¡ˆä¾‹ select date_add(\"2020-05-20\",1); -- è¿”å›2020-05-21,1è¡¨ç¤ºåŠ 1å¤© select date_add(\"2020-05-20\",-1); -- è¿”å›2020-05-19ï¼Œ-1è¡¨ç¤ºå‡ä¸€å¤© date_sub(DATE startdate, INT days) è§£é‡Š åœ¨startdateåŸºç¡€ä¸Šå‡å»å‡ å¤©ï¼Œç„¶åè¿”å›å‡å»å‡ å¤©ä¹‹åçš„ä¸€ä¸ªæ—¥æœŸ,åŠŸèƒ½ä¸date_addå¾ˆç±»ä¼¼\nä½¿ç”¨æ¡ˆä¾‹ select date_sub(\"2020-05-20\",1); -- è¿”å›2020-05-19,1è¡¨ç¤ºå‡1å¤© select date_sub(\"2020-05-20\",-1); -- è¿”å›2020-05-21ï¼Œ-1è¡¨ç¤ºåŠ 1å¤© date_format(DATE|TIMESTAMP|STRING ts, STRING fmt) è§£é‡Š å°†date/timestamp/stringç±»å‹çš„å€¼è½¬æ¢ä¸ºä¸€ä¸ªå…·ä½“æ ¼å¼åŒ–çš„å­—ç¬¦ä¸²ã€‚æ”¯æŒjavaçš„SimpleDateFormatæ ¼å¼ï¼Œç¬¬äºŒä¸ªå‚æ•°fmtå¿…é¡»æ˜¯ä¸€ä¸ªå¸¸é‡\nä½¿ç”¨æ¡ˆä¾‹ select date_format('2020-05-20', 'yyyy'); -- è¿”å›2020 select date_format('2020-05-20', 'MM'); -- è¿”å›05 select date_format('2020-05-20', 'dd'); -- è¿”å›20 -- è¿”å›2020å¹´05æœˆ20æ—¥ 00æ—¶00åˆ†00ç§’ select date_format('2020-05-20', 'yyyyå¹´MMæœˆddæ—¥ HHæ—¶mmåˆ†ssç§’') ; select date_format('2020-05-20', 'yy/MM/dd') -- è¿”å› 20/05/20 dayofmonth(STRING date) è§£é‡Š è¿”å›ä¸€ä¸ªæ—¥æœŸæˆ–æ—¶é—´çš„å¤©,ä¸day()å‡½æ•°åŠŸèƒ½ç›¸åŒ\nä½¿ç”¨æ¡ˆä¾‹ select dayofmonth('2020-05-20') -- è¿”å›20 extract(field FROM source) æ—¶é—´æˆªå–å‡½æ•° è§£é‡Š æå– day, dayofweek, hour, minute, month, quarter, second, week æˆ–è€…yearçš„å€¼ï¼Œfieldå¯ä»¥é€‰æ‹©day, dayofweek, hour, minute, month, quarter, second, week æˆ–è€…yearï¼Œsourceå¿…é¡»æ˜¯ä¸€ä¸ªdateã€timestampæˆ–è€…å¯ä»¥è½¬ä¸º date ã€timestampçš„å­—ç¬¦ä¸²ã€‚æ³¨æ„ï¼šHive 2.2.0ç‰ˆæœ¬ä¹‹åæ”¯æŒè¯¥å‡½æ•°\nä½¿ç”¨æ¡ˆä¾‹ select extract(year from '2020-05-20 15:21:34.467'); -- è¿”å›2020ï¼Œå¹´ select extract(quarter from '2020-05-20 15:21:34.467'); -- è¿”å›2ï¼Œå­£åº¦ select extract(month from '2020-05-20 15:21:34.467'); -- è¿”å›05ï¼Œæœˆä»½ select extract(week from '2020-05-20 15:21:34.467'); -- è¿”å›21ï¼ŒåŒweekofyearï¼Œä¸€å¹´ä¸­çš„ç¬¬å‡ å‘¨ select extract(dayofweek from '2020-05-20 15:21:34.467'); -- è¿”å›4,ä»£è¡¨æ˜ŸæœŸä¸‰ select extract(day from '2020-05-20 15:21:34.467'); -- è¿”å›20ï¼Œå¤© select extract(hour from '2020-05-20 15:21:34.467'); -- è¿”å›15ï¼Œå°æ—¶ select extract(minute from '2020-05-20 15:21:34.467'); -- è¿”å›21ï¼Œåˆ†é’Ÿ select extract(second from '2020-05-20 15:21:34.467'); -- è¿”å›34ï¼Œç§’ year(STRING date) è§£é‡Š è¿”å›æ—¶é—´çš„å¹´ä»½,å¯ä»¥ç”¨extractå‡½æ•°æ›¿ä»£\nä½¿ç”¨æ¡ˆä¾‹ select year('2020-05-20 15:21:34'); -- è¿”å›2020 quarter(DATE|TIMESTAMP|STRING a) è§£é‡Š è¿”å›ç»™å®šæ—¶é—´æˆ–æ—¥æœŸçš„å­£åº¦ï¼Œ1è‡³4ä¸ªå­£åº¦,å¯ä»¥ç”¨extractå‡½æ•°æ›¿ä»£\nä½¿ç”¨æ¡ˆä¾‹ select quarter('2020-05-20 15:21:34'); -- è¿”å›2ï¼Œç¬¬2å­£åº¦ month(STRING date) è§£é‡Š è¿”å›æ—¶é—´çš„æœˆä»½,å¯ä»¥ç”¨extractå‡½æ•°æ›¿ä»£\nä½¿ç”¨æ¡ˆä¾‹ select month('2020-05-20 15:21:34') -- è¿”å›5 day(STRING date), è§£é‡Š è¿”å›ä¸€ä¸ªæ—¥æœŸæˆ–è€…æ—¶é—´çš„å¤©,å¯ä»¥ç”¨extractå‡½æ•°æ›¿ä»£\nä½¿ç”¨æ¡ˆä¾‹ select day(\"2020-05-20\"); -- è¿”å›20 select day(\"2020-05-20 15:05:27.5\"); -- è¿”å›20 hour(STRING date) è§£é‡Š è¿”å›ä¸€ä¸ªæ—¶é—´çš„å°æ—¶,å¯ä»¥ç”¨extractå‡½æ•°æ›¿ä»£\nä½¿ç”¨æ¡ˆä¾‹ select hour('2020-05-20 15:21:34');-- è¿”å›15 minute(STRING date) è§£é‡Š è¿”å›ä¸€ä¸ªæ—¶é—´çš„åˆ†é’Ÿå€¼,å¯ä»¥ç”¨extractå‡½æ•°æ›¿ä»£\nä½¿ç”¨æ¡ˆä¾‹ select minute('2020-05-20 15:21:34'); -- è¿”å›21 second(STRING date) è§£é‡Š è¿”å›ä¸€ä¸ªæ—¶é—´çš„ç§’,å¯ä»¥ç”¨extractå‡½æ•°æ›¿ä»£\nä½¿ç”¨æ¡ˆä¾‹ select second('2020-05-20 15:21:34'); --è¿”å›34 from_unixtime(BIGINT unixtime [, STRING format]) è§£é‡Š å°†å°†Unixæ—¶é—´æˆ³è½¬æ¢ä¸ºå­—ç¬¦ä¸²æ ¼å¼çš„æ—¶é—´(æ¯”å¦‚yyyy-MM-dd HH:mm:ssæ ¼å¼)\nä½¿ç”¨æ¡ˆä¾‹ select from_unixtime(1589960708); -- è¿”å›2020-05-20 15:45:08 select from_unixtime(1589960708, 'yyyy-MM-dd hh:mm:ss'); -- -- è¿”å›2020-05-20 15:45:08 select from_unixtime(1589960708, 'yyyy-MM-dd'); -- è¿”å›2020-05-20 from_utc_timestamp(T a, STRING timezone) è§£é‡Š è½¬æ¢ä¸ºç‰¹å®šæ—¶åŒºçš„æ—¶é—´\nä½¿ç”¨æ¡ˆä¾‹ select from_utc_timestamp('2020-05-20 15:21:34','PST'); -- è¿”å›2020-05-20 08:21:34.0 select from_utc_timestamp('2020-05-20 15:21:34','GMT'); -- è¿”å›2020-05-20 15:21:34.0 select from_utc_timestamp('2020-05-20 15:21:34','UTC'); -- è¿”å›2020-05-20 15:21:34.0 select from_utc_timestamp('2020-05-20 15:21:34','DST'); -- è¿”å›2020-05-20 15:21:34.0 select from_utc_timestamp('2020-05-20 15:21:34','CST'); -- è¿”å›2020-05-20 10:21:34.0 last_day(STRING date) è§£é‡Š è¿”å›ç»™å®šæ—¶é—´æˆ–æ—¥æœŸæ‰€åœ¨æœˆçš„æœ€åä¸€å¤©ï¼Œå‚æ•°å¯ä»¥æ˜¯â€™yyyy-MM-dd HH:mm:ssâ€™ æˆ–è€… â€˜yyyy-MM-ddâ€™ç±»å‹ï¼Œæ—¶é—´éƒ¨åˆ†ä¼šè¢«å¿½ç•¥\nä½¿ç”¨æ¡ˆä¾‹ select last_day('2020-05-20 15:21:34'); -- è¿”å›2020-05-31 select last_day('2020-05-20'); -- è¿”å›2020-05-31 to_date(STRING timestamp) è§£é‡Š è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²æ—¶é—´çš„æ—¥æœŸéƒ¨åˆ†ï¼Œå»æ‰æ—¶é—´éƒ¨åˆ†ï¼Œ2.1.0ä¹‹å‰ç‰ˆæœ¬è¿”å›çš„æ˜¯stringï¼Œ2.1.0ç‰ˆæœ¬åŠä¹‹åè¿”å›çš„æ˜¯date\nä½¿ç”¨æ¡ˆä¾‹ select to_date('2020-05-20 15:21:34'); -- è¿”å›2020-05-20 select to_date('2020-05-20'); -- è¿”å›2020-05-20 to_utc_timestamp(T a, STRING timezone) è§£é‡Š è½¬æ¢ä¸ºä¸–ç•Œæ ‡å‡†æ—¶é—´UTCçš„æ—¶é—´æˆ³,ä¸from_utc_timestampç±»ä¼¼\nä½¿ç”¨æ¡ˆä¾‹ select to_utc_timestamp('2020-05-20 15:21:34', 'GMT'); -- è¿”å›2020-05-20 15:21:34.0 trunc(STRING date, STRING format) æˆªå–å¹´æˆ–æœˆçš„ç¬¬ä¸€å¤© è§£é‡Š æˆªæ–­æ—¥æœŸåˆ°æŒ‡å®šçš„æ—¥æœŸç²¾åº¦ï¼Œä»…æ”¯æŒæœˆï¼ˆMONTH/MON/MMï¼‰æˆ–è€…å¹´ï¼ˆYEAR/YYYY/YYï¼‰\nä½¿ç”¨æ¡ˆä¾‹ select trunc('2020-05-20', 'YY'); -- è¿”å›2020-01-01ï¼Œè¿”å›å¹´çš„1æœˆ1æ—¥ select trunc('2020-05-20', 'MM'); -- è¿”å›2020-05-01ï¼Œè¿”å›æœˆçš„ç¬¬ä¸€å¤© select trunc('2020-05-20 15:21:34', 'MM'); -- è¿”å›2020-05-01 unix_timestamp([STRING date [, STRING pattern]]) è§£é‡Š å‚æ•°æ—¶å¯é€‰çš„ï¼Œå½“å‚æ•°ä¸ºç©ºæ—¶ï¼Œè¿”å›å½“å‰Unixæ˜¯æ—¶é—´æˆ³ï¼Œç²¾ç¡®åˆ°ç§’ã€‚å¯ä»¥æŒ‡å®šä¸€ä¸ªå…·ä½“çš„æ—¥æœŸï¼Œè½¬æ¢ä¸ºUnixæ—¶é—´æˆ³æ ¼å¼\nä½¿ç”¨æ¡ˆä¾‹ -- è¿”å›1589959294 select unix_timestamp('2020-05-20 15:21:34','yyyy-MM-dd hh:mm:ss'); -- è¿”å›1589904000 select unix_timestamp('2020-05-20','yyyy-MM-dd'); weekofyear(STRING date) è§£é‡Š è¿”å›ä¸€ä¸ªæ—¥æœŸæˆ–æ—¶é—´åœ¨ä¸€å¹´ä¸­çš„ç¬¬å‡ å‘¨ï¼Œå¯ä»¥ç”¨extractæ›¿ä»£\nä½¿ç”¨æ¡ˆä¾‹ select weekofyear('2020-05-20 15:21:34'); -- è¿”å›21ï¼Œç¬¬21å‘¨ select weekofyear('2020-05-20'); -- è¿”å›21ï¼Œç¬¬21å‘¨ next_day(STRING start_date, STRING day_of_week) è§£é‡Š å‚æ•°start_dateå¯ä»¥æ˜¯ä¸€ä¸ªæ—¶é—´æˆ–æ—¥æœŸï¼Œday_of_weekè¡¨ç¤ºæ˜ŸæœŸå‡ ï¼Œæ¯”å¦‚Moè¡¨ç¤ºæ˜ŸæœŸä¸€ï¼ŒTuè¡¨ç¤ºæ˜ŸæœŸäºŒï¼ŒWedè¡¨ç¤ºæ˜ŸæœŸä¸‰ï¼ŒThurè¡¨ç¤ºæ˜ŸæœŸå››ï¼ŒFriè¡¨ç¤ºæ˜ŸæœŸäº”ï¼ŒSatè¡¨ç¤ºæ˜ŸæœŸå…­ï¼ŒSunè¡¨ç¤ºæ˜ŸæœŸæ—¥ã€‚å¦‚æœæŒ‡å®šçš„æ˜ŸæœŸå‡ åœ¨è¯¥æ—¥æœŸæ‰€åœ¨çš„å‘¨ä¸”åœ¨è¯¥æ—¥æœŸä¹‹åï¼Œåˆ™è¿”å›å½“å‘¨çš„æ˜ŸæœŸå‡ æ—¥æœŸï¼Œå¦‚æœæŒ‡å®šçš„æ˜ŸæœŸå‡ ä¸åœ¨è¯¥æ—¥æœŸæ‰€åœ¨çš„å‘¨ï¼Œåˆ™è¿”å›ä¸‹ä¸€ä¸ªæ˜ŸæœŸå‡ å¯¹åº”çš„æ—¥æœŸ\nä½¿ç”¨æ¡ˆä¾‹ select next_day('2020-05-20','Mon');-- è¿”å›å½“å‰æ—¥æœŸçš„ä¸‹ä¸€ä¸ªå‘¨ä¸€æ—¥æœŸ:2020-05-25 select next_day('2020-05-20','Tu');-- è¿”å›å½“å‰æ—¥æœŸçš„ä¸‹ä¸€ä¸ªå‘¨äºŒæ—¥æœŸ:2020-05-26 select next_day('2020-05-20','Wed');-- è¿”å›å½“å‰æ—¥æœŸçš„ä¸‹ä¸€ä¸ªå‘¨ä¸‰æ—¥æœŸ:2020-05-27 -- 2020-05-20ä¸ºå‘¨ä¸‰ï¼ŒæŒ‡å®šçš„å‚æ•°ä¸ºå‘¨å››ï¼Œæ‰€ä»¥è¿”å›å½“å‘¨çš„å‘¨å››å°±æ˜¯2020-05-21 select next_day('2020-05-20','Th'); select next_day('2020-05-20','Fri');-- è¿”å›å‘¨äº”æ—¥æœŸ2020-05-22 select next_day('2020-05-20','Sat'); -- è¿”å›å‘¨å…­æ—¥æœŸ2020-05-23 select next_day('2020-05-20','Sun'); -- è¿”å›å‘¨å…­æ—¥æœŸ2020-05-24 è¯¥å‡½æ•°æ¯”è¾ƒé‡è¦ï¼šæ¯”å¦‚å–å½“å‰æ—¥æœŸæ‰€åœ¨çš„å‘¨ä¸€å’Œå‘¨æ—¥ï¼Œé€šè¿‡é•¿ç”¨åœ¨æŒ‰å‘¨è¿›è¡Œæ±‡æ€»æ•°æ®\nselect date_add(next_day('2020-05-20','MO'),-7); -- è¿”å›å½“å‰æ—¥æœŸçš„å‘¨ä¸€æ—¥æœŸ2020-05-18 select date_add(next_day('2020-05-20','MO'),-1); -- è¿”å›å½“å‰æ—¥æœŸçš„å‘¨æ—¥æ—¥æœŸ2020-05-24 months_between(DATE|TIMESTAMP|STRING date1, DATE|TIMESTAMP|STRING date2) è§£é‡Š è¿”å› date1 å’Œ date2 çš„æœˆä»½å·®ã€‚å¦‚æœdate1å¤§äºdate2ï¼Œè¿”å›æ­£å€¼ï¼Œå¦åˆ™è¿”å›è´Ÿå€¼ï¼Œå¦‚æœæ˜¯ç›¸å‡æ˜¯æ•´æ•°æœˆï¼Œåˆ™è¿”å›ä¸€ä¸ªæ•´æ•°ï¼Œå¦åˆ™ä¼šè¿”å›å°æ•°\nä½¿ç”¨æ¡ˆä¾‹ select months_between('2020-05-20','2020-05-20'); -- è¿”å›0 select months_between('2020-05-20','2020-06-20'); -- è¿”å›-1 -- ç›¸å·®çš„æ•´æ•°æœˆ select months_between('2020-06-30','2020-05-31'); -- è¿”å›1 -- éæ•´æ•°æœˆï¼Œä¸€ä¸ªæœˆå·®ä¸€å¤© select months_between('2020-06-29','2020-05-31'); -- è¿”å›0.93548387 ","wordCount":"3250","inLanguage":"zh","datePublished":"2023-08-22T00:00:00Z","dateModified":"2023-09-04T11:19:09.320812324Z","author":{"@type":"Person","name":"xkj"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://xiaokunji.com/zh/hadoop%E7%94%9F%E6%80%81%E5%9C%88/Hive/%E5%87%BD%E6%95%B0.html"},"publisher":{"@type":"Organization","name":"ç±³äºŒ","logo":{"@type":"ImageObject","url":"https://xiaokunji.com/img/Q.svg"}}}</script></head><body class=dark id=top><script>localStorage.getItem("pref-theme")==="light"&&document.body.classList.remove("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://xiaokunji.com/zh/ accesskey=h title="ç±³äºŒ (Alt + H)"><img src=https://xiaokunji.com/img/Q.svg alt aria-label=logo height=35>ç±³äºŒ</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li><li><a href=https://xiaokunji.com/en/ title=English aria-label=English>English</a></li></ul></div></div><ul id=menu><li><a href=https://xiaokunji.com/zh/ title=ğŸ ä¸»é¡µ><span>ğŸ ä¸»é¡µ</span></a></li><li><a href=https://xiaokunji.com/zh/search title="ğŸ”æœç´¢ (Alt + /)" accesskey=/><span>ğŸ”æœç´¢</span></a></li><li><a href=https://xiaokunji.com/zh/post.html title=ğŸ“šæ–‡ç« ><span>ğŸ“šæ–‡ç« </span></a></li><li><a href=https://xiaokunji.com/zh/archives.html title=â±æ—¶é—´è½´><span>â±æ—¶é—´è½´</span></a></li><li><a href=https://xiaokunji.com/zh/tags.html title=ğŸ”–æ ‡ç­¾><span>ğŸ”–æ ‡ç­¾</span></a></li><li><a href=https://xiaokunji.com/zh/categories.html title=ğŸ“–åˆ†ç±»><span>ğŸ“–åˆ†ç±»</span></a></li><li><a href=https://xiaokunji.com/zh/links.html title=ğŸ¤å‹é“¾><span>ğŸ¤å‹é“¾</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><nav aria-label=breadcrumb><ul><a href=https://xiaokunji.com/zh/>ğŸ </a> <span>></span>
<a href=https://xiaokunji.com/zh/hadoop%E7%94%9F%E6%80%81%E5%9C%88.html>hadoopç”Ÿæ€åœˆ</a> <span>></span>
<a href=https://xiaokunji.com/zh/hadoop%E7%94%9F%E6%80%81%E5%9C%88/Hive.html>Hive</a> <span>></span></ul></nav><h1 class=post-title>å‡½æ•°</h1><div class=post-description></div><div class=post-meta>åˆ›å»º:&nbsp;<span title='2023-08-22 00:00:00 +0000 UTC'>2023-08-22</span>&nbsp;Â·&nbsp;æ›´æ–°:&nbsp;2023-09-04&nbsp;Â·&nbsp;xkj
&nbsp;|&nbsp;åˆ†ç±»: &nbsp;<ul class=post-categories-meta><a href=https://xiaokunji.com/zh/categories/Hadoop%E7%94%9F%E6%80%81%E5%9C%88.html>Hadoopç”Ÿæ€åœˆ</a></ul><span id=busuanzi_container_page_pv>&nbsp;| è®¿é—®: <span id=busuanzi_value_page_pv>1</span></span></div></header><aside id=toc-container class="toc-container wide"><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>ç›®å½•</span></summary><div class=inner><ul><li><a href=#%e6%9d%a1%e4%bb%b6%e5%87%bd%e6%95%b0 aria-label=æ¡ä»¶å‡½æ•°>æ¡ä»¶å‡½æ•°</a><ul><li><a href=#assert_trueboolean-condition aria-label="assert_true(BOOLEAN condition)">assert_true(BOOLEAN condition)</a></li><li><a href=#coalescet-v1-t-v2- aria-label="coalesce(T v1, T v2, &amp;hellip;)">coalesce(T v1, T v2, &mldr;)</a></li><li><a href=#if aria-label=if>if</a></li><li><a href=#isnotnulla aria-label=isnotnull(a)>isnotnull(a)</a></li><li><a href=#isnulla aria-label=isnull(a)>isnull(a)</a></li><li><a href=#nullifa-b aria-label="nullif(a, b)">nullif(a, b)</a></li><li><a href=#nvlt-value-t-default_value aria-label="nvl(T value, T default_value)">nvl(T value, T default_value)</a></li></ul></li><li><a href=#%e6%97%a5%e6%9c%9f%e5%87%bd%e6%95%b0 aria-label=æ—¥æœŸå‡½æ•°>æ—¥æœŸå‡½æ•°</a><ul><li><a href=#add_months aria-label=add_months>add_months</a></li><li><a href=#current_date aria-label=current_date>current_date</a></li><li><a href=#current_timestamp aria-label=current_timestamp()>current_timestamp()</a></li><li><a href=#datediffstring-enddate-string-startdate aria-label="datediff(STRING enddate, STRING startdate)">datediff(STRING enddate, STRING startdate)</a></li><li><a href=#date_adddate-startdate-int-days aria-label="date_add(DATE startdate, INT days)">date_add(DATE startdate, INT days)</a></li><li><a href=#date_subdate-startdate-int-days aria-label="date_sub(DATE startdate, INT days)">date_sub(DATE startdate, INT days)</a></li><li><a href=#date_formatdatetimestampstring-ts-string-fmt aria-label="date_format(DATE|TIMESTAMP|STRING ts, STRING fmt)">date_format(DATE|TIMESTAMP|STRING ts, STRING fmt)</a></li><li><a href=#dayofmonthstring-date aria-label="dayofmonth(STRING date)">dayofmonth(STRING date)</a></li><li><a href=#extractfield-from-source-%e6%97%b6%e9%97%b4%e6%88%aa%e5%8f%96%e5%87%bd%e6%95%b0 aria-label="extract(field FROM source) æ—¶é—´æˆªå–å‡½æ•°">extract(field FROM source) æ—¶é—´æˆªå–å‡½æ•°</a></li><li><a href=#yearstring-date aria-label="year(STRING date)">year(STRING date)</a></li><li><a href=#quarterdatetimestampstring-a aria-label="quarter(DATE|TIMESTAMP|STRING a)">quarter(DATE|TIMESTAMP|STRING a)</a></li><li><a href=#monthstring-date aria-label="month(STRING date)">month(STRING date)</a></li><li><a href=#daystring-date aria-label="day(STRING date),">day(STRING date),</a></li><li><a href=#hourstring-date aria-label="hour(STRING date)">hour(STRING date)</a></li><li><a href=#minutestring-date aria-label="minute(STRING date)">minute(STRING date)</a></li><li><a href=#secondstring-date aria-label="second(STRING date)">second(STRING date)</a></li><li><a href=#from_unixtimebigint-unixtime--string-format aria-label="from_unixtime(BIGINT unixtime [, STRING format])">from_unixtime(BIGINT unixtime [, STRING format])</a></li><li><a href=#from_utc_timestampt-a-string-timezone aria-label="from_utc_timestamp(T a, STRING timezone)">from_utc_timestamp(T a, STRING timezone)</a></li><li><a href=#last_daystring-date aria-label="last_day(STRING date)">last_day(STRING date)</a></li><li><a href=#to_datestring-timestamp aria-label="to_date(STRING timestamp)">to_date(STRING timestamp)</a></li><li><a href=#to_utc_timestampt-a-string-timezone aria-label="to_utc_timestamp(T a, STRING timezone)">to_utc_timestamp(T a, STRING timezone)</a></li><li><a href=#truncstring-date-string-format--%e6%88%aa%e5%8f%96%e5%b9%b4%e6%88%96%e6%9c%88%e7%9a%84%e7%ac%ac%e4%b8%80%e5%a4%a9 aria-label="trunc(STRING date, STRING format)  æˆªå–å¹´æˆ–æœˆçš„ç¬¬ä¸€å¤©">trunc(STRING date, STRING format) æˆªå–å¹´æˆ–æœˆçš„ç¬¬ä¸€å¤©</a></li><li><a href=#unix_timestampstring-date--string-pattern aria-label="unix_timestamp([STRING date [, STRING pattern]])">unix_timestamp([STRING date [, STRING pattern]])</a></li><li><a href=#weekofyearstring-date aria-label="weekofyear(STRING date)">weekofyear(STRING date)</a></li><li><a href=#next_daystring-start_date-string-day_of_week aria-label="next_day(STRING start_date, STRING day_of_week)">next_day(STRING start_date, STRING day_of_week)</a></li><li><a href=#months_betweendatetimestampstring-date1-datetimestampstring-date2 aria-label="months_between(DATE|TIMESTAMP|STRING date1, DATE|TIMESTAMP|STRING date2)">months_between(DATE|TIMESTAMP|STRING date1, DATE|TIMESTAMP|STRING date2)</a></li></ul></li></ul></div></details></div></aside><script>let activeElement,elements;window.addEventListener("DOMContentLoaded",function(){checkTocPosition(),elements=document.querySelectorAll("h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]"),activeElement=elements[0];const t=encodeURI(activeElement.getAttribute("id")).toLowerCase();document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active")},!1),window.addEventListener("resize",function(){checkTocPosition()},!1),window.addEventListener("scroll",()=>{activeElement=Array.from(elements).find(e=>{if(getOffsetTop(e)-window.pageYOffset>0&&getOffsetTop(e)-window.pageYOffset<window.innerHeight/2)return e})||activeElement,elements.forEach(e=>{const t=encodeURI(e.getAttribute("id")).toLowerCase();e===activeElement?document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active"):document.querySelector(`.inner ul li a[href="#${t}"]`).classList.remove("active")})},!1);const main=parseInt(getComputedStyle(document.body).getPropertyValue("--article-width"),10),toc=parseInt(getComputedStyle(document.body).getPropertyValue("--toc-width"),10),gap=parseInt(getComputedStyle(document.body).getPropertyValue("--gap"),10);function checkTocPosition(){const e=document.body.scrollWidth;e-main-toc*2-gap*4>0?document.getElementById("toc-container").classList.add("wide"):document.getElementById("toc-container").classList.remove("wide")}function getOffsetTop(e){if(!e.getClientRects().length)return 0;let t=e.getBoundingClientRect(),n=e.ownerDocument.defaultView;return t.top+n.pageYOffset}</script><div class=post-content><p>[toc]</p><h2 id=æ¡ä»¶å‡½æ•°>æ¡ä»¶å‡½æ•°<a hidden class=anchor aria-hidden=true href=#æ¡ä»¶å‡½æ•°>#</a></h2><h3 id=assert_trueboolean-condition>assert_true(BOOLEAN condition)<a hidden class=anchor aria-hidden=true href=#assert_trueboolean-condition>#</a></h3><ul><li>è§£é‡Š</li></ul><p>å¦‚æœconditionä¸ä¸ºtrueï¼Œåˆ™æŠ›å‡ºå¼‚å¸¸ï¼Œå¦åˆ™è¿”å›null</p><ul><li>ä½¿ç”¨æ¡ˆä¾‹</li></ul><div class=highlight><pre tabindex=0 style=color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>select assert_true(1&lt;2) -- è¿”å›null
</span></span><span style=display:flex><span>select assert_true(1&gt;2) -- æŠ›å‡ºå¼‚å¸¸
</span></span></code></pre></div><h3 id=coalescet-v1-t-v2->coalesce(T v1, T v2, &mldr;)<a hidden class=anchor aria-hidden=true href=#coalescet-v1-t-v2->#</a></h3><ul><li>è§£é‡Š</li></ul><p>è¿”å›ç¬¬ä¸€ä¸ªä¸ä¸ºnullçš„å€¼ï¼Œå¦‚æœéƒ½ä¸ºnullï¼Œåˆ™è¿”å›null</p><ul><li>ä½¿ç”¨æ¡ˆä¾‹</li></ul><div class=highlight><pre tabindex=0 style=color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>select coalesce(null,1,2,null)  -- è¿”å›1
</span></span><span style=display:flex><span>select coalesce(1,null) -- è¿”å›1
</span></span><span style=display:flex><span>select coalesce(null,null) -- è¿”å›null
</span></span></code></pre></div><h3 id=if>if<a hidden class=anchor aria-hidden=true href=#if>#</a></h3><p>if ( BOOLEAN testCondition, T valueTrue , T valueFalseOrNull )</p><ul><li>è§£é‡Š</li></ul><p>å¦‚æœtestConditionæ¡ä»¶ä¸ºtrueï¼Œåˆ™è¿”å›ç¬¬ä¸€ä¸ªå€¼ï¼Œå¦åˆ™è¿”å›ç¬¬äºŒä¸ªå€¼</p><ul><li>ä½¿ç”¨æ¡ˆä¾‹</li></ul><div class=highlight><pre tabindex=0 style=color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>select if(1 is null,0,1)  -- è¿”å›1
</span></span><span style=display:flex><span>select if(null is null,0,1) -- è¿”å›0
</span></span></code></pre></div><h3 id=isnotnulla>isnotnull(a)<a hidden class=anchor aria-hidden=true href=#isnotnulla>#</a></h3><ul><li>è§£é‡Š</li></ul><p>å¦‚æœå‚æ•°aä¸ä¸ºnullï¼Œåˆ™è¿”å›trueï¼Œå¦åˆ™è¿”å›false</p><ul><li>ä½¿ç”¨æ¡ˆä¾‹</li></ul><div class=highlight><pre tabindex=0 style=color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>select isnotnull(1) -- è¿”å›true
</span></span><span style=display:flex><span>select isnotnull(null) -- è¿”å›false
</span></span></code></pre></div><h3 id=isnulla>isnull(a)<a hidden class=anchor aria-hidden=true href=#isnulla>#</a></h3><ul><li>è§£é‡Š</li></ul><p>ä¸isnotnullç›¸åï¼Œå¦‚æœå‚æ•°aä¸ºnullï¼Œåˆ™è¿”å›trueï¼Œå¦åˆ™è¿”å›false</p><ul><li>ä½¿ç”¨æ¡ˆä¾‹</li></ul><div class=highlight><pre tabindex=0 style=color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>select isnull(null) -- è¿”å›true
</span></span><span style=display:flex><span>select isnull(1) -- è¿”å›false
</span></span></code></pre></div><h3 id=nullifa-b>nullif(a, b)<a hidden class=anchor aria-hidden=true href=#nullifa-b>#</a></h3><ul><li>è§£é‡Š</li></ul><p>å¦‚æœå‚æ•°a=bï¼Œè¿”å›nullï¼Œå¦åˆ™è¿”å›aå€¼(Hive2.2.0ç‰ˆæœ¬)</p><ul><li>ä½¿ç”¨æ¡ˆä¾‹</li></ul><div class=highlight><pre tabindex=0 style=color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>select nullif(1,2) -- è¿”å›1
</span></span><span style=display:flex><span>select nullif(1,1) -- è¿”å›null
</span></span></code></pre></div><h3 id=nvlt-value-t-default_value>nvl(T value, T default_value)<a hidden class=anchor aria-hidden=true href=#nvlt-value-t-default_value>#</a></h3><ul><li>è§£é‡Š</li></ul><p>å¦‚æœvalueçš„å€¼ä¸ºnullï¼Œåˆ™è¿”å›default_valueé»˜è®¤å€¼ï¼Œå¦åˆ™è¿”å›valueçš„å€¼ã€‚åœ¨nullå€¼åˆ¤æ–­æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ifå‡½æ•°ç»™å®šé»˜è®¤å€¼ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨æ­¤å‡½æ•°ç»™å®šé»˜è®¤å€¼ï¼Œä½¿ç”¨è¯¥å‡½æ•°sqlç‰¹åˆ«ç®€æ´ã€‚</p><ul><li>ä½¿ç”¨æ¡ˆä¾‹</li></ul><div class=highlight><pre tabindex=0 style=color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>select nvl(1,0) -- è¿”å›1
</span></span><span style=display:flex><span>select nvl(null,0) -- è¿”å›0
</span></span></code></pre></div><h2 id=æ—¥æœŸå‡½æ•°>æ—¥æœŸå‡½æ•°<a hidden class=anchor aria-hidden=true href=#æ—¥æœŸå‡½æ•°>#</a></h2><h3 id=add_months>add_months<a hidden class=anchor aria-hidden=true href=#add_months>#</a></h3><p>add_month( DATE | STRING | TIMESTAMP start_date , INT num_months)</p><ul><li>è§£é‡Š</li></ul><p>start_dateå‚æ•°å¯ä»¥æ˜¯string, date æˆ–è€…timestampç±»å‹ï¼Œnum_monthså‚æ•°æ—¶intç±»å‹ã€‚è¿”å›ä¸€ä¸ªæ—¥æœŸï¼Œè¯¥æ—¥æœŸæ˜¯åœ¨start_dateåŸºç¡€ä¹‹ä¸ŠåŠ ä¸Šnum_monthsä¸ªæœˆï¼Œå³start_dateä¹‹ånull_monthsä¸ªæœˆçš„ä¸€ä¸ªæ—¥æœŸã€‚å¦‚æœstart_dateçš„æ—¶é—´éƒ¨åˆ†çš„æ•°æ®ä¼šè¢«å¿½ç•¥ã€‚æ³¨æ„ï¼šå¦‚æœstart_dateæ‰€åœ¨æœˆä»½çš„å¤©æ•°å¤§äºç»“æœæ—¥æœŸæœˆçš„å¤©æ•°ï¼Œåˆ™è¿”å›ç»“æœæœˆçš„æœ€åä¸€å¤©çš„æ—¥æœŸã€‚</p><ul><li>ä½¿ç”¨æ¡ˆä¾‹</li></ul><div class=highlight><pre tabindex=0 style=color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>select add_months(&#34;2020-05-20&#34;,2); -- è¿”å›2020-07-20
</span></span><span style=display:flex><span>select add_months(&#34;2020-05-20&#34;,8); -- è¿”å›2021-01-20
</span></span><span style=display:flex><span>select add_months(&#34;2020-05-31&#34;,1); -- è¿”å›2020-06-30,5æœˆæœ‰31å¤©ï¼Œ6æœˆåªæœ‰30å¤©ï¼Œæ‰€ä»¥è¿”å›ä¸‹ä¸€ä¸ªæœˆçš„æœ€åä¸€å¤©
</span></span></code></pre></div><h3 id=current_date>current_date<a hidden class=anchor aria-hidden=true href=#current_date>#</a></h3><ul><li>è§£é‡Š</li></ul><p>è¿”å›æŸ¥è¯¢æ—¶åˆ»çš„å½“å‰æ—¥æœŸ</p><ul><li>ä½¿ç”¨æ¡ˆä¾‹</li></ul><div class=highlight><pre tabindex=0 style=color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>select current_date() -- è¿”å›å½“å‰æŸ¥è¯¢æ—¥æœŸ2020-05-20
</span></span></code></pre></div><h3 id=current_timestamp>current_timestamp()<a hidden class=anchor aria-hidden=true href=#current_timestamp>#</a></h3><ul><li>è§£é‡Š</li></ul><p>è¿”å›æŸ¥è¯¢æ—¶åˆ»çš„å½“å‰æ—¶é—´</p><ul><li>ä½¿ç”¨æ¡ˆä¾‹</li></ul><div class=highlight><pre tabindex=0 style=color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>select current_timestamp() -- 2020-05-20 14:40:47.273
</span></span></code></pre></div><h3 id=datediffstring-enddate-string-startdate>datediff(STRING enddate, STRING startdate)<a hidden class=anchor aria-hidden=true href=#datediffstring-enddate-string-startdate>#</a></h3><ul><li>è§£é‡Š</li></ul><p>è¿”å›å¼€å§‹æ—¥æœŸstartdateä¸ç»“æŸæ—¥æœŸenddateä¹‹å‰ç›¸å·®çš„å¤©æ•°</p><ul><li>ä½¿ç”¨æ¡ˆä¾‹</li></ul><div class=highlight><pre tabindex=0 style=color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>select datediff(&#34;2020-05-20&#34;,&#34;2020-05-21&#34;); -- è¿”å›-1
</span></span><span style=display:flex><span>select datediff(&#34;2020-05-21&#34;,&#34;2020-05-20&#34;); -- è¿”å›1
</span></span></code></pre></div><h3 id=date_adddate-startdate-int-days>date_add(DATE startdate, INT days)<a hidden class=anchor aria-hidden=true href=#date_adddate-startdate-int-days>#</a></h3><ul><li>è§£é‡Š</li></ul><p>åœ¨startdateåŸºç¡€ä¸ŠåŠ ä¸Šå‡ å¤©ï¼Œç„¶åè¿”å›åŠ ä¸Šå‡ å¤©ä¹‹åçš„ä¸€ä¸ªæ—¥æœŸ</p><ul><li>ä½¿ç”¨æ¡ˆä¾‹</li></ul><div class=highlight><pre tabindex=0 style=color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>select date_add(&#34;2020-05-20&#34;,1); -- è¿”å›2020-05-21,1è¡¨ç¤ºåŠ 1å¤©
</span></span><span style=display:flex><span>select date_add(&#34;2020-05-20&#34;,-1); -- è¿”å›2020-05-19ï¼Œ-1è¡¨ç¤ºå‡ä¸€å¤©
</span></span></code></pre></div><h3 id=date_subdate-startdate-int-days>date_sub(DATE startdate, INT days)<a hidden class=anchor aria-hidden=true href=#date_subdate-startdate-int-days>#</a></h3><ul><li>è§£é‡Š</li></ul><p>åœ¨startdateåŸºç¡€ä¸Šå‡å»å‡ å¤©ï¼Œç„¶åè¿”å›å‡å»å‡ å¤©ä¹‹åçš„ä¸€ä¸ªæ—¥æœŸ,åŠŸèƒ½ä¸date_addå¾ˆç±»ä¼¼</p><ul><li>ä½¿ç”¨æ¡ˆä¾‹</li></ul><div class=highlight><pre tabindex=0 style=color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>select date_sub(&#34;2020-05-20&#34;,1); -- è¿”å›2020-05-19,1è¡¨ç¤ºå‡1å¤©
</span></span><span style=display:flex><span>select date_sub(&#34;2020-05-20&#34;,-1); -- è¿”å›2020-05-21ï¼Œ-1è¡¨ç¤ºåŠ 1å¤©
</span></span></code></pre></div><h3 id=date_formatdatetimestampstring-ts-string-fmt>date_format(DATE|TIMESTAMP|STRING ts, STRING fmt)<a hidden class=anchor aria-hidden=true href=#date_formatdatetimestampstring-ts-string-fmt>#</a></h3><ul><li>è§£é‡Š</li></ul><p>å°†date/timestamp/stringç±»å‹çš„å€¼è½¬æ¢ä¸ºä¸€ä¸ªå…·ä½“æ ¼å¼åŒ–çš„å­—ç¬¦ä¸²ã€‚æ”¯æŒjavaçš„SimpleDateFormatæ ¼å¼ï¼Œç¬¬äºŒä¸ªå‚æ•°fmtå¿…é¡»æ˜¯ä¸€ä¸ªå¸¸é‡</p><ul><li>ä½¿ç”¨æ¡ˆä¾‹</li></ul><div class=highlight><pre tabindex=0 style=color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>select date_format(&#39;2020-05-20&#39;, &#39;yyyy&#39;); -- è¿”å›2020
</span></span><span style=display:flex><span>select date_format(&#39;2020-05-20&#39;, &#39;MM&#39;); -- è¿”å›05
</span></span><span style=display:flex><span>select date_format(&#39;2020-05-20&#39;, &#39;dd&#39;); -- è¿”å›20
</span></span><span style=display:flex><span>-- è¿”å›2020å¹´05æœˆ20æ—¥ 00æ—¶00åˆ†00ç§’
</span></span><span style=display:flex><span>select date_format(&#39;2020-05-20&#39;, &#39;yyyyå¹´MMæœˆddæ—¥ HHæ—¶mmåˆ†ssç§’&#39;) ;
</span></span><span style=display:flex><span>select date_format(&#39;2020-05-20&#39;, &#39;yy/MM/dd&#39;) -- è¿”å› 20/05/20
</span></span></code></pre></div><h3 id=dayofmonthstring-date>dayofmonth(STRING date)<a hidden class=anchor aria-hidden=true href=#dayofmonthstring-date>#</a></h3><ul><li>è§£é‡Š</li></ul><p>è¿”å›ä¸€ä¸ªæ—¥æœŸæˆ–æ—¶é—´çš„å¤©,ä¸day()å‡½æ•°åŠŸèƒ½ç›¸åŒ</p><ul><li>ä½¿ç”¨æ¡ˆä¾‹</li></ul><div class=highlight><pre tabindex=0 style=color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>select dayofmonth(&#39;2020-05-20&#39;) -- è¿”å›20
</span></span></code></pre></div><h3 id=extractfield-from-source-æ—¶é—´æˆªå–å‡½æ•°>extract(field FROM source) æ—¶é—´æˆªå–å‡½æ•°<a hidden class=anchor aria-hidden=true href=#extractfield-from-source-æ—¶é—´æˆªå–å‡½æ•°>#</a></h3><ul><li>è§£é‡Š</li></ul><p>æå– day, dayofweek, hour, minute, month, quarter, second, week æˆ–è€…yearçš„å€¼ï¼Œfieldå¯ä»¥é€‰æ‹©day, dayofweek, hour, minute, month, quarter, second, week æˆ–è€…yearï¼Œsourceå¿…é¡»æ˜¯ä¸€ä¸ªdateã€timestampæˆ–è€…å¯ä»¥è½¬ä¸º date ã€timestampçš„å­—ç¬¦ä¸²ã€‚æ³¨æ„ï¼šHive 2.2.0ç‰ˆæœ¬ä¹‹åæ”¯æŒè¯¥å‡½æ•°</p><ul><li>ä½¿ç”¨æ¡ˆä¾‹</li></ul><div class=highlight><pre tabindex=0 style=color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>select extract(year from &#39;2020-05-20 15:21:34.467&#39;); -- è¿”å›2020ï¼Œå¹´
</span></span><span style=display:flex><span>select extract(quarter from &#39;2020-05-20 15:21:34.467&#39;); -- è¿”å›2ï¼Œå­£åº¦
</span></span><span style=display:flex><span>select extract(month from &#39;2020-05-20 15:21:34.467&#39;); -- è¿”å›05ï¼Œæœˆä»½
</span></span><span style=display:flex><span>select extract(week from &#39;2020-05-20 15:21:34.467&#39;); -- è¿”å›21ï¼ŒåŒweekofyearï¼Œä¸€å¹´ä¸­çš„ç¬¬å‡ å‘¨
</span></span><span style=display:flex><span>select extract(dayofweek from &#39;2020-05-20 15:21:34.467&#39;); -- è¿”å›4,ä»£è¡¨æ˜ŸæœŸä¸‰
</span></span><span style=display:flex><span>select extract(day from &#39;2020-05-20 15:21:34.467&#39;); -- è¿”å›20ï¼Œå¤©
</span></span><span style=display:flex><span>select extract(hour from &#39;2020-05-20 15:21:34.467&#39;); -- è¿”å›15ï¼Œå°æ—¶
</span></span><span style=display:flex><span>select extract(minute from &#39;2020-05-20 15:21:34.467&#39;); -- è¿”å›21ï¼Œåˆ†é’Ÿ
</span></span><span style=display:flex><span>select extract(second from &#39;2020-05-20 15:21:34.467&#39;); -- è¿”å›34ï¼Œç§’
</span></span></code></pre></div><h3 id=yearstring-date>year(STRING date)<a hidden class=anchor aria-hidden=true href=#yearstring-date>#</a></h3><ul><li>è§£é‡Š</li></ul><p>è¿”å›æ—¶é—´çš„å¹´ä»½,å¯ä»¥ç”¨extractå‡½æ•°æ›¿ä»£</p><ul><li>ä½¿ç”¨æ¡ˆä¾‹</li></ul><div class=highlight><pre tabindex=0 style=color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>select year(&#39;2020-05-20 15:21:34&#39;); -- è¿”å›2020
</span></span></code></pre></div><h3 id=quarterdatetimestampstring-a>quarter(DATE|TIMESTAMP|STRING a)<a hidden class=anchor aria-hidden=true href=#quarterdatetimestampstring-a>#</a></h3><ul><li>è§£é‡Š</li></ul><p>è¿”å›ç»™å®šæ—¶é—´æˆ–æ—¥æœŸçš„å­£åº¦ï¼Œ1è‡³4ä¸ªå­£åº¦,å¯ä»¥ç”¨extractå‡½æ•°æ›¿ä»£</p><ul><li>ä½¿ç”¨æ¡ˆä¾‹</li></ul><div class=highlight><pre tabindex=0 style=color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>select quarter(&#39;2020-05-20 15:21:34&#39;); -- è¿”å›2ï¼Œç¬¬2å­£åº¦
</span></span></code></pre></div><h3 id=monthstring-date>month(STRING date)<a hidden class=anchor aria-hidden=true href=#monthstring-date>#</a></h3><ul><li>è§£é‡Š</li></ul><p>è¿”å›æ—¶é—´çš„æœˆä»½,å¯ä»¥ç”¨extractå‡½æ•°æ›¿ä»£</p><ul><li>ä½¿ç”¨æ¡ˆä¾‹</li></ul><div class=highlight><pre tabindex=0 style=color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>select month(&#39;2020-05-20 15:21:34&#39;) -- è¿”å›5
</span></span></code></pre></div><h3 id=daystring-date>day(STRING date),<a hidden class=anchor aria-hidden=true href=#daystring-date>#</a></h3><ul><li>è§£é‡Š</li></ul><p>è¿”å›ä¸€ä¸ªæ—¥æœŸæˆ–è€…æ—¶é—´çš„å¤©,å¯ä»¥ç”¨extractå‡½æ•°æ›¿ä»£</p><ul><li>ä½¿ç”¨æ¡ˆä¾‹</li></ul><div class=highlight><pre tabindex=0 style=color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>select day(&#34;2020-05-20&#34;); -- è¿”å›20
</span></span><span style=display:flex><span>select day(&#34;2020-05-20 15:05:27.5&#34;); -- è¿”å›20
</span></span></code></pre></div><h3 id=hourstring-date>hour(STRING date)<a hidden class=anchor aria-hidden=true href=#hourstring-date>#</a></h3><ul><li>è§£é‡Š</li></ul><p>è¿”å›ä¸€ä¸ªæ—¶é—´çš„å°æ—¶,å¯ä»¥ç”¨extractå‡½æ•°æ›¿ä»£</p><ul><li>ä½¿ç”¨æ¡ˆä¾‹</li></ul><div class=highlight><pre tabindex=0 style=color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>select hour(&#39;2020-05-20 15:21:34&#39;);-- è¿”å›15
</span></span></code></pre></div><h3 id=minutestring-date>minute(STRING date)<a hidden class=anchor aria-hidden=true href=#minutestring-date>#</a></h3><ul><li>è§£é‡Š</li></ul><p>è¿”å›ä¸€ä¸ªæ—¶é—´çš„åˆ†é’Ÿå€¼,å¯ä»¥ç”¨extractå‡½æ•°æ›¿ä»£</p><ul><li>ä½¿ç”¨æ¡ˆä¾‹</li></ul><div class=highlight><pre tabindex=0 style=color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>select minute(&#39;2020-05-20 15:21:34&#39;); -- è¿”å›21
</span></span></code></pre></div><h3 id=secondstring-date>second(STRING date)<a hidden class=anchor aria-hidden=true href=#secondstring-date>#</a></h3><ul><li>è§£é‡Š</li></ul><p>è¿”å›ä¸€ä¸ªæ—¶é—´çš„ç§’,å¯ä»¥ç”¨extractå‡½æ•°æ›¿ä»£</p><ul><li>ä½¿ç”¨æ¡ˆä¾‹</li></ul><div class=highlight><pre tabindex=0 style=color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>select second(&#39;2020-05-20 15:21:34&#39;); --è¿”å›34
</span></span></code></pre></div><h3 id=from_unixtimebigint-unixtime--string-format>from_unixtime(BIGINT unixtime [, STRING format])<a hidden class=anchor aria-hidden=true href=#from_unixtimebigint-unixtime--string-format>#</a></h3><ul><li>è§£é‡Š</li></ul><p>å°†å°†Unixæ—¶é—´æˆ³è½¬æ¢ä¸ºå­—ç¬¦ä¸²æ ¼å¼çš„æ—¶é—´(æ¯”å¦‚yyyy-MM-dd HH:mm:ssæ ¼å¼)</p><ul><li>ä½¿ç”¨æ¡ˆä¾‹</li></ul><div class=highlight><pre tabindex=0 style=color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>select from_unixtime(1589960708); -- è¿”å›2020-05-20 15:45:08
</span></span><span style=display:flex><span>select from_unixtime(1589960708, &#39;yyyy-MM-dd hh:mm:ss&#39;); -- -- è¿”å›2020-05-20 15:45:08
</span></span><span style=display:flex><span>select from_unixtime(1589960708, &#39;yyyy-MM-dd&#39;); -- è¿”å›2020-05-20
</span></span></code></pre></div><h3 id=from_utc_timestampt-a-string-timezone>from_utc_timestamp(T a, STRING timezone)<a hidden class=anchor aria-hidden=true href=#from_utc_timestampt-a-string-timezone>#</a></h3><ul><li>è§£é‡Š</li></ul><p>è½¬æ¢ä¸ºç‰¹å®šæ—¶åŒºçš„æ—¶é—´</p><ul><li>ä½¿ç”¨æ¡ˆä¾‹</li></ul><div class=highlight><pre tabindex=0 style=color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>select from_utc_timestamp(&#39;2020-05-20 15:21:34&#39;,&#39;PST&#39;); -- è¿”å›2020-05-20 08:21:34.0
</span></span><span style=display:flex><span>select from_utc_timestamp(&#39;2020-05-20 15:21:34&#39;,&#39;GMT&#39;); -- è¿”å›2020-05-20 15:21:34.0
</span></span><span style=display:flex><span>select from_utc_timestamp(&#39;2020-05-20 15:21:34&#39;,&#39;UTC&#39;); -- è¿”å›2020-05-20 15:21:34.0
</span></span><span style=display:flex><span>select from_utc_timestamp(&#39;2020-05-20 15:21:34&#39;,&#39;DST&#39;); -- è¿”å›2020-05-20 15:21:34.0
</span></span><span style=display:flex><span>select from_utc_timestamp(&#39;2020-05-20 15:21:34&#39;,&#39;CST&#39;); -- è¿”å›2020-05-20 10:21:34.0
</span></span></code></pre></div><h3 id=last_daystring-date>last_day(STRING date)<a hidden class=anchor aria-hidden=true href=#last_daystring-date>#</a></h3><ul><li>è§£é‡Š</li></ul><p>è¿”å›ç»™å®šæ—¶é—´æˆ–æ—¥æœŸæ‰€åœ¨æœˆçš„æœ€åä¸€å¤©ï¼Œå‚æ•°å¯ä»¥æ˜¯&rsquo;yyyy-MM-dd HH:mm:ss&rsquo; æˆ–è€… &lsquo;yyyy-MM-dd&rsquo;ç±»å‹ï¼Œæ—¶é—´éƒ¨åˆ†ä¼šè¢«å¿½ç•¥</p><ul><li>ä½¿ç”¨æ¡ˆä¾‹</li></ul><div class=highlight><pre tabindex=0 style=color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>select last_day(&#39;2020-05-20 15:21:34&#39;); -- è¿”å›2020-05-31
</span></span><span style=display:flex><span>select last_day(&#39;2020-05-20&#39;); -- è¿”å›2020-05-31 
</span></span></code></pre></div><h3 id=to_datestring-timestamp>to_date(STRING timestamp)<a hidden class=anchor aria-hidden=true href=#to_datestring-timestamp>#</a></h3><ul><li>è§£é‡Š</li></ul><p>è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²æ—¶é—´çš„æ—¥æœŸéƒ¨åˆ†ï¼Œå»æ‰æ—¶é—´éƒ¨åˆ†ï¼Œ2.1.0ä¹‹å‰ç‰ˆæœ¬è¿”å›çš„æ˜¯stringï¼Œ2.1.0ç‰ˆæœ¬åŠä¹‹åè¿”å›çš„æ˜¯date</p><ul><li>ä½¿ç”¨æ¡ˆä¾‹</li></ul><div class=highlight><pre tabindex=0 style=color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>select to_date(&#39;2020-05-20 15:21:34&#39;); -- è¿”å›2020-05-20
</span></span><span style=display:flex><span>select to_date(&#39;2020-05-20&#39;); -- è¿”å›2020-05-20
</span></span></code></pre></div><h3 id=to_utc_timestampt-a-string-timezone>to_utc_timestamp(T a, STRING timezone)<a hidden class=anchor aria-hidden=true href=#to_utc_timestampt-a-string-timezone>#</a></h3><ul><li>è§£é‡Š</li></ul><p>è½¬æ¢ä¸ºä¸–ç•Œæ ‡å‡†æ—¶é—´UTCçš„æ—¶é—´æˆ³,ä¸from_utc_timestampç±»ä¼¼</p><ul><li>ä½¿ç”¨æ¡ˆä¾‹</li></ul><div class=highlight><pre tabindex=0 style=color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>select to_utc_timestamp(&#39;2020-05-20 15:21:34&#39;, &#39;GMT&#39;); -- è¿”å›2020-05-20 15:21:34.0
</span></span></code></pre></div><h3 id=truncstring-date-string-format--æˆªå–å¹´æˆ–æœˆçš„ç¬¬ä¸€å¤©>trunc(STRING date, STRING format) æˆªå–å¹´æˆ–æœˆçš„ç¬¬ä¸€å¤©<a hidden class=anchor aria-hidden=true href=#truncstring-date-string-format--æˆªå–å¹´æˆ–æœˆçš„ç¬¬ä¸€å¤©>#</a></h3><ul><li>è§£é‡Š</li></ul><p>æˆªæ–­æ—¥æœŸåˆ°æŒ‡å®šçš„æ—¥æœŸç²¾åº¦ï¼Œä»…æ”¯æŒæœˆï¼ˆMONTH/MON/MMï¼‰æˆ–è€…å¹´ï¼ˆYEAR/YYYY/YYï¼‰</p><ul><li>ä½¿ç”¨æ¡ˆä¾‹</li></ul><div class=highlight><pre tabindex=0 style=color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>select trunc(&#39;2020-05-20&#39;, &#39;YY&#39;);   -- è¿”å›2020-01-01ï¼Œè¿”å›å¹´çš„1æœˆ1æ—¥
</span></span><span style=display:flex><span>select trunc(&#39;2020-05-20&#39;, &#39;MM&#39;);   -- è¿”å›2020-05-01ï¼Œè¿”å›æœˆçš„ç¬¬ä¸€å¤©
</span></span><span style=display:flex><span>select trunc(&#39;2020-05-20 15:21:34&#39;, &#39;MM&#39;);   -- è¿”å›2020-05-01
</span></span></code></pre></div><h3 id=unix_timestampstring-date--string-pattern>unix_timestamp([STRING date [, STRING pattern]])<a hidden class=anchor aria-hidden=true href=#unix_timestampstring-date--string-pattern>#</a></h3><ul><li>è§£é‡Š</li></ul><p>å‚æ•°æ—¶å¯é€‰çš„ï¼Œå½“å‚æ•°ä¸ºç©ºæ—¶ï¼Œè¿”å›å½“å‰Unixæ˜¯æ—¶é—´æˆ³ï¼Œç²¾ç¡®åˆ°ç§’ã€‚å¯ä»¥æŒ‡å®šä¸€ä¸ªå…·ä½“çš„æ—¥æœŸï¼Œè½¬æ¢ä¸ºUnixæ—¶é—´æˆ³æ ¼å¼</p><ul><li>ä½¿ç”¨æ¡ˆä¾‹</li></ul><div class=highlight><pre tabindex=0 style=color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>-- è¿”å›1589959294
</span></span><span style=display:flex><span>select unix_timestamp(&#39;2020-05-20 15:21:34&#39;,&#39;yyyy-MM-dd hh:mm:ss&#39;);
</span></span><span style=display:flex><span>-- è¿”å›1589904000
</span></span><span style=display:flex><span>select unix_timestamp(&#39;2020-05-20&#39;,&#39;yyyy-MM-dd&#39;);
</span></span></code></pre></div><h3 id=weekofyearstring-date>weekofyear(STRING date)<a hidden class=anchor aria-hidden=true href=#weekofyearstring-date>#</a></h3><ul><li>è§£é‡Š</li></ul><p>è¿”å›ä¸€ä¸ªæ—¥æœŸæˆ–æ—¶é—´åœ¨ä¸€å¹´ä¸­çš„ç¬¬å‡ å‘¨ï¼Œå¯ä»¥ç”¨extractæ›¿ä»£</p><ul><li>ä½¿ç”¨æ¡ˆä¾‹</li></ul><div class=highlight><pre tabindex=0 style=color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>select weekofyear(&#39;2020-05-20 15:21:34&#39;); -- è¿”å›21ï¼Œç¬¬21å‘¨
</span></span><span style=display:flex><span>select weekofyear(&#39;2020-05-20&#39;); -- è¿”å›21ï¼Œç¬¬21å‘¨
</span></span></code></pre></div><h3 id=next_daystring-start_date-string-day_of_week>next_day(STRING start_date, STRING day_of_week)<a hidden class=anchor aria-hidden=true href=#next_daystring-start_date-string-day_of_week>#</a></h3><ul><li>è§£é‡Š</li></ul><p>å‚æ•°start_dateå¯ä»¥æ˜¯ä¸€ä¸ªæ—¶é—´æˆ–æ—¥æœŸï¼Œday_of_weekè¡¨ç¤ºæ˜ŸæœŸå‡ ï¼Œæ¯”å¦‚Moè¡¨ç¤ºæ˜ŸæœŸä¸€ï¼ŒTuè¡¨ç¤ºæ˜ŸæœŸäºŒï¼ŒWedè¡¨ç¤ºæ˜ŸæœŸä¸‰ï¼ŒThurè¡¨ç¤ºæ˜ŸæœŸå››ï¼ŒFriè¡¨ç¤ºæ˜ŸæœŸäº”ï¼ŒSatè¡¨ç¤ºæ˜ŸæœŸå…­ï¼ŒSunè¡¨ç¤ºæ˜ŸæœŸæ—¥ã€‚å¦‚æœæŒ‡å®šçš„æ˜ŸæœŸå‡ åœ¨è¯¥æ—¥æœŸæ‰€åœ¨çš„å‘¨ä¸”åœ¨è¯¥æ—¥æœŸä¹‹åï¼Œåˆ™è¿”å›å½“å‘¨çš„æ˜ŸæœŸå‡ æ—¥æœŸï¼Œå¦‚æœæŒ‡å®šçš„æ˜ŸæœŸå‡ ä¸åœ¨è¯¥æ—¥æœŸæ‰€åœ¨çš„å‘¨ï¼Œåˆ™è¿”å›ä¸‹ä¸€ä¸ªæ˜ŸæœŸå‡ å¯¹åº”çš„æ—¥æœŸ</p><ul><li>ä½¿ç”¨æ¡ˆä¾‹</li></ul><div class=highlight><pre tabindex=0 style=color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>select next_day(&#39;2020-05-20&#39;,&#39;Mon&#39;);-- è¿”å›å½“å‰æ—¥æœŸçš„ä¸‹ä¸€ä¸ªå‘¨ä¸€æ—¥æœŸ:2020-05-25
</span></span><span style=display:flex><span>select next_day(&#39;2020-05-20&#39;,&#39;Tu&#39;);-- è¿”å›å½“å‰æ—¥æœŸçš„ä¸‹ä¸€ä¸ªå‘¨äºŒæ—¥æœŸ:2020-05-26
</span></span><span style=display:flex><span>select next_day(&#39;2020-05-20&#39;,&#39;Wed&#39;);-- è¿”å›å½“å‰æ—¥æœŸçš„ä¸‹ä¸€ä¸ªå‘¨ä¸‰æ—¥æœŸ:2020-05-27
</span></span><span style=display:flex><span>-- 2020-05-20ä¸ºå‘¨ä¸‰ï¼ŒæŒ‡å®šçš„å‚æ•°ä¸ºå‘¨å››ï¼Œæ‰€ä»¥è¿”å›å½“å‘¨çš„å‘¨å››å°±æ˜¯2020-05-21
</span></span><span style=display:flex><span>select next_day(&#39;2020-05-20&#39;,&#39;Th&#39;);
</span></span><span style=display:flex><span>select next_day(&#39;2020-05-20&#39;,&#39;Fri&#39;);-- è¿”å›å‘¨äº”æ—¥æœŸ2020-05-22
</span></span><span style=display:flex><span>select next_day(&#39;2020-05-20&#39;,&#39;Sat&#39;); -- è¿”å›å‘¨å…­æ—¥æœŸ2020-05-23
</span></span><span style=display:flex><span>select next_day(&#39;2020-05-20&#39;,&#39;Sun&#39;); -- è¿”å›å‘¨å…­æ—¥æœŸ2020-05-24
</span></span></code></pre></div><p>è¯¥å‡½æ•°æ¯”è¾ƒé‡è¦ï¼šæ¯”å¦‚å–å½“å‰æ—¥æœŸæ‰€åœ¨çš„å‘¨ä¸€å’Œå‘¨æ—¥ï¼Œé€šè¿‡é•¿ç”¨åœ¨æŒ‰å‘¨è¿›è¡Œæ±‡æ€»æ•°æ®</p><div class=highlight><pre tabindex=0 style=color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>select date_add(next_day(&#39;2020-05-20&#39;,&#39;MO&#39;),-7); -- è¿”å›å½“å‰æ—¥æœŸçš„å‘¨ä¸€æ—¥æœŸ2020-05-18
</span></span><span style=display:flex><span>select date_add(next_day(&#39;2020-05-20&#39;,&#39;MO&#39;),-1); -- è¿”å›å½“å‰æ—¥æœŸçš„å‘¨æ—¥æ—¥æœŸ2020-05-24
</span></span></code></pre></div><h3 id=months_betweendatetimestampstring-date1-datetimestampstring-date2>months_between(DATE|TIMESTAMP|STRING date1, DATE|TIMESTAMP|STRING date2)<a hidden class=anchor aria-hidden=true href=#months_betweendatetimestampstring-date1-datetimestampstring-date2>#</a></h3><ul><li>è§£é‡Š</li></ul><p>è¿”å› date1 å’Œ date2 çš„æœˆä»½å·®ã€‚å¦‚æœdate1å¤§äºdate2ï¼Œè¿”å›æ­£å€¼ï¼Œå¦åˆ™è¿”å›è´Ÿå€¼ï¼Œå¦‚æœæ˜¯ç›¸å‡æ˜¯æ•´æ•°æœˆï¼Œåˆ™è¿”å›ä¸€ä¸ªæ•´æ•°ï¼Œå¦åˆ™ä¼šè¿”å›å°æ•°</p><ul><li>ä½¿ç”¨æ¡ˆä¾‹</li></ul><div class=highlight><pre tabindex=0 style=color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>select months_between(&#39;2020-05-20&#39;,&#39;2020-05-20&#39;); -- è¿”å›0
</span></span><span style=display:flex><span>select months_between(&#39;2020-05-20&#39;,&#39;2020-06-20&#39;); -- è¿”å›-1
</span></span><span style=display:flex><span>-- ç›¸å·®çš„æ•´æ•°æœˆ
</span></span><span style=display:flex><span>select months_between(&#39;2020-06-30&#39;,&#39;2020-05-31&#39;); -- è¿”å›1
</span></span><span style=display:flex><span>-- éæ•´æ•°æœˆï¼Œä¸€ä¸ªæœˆå·®ä¸€å¤©
</span></span><span style=display:flex><span>select months_between(&#39;2020-06-29&#39;,&#39;2020-05-31&#39;); -- è¿”å›0.93548387
</span></span></code></pre></div></div><footer class=post-footer><ul class=post-tags><li><a href=https://xiaokunji.com/zh/tags/Hive.html>Hive</a></li><li><a href=https://xiaokunji.com/zh/tags/Hadoop%E7%94%9F%E6%80%81%E5%9C%88.html>Hadoopç”Ÿæ€åœˆ</a></li></ul></footer></article></main><script async src=//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js></script><footer class=footer><span>Copyright
&copy;
-2023
<a href=https://xiaokunji.com/zh/ style=color:#939393>ç±³äºŒ</a>
All Rights Reserved</span>
<span id=busuanzi_container><span class="fa fa-user">ç”¨æˆ·æ•°:</span><span id=busuanzi_value_site_uv></span>
<span class="fa fa-eye">è®¿é—®æ•°:</span><span id=busuanzi_value_site_pv></span></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="å¤åˆ¶";function s(){t.innerHTML="å·²å¤åˆ¶ï¼",setTimeout(()=>{t.innerHTML="å¤åˆ¶"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>