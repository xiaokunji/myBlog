<!doctype html><html lang=zh dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>KafkaStreamå¿«é€Ÿå…¥é—¨ | ç±³äºŒ</title><meta name=keywords content=" 1.1.  ç›®æ ‡, 1.2.  æˆ‘ä»¬æƒ³åšä»€ä¹ˆ, 1.3.  å¯åŠ¨Kafka é›†ç¾¤, Download and install Confluent Platform 3.0.0 from ZIP archive  , *** IMPORTANT STEP ****  , The subsequent paths and commands used throughout this quickstart assume that  , your are in the following working directory:  , Note: If you want to uninstall the Confluent Platform at the end of this quickstart, , run the following commands.  ,  ,   $ rm -rf confluent-3.0.0/  ,   $ rm -rf /var/lib/kafka           Data files of Kafka  ,   $ rm -rf /var/lib/kafka-streams   Data files of Kafka Streams  ,   $ rm -rf /var/lib/zookeeper       Data files of ZooKeeper  , Start ZooKeeper.  Run this command in its own terminal.  , Start Kafka.  Run this command in its own terminal  , 1.4.  å‡†å¤‡è¾“å…¥æ•°æ®, 1.5.  åœ¨KafkaStreamsä¸­å¤„ç†è¾“å…¥æ•°æ®, Run the WordCount demo application.  There won't be any STDOUT output.  , You can safely ignore any WARN log messages.  , 1.6.  æ£€æŸ¥è¾“å‡ºç»“æœ, Why not this,you may ask?  "><meta name=description content="     "><meta name=author content="xkj"><link rel=canonical href=https://xiaokunji.com/zh/hadoop%E7%94%9F%E6%80%81%E5%9C%88/kafka/kafkastream%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8.html><link crossorigin=anonymous href=/assets/css/stylesheet.b3faf608c544858ba700943ffe182cb647f38432d29a07d73234965beacb26f6.css integrity="sha256-s/r2CMVEhYunAJQ//hgstkfzhDLSmgfXMjSWW+rLJvY=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://xiaokunji.com/img/Q.svg><link rel=icon type=image/png sizes=16x16 href=https://xiaokunji.com/img/Q.svg><link rel=icon type=image/png sizes=32x32 href=https://xiaokunji.com/img/Q.svg><link rel=apple-touch-icon href=https://xiaokunji.com/Q.svg><link rel=mask-icon href=https://xiaokunji.com/Q.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=zh href=https://xiaokunji.com/zh/hadoop%E7%94%9F%E6%80%81%E5%9C%88/kafka/kafkastream%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8.html><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><meta property="og:title" content="KafkaStreamå¿«é€Ÿå…¥é—¨"><meta property="og:description" content="     "><meta property="og:type" content="article"><meta property="og:url" content="https://xiaokunji.com/zh/hadoop%E7%94%9F%E6%80%81%E5%9C%88/kafka/kafkastream%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8.html"><meta property="article:section" content="hadoopç”Ÿæ€åœˆ"><meta property="article:published_time" content="2023-08-22T00:00:00+00:00"><meta property="article:modified_time" content="2023-08-30T16:27:33+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="KafkaStreamå¿«é€Ÿå…¥é—¨"><meta name=twitter:description content="     "><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":4,"name":"KafkaStreamå¿«é€Ÿå…¥é—¨","item":"https://xiaokunji.com/zh/hadoop%E7%94%9F%E6%80%81%E5%9C%88/kafka/kafkastream%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8.html"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"KafkaStreamå¿«é€Ÿå…¥é—¨","name":"KafkaStreamå¿«é€Ÿå…¥é—¨","description":"     ","keywords":[" 1.1.  ç›®æ ‡"," 1.2.  æˆ‘ä»¬æƒ³åšä»€ä¹ˆ"," 1.3.  å¯åŠ¨Kafka é›†ç¾¤"," Download and install Confluent Platform 3.0.0 from ZIP archive  "," *** IMPORTANT STEP ****  "," The subsequent paths and commands used throughout this quickstart assume that  "," your are in the following working directory:  "," Note: If you want to uninstall the Confluent Platform at the end of this quickstart,  "," run the following commands.  ","  ","   $ rm -rf confluent-3.0.0/  ","   $ rm -rf /var/lib/kafka           Data files of Kafka  ","   $ rm -rf /var/lib/kafka-streams   Data files of Kafka Streams  ","   $ rm -rf /var/lib/zookeeper       Data files of ZooKeeper  "," Start ZooKeeper.  Run this command in its own terminal.  "," Start Kafka.  Run this command in its own terminal  "," 1.4.  å‡†å¤‡è¾“å…¥æ•°æ®"," 1.5.  åœ¨KafkaStreamsä¸­å¤„ç†è¾“å…¥æ•°æ®"," Run the WordCount demo application.  There won't be any STDOUT output.  "," You can safely ignore any WARN log messages.  "," 1.6.  æ£€æŸ¥è¾“å‡ºç»“æœ"," Why not this, you may ask?  "],"articleBody":"[toc]\n1.1. ç›®æ ‡ æœ¬å¿«é€Ÿå…¥é—¨æŒ‡å—çš„ç›®æ ‡æ˜¯æä¾›ä¸KafkaStreamsçš„ç¬¬ä¸€ä¸ªåº”ç”¨ç¨‹åºç¤ºä¾‹ã€‚æˆ‘ä»¬å°†æ¼”ç¤ºåœ¨ä½ çš„ç¬¬ä¸€ä¸ªç¤ºä¾‹ç¨‹åºä¸­ï¼Œå¦‚æœä½¿ç”¨Kafka Streamsåº“å’Œæ¼”ç¤ºä¸€ä¸ªç®€å•çš„ç«¯åˆ°ç«¯çš„æ•°æ®æµã€‚ å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œè¿™ç§å¿«é€Ÿå…¥é—¨åªæ¶µç›–äº†KafkaStreamsçš„è¡¨é¢ï¼Œè¿™ç¯‡æ–‡æ¡£çš„å‰©ä½™éƒ¨åˆ†å°†ä¼šæä¾›æ›´å¤šçš„ç»†èŠ‚ï¼Œæˆ‘ä»¬å°†åœ¨å¿«é€Ÿå…¥é—¨æŒ‡å—ä¸­ä¸ºä½ æŒ‡æ˜æ–¹å‘ã€‚\n1.2. æˆ‘ä»¬æƒ³åšä»€ä¹ˆ åœ¨è¿™ä¸ªå¿«é€Ÿå…¥é—¨ä¸­ï¼Œæˆ‘ä»¬å°†è¿è¡ŒåŒ…å«Apachekafkaçš„ä¸€ä¸ªwordcountæ¼”ç¤ºåº”ç”¨ç¨‹åºã€‚ä¸‹é¢ä»£ç çš„å…³é”®åœ¨äºä½¿ç”¨Java8çš„lambdaè¡¨è¾¾å¼ï¼Œæ˜“äºé˜…è¯»ã€‚(æ‘˜è‡ªWordCountLambdaExample):\n[java] view plain copy //åºåˆ—åŒ–/ååºåˆ—åŒ–Stingå’ŒLongç±»å‹ final Serde stringSerde = Serdes.String(); final Serde longSerde = Serdes.Long(); //é€šè¿‡æŒ‡å®šè¾“å…¥topic â€œmystreamâ€æ¥æ„é€ KStreamå®ä¾‹ï¼Œ\n//è¾“å…¥æ•°æ®å°±ä»¥æ–‡æœ¬çš„å½¢å¼ä¿å­˜åœ¨topic â€œmystreamâ€ ä¸­ã€‚\n//(åœ¨æœ¬ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬å¿½ç•¥æ‰€æœ‰æ¶ˆæ¯çš„key.)\nKStream textLines = builder.stream(stringSerde, stringSerde, \"mystream\"); KStream wordCounts = textLines\n//ä»¥ç©ºæ ¼ä¸ºåˆ†éš”ç¬¦ï¼Œå°†æ¯è¡Œæ–‡æœ¬æ•°æ®æ‹†åˆ†æˆå¤šä¸ªå•è¯ã€‚\n//è¿™äº›æ–‡æœ¬è¡Œå°±æ˜¯ä»è¾“å…¥topicä¸­è¯»åˆ°çš„æ¯è¡Œæ¶ˆæ¯çš„Valueã€‚\n//æˆ‘ä»¬ä½¿ç”¨flatMapValuesæ–¹æ³•æ¥å¤„ç†æ¯ä¸ªæ¶ˆæ¯Valueï¼Œè€Œä¸æ˜¯æ›´é€šç”¨çš„flatMap .flatMapValues(value -\u003e Arrays.asList(value.toLowerCase().split(\"\\W+\")))\n//æˆ‘ä»¬éšåå°†è°ƒç”¨countByKeyæ¥è®¡ç®—æ¯ä¸ªå•è¯å‡ºç°çš„æ¬¡æ•°\n//æ‰€ä»¥æˆ‘ä»¬å°†æ¯ä¸ªå•è¯ä½œä¸ºmapçš„keyã€‚\n.map((key, value) -\u003e new KeyValue\u003c\u003e(value, value)) //é€šè¿‡keyæ¥ç»Ÿè®¡æ¯ä¸ªå•è¯çš„æ¬¡æ•°\n//\n//è¿™ä¼šå°†æµç±»å‹ä»KStreamè½¬ä¸ºKTable (word-count).\n//å› æ­¤æˆ‘ä»¬å¿…é¡»æä¾›Stringå’Œlongçš„åºåˆ—åŒ–ååºåˆ—åŒ–æ–¹æ³•ã€‚\n//\n.countByKey(stringSerde, \"Counts\") //è½¬åŒ–KTableåˆ°KStream\n.toStream();\n//å°†KStreamå†™å…¥åˆ°è¾“å‡ºtopicä¸­ã€‚\nwordCounts.to(stringSerde, longSerde, \"streams-wordcount-output\"); åœ¨ä¸Šé¢çš„ä»£ç æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬å°†æ‰§è¡Œå¦‚ä¸‹æ­¥éª¤ï¼š\n1ã€ å¯åŠ¨ä¸€å°kafkaé›†ç¾¤ 2ã€ ä½¿ç”¨Kafkaconsole producerå‘½ä»¤è¡Œç”Ÿäº§è€…å®¢æˆ·ç«¯å¾€Kafka Topicä¸­å†™å…¥ç¤ºä¾‹è¾“å…¥æ•°æ® 3ã€ åœ¨Javaåº”ç”¨ç¨‹åºä¸­ä½¿ç”¨kafkaStreamåº“æ¥å¤„ç†è¾“å…¥æ•°æ®ã€‚è¿™é‡Œï¼Œæˆ‘ä»¬ä½¿ç”¨äº†ä¸€ä¸ªåŒ…å«kafkaçš„WordCountç¤ºä¾‹ç¨‹åºã€‚ 4ã€ ä½¿ç”¨Kafkaconsole consumerå‘½ä»¤è¡Œæ¶ˆè´¹è€…å®¢æˆ·ç«¯æ£€æŸ¥åº”ç”¨ç¨‹åºçš„è¾“å‡ºã€‚ 5ã€ åœæ­¢Kafkaé›†ç¾¤ 1.3. å¯åŠ¨Kafka é›†ç¾¤ åœ¨æœ¬ç« èŠ‚ä¸­ï¼Œæˆ‘ä»¬ä¼šåœ¨ä¸€å°æœºå™¨ä¸Šå®‰è£…å¹¶å¯åŠ¨Kafkaé›†ç¾¤ã€‚è¯¥é›†ç¾¤æœ‰ä¸€ä¸ªå•èŠ‚ç‚¹Kafka(åªæœ‰ä¸€ä¸ªBroker)å¤–åŠ ä¸€ä¸ªå•èŠ‚ç‚¹Zookeeperæ„æˆã€‚åœ¨wordcountæ¼”ç¤ºç¨‹åºä¸­ï¼Œè¿™ç§é›†ç¾¤ä¾èµ–æ˜¯å¿…é¡»çš„ã€‚æˆ‘ä»¬å‡å®škafka brokerè¿è¡Œåœ°å€ä¸ºlocalhost:9092, Zookeeperæœ¬åœ°åœ°å€ä¸ºlocalhost:2181ã€‚ é¦–å…ˆï¼Œå®‰è£…Oracle JREæˆ–JDK 1.7åŠä»¥ä¸Šç‰ˆæœ¬ ç„¶åï¼Œä¸‹è½½å’Œå®‰è£…åŒ…å«Kafka Streamsçš„æ–°ç‰ˆæœ¬Apache Kafka. ä¸ºæ­¤ï¼Œæˆ‘ä»¬ä½¿ç”¨Confluent Platform 3.0.0ç‰ˆæœ¬ã€‚ (ä¸‹é¢æ“ä½œæ¯”è¾ƒç®€å•ï¼Œæ‰€ä»¥ä¸ç¿»è¯‘äº†ã€‚)\n[plain] view plain copy # Download and install Confluent Platform 3.0.0 from ZIP archive $ wget http://packages.confluent.io/archive/3.0/confluent-3.0.0-2.11.zip $ unzip confluent-3.0.0-2.11.zip # *** IMPORTANT STEP **** # The subsequent paths and commands used throughout this quickstart assume that # your are in the following working directory: $ cd confluent-3.0.0/ # Note: If you want to uninstall the Confluent Platform at the end of this quickstart, # run the following commands. # # $ rm -rf confluent-3.0.0/ # $ rm -rf /var/lib/kafka # Data files of Kafka # $ rm -rf /var/lib/kafka-streams # Data files of Kafka Streams # $ rm -rf /var/lib/zookeeper # Data files of ZooKeeper æç¤ºï¼šå¯ä»¥é€šè¿‡Installationvia ZIP and TAR archives å’ŒConfluentPlatform Quickstart è·å–æ›´è¿›ä¸€æ­¥ä¿¡æ¯ã€‚ æˆ‘ä»¬é¦–å…ˆå¯åŠ¨ZooKeeperå®ä¾‹ã€‚è¯¥å®ä¾‹å°†ç›‘å¬æœ¬åœ°2181ç«¯å£ã€‚ç”±äºè¿™æ˜¯ä¸€ä¸ªé•¿æœŸè¿è¡Œçš„æœåŠ¡ï¼Œä½ åº”è¯¥åœ¨è‡ªå·±çš„ç»ˆç«¯ä¸­è¿è¡Œã€‚\n[plain] view plain copy # Start ZooKeeper. Run this command in its own terminal. $ ./bin/zookeeper-server-start ./etc/kafka/zookeeper.properties æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å¯åŠ¨Kakfaçš„Brokerï¼Œè¿™å°†ç›‘å¬æœ¬åœ°9092ç«¯å£ï¼Œç„¶åè¿æ¥åˆ°æˆ‘ä»¬åˆšåˆšå¯åŠ¨çš„Zookeeperå®ä¾‹ã€‚è¿™ä¹Ÿæ˜¯ä¸€ä¸ªé•¿æœŸè¿è¡Œçš„æœåŠ¡ï¼Œä¹Ÿåº”è¯¥åœ¨ç»ˆç«¯ä¸­è¿è¡Œå®ƒã€‚\n[plain] view plain copy # Start Kafka. Run this command in its own terminal $ ./bin/kafka-server-start ./etc/kafka/server.properties ç°åœ¨ï¼Œæˆ‘ä»¬çš„å•èŠ‚ç‚¹kafkaé›†ç¾¤å·²ç»å®Œå…¨è¿è½¬èµ·æ¥äº†ï¼Œæˆ‘ä»¬å°±å¯ä»¥ç€æ‰‹å‡†å¤‡è¾“å…¥æ•°æ®ï¼Œè¿è¡Œæˆ‘ä»¬çš„ç¬¬ä¸€ä¸ªkafka Streamsç¤ºä¾‹ç¨‹åºã€‚\n1.4. å‡†å¤‡è¾“å…¥æ•°æ® æç¤ºï¼šåœ¨æœ¬ç« èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨å†…ç½®çš„å‘½ä»¤è¡Œå·¥å…·æ¥è¾“å…¥kakfaæ•°æ®ã€‚åœ¨å®é™…ä½¿ç”¨ä¸­ï¼Œä½ åº”è¯¥é€šè¿‡å…¶ä»–æ–¹å¼å°†æ•°æ®å†™å…¥Kafkaä¸­ï¼Œæ¯”å¦‚é€šè¿‡ä½ è‡ªå·±åº”ç”¨ç¨‹åºä¸­çš„Kafkaå®¢æˆ·ç«¯ã€‚ ç°åœ¨ï¼Œæˆ‘ä»¬å°†ä¸€äº›è¾“å…¥æ•°æ®å‘é€åˆ°Kafkaçš„topicä¸­ï¼Œç„¶åç”±Kafka Streamsçš„åº”ç”¨ç¨‹åºåšåç»­å¤„ç†ã€‚ é¦–å…ˆï¼Œæˆ‘ä»¬è¦åˆ›å»ºåç§°ä¸ºmystreamçš„topicï¼š\n[plain] view plain copy $ ./bin/kafka-topics.sh --create --zookeeper slave01:2181,slave02:2181,slave03:2181 --replication-factor 1 --partitions 1 --topic mystream ä¸‹ä¸€æ­¥ï¼Œæˆ‘ä»¬ç”Ÿæˆä¸€äº›è¾“å…¥æ•°æ®å¹¶ä¿å­˜åœ¨æœ¬åœ°æ–‡ä»¶/tmp/file-input.txtä¸­ã€‚\n[plain] view plain copy $ echo -e \"all streams lead to kafka hello kafka streams join kafka summit\" \u003e /tmp/file-input.txt ç”Ÿæˆçš„æ–‡ä»¶å°†åŒ…å«å¦‚ä¸‹å†…å®¹ï¼š\n[plain] view plain copy all streams lead to kafka hello kafka streams join kafka summit æœ€åï¼Œæˆ‘ä»¬å‘é€è¿™äº›æ•°æ®åˆ°input topic\n[plain] view plain copy $ cat /tmp/file-input.txt | ./bin/kafka-console-producer --broker-list master:9092,slave01:9092,slave02:9092,slave03:9092 --topic mystream Kafka console-producerä»stdinä¸­è¯»å–æ•°æ®ï¼Œå¹¶å°†æ¯ä¸€è¡Œä½œä¸ºå•ç‹¬çš„æ¶ˆæ¯å‘é€åˆ°kafkaçš„è¾“å…¥æµä¸­ã€‚è¯¥æ¶ˆæ¯çš„keyæ˜¯nullï¼Œæ¶ˆæ¯æ˜¯æ¯è¡Œå†…å®¹ï¼Œä½¿ç”¨å­—ç¬¦ä¸²ç¼–ç ã€‚\næ³¨æ„: ä½ å¯èƒ½æƒ³çŸ¥é“è¿™æ ·ä¸€æ­¥æ­¥çš„å¿«é€Ÿå¯åŠ¨å’ŒçœŸå®æµå¤„ç†ç³»ç»Ÿçš„å·®å¼‚ï¼Œåœ¨å¤§å‹çš„å®æ—¶çš„æµå¤„ç†ç³»ç»Ÿä¸­ï¼Œæ•°æ®æ€»æ˜¯åœ¨ç§»åŠ¨çš„ï¼Œå¿«é€Ÿå…¥é—¨çš„ç›®çš„ä»…ä»…æ˜¯åšåŠŸèƒ½è¯æ˜ã€‚ç®€å•æ¥è¯´ï¼Œä¸€ä¸ªç«¯åˆ°ç«¯çš„æ•°æ®ç®¡é“å»ºç«‹åœ¨Kafkaå’ŒKafka Streamsçš„å„ä¸ªæ–¹é¢ã€‚å‡ºäºè¯´æ•™çš„åŸå› ï¼Œæˆ‘ä»¬æ•…æ„å°†å¿«é€Ÿå…¥é—¨æ¸…æ¥šåœ°æ‹†åˆ†æˆä¸€ç³»åˆ—åˆ†å¼€è¿ç»­çš„æ­¥éª¤ã€‚\nä½†åœ¨å®è·µä¸­ï¼Œè¿™äº›æ­¥éª¤é€šå¸¸ä¼šçœ‹èµ·æ¥æœ‰äº›ä¸åŒå¹¶ä¸”ä¼šæœ‰å¹¶å‘çš„å­˜åœ¨ã€‚æ¯”å¦‚è¾“å…¥æ•°æ®å¯èƒ½ä¸ä¼šæ¥æºäºæœ¬åœ°æ–‡ä»¶ï¼Œè€Œæ˜¯ç›´æ¥ä»åˆ†å¸ƒå¼ç³»ç»Ÿä¸­å‘é€çš„ï¼Œå¹¶ä¸”æ•°æ®å°†è¢«è¿ç»­çš„å†™å…¥Kafkaã€‚ç±»ä¼¼çš„ï¼Œæµå¤„ç†åº”ç”¨ç¨‹åºå¯èƒ½åœ¨ç¬¬ä¸€è¡Œæ•°æ®å‘é€ä¹‹å‰å°±å·²ç»å¯åŠ¨å¹¶è¿è¡Œã€‚\n1.5. åœ¨KafkaStreamsä¸­å¤„ç†è¾“å…¥æ•°æ® ç°åœ¨ï¼Œæˆ‘ä»¬å·²ç»ç”Ÿæˆäº†ä¸€äº›è¾“å…¥æ•°æ®ï¼Œæˆ‘ä»¬å¯ä»¥è¿è¡Œæˆ‘ä»¬çš„ç¬¬ä¸€ä¸ªåŸºäºKafka Streamsçš„javaåº”ç”¨ç¨‹åºã€‚\næˆ‘ä»¬å°†è¿è¡ŒWordCountæ¼”ç¤ºåº”ç”¨ç¨‹åºï¼Œå®ƒä½¿ç”¨äº†ApacheKafkaã€‚å®ƒå®ç°äº†WordCountç®—æ³•ï¼Œä»è¾“å…¥æ–‡æœ¬æ¥è®¡ç®—ç›´æ–¹å›¾ã€‚ç„¶è€Œå’Œå…¶ä»–ä½ ä¹‹å‰è§è¿‡çš„æ“ä½œè¢«ç»‘å®šåœ¨æ•°æ®ä¸Šçš„WordCountå®ä¾‹ç¨‹åºä¸åŒçš„æ˜¯ï¼Œè¿™ä¸ªç¤ºä¾‹ç¨‹åºæ˜¯æ•°æ®æ— ç•Œï¼Œæ— é™æµåŠ¨çš„ã€‚å’Œæœ‰ç•Œç®—æ³•çš„å˜ä½“ç±»ä¼¼ï¼Œä»–æ˜¯ä¸€ä¸ªæœ‰çŠ¶æ€çš„ç®—æ³•ï¼Œè·Ÿè¸ªå¹¶æ›´æ–°wordçš„è®¡æ•°å™¨ã€‚ç„¶åå› ä¸ºå®ƒå¿…é¡»æ¥å—æ— ç•Œçš„è¾“å…¥æ•°æ®ï¼Œå®ƒä¼šå‘¨æœŸæ€§çš„è¾“å‡ºå…¶å½“å‰çŠ¶æ€å’Œè®¡ç®—ç»“æœï¼ŒåŒæ—¶ç»§ç»­å¤„ç†æ›´å¤šçš„æ•°æ®ï¼Œå› ä¸ºå®ƒä¸çŸ¥é“æ˜¯å¦å·²ç»å¤„ç†äº†æ‰€æœ‰çš„æ•°æ®ã€‚è¿™å°±æ˜¯ä»–å’ŒHadoop çš„Mapreduceç®—æ³•ä¹‹é—´çš„å…¸å‹å·®å¼‚ã€‚ä¸€æ—¦æˆ‘ä»¬äº†è§£è¿™ç§å·®å¼‚ï¼Œæ£€æŸ¥äº†å®é™…çš„è¾“å‡ºæ•°æ®ä¹‹åï¼Œä¼šæ›´å®¹æ˜“æ¥å—å®ƒã€‚ ç”±äºwordCountç¤ºä¾‹ç¨‹åºä¸kafkaæ‰“åŒ…åœ¨ä¸€èµ·ï¼Œå·²ç»åœ¨Kafkaçš„Brokerä¸­é›†æˆï¼Œè¿™å°±æ„å‘³ç€æˆ‘ä»¬ä¸éœ€è¦åšé¢å¤–çš„äº‹æƒ…å°±å¯ä»¥è¿è¡Œå®ƒï¼Œæ— éœ€ç¼–è¯‘ä»»ä½•Javaæºä»£ç ã€‚\n[plain] view plain copy # Run the WordCount demo application. There won't be any STDOUT output. # You can safely ignore any WARN log messages. $ ./bin/kafka-run-class org.apache.kafka.streams.examples.wordcount.WordCountDemo æ³¨æ„ï¼Œè¿™é‡Œæ²¡æœ‰é­”æœ¯å¼çš„éƒ¨ç½²ï¼Œå®é™…ä¸Šï¼Œä½¿ç”¨kafkaStreamsåº“ä¸­çš„ä»»ä½•åº”ç”¨ç¨‹åºï¼Œå°±åƒå¯åŠ¨ä»»ä½•æ™®é€šçš„Javaåº”ç”¨ç¨‹åºï¼Œè¯¥è„šæœ¬kafka-run-classä¹Ÿåªæ˜¯ä¸€ä¸ªç®€å•çš„java -cpå‘½ä»¤çš„åŒ…è£…ã€‚\nè¯¥WordCountç¤ºä¾‹ç¨‹åºå°†ä»è¾“å…¥topicä¸­è¯»å–æ•°æ®ï¼Œç„¶åè®¡ç®—wordCountï¼Œå°†è®¡ç®—ç»“æœä¸æ–­è¿›è¡Œè¾“å‡ºã€‚æ¼”ç¤ºå°†è¿è¡Œå‡ ç§’é’Ÿï¼Œç„¶åå’Œå…¶ä»–å…¸å‹æµå¤„ç†åº”ç”¨ç¨‹åºä¸åŒçš„æ˜¯ï¼Œå®ƒå°†ä¼šè‡ªåŠ¨ç»ˆæ­¢ã€‚\n1.6. æ£€æŸ¥è¾“å‡ºç»“æœ åœ¨æœ¬ç« èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨å†…ç½®çš„å‘½ä»¤è¡Œå·¥å…·ä»kafkaä¸­æ‰‹å·¥è¯»å–æ•°æ®ã€‚åœ¨å®é™…ä½¿ç”¨ä¸­ï¼Œä½ å¯ä»¥é€šè¿‡å…¶ä»–æ–¹å¼ï¼Œé€šè¿‡Kakfaå®¢æˆ·ç«¯ä»Kafkaä¸­è¯»å–æ•°æ®ã€‚æ¯”å¦‚ï¼Œå¦‚æœä½ å¯ä»¥åœ¨è‡ªå·±çš„åº”ç”¨ç¨‹åºä¸­ä½¿ç”¨Kafkaå®¢æˆ·ç«¯å°†æ•°æ®ä»Kakfaä¸­è¿ç§»åˆ°å…¶å®ƒæ•°æ®ç³»ç»Ÿã€‚ ç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥ä»kafkaè¾“å‡ºtopicä¸­è¯»å–æ•°æ®å¹¶æ£€æŸ¥wordcountå®ä¾‹è¿è¡Œç»“æœã€‚\n[plain] view plain copy ./bin/kafka-console-consumer --zookeeper slave01:2181 \\ --topic streams-wordcount \\ --from-beginning \\ --formatter kafka.tools.DefaultMessageFormatter \\ --property print.key=true\\ --property key.deserializer=org.apache.kafka.common.serialization.StringDeserializer \\ --property value.deserializer=org.apache.kafka.common.serialization.LongDeserializer kafka-console-consumer.sh --zookeeper slave01:2181 --topic streams-wordcount --property print.key=true --property key.deserializer=org.apache.kafka.common.serialization.StringDeserializer --property value.deserializer=org.apache.kafka.common.serialization.LongDeserializer Wordcountçš„æ•°æ®å°†ä¼šè¢«æ‰“å°åœ¨å¦‚ä¸‹çš„æ§åˆ¶å°ä¸­ï¼š\n[plain] view plain copy all 1 streams 1 lead 1 to 1 kafka 1 hello 1 kafka 2 streams 2 join 1 kafka 3 summit 1 è¿™é‡Œï¼Œç¬¬ä¸€åˆ—æ˜¯Kafkaæ¶ˆæ¯çš„keyçš„å­—ç¬¦ä¸²æ ¼å¼ï¼Œç¬¬äºŒåˆ—æ˜¯æ¶ˆæ¯çš„å€¼ï¼Œlongç±»å‹ã€‚ä½ å¯ä»¥é€šè¿‡Ctrl+cå‘½ä»¤æ¥ç»ˆæ­¢æ§åˆ¶å°è¾“å‡ºã€‚ ä½†æ˜¯ç­‰ä¸€ä¸‹ï¼Œè¾“å‡ºçœ‹èµ·æ¥æ˜¯ä¸æ˜¯å¾ˆå¥‡æ€ªï¼Ÿä¸ºä»€ä¹ˆä¼šå‡ºç°é‡å¤çš„æ¡ç›®ï¼Ÿæ¯”å¦‚streamså‡ºç°äº†ä¸¤æ¬¡ï¼š\n[plain] view plain copy # Why not this, you may ask? all 1 lead 1 to 1 hello 1 streams 2 join 1 kafka 3 summit 1 å¯¹äºä¸Šé¢çš„è¾“å‡ºçš„è§£é‡Šæ˜¯ï¼ŒwordCountåº”ç”¨ç¨‹åºçš„è¾“å‡ºå®é™…ä¸Šæ˜¯æŒç»­æ›´æ–°çš„æµï¼Œå…¶ä¸­æ¯è¡Œè®°å½•æ˜¯ä¸€ä¸ªå•ä¸€çš„word(å³Message Keyï¼Œæ¯”å¦‚Kafka)çš„è®¡æ•°ã€‚å¯¹äºåŒä¸€ä¸ªKeyçš„å¤šä¸ªè®°å½•ï¼Œæ¯ä¸ªè®°å½•ä¹‹åæ˜¯å‰ä¸€ä¸ªçš„æ›´æ–°ã€‚\nå½“ç¬¬äºŒä¸ªæ–‡æœ¬èˆªçš„hello kafkastreamsè¢«å¤„ç†çš„æ—¶å€™ï¼Œæˆ‘ä»¬è§‚å¯Ÿåˆ°ï¼Œç›¸å¯¹ç¬¬ä¸€æ¬¡ï¼Œå·²ç»å­˜åœ¨çš„æ¡ç›®KTableè¢«æ›´æ–°äº†(Kafakå’ŒStreamsè¿™ä¸¤ä¸ªå•è¯). ä¿®æ”¹åçš„è®°å½•è¢«åœ¨æ­¤å‘é€åˆ°äº†KStreamã€‚ è¿™å°±è§£é‡Šäº†ä¸Šè¿°KStreamç¬¬äºŒåˆ—ä¸­æ˜¾ç¤ºçš„ä¿¡æ¯ï¼Œä¸ºä»€ä¹ˆè¾“å‡ºçš„topicä¸Šæ˜¾ç¤ºçš„å†…å®¹ï¼Œå› ä¸ºå®ƒæ˜¯åŒ…å«äº†å˜åŒ–çš„å®Œæ•´å†…å®¹\n[plain] view plain copy all 1 streams 1 lead 1 to 1 kafka 1 hello 1 kafka 2 streams 2 join 1 kafka 3 summit 1 æ›´å¤šå‚çœ‹å®˜ç½‘:http://kafka.apache.org/documentation/streams/\n","wordCount":"3732","inLanguage":"zh","datePublished":"2023-08-22T00:00:00Z","dateModified":"2023-08-30T16:27:33.771734927Z","author":{"@type":"Person","name":"xkj"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://xiaokunji.com/zh/hadoop%E7%94%9F%E6%80%81%E5%9C%88/kafka/kafkastream%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8.html"},"publisher":{"@type":"Organization","name":"ç±³äºŒ","logo":{"@type":"ImageObject","url":"https://xiaokunji.com/img/Q.svg"}}}</script></head><body class=dark id=top><script>localStorage.getItem("pref-theme")==="light"&&document.body.classList.remove("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://xiaokunji.com/zh/ accesskey=h title="ç±³äºŒ (Alt + H)"><img src=https://xiaokunji.com/img/Q.svg alt aria-label=logo height=35>ç±³äºŒ</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li><li><a href=https://xiaokunji.com/en/ title=English aria-label=English>English</a></li></ul></div></div><ul id=menu><li><a href=https://xiaokunji.com/zh/ title=ğŸ ä¸»é¡µ><span>ğŸ ä¸»é¡µ</span></a></li><li><a href=https://xiaokunji.com/zh/search.html title="ğŸ”æœç´¢ (Alt + /)" accesskey=/><span>ğŸ”æœç´¢</span></a></li><li><a href=https://xiaokunji.com/zh/post.html title=ğŸ“šæ–‡ç« ><span>ğŸ“šæ–‡ç« </span></a></li><li><a href=https://xiaokunji.com/zh/archives.html title=â±æ—¶é—´è½´><span>â±æ—¶é—´è½´</span></a></li><li><a href=https://xiaokunji.com/zh/tags.html title=ğŸ”–æ ‡ç­¾><span>ğŸ”–æ ‡ç­¾</span></a></li><li><a href=https://xiaokunji.com/zh/categories.html title=ğŸ“–åˆ†ç±»><span>ğŸ“–åˆ†ç±»</span></a></li><li><a href=https://xiaokunji.com/zh/links.html title=ğŸ¤å‹é“¾><span>ğŸ¤å‹é“¾</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><nav aria-label=breadcrumb><ul><a href=https://xiaokunji.com/zh/>ğŸ </a> <span>></span>
<a href=https://xiaokunji.com/zh/hadoop%E7%94%9F%E6%80%81%E5%9C%88.html>hadoopç”Ÿæ€åœˆ</a> <span>></span>
<a href=https://xiaokunji.com/zh/hadoop%E7%94%9F%E6%80%81%E5%9C%88/kafka.html>Kafka</a> <span>></span></ul></nav><h1 class=post-title>KafkaStreamå¿«é€Ÿå…¥é—¨</h1><div class=post-description></div><div class=post-meta>åˆ›å»º:&nbsp;<span title='2023-08-22 00:00:00 +0000 UTC'>2023-08-22</span>&nbsp;Â·&nbsp;æ›´æ–°:&nbsp;2023-08-30&nbsp;Â·&nbsp;8 åˆ†é’Ÿ&nbsp;Â·&nbsp;xkj
&nbsp;|&nbsp;åˆ†ç±»: &nbsp;<ul class=post-categories-meta><a href=https://xiaokunji.com/zh/categories/hadoop%E7%94%9F%E6%80%81%E5%9C%88.html>Hadoopç”Ÿæ€åœˆ</a></ul><span id=busuanzi_container_page_pv>&nbsp;| è®¿é—®: <span id=busuanzi_value_page_pv></span></span></div></header><aside id=toc-container class="toc-container wide"><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>ç›®å½•</span></summary><div class=inner><ul><li><a href=#11--%e7%9b%ae%e6%a0%87 aria-label="1.1.  ç›®æ ‡">1.1. ç›®æ ‡</a></li><li><a href=#12--%e6%88%91%e4%bb%ac%e6%83%b3%e5%81%9a%e4%bb%80%e4%b9%88 aria-label="1.2.  æˆ‘ä»¬æƒ³åšä»€ä¹ˆ">1.2. æˆ‘ä»¬æƒ³åšä»€ä¹ˆ</a></li><li><a href=#13--%e5%90%af%e5%8a%a8kafka-%e9%9b%86%e7%be%a4 aria-label="1.3.  å¯åŠ¨Kafka é›†ç¾¤">1.3. å¯åŠ¨Kafka é›†ç¾¤</a></li><li><a href=#14--%e5%87%86%e5%a4%87%e8%be%93%e5%85%a5%e6%95%b0%e6%8d%ae aria-label="1.4.  å‡†å¤‡è¾“å…¥æ•°æ®">1.4. å‡†å¤‡è¾“å…¥æ•°æ®</a></li><li><a href=#15--%e5%9c%a8kafkastreams%e4%b8%ad%e5%a4%84%e7%90%86%e8%be%93%e5%85%a5%e6%95%b0%e6%8d%ae aria-label="1.5.  åœ¨KafkaStreamsä¸­å¤„ç†è¾“å…¥æ•°æ®">1.5. åœ¨KafkaStreamsä¸­å¤„ç†è¾“å…¥æ•°æ®</a></li><li><a href=#16--%e6%a3%80%e6%9f%a5%e8%be%93%e5%87%ba%e7%bb%93%e6%9e%9c aria-label="1.6.  æ£€æŸ¥è¾“å‡ºç»“æœ">1.6. æ£€æŸ¥è¾“å‡ºç»“æœ</a></li></ul></div></details></div></aside><script>let activeElement,elements;window.addEventListener("DOMContentLoaded",function(){checkTocPosition(),elements=document.querySelectorAll("h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]"),activeElement=elements[0];const t=encodeURI(activeElement.getAttribute("id")).toLowerCase();document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active")},!1),window.addEventListener("resize",function(){checkTocPosition()},!1),window.addEventListener("scroll",()=>{activeElement=Array.from(elements).find(e=>{if(getOffsetTop(e)-window.pageYOffset>0&&getOffsetTop(e)-window.pageYOffset<window.innerHeight/2)return e})||activeElement,elements.forEach(e=>{const t=encodeURI(e.getAttribute("id")).toLowerCase();e===activeElement?document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active"):document.querySelector(`.inner ul li a[href="#${t}"]`).classList.remove("active")})},!1);const main=parseInt(getComputedStyle(document.body).getPropertyValue("--article-width"),10),toc=parseInt(getComputedStyle(document.body).getPropertyValue("--toc-width"),10),gap=parseInt(getComputedStyle(document.body).getPropertyValue("--gap"),10);function checkTocPosition(){const e=document.body.scrollWidth;e-main-toc*2-gap*4>0?document.getElementById("toc-container").classList.add("wide"):document.getElementById("toc-container").classList.remove("wide")}function getOffsetTop(e){if(!e.getClientRects().length)return 0;let t=e.getBoundingClientRect(),n=e.ownerDocument.defaultView;return t.top+n.pageYOffset}</script><div class=post-content><p>[toc]</p><h2 id=11--ç›®æ ‡>1.1. ç›®æ ‡<a hidden class=anchor aria-hidden=true href=#11--ç›®æ ‡>#</a></h2><p>æœ¬å¿«é€Ÿå…¥é—¨æŒ‡å—çš„ç›®æ ‡æ˜¯æä¾›ä¸KafkaStreamsçš„ç¬¬ä¸€ä¸ªåº”ç”¨ç¨‹åºç¤ºä¾‹ã€‚æˆ‘ä»¬å°†æ¼”ç¤ºåœ¨ä½ çš„ç¬¬ä¸€ä¸ªç¤ºä¾‹ç¨‹åºä¸­ï¼Œå¦‚æœä½¿ç”¨Kafka Streamsåº“å’Œæ¼”ç¤ºä¸€ä¸ªç®€å•çš„ç«¯åˆ°ç«¯çš„æ•°æ®æµã€‚
å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œè¿™ç§å¿«é€Ÿå…¥é—¨åªæ¶µç›–äº†KafkaStreamsçš„è¡¨é¢ï¼Œè¿™ç¯‡æ–‡æ¡£çš„å‰©ä½™éƒ¨åˆ†å°†ä¼šæä¾›æ›´å¤šçš„ç»†èŠ‚ï¼Œæˆ‘ä»¬å°†åœ¨å¿«é€Ÿå…¥é—¨æŒ‡å—ä¸­ä¸ºä½ æŒ‡æ˜æ–¹å‘ã€‚</p><h2 id=12--æˆ‘ä»¬æƒ³åšä»€ä¹ˆ>1.2. æˆ‘ä»¬æƒ³åšä»€ä¹ˆ<a hidden class=anchor aria-hidden=true href=#12--æˆ‘ä»¬æƒ³åšä»€ä¹ˆ>#</a></h2><p>åœ¨è¿™ä¸ªå¿«é€Ÿå…¥é—¨ä¸­ï¼Œæˆ‘ä»¬å°†è¿è¡ŒåŒ…å«Apachekafkaçš„ä¸€ä¸ªwordcountæ¼”ç¤ºåº”ç”¨ç¨‹åºã€‚ä¸‹é¢ä»£ç çš„å…³é”®åœ¨äºä½¿ç”¨Java8çš„lambdaè¡¨è¾¾å¼ï¼Œæ˜“äºé˜…è¯»ã€‚(æ‘˜è‡ªWordCountLambdaExample):</p><div class=highlight><pre tabindex=0 style=color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>[java] view plain copy
</span></span><span style=display:flex><span>//åºåˆ—åŒ–/ååºåˆ—åŒ–Stingå’ŒLongç±»å‹  
</span></span><span style=display:flex><span>final Serde&lt;String&gt; stringSerde = Serdes.String();  
</span></span><span style=display:flex><span>final Serde&lt;Long&gt; longSerde = Serdes.Long();  
</span></span></code></pre></div><p>//é€šè¿‡æŒ‡å®šè¾“å…¥topic â€œmystreamâ€æ¥æ„é€ KStreamå®ä¾‹ï¼Œ<br>//è¾“å…¥æ•°æ®å°±ä»¥æ–‡æœ¬çš„å½¢å¼ä¿å­˜åœ¨topic â€œmystreamâ€ ä¸­ã€‚<br>//(åœ¨æœ¬ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬å¿½ç•¥æ‰€æœ‰æ¶ˆæ¯çš„key.)<br><code>KStream&lt;String, String> textLines = builder.stream(stringSerde, stringSerde, "mystream");</code></p><p><code>KStream&lt;String, Long> wordCounts = textLines</code><br>//ä»¥ç©ºæ ¼ä¸ºåˆ†éš”ç¬¦ï¼Œå°†æ¯è¡Œæ–‡æœ¬æ•°æ®æ‹†åˆ†æˆå¤šä¸ªå•è¯ã€‚<br>//è¿™äº›æ–‡æœ¬è¡Œå°±æ˜¯ä»è¾“å…¥topicä¸­è¯»åˆ°çš„æ¯è¡Œæ¶ˆæ¯çš„Valueã€‚<br>//æˆ‘ä»¬ä½¿ç”¨flatMapValuesæ–¹æ³•æ¥å¤„ç†æ¯ä¸ªæ¶ˆæ¯Valueï¼Œè€Œä¸æ˜¯æ›´é€šç”¨çš„<code>flatMap .flatMapValues(value -> Arrays.asList(value.toLowerCase().split("\W+")))</code><br>//æˆ‘ä»¬éšåå°†è°ƒç”¨countByKeyæ¥è®¡ç®—æ¯ä¸ªå•è¯å‡ºç°çš„æ¬¡æ•°<br>//æ‰€ä»¥æˆ‘ä»¬å°†æ¯ä¸ªå•è¯ä½œä¸ºmapçš„keyã€‚<br><code>.map((key, value) -> new KeyValue&lt;>(value, value))</code>
//é€šè¿‡keyæ¥ç»Ÿè®¡æ¯ä¸ªå•è¯çš„æ¬¡æ•°<br>//<br>//è¿™ä¼šå°†æµç±»å‹ä»KStream&lt;String,String>è½¬ä¸ºKTable&lt;String,Long> (word-count).<br>//å› æ­¤æˆ‘ä»¬å¿…é¡»æä¾›Stringå’Œlongçš„åºåˆ—åŒ–ååºåˆ—åŒ–æ–¹æ³•ã€‚<br>//<br><code>.countByKey(stringSerde, "Counts")</code>
//è½¬åŒ–KTable&lt;String,Long>åˆ°KStream&lt;String,Long><br>.toStream();</p><p>//å°†KStream&lt;String,Long>å†™å…¥åˆ°è¾“å‡ºtopicä¸­ã€‚<br><code>wordCounts.to(stringSerde, longSerde, "streams-wordcount-output");</code></p><p>åœ¨ä¸Šé¢çš„ä»£ç æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬å°†æ‰§è¡Œå¦‚ä¸‹æ­¥éª¤ï¼š</p><ul><li>1ã€ å¯åŠ¨ä¸€å°kafkaé›†ç¾¤</li><li>2ã€ ä½¿ç”¨Kafkaconsole producerå‘½ä»¤è¡Œç”Ÿäº§è€…å®¢æˆ·ç«¯å¾€Kafka Topicä¸­å†™å…¥ç¤ºä¾‹è¾“å…¥æ•°æ®</li><li>3ã€ åœ¨Javaåº”ç”¨ç¨‹åºä¸­ä½¿ç”¨kafkaStreamåº“æ¥å¤„ç†è¾“å…¥æ•°æ®ã€‚è¿™é‡Œï¼Œæˆ‘ä»¬ä½¿ç”¨äº†ä¸€ä¸ªåŒ…å«kafkaçš„WordCountç¤ºä¾‹ç¨‹åºã€‚</li><li>4ã€ ä½¿ç”¨Kafkaconsole consumerå‘½ä»¤è¡Œæ¶ˆè´¹è€…å®¢æˆ·ç«¯æ£€æŸ¥åº”ç”¨ç¨‹åºçš„è¾“å‡ºã€‚</li><li>5ã€ åœæ­¢Kafkaé›†ç¾¤</li></ul><h2 id=13--å¯åŠ¨kafka-é›†ç¾¤>1.3. å¯åŠ¨Kafka é›†ç¾¤<a hidden class=anchor aria-hidden=true href=#13--å¯åŠ¨kafka-é›†ç¾¤>#</a></h2><p>åœ¨æœ¬ç« èŠ‚ä¸­ï¼Œæˆ‘ä»¬ä¼šåœ¨ä¸€å°æœºå™¨ä¸Šå®‰è£…å¹¶å¯åŠ¨Kafkaé›†ç¾¤ã€‚è¯¥é›†ç¾¤æœ‰ä¸€ä¸ªå•èŠ‚ç‚¹Kafka(åªæœ‰ä¸€ä¸ªBroker)å¤–åŠ ä¸€ä¸ªå•èŠ‚ç‚¹Zookeeperæ„æˆã€‚åœ¨wordcountæ¼”ç¤ºç¨‹åºä¸­ï¼Œè¿™ç§é›†ç¾¤ä¾èµ–æ˜¯å¿…é¡»çš„ã€‚æˆ‘ä»¬å‡å®škafka brokerè¿è¡Œåœ°å€ä¸ºlocalhost:9092, Zookeeperæœ¬åœ°åœ°å€ä¸ºlocalhost:2181ã€‚
é¦–å…ˆï¼Œå®‰è£…Oracle JREæˆ–JDK 1.7åŠä»¥ä¸Šç‰ˆæœ¬
ç„¶åï¼Œä¸‹è½½å’Œå®‰è£…åŒ…å«Kafka Streamsçš„æ–°ç‰ˆæœ¬Apache Kafka. ä¸ºæ­¤ï¼Œæˆ‘ä»¬ä½¿ç”¨Confluent Platform 3.0.0ç‰ˆæœ¬ã€‚
(ä¸‹é¢æ“ä½œæ¯”è¾ƒç®€å•ï¼Œæ‰€ä»¥ä¸ç¿»è¯‘äº†ã€‚)</p><div class=highlight><pre tabindex=0 style=color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>[plain] view plain copy
</span></span><span style=display:flex><span># Download and install Confluent Platform 3.0.0 from ZIP archive  
</span></span><span style=display:flex><span>$ wget http://packages.confluent.io/archive/3.0/confluent-3.0.0-2.11.zip  
</span></span><span style=display:flex><span>$ unzip confluent-3.0.0-2.11.zip  
</span></span><span style=display:flex><span>   
</span></span><span style=display:flex><span># *** IMPORTANT STEP ****  
</span></span><span style=display:flex><span># The subsequent paths and commands used throughout this quickstart assume that  
</span></span><span style=display:flex><span># your are in the following working directory:  
</span></span><span style=display:flex><span>$ cd confluent-3.0.0/  
</span></span><span style=display:flex><span>   
</span></span><span style=display:flex><span># Note: If you want to uninstall the Confluent Platform at the end of this quickstart,  
</span></span><span style=display:flex><span># run the following commands.  
</span></span><span style=display:flex><span>#  
</span></span><span style=display:flex><span>#   $ rm -rf confluent-3.0.0/  
</span></span><span style=display:flex><span>#   $ rm -rf /var/lib/kafka          # Data files of Kafka  
</span></span><span style=display:flex><span>#   $ rm -rf /var/lib/kafka-streams  # Data files of Kafka Streams  
</span></span><span style=display:flex><span>#   $ rm -rf /var/lib/zookeeper      # Data files of ZooKeeper  
</span></span></code></pre></div><p>æç¤ºï¼šå¯ä»¥é€šè¿‡Installationvia ZIP and TAR archives å’ŒConfluentPlatform Quickstart è·å–æ›´è¿›ä¸€æ­¥ä¿¡æ¯ã€‚
æˆ‘ä»¬é¦–å…ˆå¯åŠ¨ZooKeeperå®ä¾‹ã€‚è¯¥å®ä¾‹å°†ç›‘å¬æœ¬åœ°2181ç«¯å£ã€‚ç”±äºè¿™æ˜¯ä¸€ä¸ªé•¿æœŸè¿è¡Œçš„æœåŠ¡ï¼Œä½ åº”è¯¥åœ¨è‡ªå·±çš„ç»ˆç«¯ä¸­è¿è¡Œã€‚</p><div class=highlight><pre tabindex=0 style=color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>[plain] view plain copy
</span></span><span style=display:flex><span># Start ZooKeeper.  Run this command in its own terminal.  
</span></span><span style=display:flex><span>$ ./bin/zookeeper-server-start ./etc/kafka/zookeeper.properties  
</span></span></code></pre></div><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å¯åŠ¨Kakfaçš„Brokerï¼Œè¿™å°†ç›‘å¬æœ¬åœ°9092ç«¯å£ï¼Œç„¶åè¿æ¥åˆ°æˆ‘ä»¬åˆšåˆšå¯åŠ¨çš„Zookeeperå®ä¾‹ã€‚è¿™ä¹Ÿæ˜¯ä¸€ä¸ªé•¿æœŸè¿è¡Œçš„æœåŠ¡ï¼Œä¹Ÿåº”è¯¥åœ¨ç»ˆç«¯ä¸­è¿è¡Œå®ƒã€‚</p><div class=highlight><pre tabindex=0 style=color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>[plain] view plain copy
</span></span><span style=display:flex><span># Start Kafka.  Run this command in its own terminal  
</span></span><span style=display:flex><span>$ ./bin/kafka-server-start ./etc/kafka/server.properties  
</span></span></code></pre></div><p>ç°åœ¨ï¼Œæˆ‘ä»¬çš„å•èŠ‚ç‚¹kafkaé›†ç¾¤å·²ç»å®Œå…¨è¿è½¬èµ·æ¥äº†ï¼Œæˆ‘ä»¬å°±å¯ä»¥ç€æ‰‹å‡†å¤‡è¾“å…¥æ•°æ®ï¼Œè¿è¡Œæˆ‘ä»¬çš„ç¬¬ä¸€ä¸ªkafka Streamsç¤ºä¾‹ç¨‹åºã€‚</p><h2 id=14--å‡†å¤‡è¾“å…¥æ•°æ®>1.4. å‡†å¤‡è¾“å…¥æ•°æ®<a hidden class=anchor aria-hidden=true href=#14--å‡†å¤‡è¾“å…¥æ•°æ®>#</a></h2><p>æç¤ºï¼šåœ¨æœ¬ç« èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨å†…ç½®çš„å‘½ä»¤è¡Œå·¥å…·æ¥è¾“å…¥kakfaæ•°æ®ã€‚åœ¨å®é™…ä½¿ç”¨ä¸­ï¼Œä½ åº”è¯¥é€šè¿‡å…¶ä»–æ–¹å¼å°†æ•°æ®å†™å…¥Kafkaä¸­ï¼Œæ¯”å¦‚é€šè¿‡ä½ è‡ªå·±åº”ç”¨ç¨‹åºä¸­çš„Kafkaå®¢æˆ·ç«¯ã€‚
ç°åœ¨ï¼Œæˆ‘ä»¬å°†ä¸€äº›è¾“å…¥æ•°æ®å‘é€åˆ°Kafkaçš„topicä¸­ï¼Œç„¶åç”±Kafka Streamsçš„åº”ç”¨ç¨‹åºåšåç»­å¤„ç†ã€‚
é¦–å…ˆï¼Œæˆ‘ä»¬è¦åˆ›å»ºåç§°ä¸ºmystreamçš„topicï¼š</p><div class=highlight><pre tabindex=0 style=color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>[plain] view plain copy
</span></span><span style=display:flex><span>$ ./bin/kafka-topics.sh --create --zookeeper slave01:2181,slave02:2181,slave03:2181 --replication-factor 1 --partitions 1 --topic mystream  
</span></span></code></pre></div><p>ä¸‹ä¸€æ­¥ï¼Œæˆ‘ä»¬ç”Ÿæˆä¸€äº›è¾“å…¥æ•°æ®å¹¶ä¿å­˜åœ¨æœ¬åœ°æ–‡ä»¶/tmp/file-input.txtä¸­ã€‚</p><div class=highlight><pre tabindex=0 style=color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>[plain] view plain copy
</span></span><span style=display:flex><span>$ echo -e &#34;all streams lead to kafka
</span></span><span style=display:flex><span>hello kafka streams
</span></span><span style=display:flex><span>join kafka summit&#34; &gt; /tmp/file-input.txt
</span></span></code></pre></div><p>ç”Ÿæˆçš„æ–‡ä»¶å°†åŒ…å«å¦‚ä¸‹å†…å®¹ï¼š</p><div class=highlight><pre tabindex=0 style=color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>[plain] view plain copy
</span></span><span style=display:flex><span>all streams lead to kafka  
</span></span><span style=display:flex><span>hello kafka streams  
</span></span><span style=display:flex><span>join kafka summit  
</span></span></code></pre></div><p>æœ€åï¼Œæˆ‘ä»¬å‘é€è¿™äº›æ•°æ®åˆ°input topic</p><div class=highlight><pre tabindex=0 style=color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>[plain] view plain copy
</span></span><span style=display:flex><span>$ cat /tmp/file-input.txt | ./bin/kafka-console-producer --broker-list master:9092,slave01:9092,slave02:9092,slave03:9092 --topic mystream  
</span></span></code></pre></div><p>Kafka console-producerä»stdinä¸­è¯»å–æ•°æ®ï¼Œå¹¶å°†æ¯ä¸€è¡Œä½œä¸ºå•ç‹¬çš„æ¶ˆæ¯å‘é€åˆ°kafkaçš„è¾“å…¥æµä¸­ã€‚è¯¥æ¶ˆæ¯çš„keyæ˜¯nullï¼Œæ¶ˆæ¯æ˜¯æ¯è¡Œå†…å®¹ï¼Œä½¿ç”¨å­—ç¬¦ä¸²ç¼–ç ã€‚<br>æ³¨æ„: ä½ å¯èƒ½æƒ³çŸ¥é“è¿™æ ·ä¸€æ­¥æ­¥çš„å¿«é€Ÿå¯åŠ¨å’ŒçœŸå®æµå¤„ç†ç³»ç»Ÿçš„å·®å¼‚ï¼Œåœ¨å¤§å‹çš„å®æ—¶çš„æµå¤„ç†ç³»ç»Ÿä¸­ï¼Œæ•°æ®æ€»æ˜¯åœ¨ç§»åŠ¨çš„ï¼Œå¿«é€Ÿå…¥é—¨çš„ç›®çš„ä»…ä»…æ˜¯åšåŠŸèƒ½è¯æ˜ã€‚ç®€å•æ¥è¯´ï¼Œä¸€ä¸ªç«¯åˆ°ç«¯çš„æ•°æ®ç®¡é“å»ºç«‹åœ¨Kafkaå’ŒKafka Streamsçš„å„ä¸ªæ–¹é¢ã€‚å‡ºäºè¯´æ•™çš„åŸå› ï¼Œæˆ‘ä»¬æ•…æ„å°†å¿«é€Ÿå…¥é—¨æ¸…æ¥šåœ°æ‹†åˆ†æˆä¸€ç³»åˆ—åˆ†å¼€è¿ç»­çš„æ­¥éª¤ã€‚<br>ä½†åœ¨å®è·µä¸­ï¼Œè¿™äº›æ­¥éª¤é€šå¸¸ä¼šçœ‹èµ·æ¥æœ‰äº›ä¸åŒå¹¶ä¸”ä¼šæœ‰å¹¶å‘çš„å­˜åœ¨ã€‚æ¯”å¦‚è¾“å…¥æ•°æ®å¯èƒ½ä¸ä¼šæ¥æºäºæœ¬åœ°æ–‡ä»¶ï¼Œè€Œæ˜¯ç›´æ¥ä»åˆ†å¸ƒå¼ç³»ç»Ÿä¸­å‘é€çš„ï¼Œå¹¶ä¸”æ•°æ®å°†è¢«è¿ç»­çš„å†™å…¥Kafkaã€‚ç±»ä¼¼çš„ï¼Œæµå¤„ç†åº”ç”¨ç¨‹åºå¯èƒ½åœ¨ç¬¬ä¸€è¡Œæ•°æ®å‘é€ä¹‹å‰å°±å·²ç»å¯åŠ¨å¹¶è¿è¡Œã€‚</p><h2 id=15--åœ¨kafkastreamsä¸­å¤„ç†è¾“å…¥æ•°æ®>1.5. åœ¨KafkaStreamsä¸­å¤„ç†è¾“å…¥æ•°æ®<a hidden class=anchor aria-hidden=true href=#15--åœ¨kafkastreamsä¸­å¤„ç†è¾“å…¥æ•°æ®>#</a></h2><p>ç°åœ¨ï¼Œæˆ‘ä»¬å·²ç»ç”Ÿæˆäº†ä¸€äº›è¾“å…¥æ•°æ®ï¼Œæˆ‘ä»¬å¯ä»¥è¿è¡Œæˆ‘ä»¬çš„ç¬¬ä¸€ä¸ªåŸºäºKafka Streamsçš„javaåº”ç”¨ç¨‹åºã€‚<br>æˆ‘ä»¬å°†è¿è¡ŒWordCountæ¼”ç¤ºåº”ç”¨ç¨‹åºï¼Œå®ƒä½¿ç”¨äº†ApacheKafkaã€‚å®ƒå®ç°äº†WordCountç®—æ³•ï¼Œä»è¾“å…¥æ–‡æœ¬æ¥è®¡ç®—ç›´æ–¹å›¾ã€‚ç„¶è€Œå’Œå…¶ä»–ä½ ä¹‹å‰è§è¿‡çš„æ“ä½œè¢«ç»‘å®šåœ¨æ•°æ®ä¸Šçš„WordCountå®ä¾‹ç¨‹åºä¸åŒçš„æ˜¯ï¼Œè¿™ä¸ªç¤ºä¾‹ç¨‹åºæ˜¯æ•°æ®æ— ç•Œï¼Œæ— é™æµåŠ¨çš„ã€‚å’Œæœ‰ç•Œç®—æ³•çš„å˜ä½“ç±»ä¼¼ï¼Œä»–æ˜¯ä¸€ä¸ªæœ‰çŠ¶æ€çš„ç®—æ³•ï¼Œè·Ÿè¸ªå¹¶æ›´æ–°wordçš„è®¡æ•°å™¨ã€‚ç„¶åå› ä¸ºå®ƒå¿…é¡»æ¥å—æ— ç•Œçš„è¾“å…¥æ•°æ®ï¼Œå®ƒä¼šå‘¨æœŸæ€§çš„è¾“å‡ºå…¶å½“å‰çŠ¶æ€å’Œè®¡ç®—ç»“æœï¼ŒåŒæ—¶ç»§ç»­å¤„ç†æ›´å¤šçš„æ•°æ®ï¼Œå› ä¸ºå®ƒä¸çŸ¥é“æ˜¯å¦å·²ç»å¤„ç†äº†æ‰€æœ‰çš„æ•°æ®ã€‚è¿™å°±æ˜¯ä»–å’ŒHadoop çš„Mapreduceç®—æ³•ä¹‹é—´çš„å…¸å‹å·®å¼‚ã€‚ä¸€æ—¦æˆ‘ä»¬äº†è§£è¿™ç§å·®å¼‚ï¼Œæ£€æŸ¥äº†å®é™…çš„è¾“å‡ºæ•°æ®ä¹‹åï¼Œä¼šæ›´å®¹æ˜“æ¥å—å®ƒã€‚<br>ç”±äºwordCountç¤ºä¾‹ç¨‹åºä¸kafkaæ‰“åŒ…åœ¨ä¸€èµ·ï¼Œå·²ç»åœ¨Kafkaçš„Brokerä¸­é›†æˆï¼Œè¿™å°±æ„å‘³ç€æˆ‘ä»¬ä¸éœ€è¦åšé¢å¤–çš„äº‹æƒ…å°±å¯ä»¥è¿è¡Œå®ƒï¼Œæ— éœ€ç¼–è¯‘ä»»ä½•Javaæºä»£ç ã€‚</p><div class=highlight><pre tabindex=0 style=color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>[plain] view plain copy
</span></span><span style=display:flex><span># Run the WordCount demo application.  There won&#39;t be any STDOUT output.  
</span></span><span style=display:flex><span># You can safely ignore any WARN log messages.  
</span></span><span style=display:flex><span>$ ./bin/kafka-run-class org.apache.kafka.streams.examples.wordcount.WordCountDemo  
</span></span></code></pre></div><p>æ³¨æ„ï¼Œè¿™é‡Œæ²¡æœ‰é­”æœ¯å¼çš„éƒ¨ç½²ï¼Œå®é™…ä¸Šï¼Œä½¿ç”¨kafkaStreamsåº“ä¸­çš„ä»»ä½•åº”ç”¨ç¨‹åºï¼Œå°±åƒå¯åŠ¨ä»»ä½•æ™®é€šçš„Javaåº”ç”¨ç¨‹åºï¼Œè¯¥è„šæœ¬kafka-run-classä¹Ÿåªæ˜¯ä¸€ä¸ªç®€å•çš„java -cpå‘½ä»¤çš„åŒ…è£…ã€‚<br>è¯¥WordCountç¤ºä¾‹ç¨‹åºå°†ä»è¾“å…¥topicä¸­è¯»å–æ•°æ®ï¼Œç„¶åè®¡ç®—wordCountï¼Œå°†è®¡ç®—ç»“æœä¸æ–­è¿›è¡Œè¾“å‡ºã€‚æ¼”ç¤ºå°†è¿è¡Œå‡ ç§’é’Ÿï¼Œç„¶åå’Œå…¶ä»–å…¸å‹æµå¤„ç†åº”ç”¨ç¨‹åºä¸åŒçš„æ˜¯ï¼Œå®ƒå°†ä¼šè‡ªåŠ¨ç»ˆæ­¢ã€‚</p><h2 id=16--æ£€æŸ¥è¾“å‡ºç»“æœ>1.6. æ£€æŸ¥è¾“å‡ºç»“æœ<a hidden class=anchor aria-hidden=true href=#16--æ£€æŸ¥è¾“å‡ºç»“æœ>#</a></h2><p>åœ¨æœ¬ç« èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨å†…ç½®çš„å‘½ä»¤è¡Œå·¥å…·ä»kafkaä¸­æ‰‹å·¥è¯»å–æ•°æ®ã€‚åœ¨å®é™…ä½¿ç”¨ä¸­ï¼Œä½ å¯ä»¥é€šè¿‡å…¶ä»–æ–¹å¼ï¼Œé€šè¿‡Kakfaå®¢æˆ·ç«¯ä»Kafkaä¸­è¯»å–æ•°æ®ã€‚æ¯”å¦‚ï¼Œå¦‚æœä½ å¯ä»¥åœ¨è‡ªå·±çš„åº”ç”¨ç¨‹åºä¸­ä½¿ç”¨Kafkaå®¢æˆ·ç«¯å°†æ•°æ®ä»Kakfaä¸­è¿ç§»åˆ°å…¶å®ƒæ•°æ®ç³»ç»Ÿã€‚<br>ç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥ä»kafkaè¾“å‡ºtopicä¸­è¯»å–æ•°æ®å¹¶æ£€æŸ¥wordcountå®ä¾‹è¿è¡Œç»“æœã€‚</p><div class=highlight><pre tabindex=0 style=color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>[plain] view plain copy
</span></span><span style=display:flex><span>./bin/kafka-console-consumer --zookeeper slave01:2181 \  
</span></span><span style=display:flex><span>          --topic streams-wordcount \  
</span></span><span style=display:flex><span>          --from-beginning \  
</span></span><span style=display:flex><span>          --formatter kafka.tools.DefaultMessageFormatter \  
</span></span><span style=display:flex><span>          --property print.key=true\  
</span></span><span style=display:flex><span>          --property key.deserializer=org.apache.kafka.common.serialization.StringDeserializer \  
</span></span><span style=display:flex><span>          --property value.deserializer=org.apache.kafka.common.serialization.LongDeserializer  
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> kafka-console-consumer.sh --zookeeper slave01:2181 --topic streams-wordcount --property print.key=true --property key.deserializer=org.apache.kafka.common.serialization.StringDeserializer   --property value.deserializer=org.apache.kafka.common.serialization.LongDeserializer  
</span></span></code></pre></div><p>Wordcountçš„æ•°æ®å°†ä¼šè¢«æ‰“å°åœ¨å¦‚ä¸‹çš„æ§åˆ¶å°ä¸­ï¼š</p><div class=highlight><pre tabindex=0 style=color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>[plain] view plain copy
</span></span><span style=display:flex><span>all     1  
</span></span><span style=display:flex><span>streams 1  
</span></span><span style=display:flex><span>lead    1  
</span></span><span style=display:flex><span>to      1  
</span></span><span style=display:flex><span>kafka   1  
</span></span><span style=display:flex><span>hello   1  
</span></span><span style=display:flex><span>kafka   2  
</span></span><span style=display:flex><span>streams 2  
</span></span><span style=display:flex><span>join    1  
</span></span><span style=display:flex><span>kafka   3  
</span></span><span style=display:flex><span>summit  1  
</span></span></code></pre></div><p>è¿™é‡Œï¼Œç¬¬ä¸€åˆ—æ˜¯Kafkaæ¶ˆæ¯çš„keyçš„å­—ç¬¦ä¸²æ ¼å¼ï¼Œç¬¬äºŒåˆ—æ˜¯æ¶ˆæ¯çš„å€¼ï¼Œlongç±»å‹ã€‚ä½ å¯ä»¥é€šè¿‡Ctrl+cå‘½ä»¤æ¥ç»ˆæ­¢æ§åˆ¶å°è¾“å‡ºã€‚
ä½†æ˜¯ç­‰ä¸€ä¸‹ï¼Œè¾“å‡ºçœ‹èµ·æ¥æ˜¯ä¸æ˜¯å¾ˆå¥‡æ€ªï¼Ÿä¸ºä»€ä¹ˆä¼šå‡ºç°é‡å¤çš„æ¡ç›®ï¼Ÿæ¯”å¦‚streamså‡ºç°äº†ä¸¤æ¬¡ï¼š</p><div class=highlight><pre tabindex=0 style=color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>[plain] view plain copy
</span></span><span style=display:flex><span># Why not this, you may ask?  
</span></span><span style=display:flex><span>all     1  
</span></span><span style=display:flex><span>lead    1  
</span></span><span style=display:flex><span>to      1  
</span></span><span style=display:flex><span>hello   1  
</span></span><span style=display:flex><span>streams 2  
</span></span><span style=display:flex><span>join    1  
</span></span><span style=display:flex><span>kafka   3  
</span></span><span style=display:flex><span>summit  1  
</span></span></code></pre></div><p>å¯¹äºä¸Šé¢çš„è¾“å‡ºçš„è§£é‡Šæ˜¯ï¼ŒwordCountåº”ç”¨ç¨‹åºçš„è¾“å‡ºå®é™…ä¸Šæ˜¯æŒç»­æ›´æ–°çš„æµï¼Œå…¶ä¸­æ¯è¡Œè®°å½•æ˜¯ä¸€ä¸ªå•ä¸€çš„word(å³Message Keyï¼Œæ¯”å¦‚Kafka)çš„è®¡æ•°ã€‚å¯¹äºåŒä¸€ä¸ªKeyçš„å¤šä¸ªè®°å½•ï¼Œæ¯ä¸ªè®°å½•ä¹‹åæ˜¯å‰ä¸€ä¸ªçš„æ›´æ–°ã€‚</p><p>å½“ç¬¬äºŒä¸ªæ–‡æœ¬èˆªçš„hello kafkastreamsè¢«å¤„ç†çš„æ—¶å€™ï¼Œæˆ‘ä»¬è§‚å¯Ÿåˆ°ï¼Œç›¸å¯¹ç¬¬ä¸€æ¬¡ï¼Œå·²ç»å­˜åœ¨çš„æ¡ç›®KTableè¢«æ›´æ–°äº†(Kafakå’ŒStreamsè¿™ä¸¤ä¸ªå•è¯). ä¿®æ”¹åçš„è®°å½•è¢«åœ¨æ­¤å‘é€åˆ°äº†KStreamã€‚
è¿™å°±è§£é‡Šäº†ä¸Šè¿°KStreamç¬¬äºŒåˆ—ä¸­æ˜¾ç¤ºçš„ä¿¡æ¯ï¼Œä¸ºä»€ä¹ˆè¾“å‡ºçš„topicä¸Šæ˜¾ç¤ºçš„å†…å®¹ï¼Œå› ä¸ºå®ƒæ˜¯åŒ…å«äº†å˜åŒ–çš„å®Œæ•´å†…å®¹</p><div class=highlight><pre tabindex=0 style=color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>[plain] view plain copy
</span></span><span style=display:flex><span>all     1  
</span></span><span style=display:flex><span>streams 1  
</span></span><span style=display:flex><span>lead    1  
</span></span><span style=display:flex><span>to      1  
</span></span><span style=display:flex><span>kafka   1  
</span></span><span style=display:flex><span>hello   1  
</span></span><span style=display:flex><span>kafka   2  
</span></span><span style=display:flex><span>streams 2  
</span></span><span style=display:flex><span>join    1  
</span></span><span style=display:flex><span>kafka   3  
</span></span><span style=display:flex><span>summit  1  
</span></span></code></pre></div><blockquote><p>æ›´å¤šå‚çœ‹å®˜ç½‘:http://kafka.apache.org/documentation/streams/</p></blockquote></div><footer class=post-footer><ul class=post-tags><li><a href=https://xiaokunji.com/zh/tags/kafka.html>Kafka</a></li><li><a href=https://xiaokunji.com/zh/tags/hadoop%E7%94%9F%E6%80%81%E5%9C%88.html>Hadoopç”Ÿæ€åœˆ</a></li></ul></footer></article></main><footer class=footer><span>Copyright
&copy;
-2023
<a href=https://xiaokunji.com/zh/ style=color:#939393>ç±³äºŒ</a>
All Rights Reserved</span>
<script async src=//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js></script>
<span id=busuanzi_container><span class="fa fa-user">ç”¨æˆ·æ•°:</span><span id=busuanzi_value_site_uv></span>
<span class="fa fa-eye">è®¿é—®æ•°:</span><span id=busuanzi_value_site_pv></span></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="å¤åˆ¶";function s(){t.innerHTML="å·²å¤åˆ¶ï¼",setTimeout(()=>{t.innerHTML="å¤åˆ¶"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>