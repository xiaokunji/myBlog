<!doctype html><html lang=zh dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>analysis | ç±³äºŒ</title><meta name=keywords content=" 1. ä»€ä¹ˆæ˜¯analysis?, 2. ä¸»è¦ç»„æˆ, 3. ä½¿ç”¨åˆ†æå™¨, 3.1 Elasticsearchçš„å†…ç½®åˆ†æå™¨, 3.2 åˆ†æå™¨æµ‹è¯•, 3.3 è‡ªå®šä¹‰åˆ†æå™¨, 4. åˆ†æå™¨ä½œç”¨ä½ç½®åŠä½¿ç”¨, 4.1 åˆ›å»ºç´¢å¼•æ—¶æŒ‡å®šåˆ†æå™¨, 4.2 æœç´¢æ—¶å¦‚ä½•ç¡®å®šåˆ†æå™¨, 5. å¸¸ç”¨åˆ†æå™¨, 5.1 ç¹ç®€è½¬æ¢åˆ†æå™¨, 5.1.1 å®‰è£…ä¸éªŒè¯, 5.1.2 æ’ä»¶ä»‹ç», 5.1.3 ç®€è½¬ç¹, 5.1.4 ç¹è½¬ç®€, 5.2 Ikåˆ†æå™¨, 5.2.1 å®‰è£…ä¸éªŒè¯, 5.2.2 æ’ä»¶ä»‹ç», 5.2.3 åŸºæœ¬ä½¿ç”¨, 5.2.4 è‡ªå®šä¹‰åˆ†è¯åº“, 5.3 åŒä¹‰è¯åˆ†æå™¨, 5.4 æ‹¼éŸ³åˆ†æå™¨"><meta name=description content="     "><meta name=author content="xkj"><link rel=canonical href=https://xiaokunji.com/zh/%E7%BB%BC%E5%90%88/ELK/ElasticSearch/analysis.html><link crossorigin=anonymous href=/assets/css/stylesheet.b3faf608c544858ba700943ffe182cb647f38432d29a07d73234965beacb26f6.css integrity="sha256-s/r2CMVEhYunAJQ//hgstkfzhDLSmgfXMjSWW+rLJvY=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://xiaokunji.com/img/Q.svg><link rel=icon type=image/png sizes=16x16 href=https://xiaokunji.com/img/Q.svg><link rel=icon type=image/png sizes=32x32 href=https://xiaokunji.com/img/Q.svg><link rel=apple-touch-icon href=https://xiaokunji.com/Q.svg><link rel=mask-icon href=https://xiaokunji.com/Q.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=zh href=https://xiaokunji.com/zh/%E7%BB%BC%E5%90%88/ELK/ElasticSearch/analysis.html><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><meta property="og:title" content="analysis"><meta property="og:description" content="     "><meta property="og:type" content="article"><meta property="og:url" content="https://xiaokunji.com/zh/%E7%BB%BC%E5%90%88/ELK/ElasticSearch/analysis.html"><meta property="article:section" content="ç»¼åˆ"><meta property="article:published_time" content="2023-08-22T00:00:00+00:00"><meta property="article:modified_time" content="2023-09-04T11:26:13+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="analysis"><meta name=twitter:description content="     "><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":5,"name":"analysis","item":"https://xiaokunji.com/zh/%E7%BB%BC%E5%90%88/ELK/ElasticSearch/analysis.html"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"analysis","name":"analysis","description":"     ","keywords":[" 1. ä»€ä¹ˆæ˜¯analysis?"," 2. ä¸»è¦ç»„æˆ"," 3. ä½¿ç”¨åˆ†æå™¨"," 3.1 Elasticsearchçš„å†…ç½®åˆ†æå™¨"," 3.2 åˆ†æå™¨æµ‹è¯•"," 3.3 è‡ªå®šä¹‰åˆ†æå™¨"," 4. åˆ†æå™¨ä½œç”¨ä½ç½®åŠä½¿ç”¨"," 4.1 åˆ›å»ºç´¢å¼•æ—¶æŒ‡å®šåˆ†æå™¨"," 4.2 æœç´¢æ—¶å¦‚ä½•ç¡®å®šåˆ†æå™¨"," 5. å¸¸ç”¨åˆ†æå™¨"," 5.1 ç¹ç®€è½¬æ¢åˆ†æå™¨"," 5.1.1 å®‰è£…ä¸éªŒè¯"," 5.1.2 æ’ä»¶ä»‹ç»"," 5.1.3 ç®€è½¬ç¹"," 5.1.4 ç¹è½¬ç®€"," 5.2 Ikåˆ†æå™¨"," 5.2.1 å®‰è£…ä¸éªŒè¯"," 5.2.2 æ’ä»¶ä»‹ç»"," 5.2.3 åŸºæœ¬ä½¿ç”¨"," 5.2.4 è‡ªå®šä¹‰åˆ†è¯åº“"," 5.3 åŒä¹‰è¯åˆ†æå™¨"," 5.4 æ‹¼éŸ³åˆ†æå™¨"],"articleBody":"[toc]\n1. ä»€ä¹ˆæ˜¯analysis? analysisæ˜¯Elasticsearchåœ¨æ–‡æ¡£å‘é€ä¹‹å‰å¯¹æ–‡æ¡£æ­£æ–‡æ‰§è¡Œçš„è¿‡ç¨‹ï¼Œä»¥æ·»åŠ åˆ°åå‘ç´¢å¼•ä¸­ï¼ˆinverted indexï¼‰ã€‚ åœ¨å°†æ–‡æ¡£æ·»åŠ åˆ°ç´¢å¼•ä¹‹å‰ï¼ŒElasticsearchä¼šä¸ºæ¯ä¸ªåˆ†æçš„å­—æ®µæ‰§è¡Œè®¸å¤šæ­¥éª¤ï¼š\nCharacter filtering (å­—ç¬¦è¿‡æ»¤å™¨): ä½¿ç”¨å­—ç¬¦è¿‡æ»¤å™¨è½¬æ¢å­—ç¬¦ Breaking text into tokens (æŠŠæ–‡å­—è½¬åŒ–ä¸ºæ ‡è®°): å°†æ–‡æœ¬åˆ†æˆä¸€ç»„ä¸€ä¸ªæˆ–å¤šä¸ªæ ‡è®° Token filteringï¼šä½¿ç”¨æ ‡è®°è¿‡æ»¤å™¨è½¬æ¢æ¯ä¸ªæ ‡è®°(å¤§å°å†™è½¬åŒ–/åˆ é™¤æ— ç”¨è¯ç­‰ç­‰) Token indexingï¼šæŠŠè¿™äº›æ ‡è®°å­˜äºindexä¸­ æ–‡æœ¬åˆ†è¯ä¼šå‘ç”Ÿåœ¨ä¸¤ä¸ªåœ°æ–¹ï¼š\nåˆ›å»ºç´¢å¼•:å½“ç´¢å¼•æ–‡æ¡£å­—ç¬¦ç±»å‹ä¸ºtextæ—¶ï¼Œåœ¨å»ºç«‹ç´¢å¼•æ—¶å°†ä¼šå¯¹è¯¥å­—æ®µè¿›è¡Œåˆ†è¯ã€‚ æœç´¢ï¼šå½“å¯¹ä¸€ä¸ªtextç±»å‹çš„å­—æ®µè¿›è¡Œå…¨æ–‡æ£€ç´¢æ—¶ï¼Œä¼šå¯¹ç”¨æˆ·è¾“å…¥çš„æ–‡æœ¬è¿›è¡Œåˆ†è¯ã€‚ 2. ä¸»è¦ç»„æˆ æ€»ä½“è¯´æ¥ä¸€ä¸ªanalyzerå¯ä»¥åˆ†ä¸ºå¦‚ä¸‹çš„å‡ ä¸ªéƒ¨åˆ†ï¼š\n0ä¸ªæˆ–1ä¸ªä»¥ä¸Šçš„character filter\næ¥æ”¶åŸå­—ç¬¦æµï¼Œé€šè¿‡æ·»åŠ ã€åˆ é™¤æˆ–è€…æ›¿æ¢æ“ä½œæ”¹å˜åŸå­—ç¬¦æµã€‚ä¾‹å¦‚ï¼šå»é™¤æ–‡æœ¬ä¸­çš„htmlæ ‡ç­¾ï¼Œæˆ–è€…å°†ç½—é©¬æ•°å­—è½¬æ¢æˆé˜¿æ‹‰ä¼¯æ•°å­—ç­‰ã€‚ä¸€ä¸ªå­—ç¬¦è¿‡æ»¤å™¨å¯ä»¥æœ‰é›¶ä¸ªæˆ–è€…å¤šä¸ªã€‚\n1ä¸ªtokenizer\nç®€å•çš„è¯´å°±æ˜¯å°†ä¸€æ•´æ®µæ–‡æœ¬æ‹†åˆ†æˆä¸€ä¸ªä¸ªçš„è¯ã€‚ä¾‹å¦‚æ‹†åˆ†è‹±æ–‡ï¼Œé€šè¿‡ç©ºæ ¼èƒ½å°†å¥å­æ‹†åˆ†æˆä¸€ä¸ªä¸ªçš„è¯ï¼Œä½†æ˜¯å¯¹äºä¸­æ–‡æ¥è¯´ï¼Œæ— æ³•ä½¿ç”¨è¿™ç§æ–¹å¼æ¥å®ç°ã€‚åœ¨ä¸€ä¸ªåˆ†è¯å™¨ä¸­,æœ‰ä¸”åªæœ‰ä¸€ä¸ªtokenizeer\n0ä¸ªæˆ–1ä¸ªä»¥ä¸Šçš„token filter\nå°†åˆ‡åˆ†çš„å•è¯æ·»åŠ ã€åˆ é™¤æˆ–è€…æ”¹å˜ã€‚ä¾‹å¦‚å°†æ‰€æœ‰è‹±æ–‡å•è¯å°å†™ï¼Œæˆ–è€…å°†è‹±æ–‡ä¸­çš„åœè¯aåˆ é™¤ç­‰ã€‚åœ¨token filtersä¸­ï¼Œä¸å…è®¸å°†token(åˆ†å‡ºçš„è¯)çš„positionæˆ–è€…offsetæ”¹å˜ã€‚åŒæ—¶ï¼Œåœ¨ä¸€ä¸ªåˆ†è¯å™¨ä¸­ï¼Œå¯ä»¥æœ‰é›¶ä¸ªæˆ–è€…å¤šä¸ªtoken filters.\nå•è¯çš„è¿‡æ»¤é¡ºåºæŒ‰ç…§ filterè¿‡æ»¤å™¨çš„é¡ºåº\n3. ä½¿ç”¨åˆ†æå™¨ é»˜è®¤ESä½¿ç”¨standard analyzer\n3.1 Elasticsearchçš„å†…ç½®åˆ†æå™¨ Analyzer\nStandard Analyzer - é»˜è®¤åˆ†è¯å™¨ï¼ŒæŒ‰è¯åˆ‡åˆ†ï¼Œå°å†™å¤„ç† Simple Analyzer - æŒ‰ç…§éå­—æ¯åˆ‡åˆ†(ç¬¦å·è¢«è¿‡æ»¤), å°å†™å¤„ç† Stop Analyzer - å°å†™å¤„ç†ï¼Œåœç”¨è¯è¿‡æ»¤(the,a,is) Whitespace Analyzer - æŒ‰ç…§ç©ºæ ¼åˆ‡åˆ†ï¼Œä¸è½¬å°å†™ Keyword Analyzer - ä¸åˆ†è¯ï¼Œç›´æ¥å°†è¾“å…¥å½“ä½œè¾“å‡º Patter Analyzer - æ­£åˆ™è¡¨è¾¾å¼ï¼Œé»˜è®¤\\W+(éå­—ç¬¦åˆ†å‰²) Language - æä¾›äº†30å¤šç§å¸¸è§è¯­è¨€çš„åˆ†è¯å™¨ Customer Analyzer è‡ªå®šä¹‰åˆ†è¯å™¨ å‚è€ƒé“¾æ¥ Character Filter\ncharacter filter logical name description mapping char filter mapping æ ¹æ®é…ç½®çš„æ˜ å°„å…³ç³»æ›¿æ¢å­—ç¬¦ html strip char filter html_strip å»æ‰HTMLå…ƒç´  pattern replace char filter pattern_replace ç”¨æ­£åˆ™è¡¨è¾¾å¼å¤„ç†å­—ç¬¦ä¸² Tokenizer\ntokenizer logical name description standard tokenizer standard edge ngram tokenizer edgeNGram keyword tokenizer keyword ä¸åˆ†è¯ letter analyzer letter æŒ‰å•è¯åˆ† lowercase analyzer lowercase letter tokenizer, lower case filter ngram analyzers nGram whitespace analyzer whitespace ä»¥ç©ºæ ¼ä¸ºåˆ†éš”ç¬¦æ‹†åˆ† pattern analyzer pattern å®šä¹‰åˆ†éš”ç¬¦çš„æ­£åˆ™è¡¨è¾¾å¼ uax email url analyzer uax_url_email ä¸æ‹†åˆ† url å’Œ email path hierarchy analyzer path_hierarchy å¤„ç†ç±»ä¼¼ /path/to/somthingæ ·å¼çš„å­—ç¬¦ä¸² Token Filter\ntoken filter logical name description standard filter standard ascii folding filter asciifolding length filter length å»æ‰å¤ªé•¿æˆ–è€…å¤ªçŸ­çš„ lowercase filter lowercase è½¬æˆå°å†™ ngram filter nGram edge ngram filter edgeNGram porter stem filter porterStem æ³¢ç‰¹è¯å¹²ç®—æ³• shingle filter shingle å®šä¹‰åˆ†éš”ç¬¦çš„æ­£åˆ™è¡¨è¾¾å¼ stop filter stop ç§»é™¤ stop words word delimiter filter word_delimiter å°†ä¸€ä¸ªå•è¯å†æ‹†æˆå­åˆ†è¯ stemmer token filter stemmer stemmer override filter stemmer_override keyword marker filter keyword_marker keyword repeat filter keyword_repeat kstem filter kstem snowball filter snowball phonetic filter phonetic æ’ä»¶ synonym filter synonyms å¤„ç†åŒä¹‰è¯ compound word filter dictionary_decompounder, hyphenation_decompounder åˆ†è§£å¤åˆè¯ reverse filter reverse åè½¬å­—ç¬¦ä¸² elision filter elision å»æ‰ç¼©ç•¥è¯­ truncate filter truncate æˆªæ–­å­—ç¬¦ä¸² unique filter unique pattern capture filter pattern_capture pattern replace filte pattern_replace ç”¨æ­£åˆ™è¡¨è¾¾å¼æ›¿æ¢ trim filter trim å»æ‰ç©ºæ ¼ limit token count filter limit é™åˆ¶ token æ•°é‡ hunspell filter hunspell æ‹¼å†™æ£€æŸ¥ common grams filter common_grams normalization filter arabic_normalization, persian_normalization å†…ç½® Analyzer ä¸€è§ˆè¡¨ 3.2 åˆ†æå™¨æµ‹è¯• å¯ä»¥é€šè¿‡_analyzerAPIæ¥æµ‹è¯•åˆ†è¯çš„æ•ˆæœã€‚\nPOST _analyze { \"analyzer\": \"standard\", \"text\": \"The quick Brown Fox\" } ç»“æœ: æŒ‰ç©ºæ ¼åˆ‡åˆ†,æ‰€ä»¥ä¼šæœ‰å››ä¸ªè¯\nå¯ä»¥æŒ‰ç…§ä¸‹é¢çš„è§„åˆ™ç»„åˆä½¿ç”¨ï¼š\n0ä¸ªæˆ–è€…å¤šä¸ªcharacter filters ä¸€ä¸ªtokenizer 0ä¸ªæˆ–è€…å¤šä¸ªtoken filters POST _analyze { \"tokenizer\": \"standard\", \"filter\": [\"lowercase\"], \"text\": \"The quick Brown Fox\" } ç»“æœ: æŒ‰ç©ºæ ¼åˆ‡åˆ†,æ‰€ä»¥ä¼šæœ‰å››ä¸ªè¯,ä½†æ¯ä¸ªè¯éƒ½æ˜¯å°å†™\n3.3 è‡ªå®šä¹‰åˆ†æå™¨ å½“å†…ç½®çš„åˆ†è¯å™¨æ— æ³•æ»¡è¶³éœ€æ±‚æ—¶ï¼Œå¯ä»¥åˆ›å»ºcustomç±»å‹çš„åˆ†è¯å™¨ã€‚\ntokenizer:å†…ç½®æˆ–å®šåˆ¶çš„tokenizer.(å¿…é¡») char_filter:å†…ç½®æˆ–å®šåˆ¶çš„char_filter(éå¿…é¡») filter:å†…ç½®æˆ–å®šåˆ¶çš„token filter(éå¿…é¡») position_increment_gap:å½“å€¼ä¸ºæ–‡æœ¬æ•°ç»„æ—¶ï¼Œè®¾ç½®æ”¹å€¼ä¼šåœ¨æ–‡æœ¬çš„ä¸­é—´æ’å…¥å‡ç©ºéš™ã€‚è®¾ç½®è¯¥å±æ€§ï¼Œå¯¹ä¸åé¢çš„æŸ¥è¯¢ä¼šæœ‰å½±å“ã€‚é»˜è®¤è¯¥å€¼ä¸º100. PUT my_index { \"settings\": { \"analysis\": { \"analyzer\": { \"my_custom_analyzer\":{ \"type\":\"custom\", \"tokenizer\":\"standard\", \"char_filter\":[\"html_strip\"], \"filter\":[\"lowercase\",\"asciifolding\"] } } } } } ä¸Šé¢çš„ç¤ºä¾‹ä¸­å®šä¹‰äº†ä¸€ä¸ªåä¸ºmy_custom_analyzerçš„åˆ†æå™¨ï¼Œè¯¥åˆ†æå™¨çš„typeä¸ºcustomï¼Œtokenizerä¸ºstandardï¼Œchar_filterä¸ºhmtl_strip,filterå®šä¹‰äº†ä¸¤ä¸ªåˆ†åˆ«ä¸ºï¼šlowercaseå’Œasciifolding.\næµ‹è¯•ä¸€ä¸‹:\nPOST my_index/_analyze { \"text\": \"Is this dÃ©jÃ  vu?\", \"analyzer\": \"my_custom_analyzer\" } ç»“æœ:\n{ \"tokens\" : [ { \"token\" : \"is\", \"start_offset\" : 0, \"end_offset\" : 2, \"type\" : \"\", \"position\" : 0 }, { \"token\" : \"this\", \"start_offset\" : 3, \"end_offset\" : 7, \"type\" : \"\", \"position\" : 1 }, { \"token\" : \"deja\", \"start_offset\" : 11, \"end_offset\" : 15, \"type\" : \"\", \"position\" : 2 }, { \"token\" : \"vu\", \"start_offset\" : 16, \"end_offset\" : 22, \"type\" : \"\", \"position\" : 3 } ] } 4. åˆ†æå™¨ä½œç”¨ä½ç½®åŠä½¿ç”¨ åˆ†æå™¨çš„ä½¿ç”¨åœ°æ–¹æœ‰ä¸¤ä¸ªï¼š\nåˆ›å»ºç´¢å¼•æ—¶ è¿›è¡Œæœç´¢æ—¶ 4.1 åˆ›å»ºç´¢å¼•æ—¶æŒ‡å®šåˆ†æå™¨ å¦‚æœè®¾ç½®æ‰‹åŠ¨è®¾ç½®äº†åˆ†æå™¨ï¼ŒESå°†æŒ‰ç…§ä¸‹é¢é¡ºåºæ¥ç¡®å®šä½¿ç”¨å“ªä¸ªåˆ†æå™¨ï¼š\nå…ˆåˆ¤æ–­å­—æ®µæ˜¯å¦æœ‰è®¾ç½®åˆ†æå™¨ï¼Œå¦‚æœæœ‰ï¼Œåˆ™ä½¿ç”¨å­—æ®µå±æ€§ä¸Šçš„åˆ†æå™¨è®¾ç½® å¦‚æœè®¾ç½®äº†analysis.analyzer.defaultï¼Œåˆ™ä½¿ç”¨è¯¥è®¾ç½®çš„åˆ†æå™¨ å¦‚æœä¸Šé¢ä¸¤ä¸ªéƒ½æœªè®¾ç½®ï¼Œåˆ™ä½¿ç”¨é»˜è®¤çš„standardåˆ†æå™¨ ä¸ºå­—æ®µæŒ‡å®šåˆ†æå™¨\nPUT my_index { \"mappings\": { \"properties\": { \"title\":{ \"type\":\"text\", \"analyzer\": \"whitespace\" } } } } è®¾ç½®ç´¢å¼•é»˜è®¤åˆ†æå™¨\nPUT my_index { \"settings\": { \"analysis\": { \"analyzer\": { \"default\":{ \"type\":\"simple\" } } } } } 4.2 æœç´¢æ—¶å¦‚ä½•ç¡®å®šåˆ†æå™¨ åœ¨æœç´¢æ—¶ï¼Œé€šè¿‡ä¸‹é¢å‚æ•°ä¾æ¬¡æ£€æŸ¥æœç´¢æ—¶ä½¿ç”¨çš„åˆ†è¯å™¨ï¼š\næœç´¢æ—¶æŒ‡å®šanalyzerå‚æ•° åˆ›å»ºmappingæ—¶æŒ‡å®šå­—æ®µçš„search_analyzerå±æ€§ åˆ›å»ºç´¢å¼•æ—¶æŒ‡å®šsettingçš„analysis.analyzer.default_search æŸ¥çœ‹åˆ›å»ºç´¢å¼•æ—¶å­—æ®µæŒ‡å®šçš„analyzerå±æ€§ å¦‚æœä¸Šé¢å‡ ç§éƒ½æœªè®¾ç½®ï¼Œåˆ™ä½¿ç”¨é»˜è®¤çš„standardåˆ†è¯å™¨ã€‚ æœç´¢æ—¶æŒ‡å®šanalyzeræŸ¥è¯¢å‚æ•°\nGET my_index/_search { \"query\": { \"match\": { \"message\": { \"query\": \"Quick foxes\", \"analyzer\": \"stop\" } } } } æŒ‡å®šå­—æ®µçš„seach_analyzer\nPUT my_index { \"mappings\": { \"properties\": { \"title\":{ \"type\":\"text\", \"analyzer\": \"whitespace\", \"search_analyzer\": \"simple\" } } } } // ä¸Šé¢æŒ‡å®šåˆ›å»ºç´¢å¼•æ—¶ä½¿ç”¨çš„é»˜è®¤åˆ†æå™¨ä¸ºwhitespaceåˆ†è¯å™¨ï¼Œè€Œæœç´¢çš„é»˜è®¤åˆ†è¯å™¨ä¸º simpleåˆ†è¯å™¨ã€‚ æŒ‡å®šç´¢å¼•çš„é»˜è®¤æœç´¢åˆ†è¯å™¨\nPUT my_index { \"settings\": { \"analysis\": { \"analyzer\": { \"default\":{ \"type\":\"simple\" }, \"default_seach\":{ \"type\":\"whitespace\" } } } } } // ä¸Šé¢æŒ‡å®šåˆ›å»ºç´¢å¼•æ—¶ä½¿ç”¨çš„é»˜è®¤åˆ†è¯å™¨ä¸ºsimpleåˆ†è¯å™¨ï¼Œè€Œæœç´¢çš„é»˜è®¤åˆ†è¯å™¨ä¸ºwhitespaceåˆ†è¯å™¨ã€‚ 5. å¸¸ç”¨åˆ†æå™¨ 5.1 ç¹ç®€è½¬æ¢åˆ†æå™¨ ç®€ä½“å’Œç¹ä½“çš„å‡ ä¸ªä¸»è¦æƒ…å†µï¼š\nå­—å½¢å·®å¼‚ï¼Œæ±‰å­—å­—å½¢æœ¬èº«å­˜åœ¨ç€æ˜æ˜¾å·®å¼‚ï¼Œå¦‚ï§‡ä¸åˆ˜ï¼Œä¸€èˆ¬æ˜¯å•ä¸ªå­—ã€‚\nè¯æ±‡çš„å·®å¼‚ï¼Œä¹ æƒ¯ã€æ–‡åŒ–ç¯å¢ƒé€ æˆçš„ç”¨æ³•å·®å¼‚ï¼Œå¦‚æ»‘é¼ ä¸é¼ æ ‡ï¼Œä¸€èˆ¬æ˜¯å¤šå­—è¯è¯­ã€‚\nå¤šç§å½¢æ€å…±å­˜ï¼Œæœ‰å¾ˆå¤šä»£è¡¨ä¸åŒæ„æ€çš„ç¹ä½“æœ€åç®€åŒ–æˆäº†ä¸€ä¸ªå­—ï¼Œæ‰€ä»¥å°±å‡ºç°äº†å¤šéŸ³å’Œå¤šä¹‰çš„ç®€ä½“å­—ï¼Œå¦‚ï¼šé£†ã€é£ˆã€ğ©™ªéƒ½å¯¹åº”äºä¸€ä¸ªç®€ä½“ï¼šé£šã€‚\nå¯¹åº”ç¬¬ä¸€ç§ï¼Œæˆ‘ä»¬å¯ä»¥é‡‡ç”¨æ›¿æ¢çš„åŠæ³•ï¼Œå°†æ‰€æœ‰çš„ç¹ä½“éƒ½æ›¿æ¢æˆå¯¹åº”çš„ç®€ä½“ï¼Œåœ¨åˆ›å»ºç´¢å¼•çš„æ—¶å€™ï¼Œå°±è¿›è¡Œæ ‡å‡†åŒ–ï¼Œæ¯”è¾ƒå¥½å®ç°ï¼Œ(æ­¤æ–‡ä»…é’ˆå¯¹ç¬¬ä¸€ç§)\nç¬¬äºŒç§æˆ‘ä»¬å¯ä»¥é‡‡ç”¨æ”¶é›†ç›¸åº”çš„è¯æ±‡è½¬æ¢å…³ç³»ï¼Œè¿›è¡Œæ›¿æ¢ï¼Œä¸è¿‡å› ä¸ºæ˜¯å¤šå­—è¯è¯­çš„æ›¿æ¢ï¼Œæ‰€ä»¥è¿™é‡Œé¢è¿˜éœ€è¦æå–å¤„ç†å¥½åˆ†è¯ï¼Œä¸ç„¶å°±æœ‰å¯èƒ½æ›¿æ¢é”™è¯¯åè€Œå¼•èµ·æ­§ä¹‰çš„é—®é¢˜ã€‚\nç¬¬ä¸‰ç§æƒ…å†µï¼Œå› ä¸ºç¹ä½“å’Œç®€ä½“æ˜¯ä¸€å¯¹å¤šçš„æƒ…å†µï¼Œæˆ‘ä»¬å°†ç¹ä½“é€šè¿‡æ˜ å°„è¡¨è½¬æˆç®€ä½“ç›¸å¯¹å®¹æ˜“ï¼Œåè¿‡æ¥å°†ç®€ä½“è½¬æ¢æˆç¹ä½“å°†é‡åˆ°è°ƒæ•´ï¼Œå¯èƒ½éœ€è¦ç»“åˆå‰åè¯­ä¹‰æ¥é€‰æ‹©æ­£ç¡®çš„ç¹ä½“ã€‚\n5.1.1 å®‰è£…ä¸éªŒè¯ Github ä¸Šçš„åœ°å€æ˜¯ï¼šhttps://github.com/medcl/elasticsearch-analysis-stconvert/releases\nä¸‹è½½ä¹‹åè§£å‹åˆ°esçš„å®‰è£…ç›®å½•ä¸‹çš„plugins å­ç›®å½•,é‡å¯eså³å¯ (å¿…é¡»é€‰æ‹©å¯¹åº”ç‰ˆæœ¬)\néªŒè¯:\nå¦‚æœä½ çš„é›†ç¾¤é‡Œé¢æœ‰ä¸æ­¢ä¸€ä¸ª Elasticsearch çš„èŠ‚ç‚¹ï¼Œä½ éœ€è¦åœ¨æ¯ä¸€å° Elasticsearch çš„å®ä¾‹ä¸Šæ‰§è¡Œç›¸åŒçš„æ’ä»¶å®‰è£…ï¼Œå¹¶è¿›è¡Œé‡å¯è®©å…¶åŠ è½½ç”Ÿæ•ˆã€‚\n5.1.2 æ’ä»¶ä»‹ç» STConvert è¿™ä¸ªæ’ä»¶ä¸€å…±æä¾›äº† 4 ä¸ªä¸åŒçš„ç»„ä»¶:\nä¸€ä¸ªåä¸º stconvert çš„ Analyzerï¼Œå¯ä»¥å°†ç®€ä½“è½¬æ¢æˆç¹ä½“ ä¸€ä¸ªåä¸º stconvert çš„ Tokenizerï¼Œå¯ä»¥å°†ç®€ä½“è½¬æ¢æˆç¹ä½“ ä¸€ä¸ªåä¸º stconvert çš„ Token Filterï¼Œå¯ä»¥å°†ç®€ä½“è½¬æ¢æˆç¹ä½“ ä¸€ä¸ªåä¸º stconvert çš„ Char Filterï¼Œå¯ä»¥å°†ç®€ä½“è½¬æ¢æˆç¹ä½“ æ¯ä¸ªç»„ä»¶éƒ½å¯ä»¥æœ‰ä»¥ä¸‹3ä¸ªå‚æ•°ç”¨æ¥è¿›è¡Œè‡ªå®šä¹‰é…ç½®ï¼Œåˆ†åˆ«æ˜¯ï¼š\nå‚æ•° convert_type è®¾ç½®è½¬æ¢çš„æ–¹å‘ï¼Œé»˜è®¤æ˜¯ s2tï¼Œè¡¨ç¤ºç®€ä½“åˆ°ç¹ä½“ï¼Œå¦‚æœè¦å°†ç¹ä½“è½¬æ¢ä¸ºç®€ä½“ï¼Œåˆ™è®¾ç½®ä¸º t2s å‚æ•° keep_both ç”¨äºè®¾ç½®æ˜¯å¦ä¿ç•™è½¬æ¢ä¹‹å‰çš„å†…å®¹ï¼Œä¸€èˆ¬æ¥è¯´ä¿ç•™åŸå§‹å†…å®¹å¯ä»¥æé«˜æˆ‘ä»¬çš„æœç´¢å‘½ä¸­ç‡(ä¹Ÿå°±æ˜¯è¯´å¯ä»¥åŒæ—¶æœç´¢ç¹ä½“å’Œç®€ä½“)ï¼Œé»˜è®¤æ˜¯ falseï¼Œä¹Ÿå°±æ˜¯ä¸ä¿ç•™ å‚æ•° delimiter ä¸»è¦æ˜¯ç”¨äºï¼Œå½“ä¿ç•™åŸå§‹å†…å®¹çš„æ—¶å€™ï¼Œå¦‚ä½•åˆ†å‰²ä¸¤éƒ¨åˆ†å†…å®¹ï¼Œé»˜è®¤çš„å€¼æ˜¯é€—å· , t: Traditional (ä¼ ç»Ÿçš„) =\u003e Traditional Chinese (ç¹ä½“)\ns: Simplified (ç®€åŒ–çš„) =\u003e Simplified Chinese (ç®€ä½“)\n5.1.3 ç®€è½¬ç¹ ç®€è½¬ç¹å¥½åš,å› ä¸ºæ’ä»¶é»˜è®¤å°±æ˜¯åšè¿™ä¸ªçš„\nGET /_analyze { \"tokenizer\" : \"standard\", \"filter\" : [\"lowercase\"], \"char_filter\" : [\"stconvert\"], \"text\" : \"æˆ‘çˆ±Chinaã€‚\" } æˆ‘ä»¬æŒ‡å®šäº† Tokenizer ä¸º standardï¼Œä¹ŸæŒ‡å®šäº† lowercase ä½œä¸ºåˆ†è¯ä¹‹åçš„ Filterï¼Œè¿™æ ·å°±è·Ÿæ ‡å‡†çš„ Standard Analyzer çš„åˆ†ææ•ˆæœä¸€æ ·äº†ï¼Œæˆ‘ä»¬è¿˜æ–°å¢äº†ä¸€ä¸ª Char Filter çš„å‚æ•°è®¾ç½®ï¼Œä½¿ç”¨çš„æ˜¯æˆ‘ä»¬æ–°å®‰è£…çš„ç®€ç¹ä½“è½¬æ¢æ’ä»¶æä¾›çš„ stconvertï¼Œä¹Ÿå°±æ˜¯å°†ç®€ä½“è½¬æˆç¹ä½“,å…¶ç»“æœå¦‚ä¸‹\n{ \"tokens\": [ { \"token\": \"æˆ‘\", \"start_offset\": 0, \"end_offset\": 1, \"type\": \"\", \"position\": 0 }, { \"token\": \"æ„›\", \"start_offset\": 1, \"end_offset\": 2, \"type\": \"\", \"position\": 1 }, { \"token\": \"china\", \"start_offset\": 2, \"end_offset\": 7, \"type\": \"\", \"position\": 2 } ] } å¯ä»¥çœ‹åˆ°ï¼Œé™¤äº†å’Œ Standard åˆ†è¯æ•ˆæœä¸€æ ·çš„åœ°æ–¹ä»¥å¤–ï¼Œæˆ‘ä»¬è¿˜é¢å¤–çš„å°†ä¸­æ–‡å­—ç¬¦éƒ½è½¬æˆäº†ç¹ä½“ï¼Œçˆ± å­—è½¬æˆäº† æ„›ï¼Œè€Œ æˆ‘ æ²¡æœ‰å˜åŒ–ï¼Œæ˜¯å› ä¸ºå®ƒçš„ç¹ä½“ä¹Ÿæ˜¯ æˆ‘ã€‚å»ºè®®æˆ‘ä»¬åœ¨çœŸæ­£åŠ¨æ‰‹è¿›è¡Œè‡ªå®šä¹‰åˆ†è¯ä¹‹å‰ï¼Œé€šè¿‡è¿™æ ·çš„æ–¹å¼å…ˆè¿›è¡Œåˆ†è¯æ•ˆæœçš„æµ‹è¯•ï¼Œå¾—åˆ°æ»¡æ„çš„ç»“æœä¹‹åå†è¿›è¡Œå…·ä½“çš„è‡ªå®šä¹‰ Analyzer çš„åˆ›å»ºå·¥ä½œã€‚\n5.1.4 ç¹è½¬ç®€ åˆ›å»ºç´¢å¼•æ—¶æŒ‡å®šåˆ†æå™¨\nPUT /my_index { \"settings\": { \"analysis\": { \"analyzer\": { \"my_analyzer\": { \"tokenizer\": \"standard\", \"filter\": [\"lowercase\"], \"char_filter\": [\"tsconvert\"] } }, \"char_filter\": { \"tsconvert\" : { \"type\" : \"stconvert\", \"delimiter\" : \"#\", \"keep_both\" : false, \"convert_type\" : \"t2s\" } } } } } // delimiter å’Œ keep_both å±æ€§å¯ä»¥ä¸å†™ æµ‹è¯•:\nPOST /my_index/_analyze { \"analyzer\": \"my_analyzer\", \"text\": \"æˆ‘æ„›Chinaã€‚\" } ç»è¿‡æ‰§è¡Œï¼Œå¾—åˆ°çš„åˆ†æç»“æœå¦‚ä¸‹ï¼š\n{ \"tokens\": [ { \"token\": \"æˆ‘\", \"start_offset\": 0, \"end_offset\": 1, \"type\": \"\", \"position\": 0 }, { \"token\": \"çˆ±\", \"start_offset\": 1, \"end_offset\": 2, \"type\": \"\", \"position\": 1 }, { \"token\": \"china\", \"start_offset\": 2, \"end_offset\": 7, \"type\": \"\", \"position\": 2 } ] } 5.2 Ikåˆ†æå™¨ IKåˆ†ææ’ä»¶å°†Lucene IKåˆ†æå™¨ï¼ˆhttp://code.google.com/p/ik-analyzer/ï¼‰é›†æˆåˆ°elasticsearchä¸­ï¼Œæ”¯æŒè‡ªå®šä¹‰å­—å…¸ã€‚\n5.2.1 å®‰è£…ä¸éªŒè¯ Github ä¸Šçš„åœ°å€æ˜¯ï¼šhttps://github.com/medcl/elasticsearch-analysis-ik/releases\nä¸‹è½½ä¹‹åè§£å‹åˆ°esçš„å®‰è£…ç›®å½•ä¸‹çš„plugins å­ç›®å½•,é‡å¯eså³å¯ (å¿…é¡»é€‰æ‹©å¯¹åº”ç‰ˆæœ¬)\n5.2.2 æ’ä»¶ä»‹ç» Analyzer: ik_smart , ik_max_word , Tokenizer: ik_smart , ik_max_word ik_max_word å’Œ ik_smart ä»€ä¹ˆåŒºåˆ«?\nik_max_word: ä¼šå°†æ–‡æœ¬åšæœ€ç»†ç²’åº¦çš„æ‹†åˆ†ï¼Œæ¯”å¦‚ä¼šå°†â€œä¸­åäººæ°‘å…±å’Œå›½å›½æ­Œâ€æ‹†åˆ†ä¸ºâ€œä¸­åäººæ°‘å…±å’Œå›½,ä¸­åäººæ°‘,ä¸­å,åäºº,äººæ°‘å…±å’Œå›½,äººæ°‘,äºº,æ°‘,å…±å’Œå›½,å…±å’Œ,å’Œ,å›½å›½,å›½æ­Œâ€ï¼Œä¼šç©·å°½å„ç§å¯èƒ½çš„ç»„åˆï¼Œé€‚åˆ Term Queryï¼›\nik_smart: ä¼šåšæœ€ç²—ç²’åº¦çš„æ‹†åˆ†ï¼Œæ¯”å¦‚ä¼šå°†â€œä¸­åäººæ°‘å…±å’Œå›½å›½æ­Œâ€æ‹†åˆ†ä¸ºâ€œä¸­åäººæ°‘å…±å’Œå›½,å›½æ­Œâ€ï¼Œé€‚åˆ Phrase æŸ¥è¯¢ã€‚\n5.2.3 åŸºæœ¬ä½¿ç”¨ ä½¿ç”¨analyzer:\nä½¿ç”¨tokenizer\nPUT product { \"settings\": { \"analysis\": { \"analyzer\": { \"my_analyzer\": { \"type\": \"custom\", \"filter\": [ \"lowercase\" ], \"tokenizer\": \"ik_smart\" } } } } } 5.2.4 è‡ªå®šä¹‰åˆ†è¯åº“ é…ç½® åœ¨ikåˆ†æå™¨çš„configç›®å½•ä¸‹çš„ IKAnalyzer.cfg.xml\nå†…å®¹å¦‚ä¸‹:\n\u003c?xml version=\"1.0\" encoding=\"UTF-8\"?\u003e \u003c!DOCTYPE properties SYSTEM \"http://java.sun.com/dtd/properties.dtd\"\u003e IK Analyzer æ‰©å±•é…ç½® ","wordCount":"5517","inLanguage":"zh","datePublished":"2023-08-22T00:00:00Z","dateModified":"2023-09-04T11:26:13.667236661Z","author":{"@type":"Person","name":"xkj"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://xiaokunji.com/zh/%E7%BB%BC%E5%90%88/ELK/ElasticSearch/analysis.html"},"publisher":{"@type":"Organization","name":"ç±³äºŒ","logo":{"@type":"ImageObject","url":"https://xiaokunji.com/img/Q.svg"}}}</script></head><body class=dark id=top><script>localStorage.getItem("pref-theme")==="light"&&document.body.classList.remove("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://xiaokunji.com/zh/ accesskey=h title="ç±³äºŒ (Alt + H)"><img src=https://xiaokunji.com/img/Q.svg alt aria-label=logo height=35>ç±³äºŒ</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li><li><a href=https://xiaokunji.com/en/ title=English aria-label=English>English</a></li></ul></div></div><ul id=menu><li><a href=https://xiaokunji.com/zh/ title=ğŸ ä¸»é¡µ><span>ğŸ ä¸»é¡µ</span></a></li><li><a href=https://xiaokunji.com/zh/search title="ğŸ”æœç´¢ (Alt + /)" accesskey=/><span>ğŸ”æœç´¢</span></a></li><li><a href=https://xiaokunji.com/zh/post.html title=ğŸ“šæ–‡ç« ><span>ğŸ“šæ–‡ç« </span></a></li><li><a href=https://xiaokunji.com/zh/archives.html title=â±æ—¶é—´è½´><span>â±æ—¶é—´è½´</span></a></li><li><a href=https://xiaokunji.com/zh/tags.html title=ğŸ”–æ ‡ç­¾><span>ğŸ”–æ ‡ç­¾</span></a></li><li><a href=https://xiaokunji.com/zh/categories.html title=ğŸ“–åˆ†ç±»><span>ğŸ“–åˆ†ç±»</span></a></li><li><a href=https://xiaokunji.com/zh/links.html title=ğŸ¤å‹é“¾><span>ğŸ¤å‹é“¾</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><nav aria-label=breadcrumb><ul><a href=https://xiaokunji.com/zh/>ğŸ </a> <span>></span>
<a href=https://xiaokunji.com/zh/%E7%BB%BC%E5%90%88.html>ç»¼åˆ</a> <span>></span>
<a href=https://xiaokunji.com/zh/%E7%BB%BC%E5%90%88/ELK.html>ELK</a> <span>></span>
<a href=https://xiaokunji.com/zh/%E7%BB%BC%E5%90%88/ELK/ElasticSearch.html>ElasticSearch</a> <span>></span></ul></nav><h1 class=post-title>analysis</h1><div class=post-description></div><div class=post-meta>åˆ›å»º:&nbsp;<span title='2023-08-22 00:00:00 +0000 UTC'>2023-08-22</span>&nbsp;Â·&nbsp;æ›´æ–°:&nbsp;2023-09-04&nbsp;Â·&nbsp;xkj
&nbsp;|&nbsp;åˆ†ç±»: &nbsp;<ul class=post-categories-meta><a href=https://xiaokunji.com/zh/categories/%E7%BB%BC%E5%90%88.html>ç»¼åˆ</a></ul><span id=busuanzi_container_page_pv>&nbsp;| è®¿é—®: <span id=busuanzi_value_page_pv>1</span></span></div></header><aside id=toc-container class="toc-container wide"><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>ç›®å½•</span></summary><div class=inner><ul><li><a href=#1-%e4%bb%80%e4%b9%88%e6%98%afanalysis aria-label="1. ä»€ä¹ˆæ˜¯analysis?">1. ä»€ä¹ˆæ˜¯analysis?</a></li><li><a href=#2-%e4%b8%bb%e8%a6%81%e7%bb%84%e6%88%90 aria-label="2. ä¸»è¦ç»„æˆ">2. ä¸»è¦ç»„æˆ</a></li><li><a href=#3-%e4%bd%bf%e7%94%a8%e5%88%86%e6%9e%90%e5%99%a8 aria-label="3. ä½¿ç”¨åˆ†æå™¨">3. ä½¿ç”¨åˆ†æå™¨</a><ul><li><a href=#31-elasticsearch%e7%9a%84%e5%86%85%e7%bd%ae%e5%88%86%e6%9e%90%e5%99%a8 aria-label="3.1 Elasticsearchçš„å†…ç½®åˆ†æå™¨">3.1 Elasticsearchçš„å†…ç½®åˆ†æå™¨</a></li><li><a href=#32-%e5%88%86%e6%9e%90%e5%99%a8%e6%b5%8b%e8%af%95 aria-label="3.2 åˆ†æå™¨æµ‹è¯•">3.2 åˆ†æå™¨æµ‹è¯•</a></li><li><a href=#33-%e8%87%aa%e5%ae%9a%e4%b9%89%e5%88%86%e6%9e%90%e5%99%a8 aria-label="3.3 è‡ªå®šä¹‰åˆ†æå™¨">3.3 è‡ªå®šä¹‰åˆ†æå™¨</a></li></ul></li><li><a href=#4-%e5%88%86%e6%9e%90%e5%99%a8%e4%bd%9c%e7%94%a8%e4%bd%8d%e7%bd%ae%e5%8f%8a%e4%bd%bf%e7%94%a8 aria-label="4. åˆ†æå™¨ä½œç”¨ä½ç½®åŠä½¿ç”¨">4. åˆ†æå™¨ä½œç”¨ä½ç½®åŠä½¿ç”¨</a><ul><li><a href=#41-%e5%88%9b%e5%bb%ba%e7%b4%a2%e5%bc%95%e6%97%b6%e6%8c%87%e5%ae%9a%e5%88%86%e6%9e%90%e5%99%a8 aria-label="4.1 åˆ›å»ºç´¢å¼•æ—¶æŒ‡å®šåˆ†æå™¨">4.1 åˆ›å»ºç´¢å¼•æ—¶æŒ‡å®šåˆ†æå™¨</a></li><li><a href=#42-%e6%90%9c%e7%b4%a2%e6%97%b6%e5%a6%82%e4%bd%95%e7%a1%ae%e5%ae%9a%e5%88%86%e6%9e%90%e5%99%a8 aria-label="4.2 æœç´¢æ—¶å¦‚ä½•ç¡®å®šåˆ†æå™¨">4.2 æœç´¢æ—¶å¦‚ä½•ç¡®å®šåˆ†æå™¨</a></li></ul></li><li><a href=#5-%e5%b8%b8%e7%94%a8%e5%88%86%e6%9e%90%e5%99%a8 aria-label="5. å¸¸ç”¨åˆ†æå™¨">5. å¸¸ç”¨åˆ†æå™¨</a><ul><li><a href=#51-%e7%b9%81%e7%ae%80%e8%bd%ac%e6%8d%a2%e5%88%86%e6%9e%90%e5%99%a8 aria-label="5.1 ç¹ç®€è½¬æ¢åˆ†æå™¨">5.1 ç¹ç®€è½¬æ¢åˆ†æå™¨</a><ul><li><a href=#511-%e5%ae%89%e8%a3%85%e4%b8%8e%e9%aa%8c%e8%af%81 aria-label="5.1.1 å®‰è£…ä¸éªŒè¯">5.1.1 å®‰è£…ä¸éªŒè¯</a></li><li><a href=#512-%e6%8f%92%e4%bb%b6%e4%bb%8b%e7%bb%8d aria-label="5.1.2 æ’ä»¶ä»‹ç»">5.1.2 æ’ä»¶ä»‹ç»</a></li><li><a href=#513-%e7%ae%80%e8%bd%ac%e7%b9%81 aria-label="5.1.3 ç®€è½¬ç¹">5.1.3 ç®€è½¬ç¹</a></li><li><a href=#514-%e7%b9%81%e8%bd%ac%e7%ae%80 aria-label="5.1.4 ç¹è½¬ç®€">5.1.4 ç¹è½¬ç®€</a></li></ul></li><li><a href=#52-ik%e5%88%86%e6%9e%90%e5%99%a8 aria-label="5.2 Ikåˆ†æå™¨">5.2 Ikåˆ†æå™¨</a><ul><li><a href=#521-%e5%ae%89%e8%a3%85%e4%b8%8e%e9%aa%8c%e8%af%81 aria-label="5.2.1 å®‰è£…ä¸éªŒè¯">5.2.1 å®‰è£…ä¸éªŒè¯</a></li><li><a href=#522-%e6%8f%92%e4%bb%b6%e4%bb%8b%e7%bb%8d aria-label="5.2.2 æ’ä»¶ä»‹ç»">5.2.2 æ’ä»¶ä»‹ç»</a></li><li><a href=#523-%e5%9f%ba%e6%9c%ac%e4%bd%bf%e7%94%a8 aria-label="5.2.3 åŸºæœ¬ä½¿ç”¨">5.2.3 åŸºæœ¬ä½¿ç”¨</a></li><li><a href=#524-%e8%87%aa%e5%ae%9a%e4%b9%89%e5%88%86%e8%af%8d%e5%ba%93 aria-label="5.2.4 è‡ªå®šä¹‰åˆ†è¯åº“">5.2.4 è‡ªå®šä¹‰åˆ†è¯åº“</a></li></ul></li><li><a href=#53-%e5%90%8c%e4%b9%89%e8%af%8d%e5%88%86%e6%9e%90%e5%99%a8 aria-label="5.3 åŒä¹‰è¯åˆ†æå™¨">5.3 åŒä¹‰è¯åˆ†æå™¨</a></li><li><a href=#54-%e6%8b%bc%e9%9f%b3%e5%88%86%e6%9e%90%e5%99%a8 aria-label="5.4 æ‹¼éŸ³åˆ†æå™¨">5.4 æ‹¼éŸ³åˆ†æå™¨</a></li></ul></li></ul></div></details></div></aside><script>let activeElement,elements;window.addEventListener("DOMContentLoaded",function(){checkTocPosition(),elements=document.querySelectorAll("h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]"),activeElement=elements[0];const t=encodeURI(activeElement.getAttribute("id")).toLowerCase();document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active")},!1),window.addEventListener("resize",function(){checkTocPosition()},!1),window.addEventListener("scroll",()=>{activeElement=Array.from(elements).find(e=>{if(getOffsetTop(e)-window.pageYOffset>0&&getOffsetTop(e)-window.pageYOffset<window.innerHeight/2)return e})||activeElement,elements.forEach(e=>{const t=encodeURI(e.getAttribute("id")).toLowerCase();e===activeElement?document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active"):document.querySelector(`.inner ul li a[href="#${t}"]`).classList.remove("active")})},!1);const main=parseInt(getComputedStyle(document.body).getPropertyValue("--article-width"),10),toc=parseInt(getComputedStyle(document.body).getPropertyValue("--toc-width"),10),gap=parseInt(getComputedStyle(document.body).getPropertyValue("--gap"),10);function checkTocPosition(){const e=document.body.scrollWidth;e-main-toc*2-gap*4>0?document.getElementById("toc-container").classList.add("wide"):document.getElementById("toc-container").classList.remove("wide")}function getOffsetTop(e){if(!e.getClientRects().length)return 0;let t=e.getBoundingClientRect(),n=e.ownerDocument.defaultView;return t.top+n.pageYOffset}</script><div class=post-content><p>[toc]</p><h1 id=1-ä»€ä¹ˆæ˜¯analysis>1. ä»€ä¹ˆæ˜¯analysis?<a hidden class=anchor aria-hidden=true href=#1-ä»€ä¹ˆæ˜¯analysis>#</a></h1><p>analysisæ˜¯Elasticsearchåœ¨æ–‡æ¡£å‘é€ä¹‹å‰å¯¹æ–‡æ¡£æ­£æ–‡æ‰§è¡Œçš„è¿‡ç¨‹ï¼Œä»¥æ·»åŠ åˆ°åå‘ç´¢å¼•ä¸­ï¼ˆinverted indexï¼‰ã€‚ åœ¨å°†æ–‡æ¡£æ·»åŠ åˆ°ç´¢å¼•ä¹‹å‰ï¼ŒElasticsearchä¼šä¸ºæ¯ä¸ªåˆ†æçš„å­—æ®µæ‰§è¡Œè®¸å¤šæ­¥éª¤ï¼š</p><ul><li>Character filtering (å­—ç¬¦è¿‡æ»¤å™¨): ä½¿ç”¨å­—ç¬¦è¿‡æ»¤å™¨è½¬æ¢å­—ç¬¦</li><li>Breaking text into tokens (æŠŠæ–‡å­—è½¬åŒ–ä¸ºæ ‡è®°): å°†æ–‡æœ¬åˆ†æˆä¸€ç»„ä¸€ä¸ªæˆ–å¤šä¸ªæ ‡è®°</li><li>Token filteringï¼šä½¿ç”¨æ ‡è®°è¿‡æ»¤å™¨è½¬æ¢æ¯ä¸ªæ ‡è®°(å¤§å°å†™è½¬åŒ–/åˆ é™¤æ— ç”¨è¯ç­‰ç­‰)</li><li>Token indexingï¼šæŠŠè¿™äº›æ ‡è®°å­˜äºindexä¸­</li></ul><p>æ–‡æœ¬åˆ†è¯ä¼šå‘ç”Ÿåœ¨ä¸¤ä¸ªåœ°æ–¹ï¼š</p><ul><li><code>åˆ›å»ºç´¢å¼•</code>:å½“ç´¢å¼•æ–‡æ¡£å­—ç¬¦ç±»å‹ä¸º<code>text</code>æ—¶ï¼Œåœ¨å»ºç«‹ç´¢å¼•æ—¶å°†ä¼šå¯¹è¯¥å­—æ®µè¿›è¡Œåˆ†è¯ã€‚</li><li><code>æœç´¢</code>ï¼šå½“å¯¹ä¸€ä¸ª<code>text</code>ç±»å‹çš„å­—æ®µè¿›è¡Œå…¨æ–‡æ£€ç´¢æ—¶ï¼Œä¼šå¯¹ç”¨æˆ·è¾“å…¥çš„æ–‡æœ¬è¿›è¡Œåˆ†è¯ã€‚</li></ul><h1 id=2-ä¸»è¦ç»„æˆ>2. ä¸»è¦ç»„æˆ<a hidden class=anchor aria-hidden=true href=#2-ä¸»è¦ç»„æˆ>#</a></h1><p>æ€»ä½“è¯´æ¥ä¸€ä¸ªanalyzerå¯ä»¥åˆ†ä¸ºå¦‚ä¸‹çš„å‡ ä¸ªéƒ¨åˆ†ï¼š</p><ul><li><p>0ä¸ªæˆ–1ä¸ªä»¥ä¸Šçš„character filter</p><blockquote><p>æ¥æ”¶åŸå­—ç¬¦æµï¼Œé€šè¿‡æ·»åŠ ã€åˆ é™¤æˆ–è€…æ›¿æ¢æ“ä½œæ”¹å˜åŸå­—ç¬¦æµã€‚ä¾‹å¦‚ï¼šå»é™¤æ–‡æœ¬ä¸­çš„htmlæ ‡ç­¾ï¼Œæˆ–è€…å°†ç½—é©¬æ•°å­—è½¬æ¢æˆé˜¿æ‹‰ä¼¯æ•°å­—ç­‰ã€‚ä¸€ä¸ªå­—ç¬¦è¿‡æ»¤å™¨å¯ä»¥æœ‰é›¶ä¸ªæˆ–è€…å¤šä¸ªã€‚</p></blockquote></li><li><p>1ä¸ªtokenizer</p><blockquote><p>ç®€å•çš„è¯´å°±æ˜¯å°†ä¸€æ•´æ®µæ–‡æœ¬æ‹†åˆ†æˆä¸€ä¸ªä¸ªçš„è¯ã€‚ä¾‹å¦‚æ‹†åˆ†è‹±æ–‡ï¼Œé€šè¿‡ç©ºæ ¼èƒ½å°†å¥å­æ‹†åˆ†æˆä¸€ä¸ªä¸ªçš„è¯ï¼Œä½†æ˜¯å¯¹äºä¸­æ–‡æ¥è¯´ï¼Œæ— æ³•ä½¿ç”¨è¿™ç§æ–¹å¼æ¥å®ç°ã€‚åœ¨ä¸€ä¸ªåˆ†è¯å™¨ä¸­,æœ‰ä¸”åªæœ‰ä¸€ä¸ªtokenizeer</p></blockquote></li><li><p>0ä¸ªæˆ–1ä¸ªä»¥ä¸Šçš„token filter</p><blockquote><p>å°†åˆ‡åˆ†çš„å•è¯æ·»åŠ ã€åˆ é™¤æˆ–è€…æ”¹å˜ã€‚ä¾‹å¦‚å°†æ‰€æœ‰è‹±æ–‡å•è¯å°å†™ï¼Œæˆ–è€…å°†è‹±æ–‡ä¸­çš„åœè¯aåˆ é™¤ç­‰ã€‚åœ¨token filtersä¸­ï¼Œä¸å…è®¸å°†token(åˆ†å‡ºçš„è¯)çš„positionæˆ–è€…offsetæ”¹å˜ã€‚åŒæ—¶ï¼Œåœ¨ä¸€ä¸ªåˆ†è¯å™¨ä¸­ï¼Œå¯ä»¥æœ‰é›¶ä¸ªæˆ–è€…å¤šä¸ªtoken filters.</p><p><u>å•è¯çš„è¿‡æ»¤é¡ºåºæŒ‰ç…§ filterè¿‡æ»¤å™¨çš„é¡ºåº</u></p></blockquote></li></ul><p><img loading=lazy src="https://img-blog.csdnimg.cn/20190923230030142.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1VidW50dVRvdWNo,size_16,color_FFFFFF,t_70" alt=img></p><h1 id=3-ä½¿ç”¨åˆ†æå™¨>3. ä½¿ç”¨åˆ†æå™¨<a hidden class=anchor aria-hidden=true href=#3-ä½¿ç”¨åˆ†æå™¨>#</a></h1><p>é»˜è®¤ESä½¿ç”¨<code>standard analyzer</code></p><h2 id=31-elasticsearchçš„å†…ç½®åˆ†æå™¨>3.1 Elasticsearchçš„å†…ç½®åˆ†æå™¨<a hidden class=anchor aria-hidden=true href=#31-elasticsearchçš„å†…ç½®åˆ†æå™¨>#</a></h2><p><strong>Analyzer</strong></p><ul><li>Standard Analyzer - é»˜è®¤åˆ†è¯å™¨ï¼ŒæŒ‰è¯åˆ‡åˆ†ï¼Œå°å†™å¤„ç†</li><li>Simple Analyzer - æŒ‰ç…§éå­—æ¯åˆ‡åˆ†(ç¬¦å·è¢«è¿‡æ»¤), å°å†™å¤„ç†</li><li>Stop Analyzer - å°å†™å¤„ç†ï¼Œåœç”¨è¯è¿‡æ»¤(the,a,is)</li><li>Whitespace Analyzer - æŒ‰ç…§ç©ºæ ¼åˆ‡åˆ†ï¼Œä¸è½¬å°å†™</li><li>Keyword Analyzer - ä¸åˆ†è¯ï¼Œç›´æ¥å°†è¾“å…¥å½“ä½œè¾“å‡º</li><li>Patter Analyzer - æ­£åˆ™è¡¨è¾¾å¼ï¼Œé»˜è®¤\W+(éå­—ç¬¦åˆ†å‰²)</li><li>Language - æä¾›äº†30å¤šç§å¸¸è§è¯­è¨€çš„åˆ†è¯å™¨</li><li>Customer Analyzer è‡ªå®šä¹‰åˆ†è¯å™¨</li></ul><p><a href=https://www.cnblogs.com/qdhxhz/p/11585639.html target=_blank rel=noopener>å‚è€ƒé“¾æ¥</a></p><p><strong>Character Filter</strong></p><table><thead><tr><th>character filter</th><th style=text-align:center>logical name</th><th style=text-align:left>description</th></tr></thead><tbody><tr><td>mapping char filter</td><td style=text-align:center>mapping</td><td style=text-align:left>æ ¹æ®é…ç½®çš„æ˜ å°„å…³ç³»æ›¿æ¢å­—ç¬¦</td></tr><tr><td>html strip char filter</td><td style=text-align:center>html_strip</td><td style=text-align:left>å»æ‰HTMLå…ƒç´ </td></tr><tr><td>pattern replace char filter</td><td style=text-align:center>pattern_replace</td><td style=text-align:left>ç”¨æ­£åˆ™è¡¨è¾¾å¼å¤„ç†å­—ç¬¦ä¸²</td></tr></tbody></table><p><strong>Tokenizer</strong></p><table><thead><tr><th>tokenizer</th><th style=text-align:center>logical name</th><th style=text-align:left>description</th></tr></thead><tbody><tr><td>standard tokenizer</td><td style=text-align:center>standard</td><td style=text-align:left></td></tr><tr><td>edge ngram tokenizer</td><td style=text-align:center>edgeNGram</td><td style=text-align:left></td></tr><tr><td>keyword tokenizer</td><td style=text-align:center>keyword</td><td style=text-align:left>ä¸åˆ†è¯</td></tr><tr><td>letter analyzer</td><td style=text-align:center>letter</td><td style=text-align:left>æŒ‰å•è¯åˆ†</td></tr><tr><td>lowercase analyzer</td><td style=text-align:center>lowercase</td><td style=text-align:left>letter tokenizer, lower case filter</td></tr><tr><td>ngram analyzers</td><td style=text-align:center>nGram</td><td style=text-align:left></td></tr><tr><td>whitespace analyzer</td><td style=text-align:center>whitespace</td><td style=text-align:left>ä»¥ç©ºæ ¼ä¸ºåˆ†éš”ç¬¦æ‹†åˆ†</td></tr><tr><td>pattern analyzer</td><td style=text-align:center>pattern</td><td style=text-align:left>å®šä¹‰åˆ†éš”ç¬¦çš„æ­£åˆ™è¡¨è¾¾å¼</td></tr><tr><td>uax email url analyzer</td><td style=text-align:center>uax_url_email</td><td style=text-align:left>ä¸æ‹†åˆ† url å’Œ email</td></tr><tr><td>path hierarchy analyzer</td><td style=text-align:center>path_hierarchy</td><td style=text-align:left>å¤„ç†ç±»ä¼¼ <code>/path/to/somthing</code>æ ·å¼çš„å­—ç¬¦ä¸²</td></tr></tbody></table><p>Token Filter</p><table><thead><tr><th>token filter</th><th style=text-align:center>logical name</th><th style=text-align:left>description</th></tr></thead><tbody><tr><td>standard filter</td><td style=text-align:center>standard</td><td style=text-align:left></td></tr><tr><td>ascii folding filter</td><td style=text-align:center>asciifolding</td><td style=text-align:left></td></tr><tr><td>length filter</td><td style=text-align:center>length</td><td style=text-align:left>å»æ‰å¤ªé•¿æˆ–è€…å¤ªçŸ­çš„</td></tr><tr><td>lowercase filter</td><td style=text-align:center>lowercase</td><td style=text-align:left>è½¬æˆå°å†™</td></tr><tr><td>ngram filter</td><td style=text-align:center>nGram</td><td style=text-align:left></td></tr><tr><td>edge ngram filter</td><td style=text-align:center>edgeNGram</td><td style=text-align:left></td></tr><tr><td>porter stem filter</td><td style=text-align:center>porterStem</td><td style=text-align:left>æ³¢ç‰¹è¯å¹²ç®—æ³•</td></tr><tr><td>shingle filter</td><td style=text-align:center>shingle</td><td style=text-align:left>å®šä¹‰åˆ†éš”ç¬¦çš„æ­£åˆ™è¡¨è¾¾å¼</td></tr><tr><td>stop filter</td><td style=text-align:center>stop</td><td style=text-align:left>ç§»é™¤ stop words</td></tr><tr><td>word delimiter filter</td><td style=text-align:center>word_delimiter</td><td style=text-align:left>å°†ä¸€ä¸ªå•è¯å†æ‹†æˆå­åˆ†è¯</td></tr><tr><td>stemmer token filter</td><td style=text-align:center>stemmer</td><td style=text-align:left></td></tr><tr><td>stemmer override filter</td><td style=text-align:center>stemmer_override</td><td style=text-align:left></td></tr><tr><td>keyword marker filter</td><td style=text-align:center>keyword_marker</td><td style=text-align:left></td></tr><tr><td>keyword repeat filter</td><td style=text-align:center>keyword_repeat</td><td style=text-align:left></td></tr><tr><td>kstem filter</td><td style=text-align:center>kstem</td><td style=text-align:left></td></tr><tr><td>snowball filter</td><td style=text-align:center>snowball</td><td style=text-align:left></td></tr><tr><td>phonetic filter</td><td style=text-align:center>phonetic</td><td style=text-align:left><a href="https://link.jianshu.com?t=https://github.com/elasticsearch/elasticsearch-analysis-phonetic" target=_blank rel=noopener>æ’ä»¶</a></td></tr><tr><td>synonym filter</td><td style=text-align:center>synonyms</td><td style=text-align:left>å¤„ç†åŒä¹‰è¯</td></tr><tr><td>compound word filter</td><td style=text-align:center>dictionary_decompounder, hyphenation_decompounder</td><td style=text-align:left>åˆ†è§£å¤åˆè¯</td></tr><tr><td>reverse filter</td><td style=text-align:center>reverse</td><td style=text-align:left>åè½¬å­—ç¬¦ä¸²</td></tr><tr><td>elision filter</td><td style=text-align:center>elision</td><td style=text-align:left>å»æ‰ç¼©ç•¥è¯­</td></tr><tr><td>truncate filter</td><td style=text-align:center>truncate</td><td style=text-align:left>æˆªæ–­å­—ç¬¦ä¸²</td></tr><tr><td>unique filter</td><td style=text-align:center>unique</td><td style=text-align:left></td></tr><tr><td>pattern capture filter</td><td style=text-align:center>pattern_capture</td><td style=text-align:left></td></tr><tr><td>pattern replace filte</td><td style=text-align:center>pattern_replace</td><td style=text-align:left>ç”¨æ­£åˆ™è¡¨è¾¾å¼æ›¿æ¢</td></tr><tr><td>trim filter</td><td style=text-align:center>trim</td><td style=text-align:left>å»æ‰ç©ºæ ¼</td></tr><tr><td>limit token count filter</td><td style=text-align:center>limit</td><td style=text-align:left>é™åˆ¶ token æ•°é‡</td></tr><tr><td>hunspell filter</td><td style=text-align:center>hunspell</td><td style=text-align:left>æ‹¼å†™æ£€æŸ¥</td></tr><tr><td>common grams filter</td><td style=text-align:center>common_grams</td><td style=text-align:left></td></tr><tr><td>normalization filter</td><td style=text-align:center>arabic_normalization, persian_normalization</td><td style=text-align:left></td></tr></tbody></table><p><a href=https://www.jianshu.com/p/edbef5c9d635 target=_blank rel=noopener>å†…ç½® Analyzer ä¸€è§ˆè¡¨</a></p><h2 id=32-åˆ†æå™¨æµ‹è¯•>3.2 åˆ†æå™¨æµ‹è¯•<a hidden class=anchor aria-hidden=true href=#32-åˆ†æå™¨æµ‹è¯•>#</a></h2><p>å¯ä»¥é€šè¿‡<code>_analyzer</code>APIæ¥æµ‹è¯•åˆ†è¯çš„æ•ˆæœã€‚</p><div class=highlight><pre tabindex=0 style=color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-http data-lang=http><span style=display:flex><span><span style=color:#f85149>POST _analyze
</span></span></span><span style=display:flex><span><span style=color:#f85149>{
</span></span></span><span style=display:flex><span><span style=color:#f85149>  &#34;analyzer&#34;: &#34;standard&#34;,
</span></span></span><span style=display:flex><span><span style=color:#f85149>  &#34;text&#34;: &#34;The quick Brown Fox&#34;
</span></span></span><span style=display:flex><span><span style=color:#f85149>}
</span></span></span></code></pre></div><blockquote><p><strong>ç»“æœ</strong>: æŒ‰ç©ºæ ¼åˆ‡åˆ†,æ‰€ä»¥ä¼šæœ‰å››ä¸ªè¯</p></blockquote><p>å¯ä»¥æŒ‰ç…§ä¸‹é¢çš„è§„åˆ™ç»„åˆä½¿ç”¨ï¼š</p><ul><li>0ä¸ªæˆ–è€…å¤šä¸ª<code>character filters</code></li><li>ä¸€ä¸ª<code>tokenizer</code></li><li>0ä¸ªæˆ–è€…å¤šä¸ª<code>token filters</code></li></ul><div class=highlight><pre tabindex=0 style=color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-http data-lang=http><span style=display:flex><span><span style=color:#f85149>POST _analyze
</span></span></span><span style=display:flex><span><span style=color:#f85149>{
</span></span></span><span style=display:flex><span><span style=color:#f85149>  &#34;tokenizer&#34;: &#34;standard&#34;,
</span></span></span><span style=display:flex><span><span style=color:#f85149>  &#34;filter&#34;: [&#34;lowercase&#34;],
</span></span></span><span style=display:flex><span><span style=color:#f85149>  &#34;text&#34;: &#34;The quick Brown Fox&#34;
</span></span></span><span style=display:flex><span><span style=color:#f85149>}
</span></span></span></code></pre></div><blockquote><p><strong>ç»“æœ</strong>: æŒ‰ç©ºæ ¼åˆ‡åˆ†,æ‰€ä»¥ä¼šæœ‰å››ä¸ªè¯,ä½†æ¯ä¸ªè¯éƒ½æ˜¯å°å†™</p></blockquote><h2 id=33-è‡ªå®šä¹‰åˆ†æå™¨>3.3 è‡ªå®šä¹‰åˆ†æå™¨<a hidden class=anchor aria-hidden=true href=#33-è‡ªå®šä¹‰åˆ†æå™¨>#</a></h2><p>å½“å†…ç½®çš„åˆ†è¯å™¨æ— æ³•æ»¡è¶³éœ€æ±‚æ—¶ï¼Œå¯ä»¥åˆ›å»º<code>custom</code>ç±»å‹çš„åˆ†è¯å™¨ã€‚</p><ul><li><code>tokenizer</code>:å†…ç½®æˆ–å®šåˆ¶çš„tokenizer.(å¿…é¡»)</li><li><code>char_filter</code>:å†…ç½®æˆ–å®šåˆ¶çš„char_filter(éå¿…é¡»)</li><li><code>filter</code>:å†…ç½®æˆ–å®šåˆ¶çš„token filter(éå¿…é¡»)</li><li><code>position_increment_gap</code>:å½“å€¼ä¸ºæ–‡æœ¬æ•°ç»„æ—¶ï¼Œè®¾ç½®æ”¹å€¼ä¼šåœ¨æ–‡æœ¬çš„ä¸­é—´æ’å…¥å‡ç©ºéš™ã€‚è®¾ç½®è¯¥å±æ€§ï¼Œå¯¹ä¸åé¢çš„æŸ¥è¯¢ä¼šæœ‰å½±å“ã€‚é»˜è®¤è¯¥å€¼ä¸º100.</li></ul><div class=highlight><pre tabindex=0 style=color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-http data-lang=http><span style=display:flex><span><span style=color:#f85149>PUT my_index
</span></span></span><span style=display:flex><span><span style=color:#f85149>{
</span></span></span><span style=display:flex><span><span style=color:#f85149>  &#34;settings&#34;: {
</span></span></span><span style=display:flex><span><span style=color:#f85149>    &#34;analysis&#34;: {
</span></span></span><span style=display:flex><span><span style=color:#f85149>      &#34;analyzer&#34;: {
</span></span></span><span style=display:flex><span><span style=color:#f85149>        &#34;my_custom_analyzer&#34;:{
</span></span></span><span style=display:flex><span><span style=color:#f85149>          &#34;type&#34;:&#34;custom&#34;,
</span></span></span><span style=display:flex><span><span style=color:#f85149>          &#34;tokenizer&#34;:&#34;standard&#34;,
</span></span></span><span style=display:flex><span><span style=color:#f85149>          &#34;char_filter&#34;:[&#34;html_strip&#34;],
</span></span></span><span style=display:flex><span><span style=color:#f85149>          &#34;filter&#34;:[&#34;lowercase&#34;,&#34;asciifolding&#34;]
</span></span></span><span style=display:flex><span><span style=color:#f85149>        }
</span></span></span><span style=display:flex><span><span style=color:#f85149>      }
</span></span></span><span style=display:flex><span><span style=color:#f85149>    }
</span></span></span><span style=display:flex><span><span style=color:#f85149>  }
</span></span></span><span style=display:flex><span><span style=color:#f85149>}
</span></span></span></code></pre></div><p>ä¸Šé¢çš„ç¤ºä¾‹ä¸­å®šä¹‰äº†ä¸€ä¸ªåä¸º<code>my_custom_analyzer</code>çš„åˆ†æå™¨ï¼Œè¯¥åˆ†æå™¨çš„<code>type</code>ä¸º<code>custom</code>ï¼Œ<code>tokenizer</code>ä¸º<code>standard</code>ï¼Œ<code>char_filter</code>ä¸º<code>hmtl_strip</code>,<code>filter</code>å®šä¹‰äº†ä¸¤ä¸ªåˆ†åˆ«ä¸ºï¼š<code>lowercase</code>å’Œ<code>asciifolding</code>.</p><p>æµ‹è¯•ä¸€ä¸‹:</p><div class=highlight><pre tabindex=0 style=color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-http data-lang=http><span style=display:flex><span><span style=color:#f85149>POST my_index/_analyze
</span></span></span><span style=display:flex><span><span style=color:#f85149>{
</span></span></span><span style=display:flex><span><span style=color:#f85149>  &#34;text&#34;: &#34;Is this &lt;b&gt;dÃ©jÃ  vu&lt;/b&gt;?&#34;,
</span></span></span><span style=display:flex><span><span style=color:#f85149>  &#34;analyzer&#34;: &#34;my_custom_analyzer&#34;
</span></span></span><span style=display:flex><span><span style=color:#f85149>}
</span></span></span></code></pre></div><p>ç»“æœ:</p><div class=highlight><pre tabindex=0 style=color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#7ee787>&#34;tokens&#34;</span> : [
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>      <span style=color:#7ee787>&#34;token&#34;</span> : <span style=color:#a5d6ff>&#34;is&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#7ee787>&#34;start_offset&#34;</span> : <span style=color:#a5d6ff>0</span>,
</span></span><span style=display:flex><span>      <span style=color:#7ee787>&#34;end_offset&#34;</span> : <span style=color:#a5d6ff>2</span>,
</span></span><span style=display:flex><span>      <span style=color:#7ee787>&#34;type&#34;</span> : <span style=color:#a5d6ff>&#34;&lt;ALPHANUM&gt;&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#7ee787>&#34;position&#34;</span> : <span style=color:#a5d6ff>0</span>
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>      <span style=color:#7ee787>&#34;token&#34;</span> : <span style=color:#a5d6ff>&#34;this&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#7ee787>&#34;start_offset&#34;</span> : <span style=color:#a5d6ff>3</span>,
</span></span><span style=display:flex><span>      <span style=color:#7ee787>&#34;end_offset&#34;</span> : <span style=color:#a5d6ff>7</span>,
</span></span><span style=display:flex><span>      <span style=color:#7ee787>&#34;type&#34;</span> : <span style=color:#a5d6ff>&#34;&lt;ALPHANUM&gt;&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#7ee787>&#34;position&#34;</span> : <span style=color:#a5d6ff>1</span>
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>      <span style=color:#7ee787>&#34;token&#34;</span> : <span style=color:#a5d6ff>&#34;deja&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#7ee787>&#34;start_offset&#34;</span> : <span style=color:#a5d6ff>11</span>,
</span></span><span style=display:flex><span>      <span style=color:#7ee787>&#34;end_offset&#34;</span> : <span style=color:#a5d6ff>15</span>,
</span></span><span style=display:flex><span>      <span style=color:#7ee787>&#34;type&#34;</span> : <span style=color:#a5d6ff>&#34;&lt;ALPHANUM&gt;&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#7ee787>&#34;position&#34;</span> : <span style=color:#a5d6ff>2</span>
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>      <span style=color:#7ee787>&#34;token&#34;</span> : <span style=color:#a5d6ff>&#34;vu&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#7ee787>&#34;start_offset&#34;</span> : <span style=color:#a5d6ff>16</span>,
</span></span><span style=display:flex><span>      <span style=color:#7ee787>&#34;end_offset&#34;</span> : <span style=color:#a5d6ff>22</span>,
</span></span><span style=display:flex><span>      <span style=color:#7ee787>&#34;type&#34;</span> : <span style=color:#a5d6ff>&#34;&lt;ALPHANUM&gt;&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#7ee787>&#34;position&#34;</span> : <span style=color:#a5d6ff>3</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  ]
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h1 id=4-åˆ†æå™¨ä½œç”¨ä½ç½®åŠä½¿ç”¨>4. åˆ†æå™¨ä½œç”¨ä½ç½®åŠä½¿ç”¨<a hidden class=anchor aria-hidden=true href=#4-åˆ†æå™¨ä½œç”¨ä½ç½®åŠä½¿ç”¨>#</a></h1><p>åˆ†æå™¨çš„ä½¿ç”¨åœ°æ–¹æœ‰ä¸¤ä¸ªï¼š</p><ul><li>åˆ›å»ºç´¢å¼•æ—¶</li><li>è¿›è¡Œæœç´¢æ—¶</li></ul><h2 id=41-åˆ›å»ºç´¢å¼•æ—¶æŒ‡å®šåˆ†æå™¨>4.1 åˆ›å»ºç´¢å¼•æ—¶æŒ‡å®šåˆ†æå™¨<a hidden class=anchor aria-hidden=true href=#41-åˆ›å»ºç´¢å¼•æ—¶æŒ‡å®šåˆ†æå™¨>#</a></h2><p>å¦‚æœè®¾ç½®æ‰‹åŠ¨è®¾ç½®äº†åˆ†æå™¨ï¼ŒESå°†æŒ‰ç…§ä¸‹é¢é¡ºåºæ¥ç¡®å®šä½¿ç”¨å“ªä¸ªåˆ†æå™¨ï¼š</p><ul><li>å…ˆåˆ¤æ–­å­—æ®µæ˜¯å¦æœ‰è®¾ç½®åˆ†æå™¨ï¼Œå¦‚æœæœ‰ï¼Œåˆ™ä½¿ç”¨å­—æ®µå±æ€§ä¸Šçš„åˆ†æå™¨è®¾ç½®</li><li>å¦‚æœè®¾ç½®äº†<code>analysis.analyzer.default</code>ï¼Œåˆ™ä½¿ç”¨è¯¥è®¾ç½®çš„åˆ†æå™¨</li><li>å¦‚æœä¸Šé¢ä¸¤ä¸ªéƒ½æœªè®¾ç½®ï¼Œåˆ™ä½¿ç”¨é»˜è®¤çš„<code>standard</code>åˆ†æå™¨</li></ul><p>ä¸ºå­—æ®µæŒ‡å®šåˆ†æå™¨</p><div class=highlight><pre tabindex=0 style=color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-http data-lang=http><span style=display:flex><span><span style=color:#f85149>PUT my_index
</span></span></span><span style=display:flex><span><span style=color:#f85149>{
</span></span></span><span style=display:flex><span><span style=color:#f85149>  &#34;mappings&#34;: {
</span></span></span><span style=display:flex><span><span style=color:#f85149>    &#34;properties&#34;: {
</span></span></span><span style=display:flex><span><span style=color:#f85149>      &#34;title&#34;:{
</span></span></span><span style=display:flex><span><span style=color:#f85149>        &#34;type&#34;:&#34;text&#34;,
</span></span></span><span style=display:flex><span><span style=color:#f85149>        &#34;analyzer&#34;: &#34;whitespace&#34;
</span></span></span><span style=display:flex><span><span style=color:#f85149>      }
</span></span></span><span style=display:flex><span><span style=color:#f85149>    }
</span></span></span><span style=display:flex><span><span style=color:#f85149>  }
</span></span></span><span style=display:flex><span><span style=color:#f85149>}
</span></span></span></code></pre></div><p>è®¾ç½®ç´¢å¼•é»˜è®¤åˆ†æå™¨</p><div class=highlight><pre tabindex=0 style=color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-http data-lang=http><span style=display:flex><span><span style=color:#f85149>PUT my_index
</span></span></span><span style=display:flex><span><span style=color:#f85149>{
</span></span></span><span style=display:flex><span><span style=color:#f85149>  &#34;settings&#34;: {
</span></span></span><span style=display:flex><span><span style=color:#f85149>    &#34;analysis&#34;: {
</span></span></span><span style=display:flex><span><span style=color:#f85149>      &#34;analyzer&#34;: {
</span></span></span><span style=display:flex><span><span style=color:#f85149>        &#34;default&#34;:{
</span></span></span><span style=display:flex><span><span style=color:#f85149>          &#34;type&#34;:&#34;simple&#34;
</span></span></span><span style=display:flex><span><span style=color:#f85149>        }
</span></span></span><span style=display:flex><span><span style=color:#f85149>      }
</span></span></span><span style=display:flex><span><span style=color:#f85149>    }
</span></span></span><span style=display:flex><span><span style=color:#f85149>  }
</span></span></span><span style=display:flex><span><span style=color:#f85149>}
</span></span></span></code></pre></div><h2 id=42-æœç´¢æ—¶å¦‚ä½•ç¡®å®šåˆ†æå™¨>4.2 æœç´¢æ—¶å¦‚ä½•ç¡®å®šåˆ†æå™¨<a hidden class=anchor aria-hidden=true href=#42-æœç´¢æ—¶å¦‚ä½•ç¡®å®šåˆ†æå™¨>#</a></h2><p>åœ¨æœç´¢æ—¶ï¼Œé€šè¿‡ä¸‹é¢å‚æ•°ä¾æ¬¡æ£€æŸ¥æœç´¢æ—¶ä½¿ç”¨çš„åˆ†è¯å™¨ï¼š</p><ul><li>æœç´¢æ—¶æŒ‡å®šanalyzerå‚æ•°</li><li>åˆ›å»ºmappingæ—¶æŒ‡å®šå­—æ®µçš„search_analyzerå±æ€§</li><li>åˆ›å»ºç´¢å¼•æ—¶æŒ‡å®š<code>setting</code>çš„<code>analysis.analyzer.default_search</code></li><li>æŸ¥çœ‹åˆ›å»ºç´¢å¼•æ—¶å­—æ®µæŒ‡å®šçš„analyzerå±æ€§</li><li>å¦‚æœä¸Šé¢å‡ ç§éƒ½æœªè®¾ç½®ï¼Œåˆ™ä½¿ç”¨é»˜è®¤çš„standardåˆ†è¯å™¨ã€‚</li></ul><p>æœç´¢æ—¶æŒ‡å®šanalyzeræŸ¥è¯¢å‚æ•°</p><div class=highlight><pre tabindex=0 style=color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-http data-lang=http><span style=display:flex><span><span style=color:#f85149>GET my_index/_search
</span></span></span><span style=display:flex><span><span style=color:#f85149>{
</span></span></span><span style=display:flex><span><span style=color:#f85149>  &#34;query&#34;: {
</span></span></span><span style=display:flex><span><span style=color:#f85149>    &#34;match&#34;: {
</span></span></span><span style=display:flex><span><span style=color:#f85149>      &#34;message&#34;: {
</span></span></span><span style=display:flex><span><span style=color:#f85149>        &#34;query&#34;: &#34;Quick foxes&#34;,
</span></span></span><span style=display:flex><span><span style=color:#f85149>        &#34;analyzer&#34;: &#34;stop&#34;
</span></span></span><span style=display:flex><span><span style=color:#f85149>      }
</span></span></span><span style=display:flex><span><span style=color:#f85149>    }
</span></span></span><span style=display:flex><span><span style=color:#f85149>  }
</span></span></span><span style=display:flex><span><span style=color:#f85149>}
</span></span></span></code></pre></div><p>æŒ‡å®šå­—æ®µçš„<code>seach_analyzer</code></p><div class=highlight><pre tabindex=0 style=color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-http data-lang=http><span style=display:flex><span><span style=color:#f85149>PUT my_index
</span></span></span><span style=display:flex><span><span style=color:#f85149>{
</span></span></span><span style=display:flex><span><span style=color:#f85149>  &#34;mappings&#34;: {
</span></span></span><span style=display:flex><span><span style=color:#f85149>    &#34;properties&#34;: {
</span></span></span><span style=display:flex><span><span style=color:#f85149>      &#34;title&#34;:{
</span></span></span><span style=display:flex><span><span style=color:#f85149>        &#34;type&#34;:&#34;text&#34;,
</span></span></span><span style=display:flex><span><span style=color:#f85149>        &#34;analyzer&#34;: &#34;whitespace&#34;,
</span></span></span><span style=display:flex><span><span style=color:#f85149>        &#34;search_analyzer&#34;: &#34;simple&#34;
</span></span></span><span style=display:flex><span><span style=color:#f85149>      }
</span></span></span><span style=display:flex><span><span style=color:#f85149>    }
</span></span></span><span style=display:flex><span><span style=color:#f85149>  }
</span></span></span><span style=display:flex><span><span style=color:#f85149>}
</span></span></span><span style=display:flex><span><span style=color:#f85149>//  ä¸Šé¢æŒ‡å®šåˆ›å»ºç´¢å¼•æ—¶ä½¿ç”¨çš„é»˜è®¤åˆ†æå™¨ä¸ºwhitespaceåˆ†è¯å™¨ï¼Œè€Œæœç´¢çš„é»˜è®¤åˆ†è¯å™¨ä¸º simpleåˆ†è¯å™¨ã€‚
</span></span></span></code></pre></div><p>æŒ‡å®šç´¢å¼•çš„é»˜è®¤æœç´¢åˆ†è¯å™¨</p><div class=highlight><pre tabindex=0 style=color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-http data-lang=http><span style=display:flex><span><span style=color:#f85149>PUT my_index
</span></span></span><span style=display:flex><span><span style=color:#f85149>{
</span></span></span><span style=display:flex><span><span style=color:#f85149>  &#34;settings&#34;: {
</span></span></span><span style=display:flex><span><span style=color:#f85149>    &#34;analysis&#34;: {
</span></span></span><span style=display:flex><span><span style=color:#f85149>      &#34;analyzer&#34;: {
</span></span></span><span style=display:flex><span><span style=color:#f85149>        &#34;default&#34;:{
</span></span></span><span style=display:flex><span><span style=color:#f85149>          &#34;type&#34;:&#34;simple&#34;
</span></span></span><span style=display:flex><span><span style=color:#f85149>        },
</span></span></span><span style=display:flex><span><span style=color:#f85149>        &#34;default_seach&#34;:{
</span></span></span><span style=display:flex><span><span style=color:#f85149>          &#34;type&#34;:&#34;whitespace&#34;
</span></span></span><span style=display:flex><span><span style=color:#f85149>        }
</span></span></span><span style=display:flex><span><span style=color:#f85149>      }
</span></span></span><span style=display:flex><span><span style=color:#f85149>    }
</span></span></span><span style=display:flex><span><span style=color:#f85149>  }
</span></span></span><span style=display:flex><span><span style=color:#f85149>}
</span></span></span><span style=display:flex><span><span style=color:#f85149>// ä¸Šé¢æŒ‡å®šåˆ›å»ºç´¢å¼•æ—¶ä½¿ç”¨çš„é»˜è®¤åˆ†è¯å™¨ä¸ºsimpleåˆ†è¯å™¨ï¼Œè€Œæœç´¢çš„é»˜è®¤åˆ†è¯å™¨ä¸ºwhitespaceåˆ†è¯å™¨ã€‚
</span></span></span></code></pre></div><h1 id=5-å¸¸ç”¨åˆ†æå™¨>5. å¸¸ç”¨åˆ†æå™¨<a hidden class=anchor aria-hidden=true href=#5-å¸¸ç”¨åˆ†æå™¨>#</a></h1><h2 id=51-ç¹ç®€è½¬æ¢åˆ†æå™¨>5.1 ç¹ç®€è½¬æ¢åˆ†æå™¨<a hidden class=anchor aria-hidden=true href=#51-ç¹ç®€è½¬æ¢åˆ†æå™¨>#</a></h2><p>ç®€ä½“å’Œç¹ä½“çš„å‡ ä¸ªä¸»è¦æƒ…å†µï¼š</p><ul><li><p>å­—å½¢å·®å¼‚ï¼Œæ±‰å­—å­—å½¢æœ¬èº«å­˜åœ¨ç€æ˜æ˜¾å·®å¼‚ï¼Œå¦‚ï§‡ä¸åˆ˜ï¼Œä¸€èˆ¬æ˜¯å•ä¸ªå­—ã€‚</p></li><li><p>è¯æ±‡çš„å·®å¼‚ï¼Œä¹ æƒ¯ã€æ–‡åŒ–ç¯å¢ƒé€ æˆçš„ç”¨æ³•å·®å¼‚ï¼Œå¦‚æ»‘é¼ ä¸é¼ æ ‡ï¼Œä¸€èˆ¬æ˜¯å¤šå­—è¯è¯­ã€‚</p></li><li><p>å¤šç§å½¢æ€å…±å­˜ï¼Œæœ‰å¾ˆå¤šä»£è¡¨ä¸åŒæ„æ€çš„ç¹ä½“æœ€åç®€åŒ–æˆäº†ä¸€ä¸ªå­—ï¼Œæ‰€ä»¥å°±å‡ºç°äº†å¤šéŸ³å’Œå¤šä¹‰çš„ç®€ä½“å­—ï¼Œå¦‚ï¼šé£†ã€é£ˆã€ğ©™ªéƒ½å¯¹åº”äºä¸€ä¸ªç®€ä½“ï¼šé£šã€‚</p></li></ul><p>å¯¹åº”ç¬¬ä¸€ç§ï¼Œæˆ‘ä»¬å¯ä»¥é‡‡ç”¨æ›¿æ¢çš„åŠæ³•ï¼Œå°†æ‰€æœ‰çš„ç¹ä½“éƒ½æ›¿æ¢æˆå¯¹åº”çš„ç®€ä½“ï¼Œåœ¨åˆ›å»ºç´¢å¼•çš„æ—¶å€™ï¼Œå°±è¿›è¡Œæ ‡å‡†åŒ–ï¼Œæ¯”è¾ƒå¥½å®ç°ï¼Œ(æ­¤æ–‡ä»…é’ˆå¯¹ç¬¬ä¸€ç§)</p><p>ç¬¬äºŒç§æˆ‘ä»¬å¯ä»¥é‡‡ç”¨æ”¶é›†ç›¸åº”çš„è¯æ±‡è½¬æ¢å…³ç³»ï¼Œè¿›è¡Œæ›¿æ¢ï¼Œä¸è¿‡å› ä¸ºæ˜¯å¤šå­—è¯è¯­çš„æ›¿æ¢ï¼Œæ‰€ä»¥è¿™é‡Œé¢è¿˜éœ€è¦æå–å¤„ç†å¥½åˆ†è¯ï¼Œä¸ç„¶å°±æœ‰å¯èƒ½æ›¿æ¢é”™è¯¯åè€Œå¼•èµ·æ­§ä¹‰çš„é—®é¢˜ã€‚</p><p>ç¬¬ä¸‰ç§æƒ…å†µï¼Œå› ä¸ºç¹ä½“å’Œç®€ä½“æ˜¯ä¸€å¯¹å¤šçš„æƒ…å†µï¼Œæˆ‘ä»¬å°†ç¹ä½“é€šè¿‡æ˜ å°„è¡¨è½¬æˆç®€ä½“ç›¸å¯¹å®¹æ˜“ï¼Œåè¿‡æ¥å°†ç®€ä½“è½¬æ¢æˆç¹ä½“å°†é‡åˆ°è°ƒæ•´ï¼Œå¯èƒ½éœ€è¦ç»“åˆå‰åè¯­ä¹‰æ¥é€‰æ‹©æ­£ç¡®çš„ç¹ä½“ã€‚</p><h3 id=511-å®‰è£…ä¸éªŒè¯>5.1.1 å®‰è£…ä¸éªŒè¯<a hidden class=anchor aria-hidden=true href=#511-å®‰è£…ä¸éªŒè¯>#</a></h3><p><code>Github</code> ä¸Šçš„åœ°å€æ˜¯ï¼šhttps://github.com/medcl/elasticsearch-analysis-stconvert/releases</p><p><u>ä¸‹è½½ä¹‹åè§£å‹åˆ°esçš„å®‰è£…ç›®å½•ä¸‹çš„plugins å­ç›®å½•,é‡å¯eså³å¯</u> (å¿…é¡»é€‰æ‹©å¯¹åº”ç‰ˆæœ¬)</p><p>éªŒè¯:</p><p><img loading=lazy src=https://elastic-search-in-action.medcl.com/media/15501507055384/15509999877512.jpg alt=image></p><blockquote><p>å¦‚æœä½ çš„é›†ç¾¤é‡Œé¢æœ‰ä¸æ­¢ä¸€ä¸ª Elasticsearch çš„èŠ‚ç‚¹ï¼Œä½ éœ€è¦åœ¨æ¯ä¸€å° Elasticsearch çš„å®ä¾‹ä¸Šæ‰§è¡Œç›¸åŒçš„æ’ä»¶å®‰è£…ï¼Œå¹¶è¿›è¡Œé‡å¯è®©å…¶åŠ è½½ç”Ÿæ•ˆã€‚</p></blockquote><h3 id=512-æ’ä»¶ä»‹ç»>5.1.2 æ’ä»¶ä»‹ç»<a hidden class=anchor aria-hidden=true href=#512-æ’ä»¶ä»‹ç»>#</a></h3><p>STConvert è¿™ä¸ªæ’ä»¶ä¸€å…±æä¾›äº† 4 ä¸ªä¸åŒçš„ç»„ä»¶:</p><ul><li>ä¸€ä¸ªåä¸º <code>stconvert</code> çš„ Analyzerï¼Œå¯ä»¥å°†ç®€ä½“è½¬æ¢æˆç¹ä½“</li><li>ä¸€ä¸ªåä¸º <code>stconvert</code> çš„ Tokenizerï¼Œå¯ä»¥å°†ç®€ä½“è½¬æ¢æˆç¹ä½“</li><li>ä¸€ä¸ªåä¸º <code>stconvert</code> çš„ Token Filterï¼Œå¯ä»¥å°†ç®€ä½“è½¬æ¢æˆç¹ä½“</li><li>ä¸€ä¸ªåä¸º <code>stconvert</code> çš„ Char Filterï¼Œå¯ä»¥å°†ç®€ä½“è½¬æ¢æˆç¹ä½“</li></ul><p>æ¯ä¸ªç»„ä»¶éƒ½å¯ä»¥æœ‰ä»¥ä¸‹3ä¸ªå‚æ•°ç”¨æ¥è¿›è¡Œè‡ªå®šä¹‰é…ç½®ï¼Œåˆ†åˆ«æ˜¯ï¼š</p><ul><li>å‚æ•° <code>convert_type</code> è®¾ç½®è½¬æ¢çš„æ–¹å‘ï¼Œé»˜è®¤æ˜¯ <code>s2t</code>ï¼Œè¡¨ç¤ºç®€ä½“åˆ°ç¹ä½“ï¼Œå¦‚æœè¦å°†ç¹ä½“è½¬æ¢ä¸ºç®€ä½“ï¼Œåˆ™è®¾ç½®ä¸º <code>t2s</code></li><li>å‚æ•° <code>keep_both</code> ç”¨äºè®¾ç½®æ˜¯å¦ä¿ç•™è½¬æ¢ä¹‹å‰çš„å†…å®¹ï¼Œä¸€èˆ¬æ¥è¯´ä¿ç•™åŸå§‹å†…å®¹å¯ä»¥æé«˜æˆ‘ä»¬çš„æœç´¢å‘½ä¸­ç‡(ä¹Ÿå°±æ˜¯è¯´å¯ä»¥åŒæ—¶æœç´¢ç¹ä½“å’Œç®€ä½“)ï¼Œé»˜è®¤æ˜¯ <code>false</code>ï¼Œä¹Ÿå°±æ˜¯ä¸ä¿ç•™</li><li>å‚æ•° <code>delimiter</code> ä¸»è¦æ˜¯ç”¨äºï¼Œå½“ä¿ç•™åŸå§‹å†…å®¹çš„æ—¶å€™ï¼Œå¦‚ä½•åˆ†å‰²ä¸¤éƒ¨åˆ†å†…å®¹ï¼Œé»˜è®¤çš„å€¼æ˜¯é€—å· <code>,</code></li></ul><blockquote><p>t: Traditional (ä¼ ç»Ÿçš„) => Traditional Chinese (ç¹ä½“)</p><p>s: Simplified (ç®€åŒ–çš„) => Simplified Chinese (ç®€ä½“)</p></blockquote><h3 id=513-ç®€è½¬ç¹>5.1.3 ç®€è½¬ç¹<a hidden class=anchor aria-hidden=true href=#513-ç®€è½¬ç¹>#</a></h3><p>ç®€è½¬ç¹å¥½åš,å› ä¸ºæ’ä»¶é»˜è®¤å°±æ˜¯åšè¿™ä¸ªçš„</p><div class=highlight><pre tabindex=0 style=color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-http data-lang=http><span style=display:flex><span><span style=color:#f85149>GET /_analyze
</span></span></span><span style=display:flex><span><span style=color:#f85149>{
</span></span></span><span style=display:flex><span><span style=color:#f85149>  &#34;tokenizer&#34; : &#34;standard&#34;,
</span></span></span><span style=display:flex><span><span style=color:#f85149>  &#34;filter&#34; : [&#34;lowercase&#34;],
</span></span></span><span style=display:flex><span><span style=color:#f85149>  &#34;char_filter&#34; : [&#34;stconvert&#34;],
</span></span></span><span style=display:flex><span><span style=color:#f85149>  &#34;text&#34; : &#34;æˆ‘çˆ±Chinaã€‚&#34;
</span></span></span><span style=display:flex><span><span style=color:#f85149>}
</span></span></span></code></pre></div><blockquote><p>æˆ‘ä»¬æŒ‡å®šäº† Tokenizer ä¸º <code>standard</code>ï¼Œä¹ŸæŒ‡å®šäº† <code>lowercase</code> ä½œä¸ºåˆ†è¯ä¹‹åçš„ Filterï¼Œè¿™æ ·å°±è·Ÿæ ‡å‡†çš„ Standard Analyzer çš„åˆ†ææ•ˆæœä¸€æ ·äº†ï¼Œæˆ‘ä»¬è¿˜æ–°å¢äº†ä¸€ä¸ª Char Filter çš„å‚æ•°è®¾ç½®ï¼Œä½¿ç”¨çš„æ˜¯æˆ‘ä»¬æ–°å®‰è£…çš„ç®€ç¹ä½“è½¬æ¢æ’ä»¶æä¾›çš„ <code>stconvert</code>ï¼Œä¹Ÿå°±æ˜¯å°†ç®€ä½“è½¬æˆç¹ä½“,å…¶ç»“æœå¦‚ä¸‹</p></blockquote><div class=highlight><pre tabindex=0 style=color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#7ee787>&#34;tokens&#34;</span>: [
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>      <span style=color:#7ee787>&#34;token&#34;</span>: <span style=color:#a5d6ff>&#34;æˆ‘&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#7ee787>&#34;start_offset&#34;</span>: <span style=color:#a5d6ff>0</span>,
</span></span><span style=display:flex><span>      <span style=color:#7ee787>&#34;end_offset&#34;</span>: <span style=color:#a5d6ff>1</span>,
</span></span><span style=display:flex><span>      <span style=color:#7ee787>&#34;type&#34;</span>: <span style=color:#a5d6ff>&#34;&lt;IDEOGRAPHIC&gt;&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#7ee787>&#34;position&#34;</span>: <span style=color:#a5d6ff>0</span>
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>      <span style=color:#7ee787>&#34;token&#34;</span>: <span style=color:#a5d6ff>&#34;æ„›&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#7ee787>&#34;start_offset&#34;</span>: <span style=color:#a5d6ff>1</span>,
</span></span><span style=display:flex><span>      <span style=color:#7ee787>&#34;end_offset&#34;</span>: <span style=color:#a5d6ff>2</span>,
</span></span><span style=display:flex><span>      <span style=color:#7ee787>&#34;type&#34;</span>: <span style=color:#a5d6ff>&#34;&lt;IDEOGRAPHIC&gt;&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#7ee787>&#34;position&#34;</span>: <span style=color:#a5d6ff>1</span>
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>      <span style=color:#7ee787>&#34;token&#34;</span>: <span style=color:#a5d6ff>&#34;china&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#7ee787>&#34;start_offset&#34;</span>: <span style=color:#a5d6ff>2</span>,
</span></span><span style=display:flex><span>      <span style=color:#7ee787>&#34;end_offset&#34;</span>: <span style=color:#a5d6ff>7</span>,
</span></span><span style=display:flex><span>      <span style=color:#7ee787>&#34;type&#34;</span>: <span style=color:#a5d6ff>&#34;&lt;ALPHANUM&gt;&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#7ee787>&#34;position&#34;</span>: <span style=color:#a5d6ff>2</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  ]
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><blockquote><p>å¯ä»¥çœ‹åˆ°ï¼Œé™¤äº†å’Œ Standard åˆ†è¯æ•ˆæœä¸€æ ·çš„åœ°æ–¹ä»¥å¤–ï¼Œæˆ‘ä»¬è¿˜é¢å¤–çš„å°†ä¸­æ–‡å­—ç¬¦éƒ½è½¬æˆäº†ç¹ä½“ï¼Œ<code>çˆ±</code> å­—è½¬æˆäº† <code>æ„›</code>ï¼Œè€Œ <code>æˆ‘</code> æ²¡æœ‰å˜åŒ–ï¼Œæ˜¯å› ä¸ºå®ƒçš„ç¹ä½“ä¹Ÿæ˜¯ <code>æˆ‘</code>ã€‚å»ºè®®æˆ‘ä»¬åœ¨çœŸæ­£åŠ¨æ‰‹è¿›è¡Œè‡ªå®šä¹‰åˆ†è¯ä¹‹å‰ï¼Œé€šè¿‡è¿™æ ·çš„æ–¹å¼å…ˆè¿›è¡Œåˆ†è¯æ•ˆæœçš„æµ‹è¯•ï¼Œå¾—åˆ°æ»¡æ„çš„ç»“æœä¹‹åå†è¿›è¡Œå…·ä½“çš„è‡ªå®šä¹‰ Analyzer çš„åˆ›å»ºå·¥ä½œã€‚</p></blockquote><h3 id=514-ç¹è½¬ç®€>5.1.4 ç¹è½¬ç®€<a hidden class=anchor aria-hidden=true href=#514-ç¹è½¬ç®€>#</a></h3><p>åˆ›å»ºç´¢å¼•æ—¶æŒ‡å®šåˆ†æå™¨</p><div class=highlight><pre tabindex=0 style=color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-http data-lang=http><span style=display:flex><span><span style=color:#f85149>PUT /my_index
</span></span></span><span style=display:flex><span><span style=color:#f85149>{
</span></span></span><span style=display:flex><span><span style=color:#f85149>  &#34;settings&#34;: {
</span></span></span><span style=display:flex><span><span style=color:#f85149>    &#34;analysis&#34;: {
</span></span></span><span style=display:flex><span><span style=color:#f85149>      &#34;analyzer&#34;: {
</span></span></span><span style=display:flex><span><span style=color:#f85149>        &#34;my_analyzer&#34;: {
</span></span></span><span style=display:flex><span><span style=color:#f85149>            &#34;tokenizer&#34;: &#34;standard&#34;,
</span></span></span><span style=display:flex><span><span style=color:#f85149>            &#34;filter&#34;: [&#34;lowercase&#34;],
</span></span></span><span style=display:flex><span><span style=color:#f85149>            &#34;char_filter&#34;: [&#34;tsconvert&#34;]
</span></span></span><span style=display:flex><span><span style=color:#f85149>        }
</span></span></span><span style=display:flex><span><span style=color:#f85149>      },
</span></span></span><span style=display:flex><span><span style=color:#f85149>      &#34;char_filter&#34;: {
</span></span></span><span style=display:flex><span><span style=color:#f85149>        &#34;tsconvert&#34; : {
</span></span></span><span style=display:flex><span><span style=color:#f85149>            &#34;type&#34; : &#34;stconvert&#34;,
</span></span></span><span style=display:flex><span><span style=color:#f85149>            &#34;delimiter&#34; : &#34;#&#34;,
</span></span></span><span style=display:flex><span><span style=color:#f85149>            &#34;keep_both&#34; : false,
</span></span></span><span style=display:flex><span><span style=color:#f85149>            &#34;convert_type&#34; : &#34;t2s&#34;
</span></span></span><span style=display:flex><span><span style=color:#f85149>        }
</span></span></span><span style=display:flex><span><span style=color:#f85149>      }
</span></span></span><span style=display:flex><span><span style=color:#f85149>    }
</span></span></span><span style=display:flex><span><span style=color:#f85149>  }
</span></span></span><span style=display:flex><span><span style=color:#f85149>}
</span></span></span><span style=display:flex><span><span style=color:#f85149>// delimiter å’Œ keep_both å±æ€§å¯ä»¥ä¸å†™
</span></span></span></code></pre></div><p>æµ‹è¯•:</p><div class=highlight><pre tabindex=0 style=color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-http data-lang=http><span style=display:flex><span><span style=color:#f85149>POST /my_index/_analyze
</span></span></span><span style=display:flex><span><span style=color:#f85149>{
</span></span></span><span style=display:flex><span><span style=color:#f85149>	&#34;analyzer&#34;: &#34;my_analyzer&#34;,
</span></span></span><span style=display:flex><span><span style=color:#f85149>	&#34;text&#34;: &#34;æˆ‘æ„›Chinaã€‚&#34;
</span></span></span><span style=display:flex><span><span style=color:#f85149>}
</span></span></span></code></pre></div><p>ç»è¿‡æ‰§è¡Œï¼Œå¾—åˆ°çš„åˆ†æç»“æœå¦‚ä¸‹ï¼š</p><div class=highlight><pre tabindex=0 style=color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#7ee787>&#34;tokens&#34;</span>: [
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>      <span style=color:#7ee787>&#34;token&#34;</span>: <span style=color:#a5d6ff>&#34;æˆ‘&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#7ee787>&#34;start_offset&#34;</span>: <span style=color:#a5d6ff>0</span>,
</span></span><span style=display:flex><span>      <span style=color:#7ee787>&#34;end_offset&#34;</span>: <span style=color:#a5d6ff>1</span>,
</span></span><span style=display:flex><span>      <span style=color:#7ee787>&#34;type&#34;</span>: <span style=color:#a5d6ff>&#34;&lt;IDEOGRAPHIC&gt;&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#7ee787>&#34;position&#34;</span>: <span style=color:#a5d6ff>0</span>
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>      <span style=color:#7ee787>&#34;token&#34;</span>: <span style=color:#a5d6ff>&#34;çˆ±&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#7ee787>&#34;start_offset&#34;</span>: <span style=color:#a5d6ff>1</span>,
</span></span><span style=display:flex><span>      <span style=color:#7ee787>&#34;end_offset&#34;</span>: <span style=color:#a5d6ff>2</span>,
</span></span><span style=display:flex><span>      <span style=color:#7ee787>&#34;type&#34;</span>: <span style=color:#a5d6ff>&#34;&lt;IDEOGRAPHIC&gt;&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#7ee787>&#34;position&#34;</span>: <span style=color:#a5d6ff>1</span>
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>      <span style=color:#7ee787>&#34;token&#34;</span>: <span style=color:#a5d6ff>&#34;china&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#7ee787>&#34;start_offset&#34;</span>: <span style=color:#a5d6ff>2</span>,
</span></span><span style=display:flex><span>      <span style=color:#7ee787>&#34;end_offset&#34;</span>: <span style=color:#a5d6ff>7</span>,
</span></span><span style=display:flex><span>      <span style=color:#7ee787>&#34;type&#34;</span>: <span style=color:#a5d6ff>&#34;&lt;ALPHANUM&gt;&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#7ee787>&#34;position&#34;</span>: <span style=color:#a5d6ff>2</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  ]
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=52-ikåˆ†æå™¨>5.2 Ikåˆ†æå™¨<a hidden class=anchor aria-hidden=true href=#52-ikåˆ†æå™¨>#</a></h2><p>IKåˆ†ææ’ä»¶å°†Lucene IKåˆ†æå™¨ï¼ˆhttp://code.google.com/p/ik-analyzer/ï¼‰é›†æˆåˆ°elasticsearchä¸­ï¼Œæ”¯æŒè‡ªå®šä¹‰å­—å…¸ã€‚</p><h3 id=521-å®‰è£…ä¸éªŒè¯>5.2.1 å®‰è£…ä¸éªŒè¯<a hidden class=anchor aria-hidden=true href=#521-å®‰è£…ä¸éªŒè¯>#</a></h3><p><code>Github</code> ä¸Šçš„åœ°å€æ˜¯ï¼šhttps://github.com/medcl/elasticsearch-analysis-ik/releases</p><p><u>ä¸‹è½½ä¹‹åè§£å‹åˆ°esçš„å®‰è£…ç›®å½•ä¸‹çš„plugins å­ç›®å½•,é‡å¯eså³å¯</u> (å¿…é¡»é€‰æ‹©å¯¹åº”ç‰ˆæœ¬)</p><h3 id=522-æ’ä»¶ä»‹ç»>5.2.2 æ’ä»¶ä»‹ç»<a hidden class=anchor aria-hidden=true href=#522-æ’ä»¶ä»‹ç»>#</a></h3><ul><li>Analyzer: <code>ik_smart</code> , <code>ik_max_word</code> ,</li><li>Tokenizer: <code>ik_smart</code> , <code>ik_max_word</code></li></ul><blockquote><p><code>ik_max_word</code> å’Œ <code>ik_smart</code> ä»€ä¹ˆåŒºåˆ«?</p><p><code>ik_max_word</code>: <u>ä¼šå°†æ–‡æœ¬åšæœ€ç»†ç²’åº¦çš„æ‹†åˆ†</u>ï¼Œæ¯”å¦‚ä¼šå°†â€œä¸­åäººæ°‘å…±å’Œå›½å›½æ­Œâ€æ‹†åˆ†ä¸ºâ€œä¸­åäººæ°‘å…±å’Œå›½,ä¸­åäººæ°‘,ä¸­å,åäºº,äººæ°‘å…±å’Œå›½,äººæ°‘,äºº,æ°‘,å…±å’Œå›½,å…±å’Œ,å’Œ,å›½å›½,å›½æ­Œâ€ï¼Œä¼šç©·å°½å„ç§å¯èƒ½çš„ç»„åˆï¼Œé€‚åˆ Term Queryï¼›</p><p><code>ik_smart</code>: <u>ä¼šåšæœ€ç²—ç²’åº¦çš„æ‹†åˆ†</u>ï¼Œæ¯”å¦‚ä¼šå°†â€œä¸­åäººæ°‘å…±å’Œå›½å›½æ­Œâ€æ‹†åˆ†ä¸ºâ€œä¸­åäººæ°‘å…±å’Œå›½,å›½æ­Œâ€ï¼Œé€‚åˆ Phrase æŸ¥è¯¢ã€‚</p></blockquote><h3 id=523-åŸºæœ¬ä½¿ç”¨>5.2.3 åŸºæœ¬ä½¿ç”¨<a hidden class=anchor aria-hidden=true href=#523-åŸºæœ¬ä½¿ç”¨>#</a></h3><p><strong>ä½¿ç”¨analyzer</strong>:</p><p><img loading=lazy src=https://img-blog.csdnimg.cn/2020072414541039.png alt=image></p><p><img loading=lazy src=https://img-blog.csdnimg.cn/20200724145528317.png alt=image></p><p><strong>ä½¿ç”¨tokenizer</strong></p><div class=highlight><pre tabindex=0 style=color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-http data-lang=http><span style=display:flex><span><span style=color:#f85149>PUT product
</span></span></span><span style=display:flex><span><span style=color:#f85149>{
</span></span></span><span style=display:flex><span><span style=color:#f85149>  &#34;settings&#34;: {
</span></span></span><span style=display:flex><span><span style=color:#f85149>    &#34;analysis&#34;: {   
</span></span></span><span style=display:flex><span><span style=color:#f85149>      &#34;analyzer&#34;: {
</span></span></span><span style=display:flex><span><span style=color:#f85149>        &#34;my_analyzer&#34;: {
</span></span></span><span style=display:flex><span><span style=color:#f85149>          &#34;type&#34;: &#34;custom&#34;,       
</span></span></span><span style=display:flex><span><span style=color:#f85149>          &#34;filter&#34;: [
</span></span></span><span style=display:flex><span><span style=color:#f85149>            &#34;lowercase&#34;
</span></span></span><span style=display:flex><span><span style=color:#f85149>          ],
</span></span></span><span style=display:flex><span><span style=color:#f85149>          &#34;tokenizer&#34;: &#34;ik_smart&#34;
</span></span></span><span style=display:flex><span><span style=color:#f85149>        }
</span></span></span><span style=display:flex><span><span style=color:#f85149>      }
</span></span></span><span style=display:flex><span><span style=color:#f85149>    }
</span></span></span><span style=display:flex><span><span style=color:#f85149>  }
</span></span></span><span style=display:flex><span><span style=color:#f85149>  }
</span></span></span></code></pre></div><h3 id=524-è‡ªå®šä¹‰åˆ†è¯åº“>5.2.4 è‡ªå®šä¹‰åˆ†è¯åº“<a hidden class=anchor aria-hidden=true href=#524-è‡ªå®šä¹‰åˆ†è¯åº“>#</a></h3><p>é…ç½® åœ¨ikåˆ†æå™¨çš„configç›®å½•ä¸‹çš„ <code>IKAnalyzer.cfg.xml</code></p><p>å†…å®¹å¦‚ä¸‹:</p><div class=highlight><pre tabindex=0 style=color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#8b949e;font-weight:700;font-style:italic>&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-weight:700;font-style:italic>&lt;!DOCTYPE properties SYSTEM &#34;http://java.sun.com/dtd/properties.dtd&#34;&gt;</span>
</span></span><span style=display:flex><span><span style=color:#7ee787>&lt;properties&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#7ee787>&lt;comment&gt;</span>IK Analyzer æ‰©å±•é…ç½®<span style=color:#7ee787>&lt;/comment&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#8b949e;font-style:italic>&lt;!--ç”¨æˆ·å¯ä»¥åœ¨è¿™é‡Œé…ç½®è‡ªå·±çš„æ‰©å±•å­—å…¸ --&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#7ee787>&lt;entry</span> key=<span style=color:#a5d6ff>&#34;ext_dict&#34;</span><span style=color:#7ee787>&gt;</span>custom/mydict.dic;custom/single_word_low_freq.dic<span style=color:#7ee787>&lt;/entry&gt;</span>
</span></span><span style=display:flex><span>	 <span style=color:#8b949e;font-style:italic>&lt;!--ç”¨æˆ·å¯ä»¥åœ¨è¿™é‡Œé…ç½®è‡ªå·±çš„æ‰©å±•åœæ­¢è¯å­—å…¸--&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#7ee787>&lt;entry</span> key=<span style=color:#a5d6ff>&#34;ext_stopwords&#34;</span><span style=color:#7ee787>&gt;</span>custom/ext_stopword.dic<span style=color:#7ee787>&lt;/entry&gt;</span>
</span></span><span style=display:flex><span> 	<span style=color:#8b949e;font-style:italic>&lt;!--ç”¨æˆ·å¯ä»¥åœ¨è¿™é‡Œé…ç½®è¿œç¨‹æ‰©å±•å­—å…¸ --&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#7ee787>&lt;entry</span> key=<span style=color:#a5d6ff>&#34;remote_ext_dict&#34;</span><span style=color:#7ee787>&gt;</span>location<span style=color:#7ee787>&lt;/entry&gt;</span>
</span></span><span style=display:flex><span> 	<span style=color:#8b949e;font-style:italic>&lt;!--ç”¨æˆ·å¯ä»¥åœ¨è¿™é‡Œé…ç½®è¿œç¨‹æ‰©å±•åœæ­¢è¯å­—å…¸--&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#7ee787>&lt;entry</span> key=<span style=color:#a5d6ff>&#34;remote_ext_stopwords&#34;</span><span style=color:#7ee787>&gt;</span>http://xxx.com/xxx.dic<span style=color:#7ee787>&lt;/entry&gt;</span>
</span></span><span style=display:flex><span><span style=color:#7ee787>&lt;/properties&gt;</span>
</span></span></code></pre></div><blockquote><p>æ‰©å±•è¯: ä¸æƒ³è¢«åˆ†è¯çš„è¯: æ¯”å¦‚, ä¹”ç¢§ç½—, ç¥ç½—å¤©å¾ç­‰</p><p>åœæ­¢è¯: ä¸æƒ³è¦çš„è¯,æœç´¢æ—¶ä¸ä¼šæœå®ƒ, æ¯”å¦‚: ä¸ª ,å•Š, the , a ç­‰</p></blockquote><p><strong>è¿œç¨‹è¯å…¸å…·å¤‡çƒ­æ›´æ–°çš„èƒ½åŠ›</strong>, æ»¡è¶³ä»¥ä¸‹å‰ä¸¤ç‚¹å³å¯å®ç°çƒ­æ›´æ–°</p><p>å…¶ä¸­ <code>location</code> æ˜¯æŒ‡ä¸€ä¸ª urlï¼Œæ¯”å¦‚ <code>http://yoursite.com/getCustomDict</code>ï¼Œè¯¥è¯·æ±‚åªéœ€æ»¡è¶³ä»¥ä¸‹ä¸¤ç‚¹å³å¯å®Œæˆåˆ†è¯çƒ­æ›´æ–°ã€‚</p><ol><li><p>è¯¥ http è¯·æ±‚éœ€è¦è¿”å›ä¸¤ä¸ªå¤´éƒ¨(header)ï¼Œä¸€ä¸ªæ˜¯ <code>Last-Modified</code>ï¼Œä¸€ä¸ªæ˜¯ <code>ETag</code>ï¼Œè¿™ä¸¤è€…éƒ½æ˜¯å­—ç¬¦ä¸²ç±»å‹ï¼Œåªè¦æœ‰ä¸€ä¸ªå‘ç”Ÿå˜åŒ–ï¼Œè¯¥æ’ä»¶å°±ä¼šå»æŠ“å–æ–°çš„åˆ†è¯è¿›è€Œæ›´æ–°è¯åº“ã€‚</p><blockquote><p>å†™ä¸ªæ¥å£,è¿”å›ä¿®æ”¹æ—¶é—´å’ŒETagå³å¯</p><p>æˆ–è€…ç”¨Ngè½¬å‘é™æ€æ–‡ä»¶, ä¼šè‡ªåŠ¨åŠ ä¸Šè¿™ä¸ªä¸¤ä¸ªé…ç½®,å½“æ–‡ä»¶æ”¹åŠ¨æ—¶,è¿™ä¸¤ä¸ªå€¼è‡ªåŠ¨æ”¹å˜</p></blockquote></li><li><p>è¯¥ http è¯·æ±‚è¿”å›çš„å†…å®¹æ ¼å¼æ˜¯ä¸€è¡Œä¸€ä¸ªåˆ†è¯ï¼Œæ¢è¡Œç¬¦ç”¨ <code></code>å³å¯ã€‚</p></li><li><p>urlè¿”å›ä¸€ä¸ªUTF-8æ ¼å¼çš„æ–‡æœ¬å³å¯</p></li></ol><blockquote><p>å¦‚æœæœ‰å¤šä¸ªæ–‡ä»¶,ç”¨è‹±æ–‡åˆ†å·éš”å¼€<code>;</code></p></blockquote><blockquote><p>ç›‘æ§æµç¨‹</p><ol start=0><li><p><u>è¯»å– <code>IKAnalyzer.cfg.xml</code>é…ç½®æ–‡ä»¶,å¹¶è§£æå…¶ä¸­çš„é…ç½®</u></p></li><li><p>å‘è¯åº“æœåŠ¡å™¨å‘é€Headè¯·æ±‚</p></li><li><p>ä»å“åº”ä¸­è·å–<code>Last- Modify</code>ã€ <code>Etags</code>å­—æ®µå€¼ï¼Œåˆ¤æ–­æ˜¯å¦å˜åŒ–</p></li><li><p>å¦‚æœæœªå˜åŒ–ï¼Œä½“çœ 1min,è¿”å›ç¬¬0æ­¥</p><p>â€‹ å¦‚æœæœ‰å˜åŒ–ï¼Œé‡æ–°åŠ æˆŸè¯å…¸</p></li><li><p>ä¼‘çœ 1min,è¿”å›ç¬¬0æ­¥</p></li></ol></blockquote><p><strong>è‡ªå®šä¹‰è¯æ±‡åªä¼šå¯¹æ–°åŠ çš„æ•°æ®ç”Ÿæ•ˆ,ä¸ä¼šå¯¹å­˜é‡æ•°æ®ç”Ÿæ•ˆ,éœ€è¦æ›´æ–°ä¸€æ¬¡æ‰è¡Œ</strong></p><blockquote><p>æ•°æ®åœ¨å†™å…¥æ—¶å°±å·²åˆ†è¯å­˜å‚¨,æ‰€ä»¥è‡ªå®šä¹‰è¯æ±‡ä¸ä¼šå¯¹å­˜é‡æ•°æ®ç”Ÿæ•ˆ</p></blockquote><p><a href=https://www.elastic.co/guide/en/elasticsearch/reference/current/docs-update-by-query.html target=_blank rel=noopener>å®˜æ–¹</a>
æä¾›æ›´æ–°æ–¹å¼ <code>POST product/_update_by_query?conflicts=proceed</code></p><blockquote><p>update_by_queryåŸç†</p><p>å¼€å§‹æ—¶è·å–ä¸€ä¸ªç´¢å¼•çš„å¿«ç…§ï¼Œå¹¶ä¸”ä½¿ç”¨å†…éƒ¨ç‰ˆæœ¬æ¥å·æ¥è¿›è¡Œæ›´æ–°ã€‚è¿™æ„å‘³ç€å¦‚æœæ–‡æ¡£åœ¨è·å¾—å¿«ç…§åï¼Œå¯¹ç´¢å¼•å¤„ç† è¿‡ç¨‹ä¸­ç‰ˆæœ¬å‘ç”Ÿæ›´æ”¹ï¼Œå°†ä¼šå‘ç”Ÿç‰ˆæœ¬å†²çªã€‚å½“å¿«ç…§çš„ç‰ˆæœ¬å’Œç´¢å¼•ç‰ˆæœ¬ä¸€ç›´æ—¶åˆ™è¿›è¡Œæ›´æ–°ï¼Œå¹¶ä¸”é€’å¢æ–‡æ¡£ç‰ˆæœ¬å·ã€‚</p><p>å½“é‡åˆ°å†²çªè€Œå¯¼è‡´æ•´ä¸ªæ›´æ–°è¿‡ç¨‹å¤±è´¥æ—¶ï¼Œæ›´æ–°è¿‡ç¨‹æ˜¯ä¸ä¼šå›æ»šçš„ã€‚å¦‚æœä¸æƒ³å› ä¸ºå†²çªå¯¼è‡´æ•´ä¸ªæ›´æ–°è¿‡ç¨‹ç»ˆæ­¢ï¼Œå¯ä»¥åœ¨urlä¸­æ·»åŠ å‚æ•°conflicts=proceedã€‚æˆ–è€…åœ¨è¯·æ±‚bodyä¸­æ·»åŠ â€conflictsâ€:â€proceedâ€</p><p>ä¸å…‰è¿™é‡Œå¯ä»¥ç”¨,ä¿®æ”¹esæ–‡æ¡£ä¹Ÿæ˜¯ç”¨<code>_update_by_query</code></p><p>æ‰§è¡Œç»“æœå¦‚å›¾:(æ¶ˆè€—æ—¶é—´å•ä½ : æ¯«ç§’)</p><p>æ ¼åŠ›çš„esé›†ç¾¤,æ‰§è¡Œæ•ˆç‡å¤§æ¦‚æ˜¯2300æ¡/s, 26ä¸‡æ•°æ®,å¤§æ¦‚èŠ±äº†1.7åˆ†é’Ÿ</p><p><img loading=lazy src="https://img-blog.csdnimg.cn/20210106175123919.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM4MDExNDE1,size_16,color_FFFFFF,t_70" alt=image></p><p>æ›´æ–°å¯èƒ½è€—æ—¶å¤ªä¹…å¯¼è‡´å®¢æˆ·ç«¯è¿æ¥è¶…æ—¶,å¯ä»¥ç”¨å‘½ä»¤æŸ¥çœ‹ä»»åŠ¡æ‰§è¡Œæƒ…å†µ(æœªç»“æŸçš„ä»»åŠ¡)</p><p><code>GET _tasks?actions=*update*&amp;detailed</code></p></blockquote><h2 id=53-åŒä¹‰è¯åˆ†æå™¨>5.3 åŒä¹‰è¯åˆ†æå™¨<a hidden class=anchor aria-hidden=true href=#53-åŒä¹‰è¯åˆ†æå™¨>#</a></h2><p><a href=https://www.jianshu.com/p/7dc93f4fbb46 target=_blank rel=noopener>é…ç½®åŒä¹‰è¯</a></p><h2 id=54-æ‹¼éŸ³åˆ†æå™¨>5.4 æ‹¼éŸ³åˆ†æå™¨<a hidden class=anchor aria-hidden=true href=#54-æ‹¼éŸ³åˆ†æå™¨>#</a></h2><p><a href=https://github.com/medcl/elasticsearch-analysis-pinyin target=_blank rel=noopener>Pinyin Analysis for Elasticsearch</a></p><p>å‚è€ƒé“¾æ¥:</p><p><a href=https://www.jianshu.com/p/bebea42b5040 target=_blank rel=noopener>åˆ†æå™¨-ç®€ä¹¦</a></p><p><a href=https://www.cnblogs.com/sanduzxcvbnm/p/12084607.html target=_blank rel=noopener>åˆ†æå™¨-åšå®¢å›­</a></p><p><a href=https://elastic-search-in-action.medcl.com/3.site_search/3.3.search_box/unify_traditional_chinese_and_simplified_chinese/ target=_blank rel=noopener>ç¹ç®€è½¬æ¢</a></p><p><a href=https://blog.csdn.net/zq199419951001/article/details/89884461 target=_blank rel=noopener>ESçš„åŒä¹‰è¯ã€æ‰©å±•è¯ã€åœæ­¢è¯çƒ­æ›´æ–°æ–¹æ¡ˆ</a></p><p><a href=https://github.com/medcl/elasticsearch-analysis-ik target=_blank rel=noopener>ikåˆ†æå™¨-github</a></p><p><a href=https://www.jianshu.com/p/f7634252ff9a target=_blank rel=noopener>ikåˆ†æå™¨-ç®€ä¹¦</a></p><p><a href=https://blog.csdn.net/willingtolove/article/details/118382154 target=_blank rel=noopener>ikåˆ†æå™¨-csdn</a></p><p><a href=http://3dobe.com/archives/44/ target=_blank rel=noopener>IKåˆ†è¯å™¨åŸç†ä¸æºç åˆ†æ</a></p></div><footer class=post-footer><ul class=post-tags><li><a href=https://xiaokunji.com/zh/tags/ElasticSearch.html>ElasticSearch</a></li><li><a href=https://xiaokunji.com/zh/tags/%E7%BB%BC%E5%90%88.html>ç»¼åˆ</a></li></ul><nav class=paginav><a class=prev href=https://xiaokunji.com/zh/java%E5%8F%8A%E5%85%B6%E6%A1%86%E6%9E%B6/springBoot/Actuator.html><span class=title>Â« ä¸Šä¸€é¡µ</span><br><span>Actuator</span></a>
<a class=next href=https://xiaokunji.com/zh/java%E5%8F%8A%E5%85%B6%E6%A1%86%E6%9E%B6/spring/aop.html><span class=title>ä¸‹ä¸€é¡µ Â»</span><br><span>aop</span></a></nav></footer></article></main><script async src=//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js></script><footer class=footer><span>Copyright
&copy;
-2023
<a href=https://xiaokunji.com/zh/ style=color:#939393>ç±³äºŒ</a>
All Rights Reserved</span>
<span id=busuanzi_container><span class="fa fa-user">ç”¨æˆ·æ•°:</span><span id=busuanzi_value_site_uv></span>
<span class="fa fa-eye">è®¿é—®æ•°:</span><span id=busuanzi_value_site_pv></span></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="å¤åˆ¶";function s(){t.innerHTML="å·²å¤åˆ¶ï¼",setTimeout(()=>{t.innerHTML="å¤åˆ¶"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>