<!DOCTYPE html>
<html dir="auto" lang="zh"><head><meta charset="utf-8"/><meta content="IE=edge" http-equiv="X-UA-Compatible"/><meta content="width=device-width,initial-scale=1,shrink-to-fit=no" name="viewport"/><meta content="index, follow" name="robots"/><title>javaEE | ç±³äºŒ</title>
<meta content=" 1. java å†ç¨‹, 2. ç½‘ç«™å¦‚ä½•æé«˜å¹¶å‘é‡?, 3. å¯¹è±¡æ·±æ‹·è´ä¸æµ…æ‹·è´çš„åŒºåˆ«, 4. multipart/form-data  ä¸   application/x-www-form-urlencoded, 5. jwt, 6. springçš„è§£å†³å¾ªç¯ä¾èµ–é—®é¢˜, 7.Futureæ¨¡å¼å’ŒPromiseæ¨¡å¼, 8. å“åº”å¼å’Œå‡½æ•°å¼, 8. JIT(å³æ—¶ç¼–è¯‘)" name="keywords"/><meta content="     " name="description"/><meta content="xkj" name="author"/><link href="https://xiaokunji.com/zh/%E7%BB%BC%E5%90%88/%E4%B8%AA%E4%BA%BA%E5%B0%8F%E7%9F%A5%E8%AF%86/java/javaEE.html" rel="canonical"/><link as="style" crossorigin="anonymous" href="/assets/css/stylesheet.dc6bd2c841ee388e899e13872ae986c0e847e8b957d6714ad6ddc628ef2d17ff.css" integrity="sha256-3GvSyEHuOI6JnhOHKumGwOhH6LlX1nFK1t3GKO8tF/8=" rel="preload stylesheet"/><script crossorigin="anonymous" defer="" integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload="hljs.initHighlightingOnLoad()" src="/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js"></script><link href="https://xiaokunji.com/img/Q.svg" rel="icon"/><link href="https://xiaokunji.com/img/Q.svg" rel="icon" sizes="16x16" type="image/png"/><link href="https://xiaokunji.com/img/Q.svg" rel="icon" sizes="32x32" type="image/png"/><link href="https://xiaokunji.com/Q.svg" rel="apple-touch-icon"/><link href="https://xiaokunji.com/Q.svg" rel="mask-icon"/><meta content="#2e2e33" name="theme-color"/><meta content="#2e2e33" name="msapplication-TileColor"/><link href="https://xiaokunji.com/zh/%E7%BB%BC%E5%90%88/%E4%B8%AA%E4%BA%BA%E5%B0%8F%E7%9F%A5%E8%AF%86/java/javaEE.html" hreflang="zh" rel="alternate"/><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><meta content="javaEE" property="og:title"/><meta content="     " property="og:description"/><meta content="article" property="og:type"/><meta content="https://xiaokunji.com/zh/%E7%BB%BC%E5%90%88/%E4%B8%AA%E4%BA%BA%E5%B0%8F%E7%9F%A5%E8%AF%86/java/javaEE.html" property="og:url"/><meta content="ç»¼åˆ" property="article:section"/><meta content="2023-08-22T00:00:00+00:00" property="article:published_time"/><meta content="2023-08-22T22:36:07+08:00" property="article:modified_time"/><meta content="summary" name="twitter:card"/><meta content="javaEE" name="twitter:title"/><meta content="     " name="twitter:description"/><script type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":5,"name":"javaEE","item":"https://xiaokunji.com/zh/%E7%BB%BC%E5%90%88/%E4%B8%AA%E4%BA%BA%E5%B0%8F%E7%9F%A5%E8%AF%86/java/javaEE.html"}]}</script><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","headline":"javaEE","name":"javaEE","description":"     ","keywords":[" 1. java å†ç¨‹"," 2. ç½‘ç«™å¦‚ä½•æé«˜å¹¶å‘é‡?"," 3. å¯¹è±¡æ·±æ‹·è´ä¸æµ…æ‹·è´çš„åŒºåˆ«"," 4. multipart/form-data  ä¸   application/x-www-form-urlencoded"," 5. jwt"," 6. springçš„è§£å†³å¾ªç¯ä¾èµ–é—®é¢˜"," 7.Futureæ¨¡å¼å’ŒPromiseæ¨¡å¼"," 8. å“åº”å¼å’Œå‡½æ•°å¼"," 8. JIT(å³æ—¶ç¼–è¯‘)"],"articleBody":"[toc]\n1. java å†ç¨‹ java8:å¢åŠ lambda,æµ java9:å¢åŠ moduleç³»ç»Ÿ(è¦ç”¨ä»€ä¹ˆå…ˆå£°æ˜) java10: å¼•å…¥var,å±€éƒ¨å˜é‡ç±»å‹åˆ¤æ–­,ä¸èƒ½ç”¨äºæ–¹æ³•ä¸Šçš„å‚æ•° java11: å…è®¸åœ¨lambdaä¸­ä½¿ç”¨var,å¢åŠ äº†ZGC,(é•¿æœŸæ”¯æŒç‰ˆæœ¬) java12: swtchå¢åŠ ,å¯ä»¥å†™è¡¨è¾¾å¼,å¯ä»¥(ç”¨break)å†™è¿”å›å€¼ java13: swtchæ”¹å˜,ç”¨yield è¿”å‚,breakä¸è¿”,å¯ä»¥ä½¿ç”¨\"â€œâ€œcodeâ€â€œâ€œâ€œåŒ…å«ä»£ç å—(å’Œpyä¸€æ ·) 2. ç½‘ç«™å¦‚ä½•æé«˜å¹¶å‘é‡? ç­”:æ— æ³•å®¹çº³é«˜è®¿é—®,æ˜¯å› ä¸ºæ— æ³•å¿«é€Ÿå¤„ç†è¯·æ±‚,å¤§é‡è¯·æ±‚è¢«å †ç§¯,å¯¼è‡´æœåŠ¡å™¨å´©æºƒ.\nç›®å‰æœ€è€—æ—¶çš„æ˜¯å¯¹æ•°æ®åº“çš„è®¿é—®,æ‰€æœ‰ä¼˜åŒ–sqlæ˜¯å¿…è¦çš„.\nè¿˜å¯ä»¥ç”¨å„ç§ç¼“å­˜(Redis),å„ç§æœåŠ¡å™¨(CDN,æ–‡ä»¶æœåŠ¡å™¨),å„ç§åˆ†å¸ƒå¼æ“ä½œ,åŠ å¿«å¯¹è¯·æ±‚çš„å¤„ç†\n3. å¯¹è±¡æ·±æ‹·è´ä¸æµ…æ‹·è´çš„åŒºåˆ« æµ…æ‹·è´(å½±å­å…‹éš†):åªå¤åˆ¶å¯¹è±¡çš„åŸºæœ¬ç±»å‹,è€Œå¯¹è±¡ç±»å‹ä»å±äºåŸæ¥çš„å¼•ç”¨. æ·±æ‹·è´(æ·±åº¦å…‹éš†):ä¸ä»…å¤åˆ¶å¯¹è±¡çš„åŸºæœ¬ç±»å‹,åŒæ—¶ä¹Ÿå¤åˆ¶åŸå¯¹è±¡ä¸­çš„å¯¹è±¡.å°±æ˜¯è¯´å®Œå…¨æ˜¯æ–°å¯¹è±¡äº§ç”Ÿçš„ 4. multipart/form-data ä¸ application/x-www-form-urlencoded x-www-form-urlencoded\nä¼ é€’æ•°æ®æ˜¯æ–‡æœ¬æ ¼å¼,formè¡¨å•æäº¤ é»˜è®¤å°±æ˜¯è¿™ç§æ ¼å¼\nform-data\nä¸€èˆ¬ç”¨äºå›¾ç‰‡,è§†é¢‘ç­‰æ•°æ®,ä¼ é€’æ•°æ®ä½¿ç”¨äºŒè¿›åˆ¶æµä¼ é€’,æ‰€ä»¥åå°æ˜¯ä¸èƒ½æ¥æ”¶åˆ°å€¼çš„,æ‰€ä»¥éœ€è¦ç”¨æ–¹é¢çš„ç±»æ¥å¤„ç†,åœ¨jfw-frontä¸­,å¼•å…¥äº†æ–‡ä»¶ä¸Šä¼ çš„åŒ…,springå°±è‡ªåŠ¨è§£æäº†,æ‰€ä»¥jfw-frontè¿™ä¸¤ç§æ ¼å¼éƒ½æ”¯æŒ,å½“ç„¶ä¹Ÿå¯ä»¥ç”¨ç‰¹å®šæ–¹å¼æ¥å–form-dataæ ¼å¼çš„å€¼\n","wordCount":"5654","inLanguage":"zh","datePublished":"2023-08-22T00:00:00Z","dateModified":"2023-08-22T22:36:07+08:00","author":{"@type":"Person","name":"xkj"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://xiaokunji.com/zh/%E7%BB%BC%E5%90%88/%E4%B8%AA%E4%BA%BA%E5%B0%8F%E7%9F%A5%E8%AF%86/java/javaEE.html"},"publisher":{"@type":"Organization","name":"ç±³äºŒ","logo":{"@type":"ImageObject","url":"https://xiaokunji.com/img/Q.svg"}}}</script></head><body class="dark" id="top"><script>localStorage.getItem("pref-theme")==="light"&&document.body.classList.remove("dark")</script><header class="header"><nav class="nav"><div class="logo"><a accesskey="h" href="https://xiaokunji.com/zh/" title="ç±³äºŒ (Alt + H)"><img alt="" aria-label="logo" height="35" src="https://xiaokunji.com/img/Q.svg"/>ç±³äºŒ</a><div class="logo-switches"><button accesskey="t" id="theme-toggle" title="(Alt + T)"><svg fill="none" height="18" id="moon" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"></path></svg><svg fill="none" height="18" id="sun" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><circle cx="12" cy="12" r="5"></circle><line x1="12" x2="12" y1="1" y2="3"></line><line x1="12" x2="12" y1="21" y2="23"></line><line x1="4.22" x2="5.64" y1="4.22" y2="5.64"></line><line x1="18.36" x2="19.78" y1="18.36" y2="19.78"></line><line x1="1" x2="3" y1="12" y2="12"></line><line x1="21" x2="23" y1="12" y2="12"></line><line x1="4.22" x2="5.64" y1="19.78" y2="18.36"></line><line x1="18.36" x2="19.78" y1="5.64" y2="4.22"></line></svg></button><ul class="lang-switch"><li>|</li><li><a aria-label="English" href="https://xiaokunji.com/en/" title="English">English</a></li></ul></div></div><ul id="menu"><li><a href="https://xiaokunji.com/zh/" title="ğŸ ä¸»é¡µ"><span>ğŸ ä¸»é¡µ</span></a></li><li><a accesskey="/" href="https://xiaokunji.com/zh/search" title="ğŸ”æœç´¢ (Alt + /)"><span>ğŸ”æœç´¢</span></a></li><li><a href="https://xiaokunji.com/zh/post.html" title="ğŸ“šæ–‡ç« "><span>ğŸ“šæ–‡ç« </span></a></li><li><a href="https://xiaokunji.com/zh/archives.html" title="â±æ—¶é—´è½´"><span>â±æ—¶é—´è½´</span></a></li><li><a href="https://xiaokunji.com/zh/tags.html" title="ğŸ”–æ ‡ç­¾"><span>ğŸ”–æ ‡ç­¾</span></a></li><li><a href="https://xiaokunji.com/zh/categories.html" title="ğŸ“–åˆ†ç±»"><span>ğŸ“–åˆ†ç±»</span></a></li><li><a href="https://xiaokunji.com/zh/links.html" title="ğŸ¤å‹é“¾"><span>ğŸ¤å‹é“¾</span></a></li></ul></nav></header><main class="main"><article class="post-single"><header class="post-header"><nav aria-label="breadcrumb"><ul><a href="https://xiaokunji.com/zh/">ğŸ </a> <span>&gt;</span>
<a href="https://xiaokunji.com/zh/%E7%BB%BC%E5%90%88.html">ç»¼åˆ</a> <span>&gt;</span>
<a href="https://xiaokunji.com/zh/%E7%BB%BC%E5%90%88/%E4%B8%AA%E4%BA%BA%E5%B0%8F%E7%9F%A5%E8%AF%86.html">ä¸ªäººå°çŸ¥è¯†</a> <span>&gt;</span>
<a href="https://xiaokunji.com/zh/%E7%BB%BC%E5%90%88/%E4%B8%AA%E4%BA%BA%E5%B0%8F%E7%9F%A5%E8%AF%86/java.html">java</a> <span>&gt;</span></ul></nav><h1 class="post-title">javaEE</h1><div class="post-description"></div><div class="post-meta">åˆ›å»º:&amp;nbsp;&lt;span title='2023-08-22 00:00:00 +0000 UTC'&gt;2023-08-22&lt;/span&gt;&amp;nbsp;Â·&amp;nbsp;æ›´æ–°:&amp;nbsp;2023-08-22&amp;nbsp;Â·&amp;nbsp;xkj
Â |Â åˆ†ç±»: Â <ul class="post-categories-meta" style="display:inline"><a href="https://xiaokunji.com/zh/categories/%E7%BB%BC%E5%90%88.html">ç»¼åˆ</a></ul><span id="busuanzi_container_page_pv">Â | è®¿é—®: <span id="busuanzi_value_page_pv">1</span></span></div></header><aside class="toc-container wide" id="toc-container"><div class="toc"><details open=""><summary accesskey="c" title="(Alt + C)"><span class="details">ç›®å½•</span></summary><div class="inner"><ul><li><a aria-label="1. java å†ç¨‹" href="#1-java-%e5%8e%86%e7%a8%8b">1. java å†ç¨‹</a></li><li><a aria-label="2. ç½‘ç«™å¦‚ä½•æé«˜å¹¶å‘é‡?" href="#2-%e7%bd%91%e7%ab%99%e5%a6%82%e4%bd%95%e6%8f%90%e9%ab%98%e5%b9%b6%e5%8f%91%e9%87%8f">2. ç½‘ç«™å¦‚ä½•æé«˜å¹¶å‘é‡?</a></li><li><a aria-label="3. å¯¹è±¡æ·±æ‹·è´ä¸æµ…æ‹·è´çš„åŒºåˆ«" href="#3-%e5%af%b9%e8%b1%a1%e6%b7%b1%e6%8b%b7%e8%b4%9d%e4%b8%8e%e6%b5%85%e6%8b%b7%e8%b4%9d%e7%9a%84%e5%8c%ba%e5%88%ab">3. å¯¹è±¡æ·±æ‹·è´ä¸æµ…æ‹·è´çš„åŒºåˆ«</a></li><li><a aria-label="4. multipart/form-data  ä¸   application/x-www-form-urlencoded" href="#4-multipartform-data--%e4%b8%8e---applicationx-www-form-urlencoded">4. multipart/form-data ä¸ application/x-www-form-urlencoded</a></li><li><a aria-label="5. jwt" href="#5-jwt">5. jwt</a></li><li><a aria-label="6. springçš„è§£å†³å¾ªç¯ä¾èµ–é—®é¢˜" href="#6-spring%e7%9a%84%e8%a7%a3%e5%86%b3%e5%be%aa%e7%8e%af%e4%be%9d%e8%b5%96%e9%97%ae%e9%a2%98">6. springçš„è§£å†³å¾ªç¯ä¾èµ–é—®é¢˜</a></li><li><a aria-label="7.Futureæ¨¡å¼å’ŒPromiseæ¨¡å¼" href="#7future%e6%a8%a1%e5%bc%8f%e5%92%8cpromise%e6%a8%a1%e5%bc%8f">7.Futureæ¨¡å¼å’ŒPromiseæ¨¡å¼</a></li><li><a aria-label="8. å“åº”å¼å’Œå‡½æ•°å¼" href="#8-%e5%93%8d%e5%ba%94%e5%bc%8f%e5%92%8c%e5%87%bd%e6%95%b0%e5%bc%8f">8. å“åº”å¼å’Œå‡½æ•°å¼</a></li><li><a aria-label="8. JIT(å³æ—¶ç¼–è¯‘)" href="#8-jit%e5%8d%b3%e6%97%b6%e7%bc%96%e8%af%91">8. JIT(å³æ—¶ç¼–è¯‘)</a></li></ul></div></details></div></aside><script>let activeElement,elements;window.addEventListener("DOMContentLoaded",function(){checkTocPosition(),elements=document.querySelectorAll("h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]"),activeElement=elements[0];const t=encodeURI(activeElement.getAttribute("id")).toLowerCase();document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active")},!1),window.addEventListener("resize",function(){checkTocPosition()},!1),window.addEventListener("scroll",()=>{activeElement=Array.from(elements).find(e=>{if(getOffsetTop(e)-window.pageYOffset>0&&getOffsetTop(e)-window.pageYOffset<window.innerHeight/2)return e})||activeElement,elements.forEach(e=>{const t=encodeURI(e.getAttribute("id")).toLowerCase();e===activeElement?document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active"):document.querySelector(`.inner ul li a[href="#${t}"]`).classList.remove("active")})},!1);const main=parseInt(getComputedStyle(document.body).getPropertyValue("--article-width"),10),toc=parseInt(getComputedStyle(document.body).getPropertyValue("--toc-width"),10),gap=parseInt(getComputedStyle(document.body).getPropertyValue("--gap"),10);function checkTocPosition(){const e=document.body.scrollWidth;e-main-toc*2-gap*4>0?document.getElementById("toc-container").classList.add("wide"):document.getElementById("toc-container").classList.remove("wide")}function getOffsetTop(e){if(!e.getClientRects().length)return 0;let t=e.getBoundingClientRect(),n=e.ownerDocument.defaultView;return t.top+n.pageYOffset}</script><div class="post-content"><p>[toc]</p><h1 id="1-java-å†ç¨‹">1. java å†ç¨‹<a aria-hidden="true" class="anchor" hidden="" href="#1-java-å†ç¨‹">#</a></h1><ol><li><strong>java8</strong>:å¢åŠ lambda,æµ</li><li><strong>java9</strong>:å¢åŠ moduleç³»ç»Ÿ(è¦ç”¨ä»€ä¹ˆå…ˆå£°æ˜)</li><li><strong>java10</strong>: å¼•å…¥var,å±€éƒ¨å˜é‡ç±»å‹åˆ¤æ–­,ä¸èƒ½ç”¨äºæ–¹æ³•ä¸Šçš„å‚æ•°</li><li><strong>java11</strong>: å…è®¸åœ¨lambdaä¸­ä½¿ç”¨var,å¢åŠ äº†ZGC,(é•¿æœŸæ”¯æŒç‰ˆæœ¬)</li><li><strong>java12</strong>: swtchå¢åŠ ,å¯ä»¥å†™è¡¨è¾¾å¼,å¯ä»¥(ç”¨break)å†™è¿”å›å€¼</li><li><strong>java13</strong>: swtchæ”¹å˜,ç”¨yield è¿”å‚,breakä¸è¿”,å¯ä»¥ä½¿ç”¨"â€œâ€œcodeâ€â€œâ€œâ€œåŒ…å«ä»£ç å—(å’Œpyä¸€æ ·)</li></ol><h1 id="2-ç½‘ç«™å¦‚ä½•æé«˜å¹¶å‘é‡">2. ç½‘ç«™å¦‚ä½•æé«˜å¹¶å‘é‡?<a aria-hidden="true" class="anchor" hidden="" href="#2-ç½‘ç«™å¦‚ä½•æé«˜å¹¶å‘é‡">#</a></h1><p>ç­”:æ— æ³•å®¹çº³é«˜è®¿é—®,æ˜¯å› ä¸ºæ— æ³•å¿«é€Ÿå¤„ç†è¯·æ±‚,å¤§é‡è¯·æ±‚è¢«å †ç§¯,å¯¼è‡´æœåŠ¡å™¨å´©æºƒ.</p><p>ç›®å‰æœ€è€—æ—¶çš„æ˜¯å¯¹æ•°æ®åº“çš„è®¿é—®,æ‰€æœ‰ä¼˜åŒ–sqlæ˜¯å¿…è¦çš„.</p><p>è¿˜å¯ä»¥ç”¨å„ç§ç¼“å­˜(Redis),å„ç§æœåŠ¡å™¨(CDN,æ–‡ä»¶æœåŠ¡å™¨),å„ç§åˆ†å¸ƒå¼æ“ä½œ,åŠ å¿«å¯¹è¯·æ±‚çš„å¤„ç†</p><h1 id="3-å¯¹è±¡æ·±æ‹·è´ä¸æµ…æ‹·è´çš„åŒºåˆ«">3. å¯¹è±¡æ·±æ‹·è´ä¸æµ…æ‹·è´çš„åŒºåˆ«<a aria-hidden="true" class="anchor" hidden="" href="#3-å¯¹è±¡æ·±æ‹·è´ä¸æµ…æ‹·è´çš„åŒºåˆ«">#</a></h1><pre><code>æµ…æ‹·è´(å½±å­å…‹éš†):åªå¤åˆ¶å¯¹è±¡çš„åŸºæœ¬ç±»å‹,è€Œå¯¹è±¡ç±»å‹ä»å±äºåŸæ¥çš„å¼•ç”¨.
æ·±æ‹·è´(æ·±åº¦å…‹éš†):ä¸ä»…å¤åˆ¶å¯¹è±¡çš„åŸºæœ¬ç±»å‹,åŒæ—¶ä¹Ÿå¤åˆ¶åŸå¯¹è±¡ä¸­çš„å¯¹è±¡.å°±æ˜¯è¯´å®Œå…¨æ˜¯æ–°å¯¹è±¡äº§ç”Ÿçš„
</code></pre><h1 id="4-multipartform-data--ä¸---applicationx-www-form-urlencoded">4. multipart/form-data ä¸ application/x-www-form-urlencoded<a aria-hidden="true" class="anchor" hidden="" href="#4-multipartform-data--ä¸---applicationx-www-form-urlencoded">#</a></h1><p><code>x-www-form-urlencoded</code></p><p>ä¼ é€’æ•°æ®æ˜¯æ–‡æœ¬æ ¼å¼,formè¡¨å•æäº¤ é»˜è®¤å°±æ˜¯è¿™ç§æ ¼å¼</p><p><code>form-data</code></p><p>ä¸€èˆ¬ç”¨äºå›¾ç‰‡,è§†é¢‘ç­‰æ•°æ®,ä¼ é€’æ•°æ®ä½¿ç”¨äºŒè¿›åˆ¶æµä¼ é€’,æ‰€ä»¥åå°æ˜¯ä¸èƒ½æ¥æ”¶åˆ°å€¼çš„,æ‰€ä»¥éœ€è¦ç”¨æ–¹é¢çš„ç±»æ¥å¤„ç†,åœ¨jfw-frontä¸­,å¼•å…¥äº†æ–‡ä»¶ä¸Šä¼ çš„åŒ…,springå°±è‡ªåŠ¨è§£æäº†,æ‰€ä»¥jfw-frontè¿™ä¸¤ç§æ ¼å¼éƒ½æ”¯æŒ,å½“ç„¶ä¹Ÿå¯ä»¥ç”¨ç‰¹å®šæ–¹å¼æ¥å–form-dataæ ¼å¼çš„å€¼</p><div class="highlight"><pre style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4" tabindex="0"><code class="language-xml" data-lang="xml"><span style="display:flex"><span><span style="color:#8b949e;font-style:italic">&lt;!-- ä¸Šä¼ æ–‡ä»¶æ‹¦æˆªï¼Œè®¾ç½®æœ€å¤§ä¸Šä¼ æ–‡ä»¶å¤§å°Â Â  10M=10*1024*1024(B)=10485760 bytes --&gt;</span>Â Â 
</span></span><span style="display:flex"><span><span style="color:#7ee787">&lt;bean</span> id=<span style="color:#a5d6ff">"multipartResolver"</span> class=<span style="color:#a5d6ff">"org.springframework.web.multipart.commons.CommonsMultipartResolver"</span><span style="color:#7ee787">&gt;</span>Â Â 
</span></span><span style="display:flex"><span>    <span style="color:#7ee787">&lt;property</span> name=<span style="color:#a5d6ff">"maxUploadSize"</span> value=<span style="color:#a5d6ff">"10485760"</span> <span style="color:#7ee787">/&gt;</span>
</span></span><span style="display:flex"><span><span style="color:#7ee787">&lt;/bean&gt;</span>
</span></span><span style="display:flex"><span>
</span></span><span style="display:flex"><span><span style="color:#7ee787">&lt;dependency&gt;</span>
</span></span><span style="display:flex"><span>    <span style="color:#7ee787">&lt;groupId&gt;</span>org.springframework<span style="color:#7ee787">&lt;/groupId&gt;</span>
</span></span><span style="display:flex"><span>    <span style="color:#7ee787">&lt;artifactId&gt;</span>spring-web<span style="color:#7ee787">&lt;/artifactId&gt;</span>
</span></span><span style="display:flex"><span>    <span style="color:#7ee787">&lt;version&gt;</span>3.1.0.RELEASE<span style="color:#7ee787">&lt;/version&gt;</span>
</span></span><span style="display:flex"><span><span style="color:#7ee787">&lt;/dependency&gt;</span>
</span></span></code></pre></div><blockquote><p>è¿™äº›æ ¼å¼æ˜¯ç”¨äº httpè¯·æ±‚æˆ–è€…å“åº”, ç”¨äºæŒ‡æ˜æ•°æ®çš„æ ¼å¼, ç§°ä¸º å†…å®¹ç±»å‹ (<strong>Content-Type</strong>)</p></blockquote><p><a href="https://blog.csdn.net/qq_14869093/article/details/86307084" rel="noopener" target="_blank">Content-Type è¯¦è§£_leoss.Hçš„åšå®¢-CSDNåšå®¢_content-type</a></p><h1 id="5-jwt">5. jwt<a aria-hidden="true" class="anchor" hidden="" href="#5-jwt">#</a></h1><p><code>JSON Web Token</code>ï¼ˆç¼©å†™ JWTï¼‰æ˜¯ç›®å‰æœ€æµè¡Œçš„è·¨åŸŸè®¤è¯è§£å†³æ–¹æ¡ˆ</p><p>JWT çš„åŸç†æ˜¯ï¼ŒæœåŠ¡å™¨è®¤è¯ä»¥åï¼Œç”Ÿæˆä¸€ä¸ª JSON å¯¹è±¡(å”¯ä¸€æ ‡è¯†(ç”¨æˆ·id),åˆ°æœŸæ—¶é—´,å…¶ä»–ä¿¡æ¯ç­‰)ï¼Œå‘å›ç»™ç”¨æˆ·.</p><p>ä»¥åï¼Œç”¨æˆ·ä¸æœåŠ¡ç«¯é€šä¿¡çš„æ—¶å€™ï¼Œéƒ½è¦å‘å›è¿™ä¸ª JSON å¯¹è±¡ã€‚æœåŠ¡å™¨å®Œå…¨åªé è¿™ä¸ªå¯¹è±¡è®¤å®šç”¨æˆ·èº«ä»½ã€‚ä¸ºäº†é˜²æ­¢ç”¨æˆ·ç¯¡æ”¹æ•°æ®ï¼ŒæœåŠ¡å™¨åœ¨ç”Ÿæˆè¿™ä¸ªå¯¹è±¡çš„æ—¶å€™ï¼Œä¼šåŠ ä¸Šç­¾åï¼ˆè¯¦è§åæ–‡ï¼‰ã€‚</p><p>æœåŠ¡å™¨å°±ä¸ä¿å­˜ä»»ä½• session æ•°æ®äº†ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼ŒæœåŠ¡å™¨å˜æˆæ— çŠ¶æ€äº†ï¼Œä»è€Œæ¯”è¾ƒå®¹æ˜“å®ç°æ‰©å±•ã€‚</p><p>æ¥è‡ª <code>&lt;http://www.ruanyifeng.com/blog/2018/07/json_web_token-tutorial.html&gt;</code></p><blockquote><p>ä¸ªäººç†è§£: ä½ ç™»å½•å®Œå,æœåŠ¡æŠŠéœ€è¦çš„ä¿¡æ¯å‘é€ç»™ä½ ,ä»¥åä½ è®¿é—®å°±å¸¦è¿™ä¸ªä¿¡æ¯,æˆ‘æ—¢èƒ½éªŒè¯,åˆèƒ½è·å¾—ä¿¡æ¯(Bé—¨æˆ·ä¸­çš„ç»„ç»‡æ ‘ä¿¡æ¯),ç”¨æˆ·æ•°æ®éƒ½å­˜åœ¨äº†å®¢æˆ·ç«¯,æœåŠ¡ç«¯å°±ä¸ç”¨å­˜åœ¨,ä»¥åå¢åŠ æœåŠ¡å™¨ä¹Ÿä¸ç”¨æ‹…å¿ƒéªŒè¯é—®é¢˜</p></blockquote><p>å®é™…çš„ JWT å¤§æ¦‚å°±åƒä¸‹é¢è¿™æ ·ã€‚</p><div class="highlight"><pre style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4" tabindex="0"><code class="language-fallback" data-lang="fallback"><span style="display:flex"><span>dfesrhsrhtrsh.
</span></span><span style="display:flex"><span>gaheiugvweiugnaqoweigqowe4e4waqegq.
</span></span><span style="display:flex"><span>weughgbwggiqgwgru
</span></span></code></pre></div><p>å®ƒæ˜¯ä¸€ä¸ªå¾ˆé•¿çš„å­—ç¬¦ä¸²ï¼Œä¸­é—´ç”¨ç‚¹ï¼ˆ.ï¼‰åˆ†éš”æˆä¸‰ä¸ªéƒ¨åˆ†ã€‚æ³¨æ„ï¼ŒJWT å†…éƒ¨æ˜¯æ²¡æœ‰æ¢è¡Œçš„ï¼Œè¿™é‡Œåªæ˜¯ä¸ºäº†ä¾¿äºå±•ç¤ºï¼Œå°†å®ƒå†™æˆäº†å‡ è¡Œã€‚</p><p>æ¥è‡ª <code>&lt;http://www.ruanyifeng.com/blog/2018/07/json_web_token-tutorial.html&gt;</code></p><p>JWT çš„ä¸‰ä¸ªéƒ¨åˆ†ä¾æ¬¡å¦‚ä¸‹ã€‚</p><ul><li>Headerï¼ˆå¤´éƒ¨ï¼‰</li><li>Payloadï¼ˆè´Ÿè½½ï¼‰</li><li>Signatureï¼ˆç­¾åï¼‰</li></ul><p>æ¥è‡ª <code>&lt;http://www.ruanyifeng.com/blog/2018/07/json_web_token-tutorial.html&gt;</code></p><ol><li>Header éƒ¨åˆ†æ˜¯ä¸€ä¸ª JSON å¯¹è±¡ï¼Œæè¿° JWT çš„å…ƒæ•°æ®ï¼Œé€šå¸¸æ˜¯ä¸‹é¢çš„æ ·å­ã€‚</li></ol><div class="highlight"><pre style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4" tabindex="0"><code class="language-fallback" data-lang="fallback"><span style="display:flex"><span>{
</span></span><span style="display:flex"><span>  "alg": "HS256",
</span></span><span style="display:flex"><span>  "typ": "JWT"
</span></span><span style="display:flex"><span>}
</span></span></code></pre></div><p>ä¸Šé¢ä»£ç ä¸­ï¼Œalgå±æ€§è¡¨ç¤ºç­¾åçš„ç®—æ³•ï¼ˆalgorithmï¼‰ï¼Œé»˜è®¤æ˜¯ HMAC SHA256ï¼ˆå†™æˆ HS256ï¼‰ï¼›typå±æ€§è¡¨ç¤ºè¿™ä¸ªä»¤ç‰Œï¼ˆtokenï¼‰çš„ç±»å‹ï¼ˆtypeï¼‰ï¼ŒJWT ä»¤ç‰Œç»Ÿä¸€å†™ä¸ºJWTã€‚</p><p>æœ€åï¼Œå°†ä¸Šé¢çš„ JSON å¯¹è±¡ä½¿ç”¨ Base64URL ç®—æ³•ï¼ˆè¯¦è§åæ–‡ï¼‰è½¬æˆå­—ç¬¦ä¸²ã€‚</p><p>æ¥è‡ª <code>&lt;http://www.ruanyifeng.com/blog/2018/07/json_web_token-tutorial.html&gt;</code></p><ol start="2"><li>Payload éƒ¨åˆ†ä¹Ÿæ˜¯ä¸€ä¸ª JSON å¯¹è±¡ï¼Œç”¨æ¥å­˜æ”¾å®é™…éœ€è¦ä¼ é€’çš„æ•°æ®ã€‚JWT è§„å®šäº†7ä¸ªå®˜æ–¹å­—æ®µï¼Œä¾›é€‰ç”¨ã€‚</li></ol><ul><li>iss (issuer)ï¼šç­¾å‘äºº</li><li>exp (expiration time)ï¼šè¿‡æœŸæ—¶é—´</li><li>sub (subject)ï¼šä¸»é¢˜</li><li>aud (audience)ï¼šå—ä¼—</li><li>nbf (Not Before)ï¼šç”Ÿæ•ˆæ—¶é—´</li><li>iat (Issued At)ï¼šç­¾å‘æ—¶é—´</li><li>jti (JWT ID)ï¼šç¼–å·</li></ul><p>é™¤äº†å®˜æ–¹å­—æ®µï¼Œä½ è¿˜å¯ä»¥åœ¨è¿™ä¸ªéƒ¨åˆ†å®šä¹‰ç§æœ‰å­—æ®µï¼Œä¸‹é¢å°±æ˜¯ä¸€ä¸ªä¾‹å­ã€‚</p><div class="highlight"><pre style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4" tabindex="0"><code class="language-json" data-lang="json"><span style="display:flex"><span>{
</span></span><span style="display:flex"><span>  <span style="color:#7ee787">"sub"</span>: <span style="color:#a5d6ff">"1234567890"</span>,
</span></span><span style="display:flex"><span>  <span style="color:#7ee787">"name"</span>: <span style="color:#a5d6ff">"John Doe"</span>,
</span></span><span style="display:flex"><span>  <span style="color:#7ee787">"admin"</span>: <span style="color:#79c0ff">true</span>
</span></span><span style="display:flex"><span>}
</span></span></code></pre></div><p>æ³¨æ„ï¼ŒJWT é»˜è®¤æ˜¯ä¸åŠ å¯†çš„ï¼Œä»»ä½•äººéƒ½å¯ä»¥è¯»åˆ°ï¼Œæ‰€ä»¥ä¸è¦æŠŠç§˜å¯†ä¿¡æ¯æ”¾åœ¨è¿™ä¸ªéƒ¨åˆ†ã€‚
è¿™ä¸ª JSON å¯¹è±¡ä¹Ÿè¦ä½¿ç”¨ Base64URL ç®—æ³•è½¬æˆå­—ç¬¦ä¸²ã€‚</p><ol start="3"><li><p>Signature éƒ¨åˆ†æ˜¯å¯¹å‰ä¸¤éƒ¨åˆ†çš„ç­¾åï¼Œé˜²æ­¢æ•°æ®ç¯¡æ”¹ã€‚</p><p>é¦–å…ˆï¼Œéœ€è¦æŒ‡å®šä¸€ä¸ªå¯†é’¥ï¼ˆsecretï¼‰ã€‚è¿™ä¸ªå¯†é’¥åªæœ‰æœåŠ¡å™¨æ‰çŸ¥é“ï¼Œä¸èƒ½æ³„éœ²ç»™ç”¨æˆ·ã€‚ç„¶åï¼Œä½¿ç”¨ Header é‡Œé¢æŒ‡å®šçš„ç­¾åç®—æ³•ï¼ˆé»˜è®¤æ˜¯ HMAC SHA256ï¼‰ï¼ŒæŒ‰ç…§ä¸‹é¢çš„å…¬å¼äº§ç”Ÿç­¾åã€‚</p></li></ol><div class="highlight"><pre style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4" tabindex="0"><code class="language-gdscript3" data-lang="gdscript3"><span style="display:flex"><span>HMACSHA256(
</span></span><span style="display:flex"><span>  base64UrlEncode(header) <span style="color:#ff7b72;font-weight:700">+</span> <span style="color:#a5d6ff">"."</span> <span style="color:#ff7b72;font-weight:700">+</span>
</span></span><span style="display:flex"><span>  base64UrlEncode(payload),
</span></span><span style="display:flex"><span>  secret)
</span></span></code></pre></div><p>ç®—å‡ºç­¾åä»¥åï¼ŒæŠŠ Headerã€Payloadã€Signature ä¸‰ä¸ªéƒ¨åˆ†æ‹¼æˆä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œæ¯ä¸ªéƒ¨åˆ†ä¹‹é—´ç”¨"ç‚¹â€ï¼ˆ.ï¼‰åˆ†éš”ï¼Œå°±å¯ä»¥è¿”å›ç»™ç”¨æˆ·ã€‚</p><blockquote><p>å‰é¢æåˆ°ï¼ŒHeader å’Œ Payload ä¸²å‹åŒ–çš„ç®—æ³•æ˜¯ Base64URLã€‚è¿™ä¸ªç®—æ³•è·Ÿ Base64 ç®—æ³•åŸºæœ¬ç±»ä¼¼ï¼Œä½†æœ‰ä¸€äº›å°çš„ä¸åŒã€‚</p><p>JWT ä½œä¸ºä¸€ä¸ªä»¤ç‰Œï¼ˆtokenï¼‰ï¼Œæœ‰äº›åœºåˆå¯èƒ½ä¼šæ”¾åˆ° URLï¼ˆæ¯”å¦‚ <code>api.example.com/?token=xxx</code>ï¼‰ã€‚Base64 æœ‰ä¸‰ä¸ªå­—ç¬¦+ã€/å’Œ=ï¼Œåœ¨ URL é‡Œé¢æœ‰ç‰¹æ®Šå«ä¹‰ï¼Œæ‰€ä»¥è¦è¢«æ›¿æ¢æ‰ï¼š=è¢«çœç•¥ã€+æ›¿æ¢æˆ-ï¼Œ/æ›¿æ¢æˆ_Â ã€‚è¿™å°±æ˜¯ Base64URL ç®—æ³•ã€‚</p></blockquote><p>å®¢æˆ·ç«¯æ”¶åˆ°æœåŠ¡å™¨è¿”å›çš„ JWTï¼Œå¯ä»¥å‚¨å­˜åœ¨ Cookie é‡Œé¢ï¼Œä¹Ÿå¯ä»¥å‚¨å­˜åœ¨ localStorageã€‚</p><p>æ­¤åï¼Œå®¢æˆ·ç«¯æ¯æ¬¡ä¸æœåŠ¡å™¨é€šä¿¡ï¼Œéƒ½è¦å¸¦ä¸Šè¿™ä¸ª JWTã€‚ä½ å¯ä»¥æŠŠå®ƒæ”¾åœ¨ Cookie é‡Œé¢è‡ªåŠ¨å‘é€ï¼Œä½†æ˜¯è¿™æ ·ä¸èƒ½è·¨åŸŸï¼Œæ‰€ä»¥æ›´å¥½çš„åšæ³•æ˜¯æ”¾åœ¨ HTTP è¯·æ±‚çš„å¤´ä¿¡æ¯Authorizationå­—æ®µé‡Œé¢ã€‚</p><p><code>Authorization: Bearer &lt;token&gt;</code>
å¦ä¸€ç§åšæ³•æ˜¯ï¼Œè·¨åŸŸçš„æ—¶å€™ï¼ŒJWT å°±æ”¾åœ¨ POST è¯·æ±‚çš„æ•°æ®ä½“é‡Œé¢ã€‚</p><ol start="4"><li><p>JWT çš„å‡ ä¸ªç‰¹ç‚¹</p><p>ï¼ˆ1ï¼‰JWT é»˜è®¤æ˜¯ä¸åŠ å¯†ï¼Œä½†ä¹Ÿæ˜¯å¯ä»¥åŠ å¯†çš„ã€‚ç”ŸæˆåŸå§‹ Token ä»¥åï¼Œå¯ä»¥ç”¨å¯†é’¥å†åŠ å¯†ä¸€æ¬¡ã€‚</p><p>ï¼ˆ2ï¼‰JWT ä¸åŠ å¯†çš„æƒ…å†µä¸‹ï¼Œä¸èƒ½å°†ç§˜å¯†æ•°æ®å†™å…¥ JWTã€‚</p><p>ï¼ˆ3ï¼‰JWT ä¸ä»…å¯ä»¥ç”¨äºè®¤è¯ï¼Œä¹Ÿå¯ä»¥ç”¨äºäº¤æ¢ä¿¡æ¯ã€‚æœ‰æ•ˆä½¿ç”¨ JWTï¼Œå¯ä»¥é™ä½æœåŠ¡å™¨æŸ¥è¯¢æ•°æ®åº“çš„æ¬¡æ•°ã€‚</p><p>ï¼ˆ4ï¼‰JWT çš„æœ€å¤§ç¼ºç‚¹æ˜¯ï¼Œç”±äºæœåŠ¡å™¨ä¸ä¿å­˜ session çŠ¶æ€ï¼Œå› æ­¤æ— æ³•åœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­åºŸæ­¢æŸä¸ª tokenï¼Œæˆ–è€…æ›´æ”¹ token çš„æƒé™ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸€æ—¦ JWT ç­¾å‘äº†ï¼Œåœ¨åˆ°æœŸä¹‹å‰å°±ä¼šå§‹ç»ˆæœ‰æ•ˆï¼Œé™¤éæœåŠ¡å™¨éƒ¨ç½²é¢å¤–çš„é€»è¾‘ã€‚</p><p>ï¼ˆ5ï¼‰JWT æœ¬èº«åŒ…å«äº†è®¤è¯ä¿¡æ¯ï¼Œä¸€æ—¦æ³„éœ²ï¼Œä»»ä½•äººéƒ½å¯ä»¥è·å¾—è¯¥ä»¤ç‰Œçš„æ‰€æœ‰æƒé™ã€‚ä¸ºäº†å‡å°‘ç›—ç”¨ï¼ŒJWT çš„æœ‰æ•ˆæœŸåº”è¯¥è®¾ç½®å¾—æ¯”è¾ƒçŸ­ã€‚å¯¹äºä¸€äº›æ¯”è¾ƒé‡è¦çš„æƒé™ï¼Œä½¿ç”¨æ—¶åº”è¯¥å†æ¬¡å¯¹ç”¨æˆ·è¿›è¡Œè®¤è¯ã€‚</p><p>ï¼ˆ6ï¼‰ä¸ºäº†å‡å°‘ç›—ç”¨ï¼ŒJWT ä¸åº”è¯¥ä½¿ç”¨ HTTP åè®®æ˜ç ä¼ è¾“ï¼Œè¦ä½¿ç”¨ HTTPS åè®®ä¼ è¾“ã€‚
æ¥è‡ª <code>&lt;http://www.ruanyifeng.com/blog/2018/07/json_web_token-tutorial.html&gt;</code></p></li></ol><h1 id="6-springçš„è§£å†³å¾ªç¯ä¾èµ–é—®é¢˜">6. springçš„è§£å†³å¾ªç¯ä¾èµ–é—®é¢˜<a aria-hidden="true" class="anchor" hidden="" href="#6-springçš„è§£å†³å¾ªç¯ä¾èµ–é—®é¢˜">#</a></h1><p>Spring beanå¾ªç¯ä¾èµ–å³å¾ªç¯å¼•ç”¨ã€‚æ˜¯æŒ‡2ä¸ªæˆ–ä»¥ä¸Šbean äº’ç›¸æŒæœ‰å¯¹æ–¹ï¼Œæœ€ç»ˆå½¢æˆé—­ç¯ã€‚æ¯”å¦‚Aä¾èµ–äºBï¼ŒBä¾èµ–Aã€‚</p><p>äº§ç”Ÿå¾ªç¯ä¾èµ–çš„æ–¹å¼æœ‰ä¸¤ç§ï¼Œä¸€ç§æ˜¯é€šè¿‡æ„é€ å™¨æ³¨å…¥å½¢æˆçš„å¾ªç¯ä¾èµ–ï¼Œç¬¬äºŒç§æ˜¯é€šè¿‡fieldå±æ€§æ³¨å…¥å½¢æˆçš„å¾ªç¯ä¾èµ–ã€‚</p><p>Springé€šè¿‡ç‰¹æ®Šçš„beanç”Ÿæˆæœºåˆ¶è§£å†³äº†ç¬¬äºŒç§æ–¹å¼äº§ç”Ÿçš„å¾ªç¯ä¾èµ–é—®é¢˜ï¼Œä½¿å¾—å¾ªç¯é“¾çš„æ‰€æœ‰beanå¯¹è±¡éƒ½èƒ½æ­£ç¡®åˆ›å»ºï¼Œè€Œæ„é€ å™¨æ³¨å…¥æ–¹å¼é˜é‡Šçš„å¾ªç¯ä¾èµ–åˆ™ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚ä¸¤è€…ä¹‹é—´çš„å·®å¼‚èƒ½åœ¨beanåˆ›å»ºæœºåˆ¶ä¸­å¾—åˆ°è§£é‡Šã€‚</p><p>æ€»çš„æ¥è¯´ï¼ŒSpringè§£å†³å¾ªç¯ä¾èµ–é—®é¢˜æ˜¯é€šè¿‡<strong>ç»“åˆbeanå®ä¾‹åŒ–å’Œbeanå±æ€§å¡«è£…åˆ†ç¦»</strong>ï¼ŒsingletonObjectsã€earlySingletonObjects ã€singletonFactories ä¸‰çº§ç¼“å­˜æœºåˆ¶å’Œå¼•ç”¨æå‰æš´éœ²æœºåˆ¶å®ç°çš„ã€‚</p><blockquote><p>åŸæ–‡é“¾æ¥ï¼šhttps://blog.csdn.net/panda9527z/article/details/107359916</p></blockquote><div class="highlight"><pre style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4" tabindex="0"><code class="language-java" data-lang="java"><span style="display:flex"><span>org.springframework.beans.factory.support.DefaultSingletonBeanRegistry<span style="color:#f85149">#</span>getSingleton(java.lang.String,<span style="color:#6e7681"> </span><span style="color:#ff7b72">boolean</span>)<span style="color:#6e7681">
</span></span></span><span style="display:flex"><span><span style="color:#6e7681">
</span></span></span><span style="display:flex"><span><span style="color:#6e7681"></span><span style="color:#8b949e;font-style:italic">/** ä¸€çº§ç¼“å­˜ï¼Œä¿å­˜singletonBeanå®ä¾‹: bean name --&gt; bean instance */</span><span style="color:#6e7681">
</span></span></span><span style="display:flex"><span><span style="color:#6e7681"></span><span style="color:#ff7b72">private</span><span style="color:#6e7681"> </span><span style="color:#ff7b72">final</span><span style="color:#6e7681"> </span>Map<span style="color:#ff7b72;font-weight:700">&lt;</span>String,<span style="color:#6e7681"> </span>Object<span style="color:#ff7b72;font-weight:700">&gt;</span><span style="color:#6e7681"> </span>singletonObjects<span style="color:#6e7681"> </span><span style="color:#ff7b72;font-weight:700">=</span><span style="color:#6e7681"> </span><span style="color:#ff7b72">new</span><span style="color:#6e7681"> </span>ConcurrentHashMap<span style="color:#ff7b72;font-weight:700">&lt;</span>String,<span style="color:#6e7681"> </span>Object<span style="color:#ff7b72;font-weight:700">&gt;</span>(256);<span style="color:#6e7681">
</span></span></span><span style="display:flex"><span><span style="color:#6e7681">
</span></span></span><span style="display:flex"><span><span style="color:#6e7681"></span><span style="color:#8b949e;font-style:italic">/** äºŒçº§ç¼“å­˜ï¼Œä¿å­˜åˆ›å»ºå¥½ä½†æ²¡æœ‰åˆå§‹åŒ–å±æ€§çš„Bean : bean name --&gt; bean instance */</span><span style="color:#6e7681">
</span></span></span><span style="display:flex"><span><span style="color:#6e7681"></span><span style="color:#ff7b72">private</span><span style="color:#6e7681"> </span><span style="color:#ff7b72">final</span><span style="color:#6e7681"> </span>Map<span style="color:#ff7b72;font-weight:700">&lt;</span>String,<span style="color:#6e7681"> </span>Object<span style="color:#ff7b72;font-weight:700">&gt;</span><span style="color:#6e7681"> </span>earlySingletonObjects<span style="color:#6e7681"> </span><span style="color:#ff7b72;font-weight:700">=</span><span style="color:#6e7681"> </span><span style="color:#ff7b72">new</span><span style="color:#6e7681"> </span>HashMap<span style="color:#ff7b72;font-weight:700">&lt;</span>String,<span style="color:#6e7681"> </span>Object<span style="color:#ff7b72;font-weight:700">&gt;</span>(16);<span style="color:#6e7681"> 
</span></span></span><span style="display:flex"><span><span style="color:#6e7681">
</span></span></span><span style="display:flex"><span><span style="color:#6e7681"></span><span style="color:#8b949e;font-style:italic">/** ä¸‰çº§ç¼“å­˜ï¼Œä¿å­˜singletonBeanç”Ÿäº§å·¥å‚: bean name --&gt; ObjectFactory */</span><span style="color:#6e7681">
</span></span></span><span style="display:flex"><span><span style="color:#6e7681"></span><span style="color:#ff7b72">private</span><span style="color:#6e7681"> </span><span style="color:#ff7b72">final</span><span style="color:#6e7681"> </span>Map<span style="color:#ff7b72;font-weight:700">&lt;</span>String,<span style="color:#6e7681"> </span>ObjectFactory<span style="color:#ff7b72;font-weight:700">&lt;?&gt;&gt;</span><span style="color:#6e7681"> </span>singletonFactories<span style="color:#6e7681"> </span><span style="color:#ff7b72;font-weight:700">=</span><span style="color:#6e7681"> </span><span style="color:#ff7b72">new</span><span style="color:#6e7681"> </span>HashMap<span style="color:#ff7b72;font-weight:700">&lt;</span>String,<span style="color:#6e7681"> </span>ObjectFactory<span style="color:#ff7b72;font-weight:700">&lt;?&gt;&gt;</span>(16);<span style="color:#6e7681">
</span></span></span><span style="display:flex"><span><span style="color:#6e7681">
</span></span></span><span style="display:flex"><span><span style="color:#6e7681">
</span></span></span><span style="display:flex"><span><span style="color:#6e7681"></span><span style="color:#ff7b72">protected</span><span style="color:#6e7681"> </span>Object<span style="color:#6e7681"> </span><span style="color:#d2a8ff;font-weight:700">getSingleton</span>(String<span style="color:#6e7681"> </span>beanName,<span style="color:#6e7681"> </span><span style="color:#ff7b72">boolean</span><span style="color:#6e7681"> </span>allowEarlyReference)<span style="color:#6e7681"> </span>{<span style="color:#6e7681">
</span></span></span><span style="display:flex"><span><span style="color:#6e7681">    </span><span style="color:#8b949e;font-style:italic">// æŸ¥è¯¢ä¸€çº§ç¼“å­˜</span><span style="color:#6e7681">
</span></span></span><span style="display:flex"><span><span style="color:#6e7681">    </span>Object<span style="color:#6e7681"> </span>singletonObject<span style="color:#6e7681"> </span><span style="color:#ff7b72;font-weight:700">=</span><span style="color:#6e7681"> </span><span style="color:#ff7b72">this</span>.singletonObjects.get(beanName);<span style="color:#6e7681">
</span></span></span><span style="display:flex"><span><span style="color:#6e7681">    </span><span style="color:#ff7b72">if</span><span style="color:#6e7681"> </span>(singletonObject<span style="color:#6e7681"> </span><span style="color:#ff7b72;font-weight:700">==</span><span style="color:#6e7681"> </span><span style="color:#79c0ff">null</span><span style="color:#6e7681"> </span><span style="color:#ff7b72;font-weight:700">&amp;&amp;</span><span style="color:#6e7681"> </span>isSingletonCurrentlyInCreation(beanName))<span style="color:#6e7681"> </span>{<span style="color:#6e7681">
</span></span></span><span style="display:flex"><span><span style="color:#6e7681">        </span><span style="color:#ff7b72">synchronized</span><span style="color:#6e7681"> </span>(<span style="color:#ff7b72">this</span>.singletonObjects)<span style="color:#6e7681"> </span>{<span style="color:#6e7681">
</span></span></span><span style="display:flex"><span><span style="color:#6e7681">            </span><span style="color:#8b949e;font-style:italic">//è‹¥ä¸€çº§ç¼“å­˜å†…ä¸å­˜åœ¨ï¼ŒæŸ¥è¯¢äºŒçº§ç¼“å­˜</span><span style="color:#6e7681">
</span></span></span><span style="display:flex"><span><span style="color:#6e7681">            </span>singletonObject<span style="color:#6e7681"> </span><span style="color:#ff7b72;font-weight:700">=</span><span style="color:#6e7681"> </span><span style="color:#ff7b72">this</span>.earlySingletonObjects.get(beanName);<span style="color:#6e7681">
</span></span></span><span style="display:flex"><span><span style="color:#6e7681">            </span><span style="color:#ff7b72">if</span><span style="color:#6e7681"> </span>(singletonObject<span style="color:#6e7681"> </span><span style="color:#ff7b72;font-weight:700">==</span><span style="color:#6e7681"> </span><span style="color:#79c0ff">null</span><span style="color:#6e7681"> </span><span style="color:#ff7b72;font-weight:700">&amp;&amp;</span><span style="color:#6e7681"> </span>allowEarlyReference)<span style="color:#6e7681"> </span>{<span style="color:#6e7681">
</span></span></span><span style="display:flex"><span><span style="color:#6e7681">                </span><span style="color:#8b949e;font-style:italic">//è‹¥äºŒçº§ç¼“å­˜å†…ä¸å­˜åœ¨ï¼ŒæŸ¥è¯¢ä¸‰çº§ç¼“å­˜</span><span style="color:#6e7681">
</span></span></span><span style="display:flex"><span><span style="color:#6e7681">                </span>ObjectFactory<span style="color:#ff7b72;font-weight:700">&lt;?&gt;</span><span style="color:#6e7681"> </span>singletonFactory<span style="color:#6e7681"> </span><span style="color:#ff7b72;font-weight:700">=</span><span style="color:#6e7681"> </span><span style="color:#ff7b72">this</span>.singletonFactories.get(beanName);<span style="color:#6e7681">
</span></span></span><span style="display:flex"><span><span style="color:#6e7681">                </span><span style="color:#ff7b72">if</span><span style="color:#6e7681"> </span>(singletonFactory<span style="color:#6e7681"> </span><span style="color:#ff7b72;font-weight:700">!=</span><span style="color:#6e7681"> </span><span style="color:#79c0ff">null</span>)<span style="color:#6e7681"> </span>{<span style="color:#6e7681">
</span></span></span><span style="display:flex"><span><span style="color:#6e7681">                    </span><span style="color:#8b949e;font-style:italic">//è‹¥ä¸‰çº§ç¼“å­˜ä¸­çš„ï¼Œåˆ™é€šè¿‡å·¥å‚è·å¾—å¯¹è±¡ï¼Œå¹¶æ¸…é™¤ä¸‰çº§ç¼“å­˜ï¼Œæå‡è‡³äºŒçº§ç¼“å­˜</span><span style="color:#6e7681">
</span></span></span><span style="display:flex"><span><span style="color:#6e7681">                    </span>singletonObject<span style="color:#6e7681"> </span><span style="color:#ff7b72;font-weight:700">=</span><span style="color:#6e7681"> </span>singletonFactory.getObject();<span style="color:#6e7681">
</span></span></span><span style="display:flex"><span><span style="color:#6e7681">                    </span><span style="color:#ff7b72">this</span>.earlySingletonObjects.put(beanName,<span style="color:#6e7681"> </span>singletonObject);<span style="color:#6e7681">
</span></span></span><span style="display:flex"><span><span style="color:#6e7681">                    </span><span style="color:#ff7b72">this</span>.singletonFactories.remove(beanName);<span style="color:#6e7681">
</span></span></span><span style="display:flex"><span><span style="color:#6e7681">                </span>}<span style="color:#6e7681">
</span></span></span><span style="display:flex"><span><span style="color:#6e7681">            </span>}<span style="color:#6e7681">
</span></span></span><span style="display:flex"><span><span style="color:#6e7681">        </span>}<span style="color:#6e7681">
</span></span></span><span style="display:flex"><span><span style="color:#6e7681">    </span>}<span style="color:#6e7681">
</span></span></span><span style="display:flex"><span><span style="color:#6e7681">    </span><span style="color:#ff7b72">return</span><span style="color:#6e7681"> </span>(singletonObject<span style="color:#6e7681"> </span><span style="color:#ff7b72;font-weight:700">!=</span><span style="color:#6e7681"> </span>NULL_OBJECT<span style="color:#6e7681"> </span><span style="color:#ff7b72;font-weight:700">?</span><span style="color:#6e7681"> </span>singletonObject<span style="color:#6e7681"> </span>:<span style="color:#6e7681"> </span><span style="color:#79c0ff">null</span>);<span style="color:#6e7681">
</span></span></span><span style="display:flex"><span><span style="color:#6e7681"></span>}<span style="color:#6e7681">
</span></span></span></code></pre></div><p><strong>ä¸ºä»€ä¹ˆè¦ä¸‰çº§ç¼“å­˜å‘¢?(ä¸€çº§æˆ–äºŒçº§ä¸è¡Œå—)</strong></p><p>springå¤„ç†å¾ªç¯ä¾èµ–æ˜¯æŠŠbeançš„å®ä½“åŒ–å’Œå±æ€§è£…ç›˜åˆ†å¼€(å°±æ˜¯ å…ˆç”Ÿæˆå¯¹è±¡,å±æ€§ç­‰ä¼šå†è®¾ç½®),è¿™æ ·å¯ä»¥æŠŠå®ä½“ç±»æå‰æš´éœ²å‡ºå»,ç»™å…¶ä»–beanä½¿ç”¨,è¿™æ ·å°±è§£å†³äº†å¾ªç¯é—®é¢˜(æˆ‘å…ˆç»™ä½ ç”¨,è£…é…æ—¶ä½ åªå…³å¿ƒæˆ‘,ä¸å…³å¿ƒæˆ‘æ‰€æ‹¥æœ‰çš„å±æ€§)</p><p>æ—¢ç„¶å¦‚æ­¤,æˆ‘ç”¨ä¸€çº§ç¼“å­˜çš„ä¹Ÿæ˜¯å¯ä»¥,åªè¦æå‰æš´éœ²å°±è¡Œ,çš„ç¡®å¦‚æ­¤,ä½†è¿™æ ·,<u>ä¼šæŠŠå®Œæ•´çš„BEANå’Œä¸å®Œæ•´çš„BEAN(è¿˜æ²¡å®Œæˆå±æ€§è£…é…çš„BEAN)æ”¾ä¸€èµ·,é‚£å»å–çš„æ—¶å€™,æ— æ³•åŒºåˆ†</u>,å¦‚æœå–åˆ°æœªè£…é…çš„beanå°±å‡‰å‡‰äº†.</p><p>å¦‚æ­¤,éœ€è¦äºŒçº§ç¼“å­˜,å¤§éƒ¨åˆ†æƒ…å†µä¸‹,äºŒçº§ç¼“å­˜å°±è¶³å¤Ÿç”¨äº†,ä½†æ˜¯æœ‰ç§æƒ…å†µä¸‹ä¼šå‡ºé—®é¢˜,</p><p>ä¾‹å¦‚A-&gt;b-&gt;c-&gt;A , ä¸‰è€…å½¢æˆå¾ªç¯</p><p>æˆ‘å¯¹<u>bç±»åšäº†åˆ‡é¢(åˆ‡é¢ä¼šåˆ©ç”¨åŠ¨æ€ä»£ç†ç”Ÿæˆæ–°çš„ç±»),è¿™æ ·å¯¹beanæ± ä¸­å°±ä¼šä¸¤ä¸ªç±»,bç±»å’ŒåŠ¨æ€bç±»,ä½†springåˆæ˜¯å•ä¾‹bean,æ‰€ä»¥ä¼šæŠ›å¼‚å¸¸</u>,è¿™æ—¶éœ€è¦å†åŠ ä¸€å±‚ç¼“å­˜æ¥ä¿è¯è¿™ä¸€ç§,springåˆ©ç”¨å·¥å‚çš„æ–¹å¼æ¥å¤„ç†çš„.</p><blockquote><p><a href="https://my.oschina.net/u/4340310/blog/4332450" rel="noopener" target="_blank">https://my.oschina.net/u/4340310/blog/4332450</a></p><p><a href="https://blog.csdn.net/panda9527z/article/details/107359916" rel="noopener" target="_blank">https://blog.csdn.net/panda9527z/article/details/107359916</a></p><p><a href="https://zwmst.com/1844.html" rel="noopener" target="_blank">Springæ˜¯æ€ä¹ˆè§£å†³å¾ªç¯ä¾èµ–çš„ï¼Ÿ-Javaé¢è¯•é¢˜ (zwmst.com)</a></p></blockquote><h1 id="7futureæ¨¡å¼å’Œpromiseæ¨¡å¼">7.Futureæ¨¡å¼å’ŒPromiseæ¨¡å¼<a aria-hidden="true" class="anchor" hidden="" href="#7futureæ¨¡å¼å’Œpromiseæ¨¡å¼">#</a></h1><p><strong>Future:</strong></p><p>è¿™ä¸ªæ˜¯æ˜¯javaçš„concurrentå¹¶å‘åŒ…é‡Œé¢çš„æä¾›çš„ç±»ï¼Œä»–å’ŒCallableç±»å¸¸å¸¸ä¸€å—ä½¿ç”¨ã€‚Future è¡¨ç¤ºå¼‚æ­¥è®¡ç®—çš„ç»“æœã€‚å…¶ç”¨äºè·å–çº¿ç¨‹æ± æ‰§è¡Œcallableåçš„ç»“æœï¼Œè¿™ä¸ªç»“æœå°è£…ä¸ºFutureç±»ã€‚</p><p>å€¼å¾—ä¸€æçš„æ˜¯ï¼Œç”±äºFutureç±»è·å–è¿”å›ç»“æœçš„getæ–¹æ³•æ˜¯é˜»å¡çš„ï¼Œjdk1.8ä¸­åŠ å…¥completableFutureä½¿å¾—Futureå¯ä»¥æ³¨å†Œç›‘å¬å™¨ä»è€Œå®ç°ç±»ä¼¼JSä¸­çš„callbackåŠŸèƒ½ã€‚<u>è¿™ä¹Ÿæ˜¯å¼‚æ­¥ç¼–ç¨‹çš„æ¨èæ–¹å¼ï¼šå›è°ƒ</u>ã€‚</p><p><strong>Promise</strong></p><p>å›è°ƒæ˜¯ä¸€ç§æˆ‘ä»¬æ¨å´‡çš„å¼‚æ­¥è°ƒç”¨æ–¹å¼ï¼Œä½†ä¹Ÿä¼šé‡åˆ°é—®é¢˜ï¼Œä¹Ÿå°±æ˜¯å›è°ƒçš„åµŒå¥—ã€‚å½“éœ€è¦å¤šä¸ªå¼‚æ­¥å›è°ƒä¸€èµ·ä¹¦å†™æ—¶ï¼Œå°±ä¼šå‡ºç°ä¸‹é¢çš„ä»£ç  (ä»¥ js ä¸ºä¾‹):</p><div class="highlight"><pre style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4" tabindex="0"><code class="language-js" data-lang="js"><span style="display:flex"><span>asyncFunc1(opt, (...args1) =&gt; { 
</span></span><span style="display:flex"><span>  asyncFunc2(opt, (...args2) =&gt; {       
</span></span><span style="display:flex"><span>    asyncFunc3(opt, (...args3) =&gt; {            
</span></span><span style="display:flex"><span>      asyncFunc4(opt, (...args4) =&gt; {
</span></span><span style="display:flex"><span>          <span style="color:#8b949e;font-style:italic">// some operation
</span></span></span><span style="display:flex"><span><span style="color:#8b949e;font-style:italic"></span>      });
</span></span><span style="display:flex"><span>    });
</span></span><span style="display:flex"><span>  });
</span></span><span style="display:flex"><span>});
</span></span></code></pre></div><p>è¿™æ ·çš„ä»£ç ä¸æ˜“è¯»ï¼ŒåµŒå¥—å¤ªæ·±ä¿®æ”¹ä¹Ÿéº»çƒ¦ã€‚äºæ˜¯ ES6 æå‡ºäº† Promise æ¨¡å¼æ¥è§£å†³å›è°ƒåœ°ç‹±çš„é—®é¢˜ã€‚Promise æ˜¯ä¸€ä¸ª ECMAScript 6 æä¾›çš„ç±»ï¼Œç›®çš„æ˜¯æ›´åŠ ä¼˜é›…åœ°ä¹¦å†™å¤æ‚çš„å¼‚æ­¥ä»»åŠ¡ã€‚</p><div class="highlight"><pre style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4" tabindex="0"><code class="language-js" data-lang="js"><span style="display:flex"><span><span style="color:#ff7b72">new</span> Promise(<span style="color:#ff7b72">function</span> (resolve, reject) {
</span></span><span style="display:flex"><span>    console.log(<span style="color:#a5d6ff">1111</span>);
</span></span><span style="display:flex"><span>    resolve(<span style="color:#a5d6ff">2222</span>);
</span></span><span style="display:flex"><span>}).then(<span style="color:#ff7b72">function</span> (value) {
</span></span><span style="display:flex"><span>    console.log(value);
</span></span><span style="display:flex"><span>    <span style="color:#ff7b72">return</span> <span style="color:#a5d6ff">3333</span>;
</span></span><span style="display:flex"><span>}).then(<span style="color:#ff7b72">function</span> (value) {
</span></span><span style="display:flex"><span>    console.log(value);
</span></span><span style="display:flex"><span>    <span style="color:#ff7b72">throw</span> <span style="color:#a5d6ff">"An error"</span>;
</span></span><span style="display:flex"><span>}).<span style="color:#ff7b72">catch</span>(<span style="color:#ff7b72">function</span> (err) {
</span></span><span style="display:flex"><span>    console.log(err);
</span></span><span style="display:flex"><span>});
</span></span></code></pre></div><p>JDK8 ä¸­ completableFuture ç±»æ¥è§£å†³åµŒå¥—å›è°ƒé—®é¢˜, ä½¿ç”¨<code>thenCompose</code> å’Œ <code>whenComplete</code> è¿™ç±»å¤„ç†</p><div class="highlight"><pre style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4" tabindex="0"><code class="language-java" data-lang="java"><span style="display:flex"><span><span style="color:#ff7b72">public</span><span style="color:#6e7681"> </span><span style="color:#ff7b72">class</span> <span style="color:#f0883e;font-weight:700">CompletableFutureDemo</span><span style="color:#6e7681"> </span>{<span style="color:#6e7681">
</span></span></span><span style="display:flex"><span><span style="color:#6e7681">    </span><span style="color:#ff7b72">public</span><span style="color:#6e7681"> </span><span style="color:#ff7b72">static</span><span style="color:#6e7681"> </span><span style="color:#ff7b72">void</span><span style="color:#6e7681"> </span><span style="color:#d2a8ff;font-weight:700">main</span>(String<span style="color:#ff7b72;font-weight:700">[]</span><span style="color:#6e7681"> </span>args)<span style="color:#6e7681"> </span><span style="color:#ff7b72">throws</span><span style="color:#6e7681"> </span>InterruptedException<span style="color:#6e7681"> </span>{<span style="color:#6e7681">
</span></span></span><span style="display:flex"><span><span style="color:#6e7681">        </span><span style="color:#ff7b72">long</span><span style="color:#6e7681"> </span>l<span style="color:#6e7681"> </span><span style="color:#ff7b72;font-weight:700">=</span><span style="color:#6e7681"> </span>System.currentTimeMillis();<span style="color:#6e7681">
</span></span></span><span style="display:flex"><span><span style="color:#6e7681">        </span>CompletableFuture<span style="color:#ff7b72;font-weight:700">&lt;</span>Integer<span style="color:#ff7b72;font-weight:700">&gt;</span><span style="color:#6e7681"> </span>completableFuture<span style="color:#6e7681"> </span><span style="color:#ff7b72;font-weight:700">=</span><span style="color:#6e7681"> </span>CompletableFuture.supplyAsync(()<span style="color:#6e7681"> </span><span style="color:#ff7b72;font-weight:700">-&gt;</span><span style="color:#6e7681"> </span>{<span style="color:#6e7681">
</span></span></span><span style="display:flex"><span><span style="color:#6e7681">            </span>System.out.println(<span style="color:#a5d6ff">"åœ¨å›è°ƒä¸­æ‰§è¡Œè€—æ—¶æ“ä½œ..."</span>);<span style="color:#6e7681">
</span></span></span><span style="display:flex"><span><span style="color:#6e7681">            </span>timeConsumingOperation();<span style="color:#6e7681">
</span></span></span><span style="display:flex"><span><span style="color:#6e7681">            </span><span style="color:#ff7b72">return</span><span style="color:#6e7681"> </span>100;<span style="color:#6e7681">
</span></span></span><span style="display:flex"><span><span style="color:#6e7681">        </span>});<span style="color:#6e7681">
</span></span></span><span style="display:flex"><span><span style="color:#6e7681">        </span>completableFuture<span style="color:#6e7681"> </span><span style="color:#ff7b72;font-weight:700">=</span><span style="color:#6e7681"> </span>completableFuture.thenCompose(i<span style="color:#6e7681"> </span><span style="color:#ff7b72;font-weight:700">-&gt;</span><span style="color:#6e7681"> </span>{<span style="color:#6e7681">
</span></span></span><span style="display:flex"><span><span style="color:#6e7681">            </span><span style="color:#ff7b72">return</span><span style="color:#6e7681"> </span>CompletableFuture.supplyAsync(()<span style="color:#6e7681"> </span><span style="color:#ff7b72;font-weight:700">-&gt;</span><span style="color:#6e7681"> </span>{<span style="color:#6e7681">
</span></span></span><span style="display:flex"><span><span style="color:#6e7681">                </span>System.out.println(<span style="color:#a5d6ff">"åœ¨å›è°ƒçš„å›è°ƒä¸­æ‰§è¡Œè€—æ—¶æ“ä½œ..."</span>);<span style="color:#6e7681">
</span></span></span><span style="display:flex"><span><span style="color:#6e7681">                </span>timeConsumingOperation();<span style="color:#6e7681">
</span></span></span><span style="display:flex"><span><span style="color:#6e7681">                </span><span style="color:#ff7b72">return</span><span style="color:#6e7681"> </span>i<span style="color:#6e7681"> </span><span style="color:#ff7b72;font-weight:700">+</span><span style="color:#6e7681"> </span>100;<span style="color:#6e7681">
</span></span></span><span style="display:flex"><span><span style="color:#6e7681">            </span>});<span style="color:#6e7681">
</span></span></span><span style="display:flex"><span><span style="color:#6e7681">        </span>});<span style="color:#8b949e;font-style:italic">//&lt;1&gt;</span><span style="color:#6e7681">
</span></span></span><span style="display:flex"><span><span style="color:#6e7681">        </span>completableFuture.whenComplete((result,e)<span style="color:#ff7b72;font-weight:700">-&gt;</span>{<span style="color:#6e7681">
</span></span></span><span style="display:flex"><span><span style="color:#6e7681">            </span>System.out.println(<span style="color:#a5d6ff">"è®¡ç®—ç»“æœ:"</span><span style="color:#6e7681"> </span><span style="color:#ff7b72;font-weight:700">+</span><span style="color:#6e7681"> </span>result);<span style="color:#6e7681">
</span></span></span><span style="display:flex"><span><span style="color:#6e7681">        </span>});<span style="color:#6e7681">
</span></span></span><span style="display:flex"><span><span style="color:#6e7681">        </span>System.out.println(<span style="color:#a5d6ff">"ä¸»çº¿ç¨‹è¿ç®—è€—æ—¶:"</span><span style="color:#6e7681"> </span><span style="color:#ff7b72;font-weight:700">+</span><span style="color:#6e7681"> </span>(System.currentTimeMillis()<span style="color:#6e7681"> </span><span style="color:#ff7b72;font-weight:700">-</span><span style="color:#6e7681"> </span>l)<span style="color:#6e7681"> </span><span style="color:#ff7b72;font-weight:700">+</span><span style="color:#6e7681"> </span><span style="color:#a5d6ff">" ms"</span>);<span style="color:#6e7681">
</span></span></span><span style="display:flex"><span><span style="color:#6e7681">        </span><span style="color:#ff7b72">new</span><span style="color:#6e7681"> </span>CountDownLatch(1).await();<span style="color:#6e7681">
</span></span></span><span style="display:flex"><span><span style="color:#6e7681">    </span>}<span style="color:#6e7681">
</span></span></span><span style="display:flex"><span><span style="color:#6e7681">
</span></span></span><span style="display:flex"><span><span style="color:#6e7681">    </span><span style="color:#ff7b72">static</span><span style="color:#6e7681"> </span><span style="color:#ff7b72">void</span><span style="color:#6e7681"> </span><span style="color:#d2a8ff;font-weight:700">timeConsumingOperation</span>()<span style="color:#6e7681"> </span>{<span style="color:#6e7681">
</span></span></span><span style="display:flex"><span><span style="color:#6e7681">        </span><span style="color:#ff7b72">try</span><span style="color:#6e7681"> </span>{<span style="color:#6e7681">
</span></span></span><span style="display:flex"><span><span style="color:#6e7681">            </span>Thread.sleep(3000);<span style="color:#6e7681">
</span></span></span><span style="display:flex"><span><span style="color:#6e7681">        </span>}<span style="color:#6e7681"> </span><span style="color:#ff7b72">catch</span><span style="color:#6e7681"> </span>(Exception<span style="color:#6e7681"> </span>e)<span style="color:#6e7681"> </span>{<span style="color:#6e7681">
</span></span></span><span style="display:flex"><span><span style="color:#6e7681">            </span>e.printStackTrace();<span style="color:#6e7681">
</span></span></span><span style="display:flex"><span><span style="color:#6e7681">        </span>}<span style="color:#6e7681">
</span></span></span><span style="display:flex"><span><span style="color:#6e7681">    </span>}<span style="color:#6e7681">
</span></span></span><span style="display:flex"><span><span style="color:#6e7681"></span>}<span style="color:#6e7681">
</span></span></span></code></pre></div><blockquote><p>&lt;1&gt; : ä½¿ç”¨ thenCompose æˆ–è€… thenComposeAsync ç­‰æ–¹æ³•å¯ä»¥å®ç°å›è°ƒçš„å›è°ƒï¼Œä¸”å†™å‡ºæ¥çš„æ–¹æ³•æ˜“äºç»´æŠ¤ã€‚</p></blockquote><blockquote><p><a href="https://www.jianshu.com/p/778c127f3623" rel="noopener" target="_blank">ç®€è¿°</a></p><p><a href="https://cloud.tencent.com/developer/article/1110576" rel="noopener" target="_blank">è¯¦è§£</a></p></blockquote><h1 id="8-å“åº”å¼å’Œå‡½æ•°å¼">8. å“åº”å¼å’Œå‡½æ•°å¼<a aria-hidden="true" class="anchor" hidden="" href="#8-å“åº”å¼å’Œå‡½æ•°å¼">#</a></h1><p><strong>å“åº”å¼ç¼–ç¨‹æœ‰ä»¥ä¸‹å‡ ä¸ªç‰¹ç‚¹ï¼š</strong></p><ul><li>å¼‚æ­¥ç¼–ç¨‹ï¼šæä¾›äº†åˆé€‚çš„å¼‚æ­¥ç¼–ç¨‹æ¨¡å‹ï¼Œèƒ½å¤ŸæŒ–æ˜å¤šæ ¸CPUçš„èƒ½åŠ›ã€æé«˜æ•ˆç‡ã€é™ä½å»¶è¿Ÿå’Œé˜»å¡ç­‰ã€‚</li><li>æ•°æ®æµï¼šåŸºäºæ•°æ®æµæ¨¡å‹ï¼Œå“åº”å¼ç¼–ç¨‹æä¾›ä¸€å¥—ç»Ÿä¸€çš„Streamé£æ ¼çš„æ•°æ®å¤„ç†æ¥å£ã€‚å’ŒJava 8ä¸­çš„Streamç›¸æ¯”ï¼Œå“åº”å¼ç¼–ç¨‹é™¤äº†æ”¯æŒé™æ€æ•°æ®æµï¼Œè¿˜æ”¯æŒåŠ¨æ€æ•°æ®æµï¼Œå¹¶ä¸”å…è®¸å¤ç”¨å’ŒåŒæ—¶æ¥å…¥å¤šä¸ªè®¢é˜…è€…ã€‚</li><li>å˜åŒ–ä¼ æ’­ï¼šç®€å•æ¥è¯´å°±æ˜¯ä»¥ä¸€ä¸ªæ•°æ®æµä¸ºè¾“å…¥ï¼Œç»è¿‡ä¸€è¿ä¸²æ“ä½œè½¬åŒ–ä¸ºå¦ä¸€ä¸ªæ•°æ®æµï¼Œç„¶ååˆ†å‘ç»™å„ä¸ªè®¢é˜…è€…çš„è¿‡ç¨‹ã€‚è¿™å°±æœ‰ç‚¹åƒå‡½æ•°å¼ç¼–ç¨‹ä¸­çš„ç»„åˆå‡½æ•°ï¼Œå°†å¤šä¸ªå‡½æ•°ä¸²è”èµ·æ¥ï¼ŒæŠŠä¸€ç»„è¾“å…¥æ•°æ®è½¬åŒ–ä¸ºæ ¼å¼è¿¥å¼‚çš„è¾“å‡ºæ•°æ®ã€‚</li></ul><p><strong>å‡½æ•°å¼ç¼–ç¨‹çš„ç‰¹ç‚¹ï¼š</strong></p><ul><li>å‡½æ•°æ˜¯"ç¬¬ä¸€ç­‰å…¬æ°‘â€ï¼šæ‰€è°“"ç¬¬ä¸€ç­‰å…¬æ°‘â€ï¼ˆfirst classï¼‰ï¼ŒæŒ‡çš„æ˜¯å‡½æ•°ä¸å…¶ä»–æ•°æ®ç±»å‹ä¸€æ ·ï¼Œå¤„äºå¹³ç­‰åœ°ä½ï¼Œå¯ä»¥èµ‹å€¼ç»™å…¶ä»–å˜é‡ï¼Œä¹Ÿå¯ä»¥ä½œä¸ºå‚æ•°ï¼Œä¼ å…¥å¦ä¸€ä¸ªå‡½æ•°ï¼Œæˆ–è€…ä½œä¸ºåˆ«çš„å‡½æ•°çš„è¿”å›å€¼ã€‚</li><li>é—­åŒ…å’Œé«˜é˜¶å‡½æ•°ï¼šé—­åŒ…æ˜¯èµ·å‡½æ•°çš„ä½œç”¨å¹¶å¯ä»¥åƒå¯¹è±¡ä¸€æ ·æ“ä½œçš„å¯¹è±¡ã€‚ä¸æ­¤ç±»ä¼¼ï¼ŒFP è¯­è¨€æ”¯æŒé«˜é˜¶å‡½æ•°ã€‚é«˜é˜¶å‡½æ•°å¯ä»¥ç”¨å¦ä¸€ä¸ªå‡½æ•°ï¼ˆé—´æ¥åœ°ï¼Œç”¨ä¸€ä¸ªè¡¨è¾¾å¼ï¼‰ ä½œä¸ºå…¶è¾“å…¥å‚æ•°ï¼Œåœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå®ƒç”šè‡³è¿”å›ä¸€ä¸ªå‡½æ•°ä½œä¸ºå…¶è¾“å‡ºå‚æ•°ã€‚è¿™ä¸¤ç§ç»“æ„ç»“åˆåœ¨ä¸€èµ·ä½¿å¾—å¯ä»¥ç”¨ä¼˜é›…çš„æ–¹å¼è¿›è¡Œæ¨¡å—åŒ–ç¼–ç¨‹ï¼Œè¿™æ˜¯ä½¿ç”¨ FP çš„æœ€å¤§å¥½å¤„ã€‚</li><li>é€’å½’: ç”¨é€’å½’åšä¸ºæ§åˆ¶æµç¨‹çš„æœºåˆ¶ã€‚ä¾‹å¦‚åœ¨Haskellçš„ä¸–ç•Œä¸­ï¼Œæ²¡æœ‰å˜é‡èµ‹å€¼ï¼Œæµç¨‹è·³è½¬ï¼Œå¦‚æœè¦å®ç°ä¸€äº›ç®€å•çš„åŠŸèƒ½ï¼Œæ¯”å¦‚æ±‚ä¸€ä¸ªæ•°ç»„ä¸­çš„æœ€å¤§å€¼ï¼Œéƒ½éœ€è¦å€ŸåŠ©é€’å½’å®ç°ã€‚</li><li>æƒ°æ€§æ±‚å€¼(Lazy Evaluation): å®ƒè¡¨ç¤ºä¸ºâ€œå»¶è¿Ÿæ±‚å€¼â€œå’Œâ€æœ€å°åŒ–æ±‚å€¼â€œã€‚æƒ°æ€§æ±‚å€¼ä½¿å¾—ä»£ç å…·å¤‡äº†å·¨å¤§çš„ä¼˜åŒ–æ½œèƒ½ã€‚æ”¯æŒæƒ°æ€§æ±‚å€¼çš„ç¼–è¯‘å™¨ä¼šåƒæ•°å­¦å®¶çœ‹å¾…ä»£æ•°è¡¨è¾¾å¼é‚£æ ·çœ‹å¾…å‡½æ•°å¼ç¼–ç¨‹çš„ç¨‹åºï¼šæŠµæ¶ˆç›¸åŒé¡¹ä»è€Œé¿å…æ‰§è¡Œæ— è°“çš„ä»£ç ï¼Œå®‰æ’ä»£ç æ‰§è¡Œé¡ºåºä»è€Œå®ç°æ›´é«˜çš„æ‰§è¡Œæ•ˆç‡ç”šè‡³æ˜¯å‡å°‘é”™è¯¯ã€‚ æƒ°æ€§æ±‚å€¼å¦ä¸€ä¸ªé‡è¦çš„å¥½å¤„æ˜¯å®ƒå¯ä»¥æ„é€ ä¸€ä¸ªæ— é™çš„æ•°æ®ç±»å‹ï¼Œæ— éœ€è¦æ‹…å¿ƒç”±æ— ç©·è®¡ç®—æ‰€å¯¼è‡´çš„ out-of-memory é”™è¯¯ã€‚</li><li>æ²¡æœ‰"å‰¯ä½œç”¨â€(side effect)ï¼šæŒ‡çš„æ˜¯å‡½æ•°å†…éƒ¨ä¸å¤–éƒ¨äº’åŠ¨ï¼ˆæœ€å…¸å‹çš„æƒ…å†µï¼Œå°±æ˜¯ä¿®æ”¹å…¨å±€å˜é‡çš„å€¼ï¼‰ï¼Œäº§ç”Ÿè¿ç®—ä»¥å¤–çš„å…¶ä»–ç»“æœã€‚å‡½æ•°å¼ç¼–ç¨‹å¼ºè°ƒæ²¡æœ‰"å‰¯ä½œç”¨"ï¼Œæ„å‘³ç€å‡½æ•°è¦ä¿æŒç‹¬ç«‹ï¼Œæ‰€æœ‰åŠŸèƒ½å°±æ˜¯è¿”å›ä¸€ä¸ªæ–°çš„å€¼ï¼Œæ²¡æœ‰å…¶ä»–è¡Œä¸ºï¼Œå°¤å…¶æ˜¯ä¸å¾—ä¿®æ”¹å¤–éƒ¨å˜é‡çš„å€¼ã€‚</li></ul><p><strong>ä¼ ç»Ÿçš„é¢å‘å¯¹è±¡ç¼–ç¨‹é€šè¿‡æŠ½è±¡å‡ºçš„å¯¹è±¡å…³ç³»æ¥è§£å†³é—®é¢˜ã€‚å‡½æ•°å¼ç¼–ç¨‹é€šè¿‡functionçš„ç»„åˆæ¥è§£å†³é—®é¢˜ï¼Œå“åº”å¼ç¼–ç¨‹é€šè¿‡å‡½æ•°å¼ç¼–ç¨‹çš„æ–¹å¼æ¥è§£å†³å›è°ƒåœ°ç‹±çš„é—®é¢˜ã€‚</strong></p><p><a href="https://www.jianshu.com/p/0c8a692a0c7f" rel="noopener" target="_blank">æ¥æºæ–‡ç« </a></p><h1 id="8-jitå³æ—¶ç¼–è¯‘">8. JIT(å³æ—¶ç¼–è¯‘)<a aria-hidden="true" class="anchor" hidden="" href="#8-jitå³æ—¶ç¼–è¯‘">#</a></h1><p><strong>å®šä¹‰:</strong> javaä»£ç éœ€è¦ç»è¿‡ç¼–è¯‘å½¢æˆå­—èŠ‚ç ,ç„¶åè¢«ç¿»è¯‘æ‰§è¡Œ, ç¿»è¯‘è¿‡ç¨‹éœ€è¦ç¿»è¯‘å™¨æ¥æ“ä½œçš„,è€ŒJITæ˜¯æŠŠå­—èŠ‚ç ç›´æ¥ç¼–è¯‘æˆæœºå™¨ç ,å†åŠ ä¸Šä¸€äº›ä¼˜åŒ–,è¿™æ ·ä½¿å¾—javaä»£ç æ‰§è¡Œçš„æ•´ä½“é€Ÿåº¦åŠ å¿«äº†</p><p><img alt="img" loading="lazy" src="javaEE.assets/webp.webp"/></p><blockquote><p><strong>è¯´JITæ¯”è§£é‡Šå¿«ï¼Œå…¶å®è¯´çš„æ˜¯â€œæ‰§è¡Œç¼–è¯‘åçš„ä»£ç â€æ¯”â€œè§£é‡Šå™¨è§£é‡Šæ‰§è¡Œâ€è¦å¿«ï¼Œå¹¶ä¸æ˜¯è¯´â€œç¼–è¯‘â€è¿™ä¸ªåŠ¨ä½œæ¯”â€œè§£é‡Šâ€è¿™ä¸ªåŠ¨ä½œå¿«ã€‚</strong></p><p>JIT åŠ å¿«çš„æ˜¯è§£é‡Šè¿‡ç¨‹,è€Œä¸æ˜¯ç¼–è¯‘è¿‡ç¨‹, å…¶ä¸­é€ƒé€¸åˆ†æå°±æ˜¯JITçš„ä¼˜åŒ–å¤„ç†ä¹‹ä¸€,(é€ƒé€¸åˆ†æçš„ä½œç”¨ä¹‹ä¸€æ˜¯<strong>æ ˆä¸Šåˆ†é…å¯¹è±¡å†…å­˜</strong>)</p></blockquote><p><strong>æ—¢ç„¶å®ƒå¿«,ä¸ºä»€ä¹ˆä¸å…¨ç”¨JITè€Œæ˜¯è§£é‡Šå™¨+JITæ··åˆä½¿ç”¨å‘¢?</strong></p><ol><li>JITç¼–è¯‘å†æ€ä¹ˆå¿«ï¼Œè‡³å°‘ä¹Ÿæ¯”è§£é‡Šæ‰§è¡Œä¸€æ¬¡ç•¥æ…¢ä¸€äº›ï¼Œè€Œè¦å¾—åˆ°æœ€åçš„æ‰§è¡Œç»“æœè¿˜å¾—å†ç»è¿‡ä¸€ä¸ªâ€œæ‰§è¡Œç¼–è¯‘åçš„ä»£ç â€çš„è¿‡ç¨‹ã€‚æ‰€ä»¥ï¼Œå¯¹â€œåªæ‰§è¡Œä¸€æ¬¡â€çš„ä»£ç è€Œè¨€ï¼Œè§£é‡Šæ‰§è¡Œå…¶å®æ€»æ˜¯æ¯”JITç¼–è¯‘æ‰§è¡Œè¦å¿«</li><li>ç¼–è¯‘åä»£ç çš„å¤§å°ç›¸å¯¹äºå­—èŠ‚ç çš„å¤§å°ï¼Œè†¨èƒ€æ¯”è¾¾åˆ°10xæ˜¯å¾ˆæ­£å¸¸çš„ã€‚åŒä¸Šé¢è¯´çš„æ—¶é—´å¼€é”€ä¸€æ ·ï¼Œè¿™é‡Œçš„ç©ºé—´å¼€é”€ä¹Ÿæ˜¯ï¼Œåªæœ‰å¯¹æ‰§è¡Œé¢‘ç¹çš„ä»£ç æ‰å€¼å¾—ç¼–è¯‘ï¼Œå¦‚æœæŠŠæ‰€æœ‰ä»£ç éƒ½ç¼–è¯‘åˆ™ä¼šæ˜¾è‘—å¢åŠ ä»£ç æ‰€å ç©ºé—´ï¼Œå¯¼è‡´â€œä»£ç çˆ†ç‚¸â€</li></ol><p><a href="https://www.jianshu.com/p/eea12f3bf490" rel="noopener" target="_blank">æ¥æº</a></p><p><a href="https://tech.meituan.com/2020/10/22/java-jit-practice-in-meituan.html" rel="noopener" target="_blank">JITåŸç†</a></p></div><footer class="post-footer"><ul class="post-tags"><li><a href="https://xiaokunji.com/zh/tags/java.html">java</a></li><li><a href="https://xiaokunji.com/zh/tags/%E7%BB%BC%E5%90%88.html">ç»¼åˆ</a></li></ul><nav class="paginav"><a class="prev" href="https://xiaokunji.com/zh/java%E5%8F%8A%E5%85%B6%E6%A1%86%E6%9E%B6/java%E5%9F%BA%E7%A1%80/java8.html"><span class="title">Â« ä¸Šä¸€é¡µ</span><br/><span>java8</span>
</a><a class="next" href="https://xiaokunji.com/zh/%E7%BB%BC%E5%90%88/%E4%B8%AA%E4%BA%BA%E5%B0%8F%E7%9F%A5%E8%AF%86/%E4%BB%A3%E7%A0%81%E7%B1%BB/java%E6%93%8D%E4%BD%9Cword%E6%96%87%E6%A1%A3.html"><span class="title">ä¸‹ä¸€é¡µ Â»</span><br/><span>javaæ“ä½œwordæ–‡æ¡£</span></a></nav></footer></article></main><script async="" src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><footer class="footer"><span>Copyright
Â©
-2023
<a href="https://xiaokunji.com/zh/" style="color:#939393">ç±³äºŒ</a>
All Rights Reserved
</span><span id="busuanzi_container"><span class="fa fa-user">ç”¨æˆ·æ•°:</span><span id="busuanzi_value_site_uv"></span>
<span class="fa fa-eye">è®¿é—®æ•°:</span><span id="busuanzi_value_site_pv"></span></span></footer><a accesskey="g" aria-label="go to top" class="top-link" href="#top" id="top-link" title="Go to Top (Alt + G)"><svg fill="currentcolor" viewbox="0 0 12 6" xmlns="http://www.w3.org/2000/svg"><path d="M12 6H0l6-6z"></path></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="å¤åˆ¶";function s(){t.innerHTML="å·²å¤åˆ¶ï¼",setTimeout(()=>{t.innerHTML="å¤åˆ¶"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>